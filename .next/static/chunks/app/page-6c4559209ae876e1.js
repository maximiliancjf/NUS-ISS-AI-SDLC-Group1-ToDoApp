(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{63:(e,t,a)=>{"use strict";var r=a(7260);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},7322:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(5155),s=a(2115),l=a(2619),o=a.n(l),n=a(63);function i(){var e;let t=(0,n.useRouter)(),[a,l]=(0,s.useState)([]),[i,d]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[p,m]=(0,s.useState)("medium"),[x,g]=(0,s.useState)(null),[h,b]=(0,s.useState)(!0),[y,f]=(0,s.useState)(new Set),[j,v]=(0,s.useState)({}),[N,w]=(0,s.useState)(null),[C,k]=(0,s.useState)([]),[D,S]=(0,s.useState)(!1),[E,T]=(0,s.useState)(""),[O,_]=(0,s.useState)([]),[P,A]=(0,s.useState)(null),[L,F]=(0,s.useState)(""),[J,R]=(0,s.useState)("all"),[M,I]=(0,s.useState)("all"),[U,B]=(0,s.useState)(!1),[H,z]=(0,s.useState)(""),[W,q]=(0,s.useState)([]),[K,Y]=(0,s.useState)(!1),[G,Q]=(0,s.useState)(!1),[V,X]=(0,s.useState)(null),[Z,$]=(0,s.useState)(""),[ee,et]=(0,s.useState)(null),[ea,er]=(0,s.useState)(""),[es,el]=(0,s.useState)(null),[eo,en]=(0,s.useState)("default"),[ei,ed]=(0,s.useState)("");(0,s.useEffect)(()=>{ec(),eu(),ep(),em(),ex();let e=setInterval(eh,6e4);return()=>clearInterval(e)},[]);let ec=async()=>{try{let e=await fetch("/api/auth/session"),t=await e.json();t.user&&ed(t.user.username)}catch(e){console.error("Error fetching user:",e)}},eu=async()=>{try{let e=await fetch("/api/todos"),t=await e.json();l(t)}catch(e){console.error("Error fetching todos:",e)}finally{b(!1)}},ep=async()=>{try{let e=await fetch("/api/tags"),t=await e.json();k(t)}catch(e){console.error("Error fetching tags:",e)}},em=async()=>{try{let e=await fetch("/api/templates"),t=await e.json();q(t)}catch(e){console.error("Error fetching templates:",e)}},ex=()=>{"Notification"in window&&en(Notification.permission)},eg=async()=>{"Notification"in window&&"default"===Notification.permission&&en(await Notification.requestPermission())},eh=async()=>{if("granted"===eo)try{let e=await fetch("/api/reminders");for(let t of(await e.json()))new Notification("Todo Reminder",{body:'"'.concat(t.title,'" is due ').concat(eb(t)),icon:"/favicon.ico",tag:"todo-".concat(t.id)})}catch(e){console.error("Error checking reminders:",e)}},eb=e=>{let t=new Date(e.due_date),a=new Date,r=t.getTime()-a.getTime(),s=Math.floor(r/36e5),l=Math.floor(r%36e5/6e4);if(s>24){let e=Math.floor(s/24);return"in ".concat(e," day").concat(1!==e?"s":"")}return s>0?"in ".concat(s," hour").concat(1!==s?"s":""):l>0?"in ".concat(l," minute").concat(1!==l?"s":""):"soon"},ey=async e=>{if(e.preventDefault(),i.trim()&&c)try{if(x){let e=await fetch("/api/todos/".concat(x),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:i,due_date:c,priority:p})}),t=await e.json();l(a.map(e=>e.id===x?{...t,subtasks:e.subtasks}:e)),g(null)}else{let e=await fetch("/api/todos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:i,due_date:c,priority:p,recurrence_pattern:H||null,reminder_minutes:es})}),t=await e.json();l([...a,{...t,subtasks:[],tags:[]}])}d(""),u(""),m("medium"),z(""),el(null),B(!1)}catch(e){console.error("Error saving todo:",e)}},ef=async e=>{try{let t=await fetch("/api/todos/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:+!e.completed})}),r=await t.json();l(a.map(t=>t.id===e.id?{...r,subtasks:t.subtasks}:t))}catch(e){console.error("Error toggling todo:",e)}},ej=async e=>{if(confirm("Are you sure you want to delete this todo?"))try{await fetch("/api/todos/".concat(e),{method:"DELETE"}),l(a.filter(t=>t.id!==e))}catch(e){console.error("Error deleting todo:",e)}},ev=async e=>{var t;let r=null==(t=j[e])?void 0:t.trim();if(r)try{let t=await fetch("/api/subtasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({todo_id:e,title:r})}),s=await t.json();l(a.map(t=>t.id===e?{...t,subtasks:[...t.subtasks,s]}:t)),v({...j,[e]:""}),w(null)}catch(e){console.error("Error adding subtask:",e)}},eN=async(e,t)=>{try{let r=await fetch("/api/subtasks/".concat(t.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:+!t.completed})}),s=await r.json();l(a.map(a=>a.id===e?{...a,subtasks:a.subtasks.map(e=>e.id===t.id?s:e)}:a))}catch(e){console.error("Error toggling subtask:",e)}},ew=async(e,t)=>{try{await fetch("/api/subtasks/".concat(t),{method:"DELETE"}),l(a.map(a=>a.id===e?{...a,subtasks:a.subtasks.filter(e=>e.id!==t)}:a))}catch(e){console.error("Error deleting subtask:",e)}},eC=async()=>{if(E.trim())try{let e=await fetch("/api/tags",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:E})}),t=await e.json();k([...C,t]),T("")}catch(e){console.error("Error creating tag:",e)}},ek=async e=>{if(confirm("Delete this tag? It will be removed from all todos."))try{await fetch("/api/tags/".concat(e),{method:"DELETE"}),k(C.filter(t=>t.id!==e)),l(a.map(t=>({...t,tags:t.tags.filter(t=>t.id!==e)})))}catch(e){console.error("Error deleting tag:",e)}},eD=async(e,t)=>{let r=a.find(t=>t.id===e),s=null==r?void 0:r.tags.some(e=>e.id===t);try{if(s)await fetch("/api/todos/".concat(e,"/tags?tagId=").concat(t),{method:"DELETE"}),l(a.map(a=>a.id===e?{...a,tags:a.tags.filter(e=>e.id!==t)}:a));else{await fetch("/api/todos/".concat(e,"/tags"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag_id:t})});let r=C.find(e=>e.id===t);r&&l(a.map(t=>t.id===e?{...t,tags:[...t.tags,r]}:t))}}catch(e){console.error("Error toggling tag:",e)}},eS=()=>a.filter(e=>{if(L){let t=L.toLowerCase(),a=e.title.toLowerCase().includes(t),r=e.tags.some(e=>e.name.toLowerCase().includes(t)),s=e.subtasks.some(e=>e.title.toLowerCase().includes(t));if(!a&&!r&&!s)return!1}return("all"===J||e.priority===J)&&("active"!==M||!e.completed)&&("completed"!==M||!!e.completed)&&(!P||!!e.tags.some(e=>e.id===P))}),eE=L||"all"!==J||"all"!==M||null!==P,eT=async()=>{try{let e=await fetch("/api/export"),t=await e.json(),a=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download="todos-backup-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}catch(e){console.error("Error exporting:",e),alert("Failed to export data")}},eO=async e=>{var t,a,r;let s=null==(t=e.target.files)?void 0:t[0];if(s)try{let e=await s.text(),t=JSON.parse(e);if(!confirm("Import ".concat((null==(a=t.todos)?void 0:a.length)||0," todos and ").concat((null==(r=t.tags)?void 0:r.length)||0," tags?")))return;(await fetch("/api/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(alert("Data imported successfully!"),eu(),ep()):alert("Failed to import data")}catch(e){console.error("Error importing:",e),alert("Failed to import data - invalid file format")}},e_=async()=>{if(V&&Z.trim())try{(await fetch("/api/templates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Z,todoId:V})})).ok?(alert("Template saved successfully!"),Q(!1),$(""),X(null),em()):alert("Failed to save template")}catch(e){console.error("Error saving template:",e),alert("Failed to save template")}},eP=async e=>{if(confirm("Delete this template?"))try{(await fetch("/api/templates/".concat(e),{method:"DELETE"})).ok?em():alert("Failed to delete template")}catch(e){console.error("Error deleting template:",e),alert("Failed to delete template")}},eA=async()=>{if(!ee||!ea)return void alert("Please select a template and due date");try{(await fetch("/api/templates/".concat(ee),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dueDate:ea})})).ok?(alert("Todo created from template!"),Y(!1),et(null),er(""),eu()):alert("Failed to create todo from template")}catch(e){console.error("Error using template:",e),alert("Failed to create todo from template")}},eL=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),t.push("/login")}catch(e){console.error("Error logging out:",e)}},eF=e=>{switch(e){case"high":return"bg-red-100 text-red-800 border-red-300";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"low":return"bg-green-100 text-green-800 border-green-300"}};return h?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-xl text-gray-600",children:"Loading todos..."})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"\uD83D\uDCDD My Todo App"}),ei&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Welcome, ",(0,r.jsx)("span",{className:"font-semibold",children:ei})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(o(),{href:"/calendar",className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition",children:"\uD83D\uDCC5 Calendar"}),(0,r.jsx)("button",{onClick:eT,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",title:"Export all data",children:"\uD83D\uDCE5 Export"}),(0,r.jsxs)("label",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition cursor-pointer",children:["\uD83D\uDCE4 Import",(0,r.jsx)("input",{type:"file",accept:".json",onChange:eO,className:"hidden"})]}),(0,r.jsx)("button",{onClick:()=>S(!0),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",children:"\uD83C\uDFF7️ Manage Tags"}),(0,r.jsx)("button",{onClick:()=>Y(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition",children:"\uD83D\uDCCB Templates"}),(0,r.jsx)("button",{onClick:eL,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",title:"Logout",children:"\uD83D\uDEAA Logout"})]})]}),C.length>0&&(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Filter by Tag:"}),(0,r.jsx)("button",{onClick:()=>A(null),className:"px-3 py-1 rounded-full text-sm transition ".concat(null===P?"bg-gray-800 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"All"}),C.map(e=>(0,r.jsx)("button",{onClick:()=>A(P===e.id?null:e.id),className:"px-3 py-1 rounded-full text-sm transition border-2 ".concat(P===e.id?"border-gray-800 font-bold":"border-transparent"),style:{backgroundColor:P===e.id?e.color:e.color+"40",color:P===e.id?"#fff":"#000"},children:e.name},e.id))]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsx)("input",{type:"text",value:L,onChange:e=>F(e.target.value),placeholder:"\uD83D\uDD0D Search todos, tags, subtasks...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:J,onChange:e=>R(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"all",children:"All Priorities"}),(0,r.jsx)("option",{value:"high",children:"High Priority"}),(0,r.jsx)("option",{value:"medium",children:"Medium Priority"}),(0,r.jsx)("option",{value:"low",children:"Low Priority"})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:M,onChange:e=>I(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"all",children:"All Status"}),(0,r.jsx)("option",{value:"active",children:"Active Only"}),(0,r.jsx)("option",{value:"completed",children:"Completed Only"})]})})]}),eE&&(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Active filters:"}),L&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:['Search: "',L,'"']}),"all"!==J&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-sm",children:["Priority: ",J]}),"all"!==M&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-sm",children:["Status: ",M]}),P&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-sm",children:["Tag: ",null==(e=C.find(e=>e.id===P))?void 0:e.name]}),(0,r.jsx)("button",{onClick:()=>{F(""),R("all"),I("all"),A(null)},className:"ml-auto px-3 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200 text-sm",children:"Clear All"})]})]}),D&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>S(!1),children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Tags"}),(0,r.jsx)("button",{onClick:()=>S(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"\xd7"})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:E,onChange:e=>T(e.target.value),placeholder:"New tag name...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",onKeyPress:e=>"Enter"===e.key&&eC()}),(0,r.jsx)("button",{onClick:eC,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",children:"Add"})]})}),(0,r.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:0===C.length?(0,r.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No tags yet. Create one above!"}):C.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:e.color}}),(0,r.jsx)("span",{className:"font-medium",children:e.name})]}),(0,r.jsx)("button",{onClick:()=>ek(e.id),className:"text-red-600 hover:text-red-800",children:"Delete"})]},e.id))})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:x?"Edit Todo":"Add New Todo"}),(0,r.jsxs)("form",{onSubmit:ey,className:"space-y-4",children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),placeholder:"What needs to be done?",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"date",value:c,onChange:e=>u(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"low",children:"Low Priority"}),(0,r.jsx)("option",{value:"medium",children:"Medium Priority"}),(0,r.jsx)("option",{value:"high",children:"High Priority"})]})})]}),(0,r.jsx)("div",{children:(0,r.jsxs)("button",{type:"button",onClick:()=>B(!U),className:"text-sm text-blue-600 hover:text-blue-800",children:[U?"▼":"▶"," Advanced Options"]})}),U&&(0,r.jsxs)("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recurrence Pattern"}),(0,r.jsxs)("select",{value:H,onChange:e=>z(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"",children:"No Recurrence"}),(0,r.jsx)("option",{value:"daily",children:"Daily"}),(0,r.jsx)("option",{value:"weekly",children:"Weekly"}),(0,r.jsx)("option",{value:"monthly",children:"Monthly"}),(0,r.jsx)("option",{value:"yearly",children:"Yearly"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reminder","granted"!==eo&&(0,r.jsx)("button",{type:"button",onClick:eg,className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline",children:"Enable Notifications"})]}),(0,r.jsxs)("select",{value:null!=es?es:"",onChange:e=>el(e.target.value?parseInt(e.target.value):null),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"",children:"No Reminder"}),(0,r.jsx)("option",{value:"15",children:"15 minutes before"}),(0,r.jsx)("option",{value:"30",children:"30 minutes before"}),(0,r.jsx)("option",{value:"60",children:"1 hour before"}),(0,r.jsx)("option",{value:"120",children:"2 hours before"}),(0,r.jsx)("option",{value:"1440",children:"1 day before"}),(0,r.jsx)("option",{value:"2880",children:"2 days before"}),(0,r.jsx)("option",{value:"10080",children:"1 week before"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition",children:x?"Update Todo":"Add Todo"}),x&&(0,r.jsx)("button",{type:"button",onClick:()=>{g(null),d(""),u(""),m("medium")},className:"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition",children:"Cancel"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:[eS().filter(e=>!e.completed).length," Active Tasks",eE&&(0,r.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:["(of ",a.filter(e=>!e.completed).length," total)"]})]}),0===a.length?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center text-gray-500",children:"No todos yet. Add one above to get started! \uD83D\uDE80"}):0===eS().length?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center text-gray-500",children:"No todos match your filters. Try adjusting your search criteria."}):eS().map(e=>{let t=(e=>{if(0===e.length)return null;let t=e.filter(e=>e.completed).length,a=Math.round(t/e.length*100);return{completed:t,total:e.length,percentage:a}})(e.subtasks),a=y.has(e.id);return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"p-4 flex items-center gap-4 transition ".concat(e.completed?"opacity-60":""),children:[(0,r.jsx)("input",{type:"checkbox",checked:!!e.completed,onChange:()=>ef(e),className:"w-5 h-5 cursor-pointer"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium ".concat(e.completed?"line-through text-gray-500":"text-gray-900"),children:[e.title,e.recurrence_pattern&&(0,r.jsxs)("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded",children:["\uD83D\uDD04 ",e.recurrence_pattern]})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Due: ",new Date(e.due_date).toLocaleDateString()]}),e.tags&&e.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.tags.map(e=>(0,r.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium text-white",style:{backgroundColor:e.color},children:e.name},e.id))}),t&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:"".concat(t.percentage,"%")}})}),(0,r.jsxs)("span",{className:"text-xs text-gray-600",children:[t.completed,"/",t.total]})]})})]}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium border ".concat(eF(e.priority)),children:e.priority.toUpperCase()}),(0,r.jsxs)("div",{className:"flex gap-2",children:[e.subtasks.length>0&&(0,r.jsxs)("button",{onClick:()=>(e=>{let t=new Set(y);t.has(e)?t.delete(e):t.add(e),f(t)})(e.id),className:"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition text-sm",children:[a?"▼":"▶"," ",e.subtasks.length]}),C.length>0&&(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("button",{className:"px-3 py-1 bg-indigo-100 text-indigo-700 rounded hover:bg-indigo-200 transition text-sm",title:"Manage tags",children:"\uD83C\uDFF7️"}),(0,r.jsx)("div",{className:"hidden group-hover:block absolute right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-2 z-10 min-w-[150px]",children:C.map(t=>(0,r.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:e.tags.some(e=>e.id===t.id),onChange:()=>eD(e.id,t.id),className:"w-4 h-4"}),(0,r.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:t.color}}),(0,r.jsx)("span",{className:"text-sm",children:t.name})]},t.id))})]}),(0,r.jsx)("button",{onClick:()=>w(N===e.id?null:e.id),className:"px-3 py-1 bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition text-sm",title:"Add subtask",children:"+"}),(0,r.jsx)("button",{onClick:()=>{X(e.id),Q(!0)},className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200 transition text-sm",title:"Save as template",children:"\uD83D\uDCCB"}),(0,r.jsx)("button",{onClick:()=>{g(e.id),d(e.title),u(e.due_date.split("T")[0]),m(e.priority)},className:"px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition text-sm",disabled:!!e.completed,children:"Edit"}),(0,r.jsx)("button",{onClick:()=>ej(e.id),className:"px-3 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200 transition text-sm",children:"Delete"})]})]}),N===e.id&&(0,r.jsx)("div",{className:"px-4 pb-3 border-t border-gray-200 pt-3",children:(0,r.jsxs)("div",{className:"flex gap-2 ml-9",children:[(0,r.jsx)("input",{type:"text",value:j[e.id]||"",onChange:t=>v({...j,[e.id]:t.target.value}),placeholder:"New subtask...",className:"flex-1 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent",onKeyPress:t=>"Enter"===t.key&&ev(e.id),autoFocus:!0}),(0,r.jsx)("button",{onClick:()=>ev(e.id),className:"px-3 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 text-sm",children:"Add"}),(0,r.jsx)("button",{onClick:()=>w(null),className:"px-3 py-1 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 text-sm",children:"Cancel"})]})}),a&&e.subtasks.length>0&&(0,r.jsx)("div",{className:"px-4 pb-4 border-t border-gray-200",children:e.subtasks.map(t=>(0,r.jsxs)("div",{className:"flex items-center gap-3 py-2 ml-9 border-l-2 border-gray-300 pl-4",children:[(0,r.jsx)("input",{type:"checkbox",checked:!!t.completed,onChange:()=>eN(e.id,t),className:"w-4 h-4 cursor-pointer"}),(0,r.jsx)("span",{className:"flex-1 text-sm ".concat(t.completed?"line-through text-gray-500":"text-gray-700"),children:t.title}),(0,r.jsx)("button",{onClick:()=>ew(e.id,t.id),className:"text-red-600 hover:text-red-800 text-sm",children:"✕"})]},t.id))})]},e.id)})]}),eS().some(e=>e.completed)&&(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:["✅ Completed (",eS().filter(e=>e.completed).length,")"]})}),G&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Save as Template"}),(0,r.jsx)("input",{type:"text",value:Z,onChange:e=>$(e.target.value),placeholder:"Template name (e.g., Weekly Report)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg mb-4",autoFocus:!0}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,r.jsx)("button",{onClick:()=>{Q(!1),$(""),X(null)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Cancel"}),(0,r.jsx)("button",{onClick:e_,disabled:!Z.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]})]})}),K&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDCCB Templates"}),0===W.length?(0,r.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No templates yet. Save a todo as a template to reuse it later!"}):(0,r.jsx)("div",{className:"space-y-3 mb-6",children:W.map(e=>{let t=e.subtasks_json?JSON.parse(e.subtasks_json):[],a=e.tag_ids_json?JSON.parse(e.tag_ids_json):[],s=C.filter(e=>a.includes(e.id));return(0,r.jsxs)("div",{className:"p-4 border rounded-lg cursor-pointer transition ".concat(ee===e.id?"border-purple-600 bg-purple-50":"border-gray-200 hover:border-purple-300"),onClick:()=>et(e.id),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(eF(e.priority)),children:e.priority.toUpperCase()}),0!==e.due_date_offset&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["Due: ",e.due_date_offset>0?"+":"",e.due_date_offset," days"]})]})]}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),eP(e.id)},className:"text-red-600 hover:text-red-800",children:"✕"})]}),t.length>0&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:["\uD83D\uDCCB ",t.length," subtask",1!==t.length?"s":""]}),s.length>0&&(0,r.jsx)("div",{className:"flex gap-2 mt-2 flex-wrap",children:s.map(e=>(0,r.jsx)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:e.color+"40"},children:e.name},e.id))})]},e.id)})}),ee&&(0,r.jsxs)("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date for New Todo"}),(0,r.jsx)("input",{type:"date",value:ea,onChange:e=>er(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,r.jsx)("button",{onClick:()=>{Y(!1),et(null),er("")},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Close"}),(0,r.jsx)("button",{onClick:eA,disabled:!ee||!ea,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Todo"})]})]})})]})})}},9370:(e,t,a)=>{Promise.resolve().then(a.bind(a,7322))}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=9370)),_N_E=e.O()}]);