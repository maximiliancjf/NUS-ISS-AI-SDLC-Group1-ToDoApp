"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@simplewebauthn";
exports.ids = ["vendor-chunks/@simplewebauthn"];
exports.modules = {

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/authentication/generateAuthenticationOptions.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/authentication/generateAuthenticationOptions.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateAuthenticationOptions: () => (/* binding */ generateAuthenticationOptions)\n/* harmony export */ });\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _helpers_generateChallenge_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/generateChallenge.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateChallenge.js\");\n\n\n/**\n * Prepare a value to pass into navigator.credentials.get(...) for authenticator authentication\n *\n * **Options:**\n *\n * @param rpID - Valid domain name (after `https://`)\n * @param allowCredentials **(Optional)** - Authenticators previously registered by the user, if any. If undefined the client will ask the user which credential they want to use\n * @param challenge **(Optional)** - Random value the authenticator needs to sign and pass back user for authentication. Defaults to generating a random value\n * @param timeout **(Optional)** - How long (in ms) the user can take to complete authentication. Defaults to `60000`\n * @param userVerification **(Optional)** - Set to `'discouraged'` when asserting as part of a 2FA flow, otherwise set to `'preferred'` or `'required'` as desired. Defaults to `\"preferred\"`\n * @param extensions **(Optional)** - Additional plugins the authenticator or browser should use during authentication\n */\nasync function generateAuthenticationOptions(options) {\n    const { allowCredentials, challenge = await (0,_helpers_generateChallenge_js__WEBPACK_IMPORTED_MODULE_1__.generateChallenge)(), timeout = 60000, userVerification = 'preferred', extensions, rpID, } = options;\n    /**\n     * Preserve ability to specify `string` values for challenges\n     */\n    let _challenge = challenge;\n    if (typeof _challenge === 'string') {\n        _challenge = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoUint8Array.fromUTF8String(_challenge);\n    }\n    return {\n        rpId: rpID,\n        challenge: _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.fromBuffer(_challenge),\n        allowCredentials: allowCredentials?.map((cred) => {\n            if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.isBase64URL(cred.id)) {\n                throw new Error(`excludeCredential id \"${cred.id}\" is not a valid base64url string`);\n            }\n            return {\n                ...cred,\n                id: _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.trimPadding(cred.id),\n                type: 'public-key',\n            };\n        }),\n        timeout,\n        userVerification,\n        extensions,\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vYXV0aGVudGljYXRpb24vZ2VuZXJhdGVBdXRoZW50aWNhdGlvbk9wdGlvbnMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXNFO0FBQ0Y7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxZQUFZLG9DQUFvQyxnRkFBaUIseUVBQXlFO0FBQzFJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsK0VBQTRCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwwRUFBdUI7QUFDMUM7QUFDQSxpQkFBaUIsMkVBQXdCO0FBQ3pDLHlEQUF5RCxRQUFRO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwyRUFBd0I7QUFDNUM7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcYXV0aGVudGljYXRpb25cXGdlbmVyYXRlQXV0aGVudGljYXRpb25PcHRpb25zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzb0Jhc2U2NFVSTCwgaXNvVWludDhBcnJheSB9IGZyb20gJy4uL2hlbHBlcnMvaXNvL2luZGV4LmpzJztcbmltcG9ydCB7IGdlbmVyYXRlQ2hhbGxlbmdlIH0gZnJvbSAnLi4vaGVscGVycy9nZW5lcmF0ZUNoYWxsZW5nZS5qcyc7XG4vKipcbiAqIFByZXBhcmUgYSB2YWx1ZSB0byBwYXNzIGludG8gbmF2aWdhdG9yLmNyZWRlbnRpYWxzLmdldCguLi4pIGZvciBhdXRoZW50aWNhdG9yIGF1dGhlbnRpY2F0aW9uXG4gKlxuICogKipPcHRpb25zOioqXG4gKlxuICogQHBhcmFtIHJwSUQgLSBWYWxpZCBkb21haW4gbmFtZSAoYWZ0ZXIgYGh0dHBzOi8vYClcbiAqIEBwYXJhbSBhbGxvd0NyZWRlbnRpYWxzICoqKE9wdGlvbmFsKSoqIC0gQXV0aGVudGljYXRvcnMgcHJldmlvdXNseSByZWdpc3RlcmVkIGJ5IHRoZSB1c2VyLCBpZiBhbnkuIElmIHVuZGVmaW5lZCB0aGUgY2xpZW50IHdpbGwgYXNrIHRoZSB1c2VyIHdoaWNoIGNyZWRlbnRpYWwgdGhleSB3YW50IHRvIHVzZVxuICogQHBhcmFtIGNoYWxsZW5nZSAqKihPcHRpb25hbCkqKiAtIFJhbmRvbSB2YWx1ZSB0aGUgYXV0aGVudGljYXRvciBuZWVkcyB0byBzaWduIGFuZCBwYXNzIGJhY2sgdXNlciBmb3IgYXV0aGVudGljYXRpb24uIERlZmF1bHRzIHRvIGdlbmVyYXRpbmcgYSByYW5kb20gdmFsdWVcbiAqIEBwYXJhbSB0aW1lb3V0ICoqKE9wdGlvbmFsKSoqIC0gSG93IGxvbmcgKGluIG1zKSB0aGUgdXNlciBjYW4gdGFrZSB0byBjb21wbGV0ZSBhdXRoZW50aWNhdGlvbi4gRGVmYXVsdHMgdG8gYDYwMDAwYFxuICogQHBhcmFtIHVzZXJWZXJpZmljYXRpb24gKiooT3B0aW9uYWwpKiogLSBTZXQgdG8gYCdkaXNjb3VyYWdlZCdgIHdoZW4gYXNzZXJ0aW5nIGFzIHBhcnQgb2YgYSAyRkEgZmxvdywgb3RoZXJ3aXNlIHNldCB0byBgJ3ByZWZlcnJlZCdgIG9yIGAncmVxdWlyZWQnYCBhcyBkZXNpcmVkLiBEZWZhdWx0cyB0byBgXCJwcmVmZXJyZWRcImBcbiAqIEBwYXJhbSBleHRlbnNpb25zICoqKE9wdGlvbmFsKSoqIC0gQWRkaXRpb25hbCBwbHVnaW5zIHRoZSBhdXRoZW50aWNhdG9yIG9yIGJyb3dzZXIgc2hvdWxkIHVzZSBkdXJpbmcgYXV0aGVudGljYXRpb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQXV0aGVudGljYXRpb25PcHRpb25zKG9wdGlvbnMpIHtcbiAgICBjb25zdCB7IGFsbG93Q3JlZGVudGlhbHMsIGNoYWxsZW5nZSA9IGF3YWl0IGdlbmVyYXRlQ2hhbGxlbmdlKCksIHRpbWVvdXQgPSA2MDAwMCwgdXNlclZlcmlmaWNhdGlvbiA9ICdwcmVmZXJyZWQnLCBleHRlbnNpb25zLCBycElELCB9ID0gb3B0aW9ucztcbiAgICAvKipcbiAgICAgKiBQcmVzZXJ2ZSBhYmlsaXR5IHRvIHNwZWNpZnkgYHN0cmluZ2AgdmFsdWVzIGZvciBjaGFsbGVuZ2VzXG4gICAgICovXG4gICAgbGV0IF9jaGFsbGVuZ2UgPSBjaGFsbGVuZ2U7XG4gICAgaWYgKHR5cGVvZiBfY2hhbGxlbmdlID09PSAnc3RyaW5nJykge1xuICAgICAgICBfY2hhbGxlbmdlID0gaXNvVWludDhBcnJheS5mcm9tVVRGOFN0cmluZyhfY2hhbGxlbmdlKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcnBJZDogcnBJRCxcbiAgICAgICAgY2hhbGxlbmdlOiBpc29CYXNlNjRVUkwuZnJvbUJ1ZmZlcihfY2hhbGxlbmdlKSxcbiAgICAgICAgYWxsb3dDcmVkZW50aWFsczogYWxsb3dDcmVkZW50aWFscz8ubWFwKChjcmVkKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWlzb0Jhc2U2NFVSTC5pc0Jhc2U2NFVSTChjcmVkLmlkKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgZXhjbHVkZUNyZWRlbnRpYWwgaWQgXCIke2NyZWQuaWR9XCIgaXMgbm90IGEgdmFsaWQgYmFzZTY0dXJsIHN0cmluZ2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAuLi5jcmVkLFxuICAgICAgICAgICAgICAgIGlkOiBpc29CYXNlNjRVUkwudHJpbVBhZGRpbmcoY3JlZC5pZCksXG4gICAgICAgICAgICAgICAgdHlwZTogJ3B1YmxpYy1rZXknLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICAgIHRpbWVvdXQsXG4gICAgICAgIHVzZXJWZXJpZmljYXRpb24sXG4gICAgICAgIGV4dGVuc2lvbnMsXG4gICAgfTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/authentication/generateAuthenticationOptions.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/authentication/verifyAuthenticationResponse.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/authentication/verifyAuthenticationResponse.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyAuthenticationResponse: () => (/* binding */ verifyAuthenticationResponse)\n/* harmony export */ });\n/* harmony import */ var _helpers_decodeClientDataJSON_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/decodeClientDataJSON.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeClientDataJSON.js\");\n/* harmony import */ var _helpers_toHash_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/toHash.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js\");\n/* harmony import */ var _helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/verifySignature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\");\n/* harmony import */ var _helpers_parseAuthenticatorData_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../helpers/parseAuthenticatorData.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseAuthenticatorData.js\");\n/* harmony import */ var _helpers_parseBackupFlags_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/parseBackupFlags.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseBackupFlags.js\");\n/* harmony import */ var _helpers_matchExpectedRPID_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../helpers/matchExpectedRPID.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/matchExpectedRPID.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n\n\n\n\n\n\n/**\n * Verify that the user has legitimately completed the authentication process\n *\n * **Options:**\n *\n * @param response - Response returned by **@simplewebauthn/browser**'s `startAssertion()`\n * @param expectedChallenge - The base64url-encoded `options.challenge` returned by `generateAuthenticationOptions()`\n * @param expectedOrigin - Website URL (or array of URLs) that the registration should have occurred on\n * @param expectedRPID - RP ID (or array of IDs) that was specified in the registration options\n * @param authenticator - An internal {@link AuthenticatorDevice} matching the credential's ID\n * @param expectedType **(Optional)** - The response type expected ('webauthn.get')\n * @param requireUserVerification **(Optional)** - Enforce user verification by the authenticator (via PIN, fingerprint, etc...) Defaults to `true`\n * @param advancedFIDOConfig **(Optional)** - Options for satisfying more stringent FIDO RP feature requirements\n * @param advancedFIDOConfig.userVerification **(Optional)** - Enable alternative rules for evaluating the User Presence and User Verified flags in authenticator data: UV (and UP) flags are optional unless this value is `\"required\"`\n */\nasync function verifyAuthenticationResponse(options) {\n    const { response, expectedChallenge, expectedOrigin, expectedRPID, expectedType, authenticator, requireUserVerification = true, advancedFIDOConfig, } = options;\n    const { id, rawId, type: credentialType, response: assertionResponse } = response;\n    // Ensure credential specified an ID\n    if (!id) {\n        throw new Error('Missing credential ID');\n    }\n    // Ensure ID is base64url-encoded\n    if (id !== rawId) {\n        throw new Error('Credential ID was not base64url-encoded');\n    }\n    // Make sure credential type is public-key\n    if (credentialType !== 'public-key') {\n        throw new Error(`Unexpected credential type ${credentialType}, expected \"public-key\"`);\n    }\n    if (!response) {\n        throw new Error('Credential missing response');\n    }\n    if (typeof assertionResponse?.clientDataJSON !== 'string') {\n        throw new Error('Credential response clientDataJSON was not a string');\n    }\n    const clientDataJSON = (0,_helpers_decodeClientDataJSON_js__WEBPACK_IMPORTED_MODULE_0__.decodeClientDataJSON)(assertionResponse.clientDataJSON);\n    const { type, origin, challenge, tokenBinding } = clientDataJSON;\n    // Make sure we're handling an authentication\n    if (Array.isArray(expectedType)) {\n        if (!expectedType.includes(type)) {\n            const joinedExpectedType = expectedType.join(', ');\n            throw new Error(`Unexpected authentication response type \"${type}\", expected one of: ${joinedExpectedType}`);\n        }\n    }\n    else if (expectedType) {\n        if (type !== expectedType) {\n            throw new Error(`Unexpected authentication response type \"${type}\", expected \"${expectedType}\"`);\n        }\n    }\n    else if (type !== 'webauthn.get') {\n        throw new Error(`Unexpected authentication response type: ${type}`);\n    }\n    // Ensure the device provided the challenge we gave it\n    if (typeof expectedChallenge === 'function') {\n        if (!(await expectedChallenge(challenge))) {\n            throw new Error(`Custom challenge verifier returned false for registration response challenge \"${challenge}\"`);\n        }\n    }\n    else if (challenge !== expectedChallenge) {\n        throw new Error(`Unexpected authentication response challenge \"${challenge}\", expected \"${expectedChallenge}\"`);\n    }\n    // Check that the origin is our site\n    if (Array.isArray(expectedOrigin)) {\n        if (!expectedOrigin.includes(origin)) {\n            const joinedExpectedOrigin = expectedOrigin.join(', ');\n            throw new Error(`Unexpected authentication response origin \"${origin}\", expected one of: ${joinedExpectedOrigin}`);\n        }\n    }\n    else {\n        if (origin !== expectedOrigin) {\n            throw new Error(`Unexpected authentication response origin \"${origin}\", expected \"${expectedOrigin}\"`);\n        }\n    }\n    if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoBase64URL.isBase64URL(assertionResponse.authenticatorData)) {\n        throw new Error('Credential response authenticatorData was not a base64url string');\n    }\n    if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoBase64URL.isBase64URL(assertionResponse.signature)) {\n        throw new Error('Credential response signature was not a base64url string');\n    }\n    if (assertionResponse.userHandle &&\n        typeof assertionResponse.userHandle !== 'string') {\n        throw new Error('Credential response userHandle was not a string');\n    }\n    if (tokenBinding) {\n        if (typeof tokenBinding !== 'object') {\n            throw new Error('ClientDataJSON tokenBinding was not an object');\n        }\n        if (['present', 'supported', 'notSupported'].indexOf(tokenBinding.status) < 0) {\n            throw new Error(`Unexpected tokenBinding status ${tokenBinding.status}`);\n        }\n    }\n    const authDataBuffer = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoBase64URL.toBuffer(assertionResponse.authenticatorData);\n    const parsedAuthData = (0,_helpers_parseAuthenticatorData_js__WEBPACK_IMPORTED_MODULE_3__.parseAuthenticatorData)(authDataBuffer);\n    const { rpIdHash, flags, counter, extensionsData } = parsedAuthData;\n    // Make sure the response's RP ID is ours\n    let expectedRPIDs = [];\n    if (typeof expectedRPID === 'string') {\n        expectedRPIDs = [expectedRPID];\n    }\n    else {\n        expectedRPIDs = expectedRPID;\n    }\n    const matchedRPID = await (0,_helpers_matchExpectedRPID_js__WEBPACK_IMPORTED_MODULE_5__.matchExpectedRPID)(rpIdHash, expectedRPIDs);\n    if (advancedFIDOConfig !== undefined) {\n        const { userVerification: fidoUserVerification } = advancedFIDOConfig;\n        /**\n         * Use FIDO Conformance-defined rules for verifying UP and UV flags\n         */\n        if (fidoUserVerification === 'required') {\n            // Require `flags.uv` be true (implies `flags.up` is true)\n            if (!flags.uv) {\n                throw new Error('User verification required, but user could not be verified');\n            }\n        }\n        else if (fidoUserVerification === 'preferred' ||\n            fidoUserVerification === 'discouraged') {\n            // Ignore `flags.uv`\n        }\n    }\n    else {\n        /**\n         * Use WebAuthn spec-defined rules for verifying UP and UV flags\n         */\n        // WebAuthn only requires the user presence flag be true\n        if (!flags.up) {\n            throw new Error('User not present during authentication');\n        }\n        // Enforce user verification if required\n        if (requireUserVerification && !flags.uv) {\n            throw new Error('User verification required, but user could not be verified');\n        }\n    }\n    const clientDataHash = await (0,_helpers_toHash_js__WEBPACK_IMPORTED_MODULE_1__.toHash)(_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoBase64URL.toBuffer(assertionResponse.clientDataJSON));\n    const signatureBase = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoUint8Array.concat([authDataBuffer, clientDataHash]);\n    const signature = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoBase64URL.toBuffer(assertionResponse.signature);\n    if ((counter > 0 || authenticator.counter > 0) &&\n        counter <= authenticator.counter) {\n        // Error out when the counter in the DB is greater than or equal to the counter in the\n        // dataStruct. It's related to how the authenticator maintains the number of times its been\n        // used for this client. If this happens, then someone's somehow increased the counter\n        // on the device without going through this site\n        throw new Error(`Response counter value ${counter} was lower than expected ${authenticator.counter}`);\n    }\n    const { credentialDeviceType, credentialBackedUp } = (0,_helpers_parseBackupFlags_js__WEBPACK_IMPORTED_MODULE_4__.parseBackupFlags)(flags);\n    const toReturn = {\n        verified: await (0,_helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_2__.verifySignature)({\n            signature,\n            data: signatureBase,\n            credentialPublicKey: authenticator.credentialPublicKey,\n        }),\n        authenticationInfo: {\n            newCounter: counter,\n            credentialID: authenticator.credentialID,\n            userVerified: flags.uv,\n            credentialDeviceType,\n            credentialBackedUp,\n            authenticatorExtensionResults: extensionsData,\n            origin: clientDataJSON.origin,\n            rpID: matchedRPID,\n        },\n    };\n    return toReturn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vYXV0aGVudGljYXRpb24vdmVyaWZ5QXV0aGVudGljYXRpb25SZXNwb25zZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUEwRTtBQUM1QjtBQUNrQjtBQUNjO0FBQ1o7QUFDRTtBQUNFO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QywyQkFBMkI7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsWUFBWSw4SUFBOEk7QUFDMUosWUFBWSwrREFBK0Q7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsZUFBZTtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixzRkFBb0I7QUFDL0MsWUFBWSx3Q0FBd0M7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UsS0FBSyxzQkFBc0IsbUJBQW1CO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLEtBQUssZUFBZSxhQUFhO0FBQ3pHO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSxLQUFLO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkdBQTZHLFVBQVU7QUFDdkg7QUFDQTtBQUNBO0FBQ0EseUVBQXlFLFVBQVUsZUFBZSxrQkFBa0I7QUFDcEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRSxPQUFPLHNCQUFzQixxQkFBcUI7QUFDNUg7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEUsT0FBTyxlQUFlLGVBQWU7QUFDL0c7QUFDQTtBQUNBLFNBQVMsMkVBQXdCO0FBQ2pDO0FBQ0E7QUFDQSxTQUFTLDJFQUF3QjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThELG9CQUFvQjtBQUNsRjtBQUNBO0FBQ0EsMkJBQTJCLHdFQUFxQjtBQUNoRCwyQkFBMkIsMEZBQXNCO0FBQ2pELFlBQVksMkNBQTJDO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsZ0ZBQWlCO0FBQy9DO0FBQ0EsZ0JBQWdCLHlDQUF5QztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsMERBQU0sQ0FBQyx3RUFBcUI7QUFDN0QsMEJBQTBCLHVFQUFvQjtBQUM5QyxzQkFBc0Isd0VBQXFCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxTQUFTLDBCQUEwQixzQkFBc0I7QUFDM0c7QUFDQSxZQUFZLDJDQUEyQyxFQUFFLDhFQUFnQjtBQUN6RTtBQUNBLHdCQUF3Qiw0RUFBZTtBQUN2QztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGF1dGhlbnRpY2F0aW9uXFx2ZXJpZnlBdXRoZW50aWNhdGlvblJlc3BvbnNlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlY29kZUNsaWVudERhdGFKU09OIH0gZnJvbSAnLi4vaGVscGVycy9kZWNvZGVDbGllbnREYXRhSlNPTi5qcyc7XG5pbXBvcnQgeyB0b0hhc2ggfSBmcm9tICcuLi9oZWxwZXJzL3RvSGFzaC5qcyc7XG5pbXBvcnQgeyB2ZXJpZnlTaWduYXR1cmUgfSBmcm9tICcuLi9oZWxwZXJzL3ZlcmlmeVNpZ25hdHVyZS5qcyc7XG5pbXBvcnQgeyBwYXJzZUF1dGhlbnRpY2F0b3JEYXRhIH0gZnJvbSAnLi4vaGVscGVycy9wYXJzZUF1dGhlbnRpY2F0b3JEYXRhLmpzJztcbmltcG9ydCB7IHBhcnNlQmFja3VwRmxhZ3MgfSBmcm9tICcuLi9oZWxwZXJzL3BhcnNlQmFja3VwRmxhZ3MuanMnO1xuaW1wb3J0IHsgbWF0Y2hFeHBlY3RlZFJQSUQgfSBmcm9tICcuLi9oZWxwZXJzL21hdGNoRXhwZWN0ZWRSUElELmpzJztcbmltcG9ydCB7IGlzb0Jhc2U2NFVSTCwgaXNvVWludDhBcnJheSB9IGZyb20gJy4uL2hlbHBlcnMvaXNvL2luZGV4LmpzJztcbi8qKlxuICogVmVyaWZ5IHRoYXQgdGhlIHVzZXIgaGFzIGxlZ2l0aW1hdGVseSBjb21wbGV0ZWQgdGhlIGF1dGhlbnRpY2F0aW9uIHByb2Nlc3NcbiAqXG4gKiAqKk9wdGlvbnM6KipcbiAqXG4gKiBAcGFyYW0gcmVzcG9uc2UgLSBSZXNwb25zZSByZXR1cm5lZCBieSAqKkBzaW1wbGV3ZWJhdXRobi9icm93c2VyKioncyBgc3RhcnRBc3NlcnRpb24oKWBcbiAqIEBwYXJhbSBleHBlY3RlZENoYWxsZW5nZSAtIFRoZSBiYXNlNjR1cmwtZW5jb2RlZCBgb3B0aW9ucy5jaGFsbGVuZ2VgIHJldHVybmVkIGJ5IGBnZW5lcmF0ZUF1dGhlbnRpY2F0aW9uT3B0aW9ucygpYFxuICogQHBhcmFtIGV4cGVjdGVkT3JpZ2luIC0gV2Vic2l0ZSBVUkwgKG9yIGFycmF5IG9mIFVSTHMpIHRoYXQgdGhlIHJlZ2lzdHJhdGlvbiBzaG91bGQgaGF2ZSBvY2N1cnJlZCBvblxuICogQHBhcmFtIGV4cGVjdGVkUlBJRCAtIFJQIElEIChvciBhcnJheSBvZiBJRHMpIHRoYXQgd2FzIHNwZWNpZmllZCBpbiB0aGUgcmVnaXN0cmF0aW9uIG9wdGlvbnNcbiAqIEBwYXJhbSBhdXRoZW50aWNhdG9yIC0gQW4gaW50ZXJuYWwge0BsaW5rIEF1dGhlbnRpY2F0b3JEZXZpY2V9IG1hdGNoaW5nIHRoZSBjcmVkZW50aWFsJ3MgSURcbiAqIEBwYXJhbSBleHBlY3RlZFR5cGUgKiooT3B0aW9uYWwpKiogLSBUaGUgcmVzcG9uc2UgdHlwZSBleHBlY3RlZCAoJ3dlYmF1dGhuLmdldCcpXG4gKiBAcGFyYW0gcmVxdWlyZVVzZXJWZXJpZmljYXRpb24gKiooT3B0aW9uYWwpKiogLSBFbmZvcmNlIHVzZXIgdmVyaWZpY2F0aW9uIGJ5IHRoZSBhdXRoZW50aWNhdG9yICh2aWEgUElOLCBmaW5nZXJwcmludCwgZXRjLi4uKSBEZWZhdWx0cyB0byBgdHJ1ZWBcbiAqIEBwYXJhbSBhZHZhbmNlZEZJRE9Db25maWcgKiooT3B0aW9uYWwpKiogLSBPcHRpb25zIGZvciBzYXRpc2Z5aW5nIG1vcmUgc3RyaW5nZW50IEZJRE8gUlAgZmVhdHVyZSByZXF1aXJlbWVudHNcbiAqIEBwYXJhbSBhZHZhbmNlZEZJRE9Db25maWcudXNlclZlcmlmaWNhdGlvbiAqKihPcHRpb25hbCkqKiAtIEVuYWJsZSBhbHRlcm5hdGl2ZSBydWxlcyBmb3IgZXZhbHVhdGluZyB0aGUgVXNlciBQcmVzZW5jZSBhbmQgVXNlciBWZXJpZmllZCBmbGFncyBpbiBhdXRoZW50aWNhdG9yIGRhdGE6IFVWIChhbmQgVVApIGZsYWdzIGFyZSBvcHRpb25hbCB1bmxlc3MgdGhpcyB2YWx1ZSBpcyBgXCJyZXF1aXJlZFwiYFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QXV0aGVudGljYXRpb25SZXNwb25zZShvcHRpb25zKSB7XG4gICAgY29uc3QgeyByZXNwb25zZSwgZXhwZWN0ZWRDaGFsbGVuZ2UsIGV4cGVjdGVkT3JpZ2luLCBleHBlY3RlZFJQSUQsIGV4cGVjdGVkVHlwZSwgYXV0aGVudGljYXRvciwgcmVxdWlyZVVzZXJWZXJpZmljYXRpb24gPSB0cnVlLCBhZHZhbmNlZEZJRE9Db25maWcsIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHsgaWQsIHJhd0lkLCB0eXBlOiBjcmVkZW50aWFsVHlwZSwgcmVzcG9uc2U6IGFzc2VydGlvblJlc3BvbnNlIH0gPSByZXNwb25zZTtcbiAgICAvLyBFbnN1cmUgY3JlZGVudGlhbCBzcGVjaWZpZWQgYW4gSURcbiAgICBpZiAoIWlkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjcmVkZW50aWFsIElEJyk7XG4gICAgfVxuICAgIC8vIEVuc3VyZSBJRCBpcyBiYXNlNjR1cmwtZW5jb2RlZFxuICAgIGlmIChpZCAhPT0gcmF3SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDcmVkZW50aWFsIElEIHdhcyBub3QgYmFzZTY0dXJsLWVuY29kZWQnKTtcbiAgICB9XG4gICAgLy8gTWFrZSBzdXJlIGNyZWRlbnRpYWwgdHlwZSBpcyBwdWJsaWMta2V5XG4gICAgaWYgKGNyZWRlbnRpYWxUeXBlICE9PSAncHVibGljLWtleScpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIGNyZWRlbnRpYWwgdHlwZSAke2NyZWRlbnRpYWxUeXBlfSwgZXhwZWN0ZWQgXCJwdWJsaWMta2V5XCJgKTtcbiAgICB9XG4gICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyZWRlbnRpYWwgbWlzc2luZyByZXNwb25zZScpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGFzc2VydGlvblJlc3BvbnNlPy5jbGllbnREYXRhSlNPTiAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDcmVkZW50aWFsIHJlc3BvbnNlIGNsaWVudERhdGFKU09OIHdhcyBub3QgYSBzdHJpbmcnKTtcbiAgICB9XG4gICAgY29uc3QgY2xpZW50RGF0YUpTT04gPSBkZWNvZGVDbGllbnREYXRhSlNPTihhc3NlcnRpb25SZXNwb25zZS5jbGllbnREYXRhSlNPTik7XG4gICAgY29uc3QgeyB0eXBlLCBvcmlnaW4sIGNoYWxsZW5nZSwgdG9rZW5CaW5kaW5nIH0gPSBjbGllbnREYXRhSlNPTjtcbiAgICAvLyBNYWtlIHN1cmUgd2UncmUgaGFuZGxpbmcgYW4gYXV0aGVudGljYXRpb25cbiAgICBpZiAoQXJyYXkuaXNBcnJheShleHBlY3RlZFR5cGUpKSB7XG4gICAgICAgIGlmICghZXhwZWN0ZWRUeXBlLmluY2x1ZGVzKHR5cGUpKSB7XG4gICAgICAgICAgICBjb25zdCBqb2luZWRFeHBlY3RlZFR5cGUgPSBleHBlY3RlZFR5cGUuam9pbignLCAnKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCBhdXRoZW50aWNhdGlvbiByZXNwb25zZSB0eXBlIFwiJHt0eXBlfVwiLCBleHBlY3RlZCBvbmUgb2Y6ICR7am9pbmVkRXhwZWN0ZWRUeXBlfWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cGVjdGVkVHlwZSkge1xuICAgICAgICBpZiAodHlwZSAhPT0gZXhwZWN0ZWRUeXBlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgYXV0aGVudGljYXRpb24gcmVzcG9uc2UgdHlwZSBcIiR7dHlwZX1cIiwgZXhwZWN0ZWQgXCIke2V4cGVjdGVkVHlwZX1cImApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGUgIT09ICd3ZWJhdXRobi5nZXQnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCBhdXRoZW50aWNhdGlvbiByZXNwb25zZSB0eXBlOiAke3R5cGV9YCk7XG4gICAgfVxuICAgIC8vIEVuc3VyZSB0aGUgZGV2aWNlIHByb3ZpZGVkIHRoZSBjaGFsbGVuZ2Ugd2UgZ2F2ZSBpdFxuICAgIGlmICh0eXBlb2YgZXhwZWN0ZWRDaGFsbGVuZ2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgaWYgKCEoYXdhaXQgZXhwZWN0ZWRDaGFsbGVuZ2UoY2hhbGxlbmdlKSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ3VzdG9tIGNoYWxsZW5nZSB2ZXJpZmllciByZXR1cm5lZCBmYWxzZSBmb3IgcmVnaXN0cmF0aW9uIHJlc3BvbnNlIGNoYWxsZW5nZSBcIiR7Y2hhbGxlbmdlfVwiYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoY2hhbGxlbmdlICE9PSBleHBlY3RlZENoYWxsZW5nZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgYXV0aGVudGljYXRpb24gcmVzcG9uc2UgY2hhbGxlbmdlIFwiJHtjaGFsbGVuZ2V9XCIsIGV4cGVjdGVkIFwiJHtleHBlY3RlZENoYWxsZW5nZX1cImApO1xuICAgIH1cbiAgICAvLyBDaGVjayB0aGF0IHRoZSBvcmlnaW4gaXMgb3VyIHNpdGVcbiAgICBpZiAoQXJyYXkuaXNBcnJheShleHBlY3RlZE9yaWdpbikpIHtcbiAgICAgICAgaWYgKCFleHBlY3RlZE9yaWdpbi5pbmNsdWRlcyhvcmlnaW4pKSB7XG4gICAgICAgICAgICBjb25zdCBqb2luZWRFeHBlY3RlZE9yaWdpbiA9IGV4cGVjdGVkT3JpZ2luLmpvaW4oJywgJyk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgYXV0aGVudGljYXRpb24gcmVzcG9uc2Ugb3JpZ2luIFwiJHtvcmlnaW59XCIsIGV4cGVjdGVkIG9uZSBvZjogJHtqb2luZWRFeHBlY3RlZE9yaWdpbn1gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKG9yaWdpbiAhPT0gZXhwZWN0ZWRPcmlnaW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCBhdXRoZW50aWNhdGlvbiByZXNwb25zZSBvcmlnaW4gXCIke29yaWdpbn1cIiwgZXhwZWN0ZWQgXCIke2V4cGVjdGVkT3JpZ2lufVwiYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFpc29CYXNlNjRVUkwuaXNCYXNlNjRVUkwoYXNzZXJ0aW9uUmVzcG9uc2UuYXV0aGVudGljYXRvckRhdGEpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ3JlZGVudGlhbCByZXNwb25zZSBhdXRoZW50aWNhdG9yRGF0YSB3YXMgbm90IGEgYmFzZTY0dXJsIHN0cmluZycpO1xuICAgIH1cbiAgICBpZiAoIWlzb0Jhc2U2NFVSTC5pc0Jhc2U2NFVSTChhc3NlcnRpb25SZXNwb25zZS5zaWduYXR1cmUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ3JlZGVudGlhbCByZXNwb25zZSBzaWduYXR1cmUgd2FzIG5vdCBhIGJhc2U2NHVybCBzdHJpbmcnKTtcbiAgICB9XG4gICAgaWYgKGFzc2VydGlvblJlc3BvbnNlLnVzZXJIYW5kbGUgJiZcbiAgICAgICAgdHlwZW9mIGFzc2VydGlvblJlc3BvbnNlLnVzZXJIYW5kbGUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ3JlZGVudGlhbCByZXNwb25zZSB1c2VySGFuZGxlIHdhcyBub3QgYSBzdHJpbmcnKTtcbiAgICB9XG4gICAgaWYgKHRva2VuQmluZGluZykge1xuICAgICAgICBpZiAodHlwZW9mIHRva2VuQmluZGluZyAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2xpZW50RGF0YUpTT04gdG9rZW5CaW5kaW5nIHdhcyBub3QgYW4gb2JqZWN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFsncHJlc2VudCcsICdzdXBwb3J0ZWQnLCAnbm90U3VwcG9ydGVkJ10uaW5kZXhPZih0b2tlbkJpbmRpbmcuc3RhdHVzKSA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCB0b2tlbkJpbmRpbmcgc3RhdHVzICR7dG9rZW5CaW5kaW5nLnN0YXR1c31gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBhdXRoRGF0YUJ1ZmZlciA9IGlzb0Jhc2U2NFVSTC50b0J1ZmZlcihhc3NlcnRpb25SZXNwb25zZS5hdXRoZW50aWNhdG9yRGF0YSk7XG4gICAgY29uc3QgcGFyc2VkQXV0aERhdGEgPSBwYXJzZUF1dGhlbnRpY2F0b3JEYXRhKGF1dGhEYXRhQnVmZmVyKTtcbiAgICBjb25zdCB7IHJwSWRIYXNoLCBmbGFncywgY291bnRlciwgZXh0ZW5zaW9uc0RhdGEgfSA9IHBhcnNlZEF1dGhEYXRhO1xuICAgIC8vIE1ha2Ugc3VyZSB0aGUgcmVzcG9uc2UncyBSUCBJRCBpcyBvdXJzXG4gICAgbGV0IGV4cGVjdGVkUlBJRHMgPSBbXTtcbiAgICBpZiAodHlwZW9mIGV4cGVjdGVkUlBJRCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgZXhwZWN0ZWRSUElEcyA9IFtleHBlY3RlZFJQSURdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZXhwZWN0ZWRSUElEcyA9IGV4cGVjdGVkUlBJRDtcbiAgICB9XG4gICAgY29uc3QgbWF0Y2hlZFJQSUQgPSBhd2FpdCBtYXRjaEV4cGVjdGVkUlBJRChycElkSGFzaCwgZXhwZWN0ZWRSUElEcyk7XG4gICAgaWYgKGFkdmFuY2VkRklET0NvbmZpZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IHsgdXNlclZlcmlmaWNhdGlvbjogZmlkb1VzZXJWZXJpZmljYXRpb24gfSA9IGFkdmFuY2VkRklET0NvbmZpZztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFVzZSBGSURPIENvbmZvcm1hbmNlLWRlZmluZWQgcnVsZXMgZm9yIHZlcmlmeWluZyBVUCBhbmQgVVYgZmxhZ3NcbiAgICAgICAgICovXG4gICAgICAgIGlmIChmaWRvVXNlclZlcmlmaWNhdGlvbiA9PT0gJ3JlcXVpcmVkJykge1xuICAgICAgICAgICAgLy8gUmVxdWlyZSBgZmxhZ3MudXZgIGJlIHRydWUgKGltcGxpZXMgYGZsYWdzLnVwYCBpcyB0cnVlKVxuICAgICAgICAgICAgaWYgKCFmbGFncy51dikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVXNlciB2ZXJpZmljYXRpb24gcmVxdWlyZWQsIGJ1dCB1c2VyIGNvdWxkIG5vdCBiZSB2ZXJpZmllZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGZpZG9Vc2VyVmVyaWZpY2F0aW9uID09PSAncHJlZmVycmVkJyB8fFxuICAgICAgICAgICAgZmlkb1VzZXJWZXJpZmljYXRpb24gPT09ICdkaXNjb3VyYWdlZCcpIHtcbiAgICAgICAgICAgIC8vIElnbm9yZSBgZmxhZ3MudXZgXG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBVc2UgV2ViQXV0aG4gc3BlYy1kZWZpbmVkIHJ1bGVzIGZvciB2ZXJpZnlpbmcgVVAgYW5kIFVWIGZsYWdzXG4gICAgICAgICAqL1xuICAgICAgICAvLyBXZWJBdXRobiBvbmx5IHJlcXVpcmVzIHRoZSB1c2VyIHByZXNlbmNlIGZsYWcgYmUgdHJ1ZVxuICAgICAgICBpZiAoIWZsYWdzLnVwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgbm90IHByZXNlbnQgZHVyaW5nIGF1dGhlbnRpY2F0aW9uJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRW5mb3JjZSB1c2VyIHZlcmlmaWNhdGlvbiBpZiByZXF1aXJlZFxuICAgICAgICBpZiAocmVxdWlyZVVzZXJWZXJpZmljYXRpb24gJiYgIWZsYWdzLnV2KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgdmVyaWZpY2F0aW9uIHJlcXVpcmVkLCBidXQgdXNlciBjb3VsZCBub3QgYmUgdmVyaWZpZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjbGllbnREYXRhSGFzaCA9IGF3YWl0IHRvSGFzaChpc29CYXNlNjRVUkwudG9CdWZmZXIoYXNzZXJ0aW9uUmVzcG9uc2UuY2xpZW50RGF0YUpTT04pKTtcbiAgICBjb25zdCBzaWduYXR1cmVCYXNlID0gaXNvVWludDhBcnJheS5jb25jYXQoW2F1dGhEYXRhQnVmZmVyLCBjbGllbnREYXRhSGFzaF0pO1xuICAgIGNvbnN0IHNpZ25hdHVyZSA9IGlzb0Jhc2U2NFVSTC50b0J1ZmZlcihhc3NlcnRpb25SZXNwb25zZS5zaWduYXR1cmUpO1xuICAgIGlmICgoY291bnRlciA+IDAgfHwgYXV0aGVudGljYXRvci5jb3VudGVyID4gMCkgJiZcbiAgICAgICAgY291bnRlciA8PSBhdXRoZW50aWNhdG9yLmNvdW50ZXIpIHtcbiAgICAgICAgLy8gRXJyb3Igb3V0IHdoZW4gdGhlIGNvdW50ZXIgaW4gdGhlIERCIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgY291bnRlciBpbiB0aGVcbiAgICAgICAgLy8gZGF0YVN0cnVjdC4gSXQncyByZWxhdGVkIHRvIGhvdyB0aGUgYXV0aGVudGljYXRvciBtYWludGFpbnMgdGhlIG51bWJlciBvZiB0aW1lcyBpdHMgYmVlblxuICAgICAgICAvLyB1c2VkIGZvciB0aGlzIGNsaWVudC4gSWYgdGhpcyBoYXBwZW5zLCB0aGVuIHNvbWVvbmUncyBzb21laG93IGluY3JlYXNlZCB0aGUgY291bnRlclxuICAgICAgICAvLyBvbiB0aGUgZGV2aWNlIHdpdGhvdXQgZ29pbmcgdGhyb3VnaCB0aGlzIHNpdGVcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSZXNwb25zZSBjb3VudGVyIHZhbHVlICR7Y291bnRlcn0gd2FzIGxvd2VyIHRoYW4gZXhwZWN0ZWQgJHthdXRoZW50aWNhdG9yLmNvdW50ZXJ9YCk7XG4gICAgfVxuICAgIGNvbnN0IHsgY3JlZGVudGlhbERldmljZVR5cGUsIGNyZWRlbnRpYWxCYWNrZWRVcCB9ID0gcGFyc2VCYWNrdXBGbGFncyhmbGFncyk7XG4gICAgY29uc3QgdG9SZXR1cm4gPSB7XG4gICAgICAgIHZlcmlmaWVkOiBhd2FpdCB2ZXJpZnlTaWduYXR1cmUoe1xuICAgICAgICAgICAgc2lnbmF0dXJlLFxuICAgICAgICAgICAgZGF0YTogc2lnbmF0dXJlQmFzZSxcbiAgICAgICAgICAgIGNyZWRlbnRpYWxQdWJsaWNLZXk6IGF1dGhlbnRpY2F0b3IuY3JlZGVudGlhbFB1YmxpY0tleSxcbiAgICAgICAgfSksXG4gICAgICAgIGF1dGhlbnRpY2F0aW9uSW5mbzoge1xuICAgICAgICAgICAgbmV3Q291bnRlcjogY291bnRlcixcbiAgICAgICAgICAgIGNyZWRlbnRpYWxJRDogYXV0aGVudGljYXRvci5jcmVkZW50aWFsSUQsXG4gICAgICAgICAgICB1c2VyVmVyaWZpZWQ6IGZsYWdzLnV2LFxuICAgICAgICAgICAgY3JlZGVudGlhbERldmljZVR5cGUsXG4gICAgICAgICAgICBjcmVkZW50aWFsQmFja2VkVXAsXG4gICAgICAgICAgICBhdXRoZW50aWNhdG9yRXh0ZW5zaW9uUmVzdWx0czogZXh0ZW5zaW9uc0RhdGEsXG4gICAgICAgICAgICBvcmlnaW46IGNsaWVudERhdGFKU09OLm9yaWdpbixcbiAgICAgICAgICAgIHJwSUQ6IG1hdGNoZWRSUElELFxuICAgICAgICB9LFxuICAgIH07XG4gICAgcmV0dXJuIHRvUmV0dXJuO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/authentication/verifyAuthenticationResponse.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js":
/*!*********************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/deps.js ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AsnParser: () => (/* reexport safe */ _peculiar_asn1_schema__WEBPACK_IMPORTED_MODULE_3__.AsnParser),\n/* harmony export */   AsnSerializer: () => (/* reexport safe */ _peculiar_asn1_schema__WEBPACK_IMPORTED_MODULE_3__.AsnSerializer),\n/* harmony export */   AuthorityKeyIdentifier: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.AuthorityKeyIdentifier),\n/* harmony export */   BasicConstraints: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.BasicConstraints),\n/* harmony export */   CRLDistributionPoints: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.CRLDistributionPoints),\n/* harmony export */   Certificate: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.Certificate),\n/* harmony export */   CertificateList: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.CertificateList),\n/* harmony export */   ECDSASigValue: () => (/* reexport safe */ _peculiar_asn1_ecc__WEBPACK_IMPORTED_MODULE_5__.ECDSASigValue),\n/* harmony export */   ECParameters: () => (/* reexport safe */ _peculiar_asn1_ecc__WEBPACK_IMPORTED_MODULE_5__.ECParameters),\n/* harmony export */   ExtendedKeyUsage: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.ExtendedKeyUsage),\n/* harmony export */   KeyDescription: () => (/* reexport safe */ _peculiar_asn1_android__WEBPACK_IMPORTED_MODULE_7__.KeyDescription),\n/* harmony export */   Name: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.Name),\n/* harmony export */   RSAPublicKey: () => (/* reexport safe */ _peculiar_asn1_rsa__WEBPACK_IMPORTED_MODULE_6__.RSAPublicKey),\n/* harmony export */   SubjectAlternativeName: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.SubjectAlternativeName),\n/* harmony export */   SubjectKeyIdentifier: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.SubjectKeyIdentifier),\n/* harmony export */   base64: () => (/* reexport safe */ _hexagon_base64__WEBPACK_IMPORTED_MODULE_1__[\"default\"]),\n/* harmony export */   crossFetch: () => (/* reexport safe */ cross_fetch__WEBPACK_IMPORTED_MODULE_2__.fetch),\n/* harmony export */   id_ce_authorityKeyIdentifier: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.id_ce_authorityKeyIdentifier),\n/* harmony export */   id_ce_basicConstraints: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.id_ce_basicConstraints),\n/* harmony export */   id_ce_cRLDistributionPoints: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.id_ce_cRLDistributionPoints),\n/* harmony export */   id_ce_extKeyUsage: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.id_ce_extKeyUsage),\n/* harmony export */   id_ce_keyDescription: () => (/* reexport safe */ _peculiar_asn1_android__WEBPACK_IMPORTED_MODULE_7__.id_ce_keyDescription),\n/* harmony export */   id_ce_subjectAltName: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.id_ce_subjectAltName),\n/* harmony export */   id_ce_subjectKeyIdentifier: () => (/* reexport safe */ _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__.id_ce_subjectKeyIdentifier),\n/* harmony export */   id_ecPublicKey: () => (/* reexport safe */ _peculiar_asn1_ecc__WEBPACK_IMPORTED_MODULE_5__.id_ecPublicKey),\n/* harmony export */   id_secp256r1: () => (/* reexport safe */ _peculiar_asn1_ecc__WEBPACK_IMPORTED_MODULE_5__.id_secp256r1),\n/* harmony export */   id_secp384r1: () => (/* reexport safe */ _peculiar_asn1_ecc__WEBPACK_IMPORTED_MODULE_5__.id_secp384r1),\n/* harmony export */   tinyCbor: () => (/* reexport module object */ _levischuck_tiny_cbor__WEBPACK_IMPORTED_MODULE_0__)\n/* harmony export */ });\n/* harmony import */ var _levischuck_tiny_cbor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @levischuck/tiny-cbor */ \"(rsc)/./node_modules/@levischuck/tiny-cbor/esm/index.js\");\n/* harmony import */ var _hexagon_base64__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @hexagon/base64 */ \"(rsc)/./node_modules/@hexagon/base64/src/base64.js\");\n/* harmony import */ var cross_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! cross-fetch */ \"(rsc)/./node_modules/cross-fetch/dist/node-ponyfill.js\");\n/* harmony import */ var _peculiar_asn1_schema__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @peculiar/asn1-schema */ \"(rsc)/./node_modules/@peculiar/asn1-schema/build/es2015/index.js\");\n/* harmony import */ var _peculiar_asn1_x509__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @peculiar/asn1-x509 */ \"(rsc)/./node_modules/@peculiar/asn1-x509/build/es2015/index.js\");\n/* harmony import */ var _peculiar_asn1_ecc__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @peculiar/asn1-ecc */ \"(rsc)/./node_modules/@peculiar/asn1-ecc/build/es2015/index.js\");\n/* harmony import */ var _peculiar_asn1_rsa__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @peculiar/asn1-rsa */ \"(rsc)/./node_modules/@peculiar/asn1-rsa/build/es2015/index.js\");\n/* harmony import */ var _peculiar_asn1_android__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @peculiar/asn1-android */ \"(rsc)/./node_modules/@peculiar/asn1-android/build/es2015/index.js\");\n// tiny_cbor (a.k.a. tiny-cbor in Node land)\n\n// b64 (a.k.a. @hexagon/base64 in Node land)\n\n// cross-fetch\n\n// @peculiar libraries\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vZGVwcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNrRDtBQUNsRDtBQUNvRDtBQUNwRDtBQUNrRDtBQUNsRDtBQUNpRTtBQUNrUztBQUNyUDtBQUM1RDtBQUM0QiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGRlcHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gdGlueV9jYm9yIChhLmsuYS4gdGlueS1jYm9yIGluIE5vZGUgbGFuZClcbmV4cG9ydCAqIGFzIHRpbnlDYm9yIGZyb20gJ0BsZXZpc2NodWNrL3RpbnktY2Jvcic7XG4vLyBiNjQgKGEuay5hLiBAaGV4YWdvbi9iYXNlNjQgaW4gTm9kZSBsYW5kKVxuZXhwb3J0IHsgZGVmYXVsdCBhcyBiYXNlNjQgfSBmcm9tICdAaGV4YWdvbi9iYXNlNjQnO1xuLy8gY3Jvc3MtZmV0Y2hcbmV4cG9ydCB7IGZldGNoIGFzIGNyb3NzRmV0Y2ggfSBmcm9tICdjcm9zcy1mZXRjaCc7XG4vLyBAcGVjdWxpYXIgbGlicmFyaWVzXG5leHBvcnQgeyBBc25QYXJzZXIsIEFzblNlcmlhbGl6ZXIgfSBmcm9tICdAcGVjdWxpYXIvYXNuMS1zY2hlbWEnO1xuZXhwb3J0IHsgQXV0aG9yaXR5S2V5SWRlbnRpZmllciwgQmFzaWNDb25zdHJhaW50cywgQ2VydGlmaWNhdGUsIENlcnRpZmljYXRlTGlzdCwgQ1JMRGlzdHJpYnV0aW9uUG9pbnRzLCBFeHRlbmRlZEtleVVzYWdlLCBpZF9jZV9hdXRob3JpdHlLZXlJZGVudGlmaWVyLCBpZF9jZV9iYXNpY0NvbnN0cmFpbnRzLCBpZF9jZV9jUkxEaXN0cmlidXRpb25Qb2ludHMsIGlkX2NlX2V4dEtleVVzYWdlLCBpZF9jZV9zdWJqZWN0QWx0TmFtZSwgaWRfY2Vfc3ViamVjdEtleUlkZW50aWZpZXIsIE5hbWUsIFN1YmplY3RBbHRlcm5hdGl2ZU5hbWUsIFN1YmplY3RLZXlJZGVudGlmaWVyLCB9IGZyb20gJ0BwZWN1bGlhci9hc24xLXg1MDknO1xuZXhwb3J0IHsgRUNEU0FTaWdWYWx1ZSwgRUNQYXJhbWV0ZXJzLCBpZF9lY1B1YmxpY0tleSwgaWRfc2VjcDI1NnIxLCBpZF9zZWNwMzg0cjEsIH0gZnJvbSAnQHBlY3VsaWFyL2FzbjEtZWNjJztcbmV4cG9ydCB7IFJTQVB1YmxpY0tleSB9IGZyb20gJ0BwZWN1bGlhci9hc24xLXJzYSc7XG5leHBvcnQgeyBpZF9jZV9rZXlEZXNjcmlwdGlvbiwgS2V5RGVzY3JpcHRpb24gfSBmcm9tICdAcGVjdWxpYXIvYXNuMS1hbmRyb2lkJztcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertAAGUIDToString.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/convertAAGUIDToString.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertAAGUIDToString: () => (/* binding */ convertAAGUIDToString)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Convert the aaguid buffer in authData into a UUID string\n */\nfunction convertAAGUIDToString(aaguid) {\n    // Raw Hex: adce000235bcc60a648b0b25f1f05503\n    const hex = _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoUint8Array.toHex(aaguid);\n    const segments = [\n        hex.slice(0, 8),\n        hex.slice(8, 12),\n        hex.slice(12, 16),\n        hex.slice(16, 20),\n        hex.slice(20, 32), // 8\n    ];\n    // Formatted: adce0002-35bc-c60a-648b-0b25f1f05503\n    return segments.join('-');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9jb252ZXJ0QUFHVUlEVG9TdHJpbmcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBK0M7QUFDL0M7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBLGdCQUFnQiw4REFBbUI7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxjb252ZXJ0QUFHVUlEVG9TdHJpbmcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNvVWludDhBcnJheSB9IGZyb20gJy4vaXNvL2luZGV4LmpzJztcbi8qKlxuICogQ29udmVydCB0aGUgYWFndWlkIGJ1ZmZlciBpbiBhdXRoRGF0YSBpbnRvIGEgVVVJRCBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRBQUdVSURUb1N0cmluZyhhYWd1aWQpIHtcbiAgICAvLyBSYXcgSGV4OiBhZGNlMDAwMjM1YmNjNjBhNjQ4YjBiMjVmMWYwNTUwM1xuICAgIGNvbnN0IGhleCA9IGlzb1VpbnQ4QXJyYXkudG9IZXgoYWFndWlkKTtcbiAgICBjb25zdCBzZWdtZW50cyA9IFtcbiAgICAgICAgaGV4LnNsaWNlKDAsIDgpLFxuICAgICAgICBoZXguc2xpY2UoOCwgMTIpLFxuICAgICAgICBoZXguc2xpY2UoMTIsIDE2KSxcbiAgICAgICAgaGV4LnNsaWNlKDE2LCAyMCksXG4gICAgICAgIGhleC5zbGljZSgyMCwgMzIpLCAvLyA4XG4gICAgXTtcbiAgICAvLyBGb3JtYXR0ZWQ6IGFkY2UwMDAyLTM1YmMtYzYwYS02NDhiLTBiMjVmMWYwNTUwM1xuICAgIHJldHVybiBzZWdtZW50cy5qb2luKCctJyk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertAAGUIDToString.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCOSEtoPKCS.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/convertCOSEtoPKCS.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertCOSEtoPKCS: () => (/* binding */ convertCOSEtoPKCS)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n\n\n/**\n * Takes COSE-encoded public key and converts it to PKCS key\n */\nfunction convertCOSEtoPKCS(cosePublicKey) {\n    // This is a little sloppy, I'm using COSEPublicKeyEC2 since it could have both x and y, but when\n    // there's no y it means it's probably better typed as COSEPublicKeyOKP. I'll leave this for now\n    // and revisit it later if it ever becomes an actual problem.\n    const struct = _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoCBOR.decodeFirst(cosePublicKey);\n    const tag = Uint8Array.from([0x04]);\n    const x = struct.get(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.x);\n    const y = struct.get(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.y);\n    if (!x) {\n        throw new Error('COSE public key was missing x');\n    }\n    if (y) {\n        return _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoUint8Array.concat([tag, x, y]);\n    }\n    return _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoUint8Array.concat([tag, x]);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9jb252ZXJ0Q09TRXRvUEtDUy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBd0Q7QUFDbkI7QUFDckM7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsOERBQW1CO0FBQ3RDO0FBQ0EseUJBQXlCLDhDQUFRO0FBQ2pDLHlCQUF5Qiw4Q0FBUTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsK0RBQW9CO0FBQ25DO0FBQ0EsV0FBVywrREFBb0I7QUFDL0IiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxjb252ZXJ0Q09TRXRvUEtDUy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc29DQk9SLCBpc29VaW50OEFycmF5IH0gZnJvbSAnLi9pc28vaW5kZXguanMnO1xuaW1wb3J0IHsgQ09TRUtFWVMgfSBmcm9tICcuL2Nvc2UuanMnO1xuLyoqXG4gKiBUYWtlcyBDT1NFLWVuY29kZWQgcHVibGljIGtleSBhbmQgY29udmVydHMgaXQgdG8gUEtDUyBrZXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRDT1NFdG9QS0NTKGNvc2VQdWJsaWNLZXkpIHtcbiAgICAvLyBUaGlzIGlzIGEgbGl0dGxlIHNsb3BweSwgSSdtIHVzaW5nIENPU0VQdWJsaWNLZXlFQzIgc2luY2UgaXQgY291bGQgaGF2ZSBib3RoIHggYW5kIHksIGJ1dCB3aGVuXG4gICAgLy8gdGhlcmUncyBubyB5IGl0IG1lYW5zIGl0J3MgcHJvYmFibHkgYmV0dGVyIHR5cGVkIGFzIENPU0VQdWJsaWNLZXlPS1AuIEknbGwgbGVhdmUgdGhpcyBmb3Igbm93XG4gICAgLy8gYW5kIHJldmlzaXQgaXQgbGF0ZXIgaWYgaXQgZXZlciBiZWNvbWVzIGFuIGFjdHVhbCBwcm9ibGVtLlxuICAgIGNvbnN0IHN0cnVjdCA9IGlzb0NCT1IuZGVjb2RlRmlyc3QoY29zZVB1YmxpY0tleSk7XG4gICAgY29uc3QgdGFnID0gVWludDhBcnJheS5mcm9tKFsweDA0XSk7XG4gICAgY29uc3QgeCA9IHN0cnVjdC5nZXQoQ09TRUtFWVMueCk7XG4gICAgY29uc3QgeSA9IHN0cnVjdC5nZXQoQ09TRUtFWVMueSk7XG4gICAgaWYgKCF4KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ09TRSBwdWJsaWMga2V5IHdhcyBtaXNzaW5nIHgnKTtcbiAgICB9XG4gICAgaWYgKHkpIHtcbiAgICAgICAgcmV0dXJuIGlzb1VpbnQ4QXJyYXkuY29uY2F0KFt0YWcsIHgsIHldKTtcbiAgICB9XG4gICAgcmV0dXJuIGlzb1VpbnQ4QXJyYXkuY29uY2F0KFt0YWcsIHhdKTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCOSEtoPKCS.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertCertBufferToPEM: () => (/* binding */ convertCertBufferToPEM)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Convert buffer to an OpenSSL-compatible PEM text format.\n */\nfunction convertCertBufferToPEM(certBuffer) {\n    let b64cert;\n    /**\n     * Get certBuffer to a base64 representation\n     */\n    if (typeof certBuffer === 'string') {\n        if (_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.isBase64URL(certBuffer)) {\n            b64cert = _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.toBase64(certBuffer);\n        }\n        else if (_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.isBase64(certBuffer)) {\n            b64cert = certBuffer;\n        }\n        else {\n            throw new Error('Certificate is not a valid base64 or base64url string');\n        }\n    }\n    else {\n        b64cert = _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.fromBuffer(certBuffer, 'base64');\n    }\n    let PEMKey = '';\n    for (let i = 0; i < Math.ceil(b64cert.length / 64); i += 1) {\n        const start = 64 * i;\n        PEMKey += `${b64cert.substr(start, 64)}\\n`;\n    }\n    PEMKey = `-----BEGIN CERTIFICATE-----\\n${PEMKey}-----END CERTIFICATE-----\\n`;\n    return PEMKey;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9jb252ZXJ0Q2VydEJ1ZmZlclRvUEVNLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksbUVBQXdCO0FBQ3BDLHNCQUFzQixnRUFBcUI7QUFDM0M7QUFDQSxpQkFBaUIsZ0VBQXFCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGtFQUF1QjtBQUN6QztBQUNBO0FBQ0Esb0JBQW9CLG9DQUFvQztBQUN4RDtBQUNBLHFCQUFxQiwwQkFBMEI7QUFDL0M7QUFDQSw2Q0FBNkMsT0FBTztBQUNwRDtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcY29udmVydENlcnRCdWZmZXJUb1BFTS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc29CYXNlNjRVUkwgfSBmcm9tICcuL2lzby9pbmRleC5qcyc7XG4vKipcbiAqIENvbnZlcnQgYnVmZmVyIHRvIGFuIE9wZW5TU0wtY29tcGF0aWJsZSBQRU0gdGV4dCBmb3JtYXQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNKGNlcnRCdWZmZXIpIHtcbiAgICBsZXQgYjY0Y2VydDtcbiAgICAvKipcbiAgICAgKiBHZXQgY2VydEJ1ZmZlciB0byBhIGJhc2U2NCByZXByZXNlbnRhdGlvblxuICAgICAqL1xuICAgIGlmICh0eXBlb2YgY2VydEJ1ZmZlciA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKGlzb0Jhc2U2NFVSTC5pc0Jhc2U2NFVSTChjZXJ0QnVmZmVyKSkge1xuICAgICAgICAgICAgYjY0Y2VydCA9IGlzb0Jhc2U2NFVSTC50b0Jhc2U2NChjZXJ0QnVmZmVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc29CYXNlNjRVUkwuaXNCYXNlNjQoY2VydEJ1ZmZlcikpIHtcbiAgICAgICAgICAgIGI2NGNlcnQgPSBjZXJ0QnVmZmVyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSBpcyBub3QgYSB2YWxpZCBiYXNlNjQgb3IgYmFzZTY0dXJsIHN0cmluZycpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBiNjRjZXJ0ID0gaXNvQmFzZTY0VVJMLmZyb21CdWZmZXIoY2VydEJ1ZmZlciwgJ2Jhc2U2NCcpO1xuICAgIH1cbiAgICBsZXQgUEVNS2V5ID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLmNlaWwoYjY0Y2VydC5sZW5ndGggLyA2NCk7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBzdGFydCA9IDY0ICogaTtcbiAgICAgICAgUEVNS2V5ICs9IGAke2I2NGNlcnQuc3Vic3RyKHN0YXJ0LCA2NCl9XFxuYDtcbiAgICB9XG4gICAgUEVNS2V5ID0gYC0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLVxcbiR7UEVNS2V5fS0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS1cXG5gO1xuICAgIHJldHVybiBQRU1LZXk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertPEMToBytes.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/convertPEMToBytes.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertPEMToBytes: () => (/* binding */ convertPEMToBytes)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Take a certificate in PEM format and convert it to bytes\n */\nfunction convertPEMToBytes(pem) {\n    const certBase64 = pem\n        .replace('-----BEGIN CERTIFICATE-----', '')\n        .replace('-----END CERTIFICATE-----', '')\n        .replace(/[\\n ]/g, '');\n    return _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.toBuffer(certBase64, 'base64');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9jb252ZXJ0UEVNVG9CeXRlcy5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxnRUFBcUI7QUFDaEMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxjb252ZXJ0UEVNVG9CeXRlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc29CYXNlNjRVUkwgfSBmcm9tICcuL2lzby9pbmRleC5qcyc7XG4vKipcbiAqIFRha2UgYSBjZXJ0aWZpY2F0ZSBpbiBQRU0gZm9ybWF0IGFuZCBjb252ZXJ0IGl0IHRvIGJ5dGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0UEVNVG9CeXRlcyhwZW0pIHtcbiAgICBjb25zdCBjZXJ0QmFzZTY0ID0gcGVtXG4gICAgICAgIC5yZXBsYWNlKCctLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0nLCAnJylcbiAgICAgICAgLnJlcGxhY2UoJy0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0nLCAnJylcbiAgICAgICAgLnJlcGxhY2UoL1tcXG4gXS9nLCAnJyk7XG4gICAgcmV0dXJuIGlzb0Jhc2U2NFVSTC50b0J1ZmZlcihjZXJ0QmFzZTY0LCAnYmFzZTY0Jyk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertPEMToBytes.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertX509PublicKeyToCOSE.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/convertX509PublicKeyToCOSE.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertX509PublicKeyToCOSE: () => (/* binding */ convertX509PublicKeyToCOSE)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _mapX509SignatureAlgToCOSEAlg_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mapX509SignatureAlgToCOSEAlg.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/mapX509SignatureAlgToCOSEAlg.js\");\n\n\n\nfunction convertX509PublicKeyToCOSE(x509Certificate) {\n    let cosePublicKey = new Map();\n    /**\n     * Time to extract the public key from an X.509 certificate\n     */\n    const x509 = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(x509Certificate, _deps_js__WEBPACK_IMPORTED_MODULE_0__.Certificate);\n    const { tbsCertificate } = x509;\n    const { subjectPublicKeyInfo, signature: _tbsSignature } = tbsCertificate;\n    const signatureAlgorithm = _tbsSignature.algorithm;\n    const publicKeyAlgorithmID = subjectPublicKeyInfo.algorithm.algorithm;\n    if (publicKeyAlgorithmID === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_ecPublicKey) {\n        /**\n         * EC2 Public Key\n         */\n        if (!subjectPublicKeyInfo.algorithm.parameters) {\n            throw new Error('Certificate public key was missing parameters (EC2)');\n        }\n        const ecParameters = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(new Uint8Array(subjectPublicKeyInfo.algorithm.parameters), _deps_js__WEBPACK_IMPORTED_MODULE_0__.ECParameters);\n        let crv = -999;\n        const { namedCurve } = ecParameters;\n        if (namedCurve === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_secp256r1) {\n            crv = _cose_js__WEBPACK_IMPORTED_MODULE_1__.COSECRV.P256;\n        }\n        else if (namedCurve === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_secp384r1) {\n            crv = _cose_js__WEBPACK_IMPORTED_MODULE_1__.COSECRV.P384;\n        }\n        else {\n            throw new Error(`Certificate public key contained unexpected namedCurve ${namedCurve} (EC2)`);\n        }\n        const subjectPublicKey = new Uint8Array(subjectPublicKeyInfo.subjectPublicKey);\n        let x;\n        let y;\n        if (subjectPublicKey[0] === 0x04) {\n            // Public key is in \"uncompressed form\", so we can split the remaining bytes in half\n            let pointer = 1;\n            const halfLength = (subjectPublicKey.length - 1) / 2;\n            x = subjectPublicKey.slice(pointer, pointer += halfLength);\n            y = subjectPublicKey.slice(pointer);\n        }\n        else {\n            throw new Error('TODO: Figure out how to handle public keys in \"compressed form\"');\n        }\n        const coseEC2PubKey = new Map();\n        coseEC2PubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.kty, _cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKTY.EC2);\n        coseEC2PubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.alg, (0,_mapX509SignatureAlgToCOSEAlg_js__WEBPACK_IMPORTED_MODULE_2__.mapX509SignatureAlgToCOSEAlg)(signatureAlgorithm));\n        coseEC2PubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.crv, crv);\n        coseEC2PubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.x, x);\n        coseEC2PubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.y, y);\n        cosePublicKey = coseEC2PubKey;\n    }\n    else if (publicKeyAlgorithmID === '1.2.840.113549.1.1.1') {\n        /**\n         * RSA public key\n         */\n        const rsaPublicKey = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(subjectPublicKeyInfo.subjectPublicKey, _deps_js__WEBPACK_IMPORTED_MODULE_0__.RSAPublicKey);\n        const coseRSAPubKey = new Map();\n        coseRSAPubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.kty, _cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKTY.RSA);\n        coseRSAPubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.alg, (0,_mapX509SignatureAlgToCOSEAlg_js__WEBPACK_IMPORTED_MODULE_2__.mapX509SignatureAlgToCOSEAlg)(signatureAlgorithm));\n        coseRSAPubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.n, new Uint8Array(rsaPublicKey.modulus));\n        coseRSAPubKey.set(_cose_js__WEBPACK_IMPORTED_MODULE_1__.COSEKEYS.e, new Uint8Array(rsaPublicKey.publicExponent));\n        cosePublicKey = coseRSAPubKey;\n    }\n    else {\n        throw new Error(`Certificate public key contained unexpected algorithm ID ${publicKeyAlgorithmID}`);\n    }\n    return cosePublicKey;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9jb252ZXJ0WDUwOVB1YmxpY0tleVRvQ09TRS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTZIO0FBQ3JFO0FBQ3lCO0FBQzFFO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsK0NBQVMsd0JBQXdCLGlEQUFXO0FBQzdELFlBQVksaUJBQWlCO0FBQzdCLFlBQVksaURBQWlEO0FBQzdEO0FBQ0E7QUFDQSxpQ0FBaUMsb0RBQWM7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLCtDQUFTLGtFQUFrRSxrREFBWTtBQUNwSDtBQUNBLGdCQUFnQixhQUFhO0FBQzdCLDJCQUEyQixrREFBWTtBQUN2QyxrQkFBa0IsNkNBQU87QUFDekI7QUFDQSxnQ0FBZ0Msa0RBQVk7QUFDNUMsa0JBQWtCLDZDQUFPO0FBQ3pCO0FBQ0E7QUFDQSxzRkFBc0YsWUFBWTtBQUNsRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsOENBQVEsTUFBTSw2Q0FBTztBQUMvQywwQkFBMEIsOENBQVEsTUFBTSw4RkFBNEI7QUFDcEUsMEJBQTBCLDhDQUFRO0FBQ2xDLDBCQUEwQiw4Q0FBUTtBQUNsQywwQkFBMEIsOENBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLCtDQUFTLDhDQUE4QyxrREFBWTtBQUNoRztBQUNBLDBCQUEwQiw4Q0FBUSxNQUFNLDZDQUFPO0FBQy9DLDBCQUEwQiw4Q0FBUSxNQUFNLDhGQUE0QjtBQUNwRSwwQkFBMEIsOENBQVE7QUFDbEMsMEJBQTBCLDhDQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLG9GQUFvRixxQkFBcUI7QUFDekc7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcY29udmVydFg1MDlQdWJsaWNLZXlUb0NPU0UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXNuUGFyc2VyLCBDZXJ0aWZpY2F0ZSwgRUNQYXJhbWV0ZXJzLCBpZF9lY1B1YmxpY0tleSwgaWRfc2VjcDI1NnIxLCBpZF9zZWNwMzg0cjEsIFJTQVB1YmxpY0tleSwgfSBmcm9tICcuLi9kZXBzLmpzJztcbmltcG9ydCB7IENPU0VDUlYsIENPU0VLRVlTLCBDT1NFS1RZLCB9IGZyb20gJy4vY29zZS5qcyc7XG5pbXBvcnQgeyBtYXBYNTA5U2lnbmF0dXJlQWxnVG9DT1NFQWxnIH0gZnJvbSAnLi9tYXBYNTA5U2lnbmF0dXJlQWxnVG9DT1NFQWxnLmpzJztcbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0WDUwOVB1YmxpY0tleVRvQ09TRSh4NTA5Q2VydGlmaWNhdGUpIHtcbiAgICBsZXQgY29zZVB1YmxpY0tleSA9IG5ldyBNYXAoKTtcbiAgICAvKipcbiAgICAgKiBUaW1lIHRvIGV4dHJhY3QgdGhlIHB1YmxpYyBrZXkgZnJvbSBhbiBYLjUwOSBjZXJ0aWZpY2F0ZVxuICAgICAqL1xuICAgIGNvbnN0IHg1MDkgPSBBc25QYXJzZXIucGFyc2UoeDUwOUNlcnRpZmljYXRlLCBDZXJ0aWZpY2F0ZSk7XG4gICAgY29uc3QgeyB0YnNDZXJ0aWZpY2F0ZSB9ID0geDUwOTtcbiAgICBjb25zdCB7IHN1YmplY3RQdWJsaWNLZXlJbmZvLCBzaWduYXR1cmU6IF90YnNTaWduYXR1cmUgfSA9IHRic0NlcnRpZmljYXRlO1xuICAgIGNvbnN0IHNpZ25hdHVyZUFsZ29yaXRobSA9IF90YnNTaWduYXR1cmUuYWxnb3JpdGhtO1xuICAgIGNvbnN0IHB1YmxpY0tleUFsZ29yaXRobUlEID0gc3ViamVjdFB1YmxpY0tleUluZm8uYWxnb3JpdGhtLmFsZ29yaXRobTtcbiAgICBpZiAocHVibGljS2V5QWxnb3JpdGhtSUQgPT09IGlkX2VjUHVibGljS2V5KSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBFQzIgUHVibGljIEtleVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCFzdWJqZWN0UHVibGljS2V5SW5mby5hbGdvcml0aG0ucGFyYW1ldGVycykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSBwdWJsaWMga2V5IHdhcyBtaXNzaW5nIHBhcmFtZXRlcnMgKEVDMiknKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlY1BhcmFtZXRlcnMgPSBBc25QYXJzZXIucGFyc2UobmV3IFVpbnQ4QXJyYXkoc3ViamVjdFB1YmxpY0tleUluZm8uYWxnb3JpdGhtLnBhcmFtZXRlcnMpLCBFQ1BhcmFtZXRlcnMpO1xuICAgICAgICBsZXQgY3J2ID0gLTk5OTtcbiAgICAgICAgY29uc3QgeyBuYW1lZEN1cnZlIH0gPSBlY1BhcmFtZXRlcnM7XG4gICAgICAgIGlmIChuYW1lZEN1cnZlID09PSBpZF9zZWNwMjU2cjEpIHtcbiAgICAgICAgICAgIGNydiA9IENPU0VDUlYuUDI1NjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuYW1lZEN1cnZlID09PSBpZF9zZWNwMzg0cjEpIHtcbiAgICAgICAgICAgIGNydiA9IENPU0VDUlYuUDM4NDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2VydGlmaWNhdGUgcHVibGljIGtleSBjb250YWluZWQgdW5leHBlY3RlZCBuYW1lZEN1cnZlICR7bmFtZWRDdXJ2ZX0gKEVDMilgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdWJqZWN0UHVibGljS2V5ID0gbmV3IFVpbnQ4QXJyYXkoc3ViamVjdFB1YmxpY0tleUluZm8uc3ViamVjdFB1YmxpY0tleSk7XG4gICAgICAgIGxldCB4O1xuICAgICAgICBsZXQgeTtcbiAgICAgICAgaWYgKHN1YmplY3RQdWJsaWNLZXlbMF0gPT09IDB4MDQpIHtcbiAgICAgICAgICAgIC8vIFB1YmxpYyBrZXkgaXMgaW4gXCJ1bmNvbXByZXNzZWQgZm9ybVwiLCBzbyB3ZSBjYW4gc3BsaXQgdGhlIHJlbWFpbmluZyBieXRlcyBpbiBoYWxmXG4gICAgICAgICAgICBsZXQgcG9pbnRlciA9IDE7XG4gICAgICAgICAgICBjb25zdCBoYWxmTGVuZ3RoID0gKHN1YmplY3RQdWJsaWNLZXkubGVuZ3RoIC0gMSkgLyAyO1xuICAgICAgICAgICAgeCA9IHN1YmplY3RQdWJsaWNLZXkuc2xpY2UocG9pbnRlciwgcG9pbnRlciArPSBoYWxmTGVuZ3RoKTtcbiAgICAgICAgICAgIHkgPSBzdWJqZWN0UHVibGljS2V5LnNsaWNlKHBvaW50ZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUT0RPOiBGaWd1cmUgb3V0IGhvdyB0byBoYW5kbGUgcHVibGljIGtleXMgaW4gXCJjb21wcmVzc2VkIGZvcm1cIicpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvc2VFQzJQdWJLZXkgPSBuZXcgTWFwKCk7XG4gICAgICAgIGNvc2VFQzJQdWJLZXkuc2V0KENPU0VLRVlTLmt0eSwgQ09TRUtUWS5FQzIpO1xuICAgICAgICBjb3NlRUMyUHViS2V5LnNldChDT1NFS0VZUy5hbGcsIG1hcFg1MDlTaWduYXR1cmVBbGdUb0NPU0VBbGcoc2lnbmF0dXJlQWxnb3JpdGhtKSk7XG4gICAgICAgIGNvc2VFQzJQdWJLZXkuc2V0KENPU0VLRVlTLmNydiwgY3J2KTtcbiAgICAgICAgY29zZUVDMlB1YktleS5zZXQoQ09TRUtFWVMueCwgeCk7XG4gICAgICAgIGNvc2VFQzJQdWJLZXkuc2V0KENPU0VLRVlTLnksIHkpO1xuICAgICAgICBjb3NlUHVibGljS2V5ID0gY29zZUVDMlB1YktleTtcbiAgICB9XG4gICAgZWxzZSBpZiAocHVibGljS2V5QWxnb3JpdGhtSUQgPT09ICcxLjIuODQwLjExMzU0OS4xLjEuMScpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJTQSBwdWJsaWMga2V5XG4gICAgICAgICAqL1xuICAgICAgICBjb25zdCByc2FQdWJsaWNLZXkgPSBBc25QYXJzZXIucGFyc2Uoc3ViamVjdFB1YmxpY0tleUluZm8uc3ViamVjdFB1YmxpY0tleSwgUlNBUHVibGljS2V5KTtcbiAgICAgICAgY29uc3QgY29zZVJTQVB1YktleSA9IG5ldyBNYXAoKTtcbiAgICAgICAgY29zZVJTQVB1YktleS5zZXQoQ09TRUtFWVMua3R5LCBDT1NFS1RZLlJTQSk7XG4gICAgICAgIGNvc2VSU0FQdWJLZXkuc2V0KENPU0VLRVlTLmFsZywgbWFwWDUwOVNpZ25hdHVyZUFsZ1RvQ09TRUFsZyhzaWduYXR1cmVBbGdvcml0aG0pKTtcbiAgICAgICAgY29zZVJTQVB1YktleS5zZXQoQ09TRUtFWVMubiwgbmV3IFVpbnQ4QXJyYXkocnNhUHVibGljS2V5Lm1vZHVsdXMpKTtcbiAgICAgICAgY29zZVJTQVB1YktleS5zZXQoQ09TRUtFWVMuZSwgbmV3IFVpbnQ4QXJyYXkocnNhUHVibGljS2V5LnB1YmxpY0V4cG9uZW50KSk7XG4gICAgICAgIGNvc2VQdWJsaWNLZXkgPSBjb3NlUlNBUHViS2V5O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDZXJ0aWZpY2F0ZSBwdWJsaWMga2V5IGNvbnRhaW5lZCB1bmV4cGVjdGVkIGFsZ29yaXRobSBJRCAke3B1YmxpY0tleUFsZ29yaXRobUlEfWApO1xuICAgIH1cbiAgICByZXR1cm4gY29zZVB1YmxpY0tleTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertX509PublicKeyToCOSE.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/cose.js ***!
  \*****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   COSEALG: () => (/* binding */ COSEALG),\n/* harmony export */   COSECRV: () => (/* binding */ COSECRV),\n/* harmony export */   COSEKEYS: () => (/* binding */ COSEKEYS),\n/* harmony export */   COSEKTY: () => (/* binding */ COSEKTY),\n/* harmony export */   isCOSEAlg: () => (/* binding */ isCOSEAlg),\n/* harmony export */   isCOSECrv: () => (/* binding */ isCOSECrv),\n/* harmony export */   isCOSEKty: () => (/* binding */ isCOSEKty),\n/* harmony export */   isCOSEPublicKeyEC2: () => (/* binding */ isCOSEPublicKeyEC2),\n/* harmony export */   isCOSEPublicKeyOKP: () => (/* binding */ isCOSEPublicKeyOKP),\n/* harmony export */   isCOSEPublicKeyRSA: () => (/* binding */ isCOSEPublicKeyRSA)\n/* harmony export */ });\nfunction isCOSEPublicKeyOKP(cosePublicKey) {\n    const kty = cosePublicKey.get(COSEKEYS.kty);\n    return isCOSEKty(kty) && kty === COSEKTY.OKP;\n}\nfunction isCOSEPublicKeyEC2(cosePublicKey) {\n    const kty = cosePublicKey.get(COSEKEYS.kty);\n    return isCOSEKty(kty) && kty === COSEKTY.EC2;\n}\nfunction isCOSEPublicKeyRSA(cosePublicKey) {\n    const kty = cosePublicKey.get(COSEKEYS.kty);\n    return isCOSEKty(kty) && kty === COSEKTY.RSA;\n}\n/**\n * COSE Keys\n *\n * https://www.iana.org/assignments/cose/cose.xhtml#key-common-parameters\n * https://www.iana.org/assignments/cose/cose.xhtml#key-type-parameters\n */\nvar COSEKEYS;\n(function (COSEKEYS) {\n    COSEKEYS[COSEKEYS[\"kty\"] = 1] = \"kty\";\n    COSEKEYS[COSEKEYS[\"alg\"] = 3] = \"alg\";\n    COSEKEYS[COSEKEYS[\"crv\"] = -1] = \"crv\";\n    COSEKEYS[COSEKEYS[\"x\"] = -2] = \"x\";\n    COSEKEYS[COSEKEYS[\"y\"] = -3] = \"y\";\n    COSEKEYS[COSEKEYS[\"n\"] = -1] = \"n\";\n    COSEKEYS[COSEKEYS[\"e\"] = -2] = \"e\";\n})(COSEKEYS || (COSEKEYS = {}));\n/**\n * COSE Key Types\n *\n * https://www.iana.org/assignments/cose/cose.xhtml#key-type\n */\nvar COSEKTY;\n(function (COSEKTY) {\n    COSEKTY[COSEKTY[\"OKP\"] = 1] = \"OKP\";\n    COSEKTY[COSEKTY[\"EC2\"] = 2] = \"EC2\";\n    COSEKTY[COSEKTY[\"RSA\"] = 3] = \"RSA\";\n})(COSEKTY || (COSEKTY = {}));\nfunction isCOSEKty(kty) {\n    return Object.values(COSEKTY).indexOf(kty) >= 0;\n}\n/**\n * COSE Curves\n *\n * https://www.iana.org/assignments/cose/cose.xhtml#elliptic-curves\n */\nvar COSECRV;\n(function (COSECRV) {\n    COSECRV[COSECRV[\"P256\"] = 1] = \"P256\";\n    COSECRV[COSECRV[\"P384\"] = 2] = \"P384\";\n    COSECRV[COSECRV[\"P521\"] = 3] = \"P521\";\n    COSECRV[COSECRV[\"ED25519\"] = 6] = \"ED25519\";\n    COSECRV[COSECRV[\"SECP256K1\"] = 8] = \"SECP256K1\";\n})(COSECRV || (COSECRV = {}));\nfunction isCOSECrv(crv) {\n    return Object.values(COSECRV).indexOf(crv) >= 0;\n}\n/**\n * COSE Algorithms\n *\n * https://www.iana.org/assignments/cose/cose.xhtml#algorithms\n */\nvar COSEALG;\n(function (COSEALG) {\n    COSEALG[COSEALG[\"ES256\"] = -7] = \"ES256\";\n    COSEALG[COSEALG[\"EdDSA\"] = -8] = \"EdDSA\";\n    COSEALG[COSEALG[\"ES384\"] = -35] = \"ES384\";\n    COSEALG[COSEALG[\"ES512\"] = -36] = \"ES512\";\n    COSEALG[COSEALG[\"PS256\"] = -37] = \"PS256\";\n    COSEALG[COSEALG[\"PS384\"] = -38] = \"PS384\";\n    COSEALG[COSEALG[\"PS512\"] = -39] = \"PS512\";\n    COSEALG[COSEALG[\"ES256K\"] = -47] = \"ES256K\";\n    COSEALG[COSEALG[\"RS256\"] = -257] = \"RS256\";\n    COSEALG[COSEALG[\"RS384\"] = -258] = \"RS384\";\n    COSEALG[COSEALG[\"RS512\"] = -259] = \"RS512\";\n    COSEALG[COSEALG[\"RS1\"] = -65535] = \"RS1\";\n})(COSEALG || (COSEALG = {}));\nfunction isCOSEAlg(alg) {\n    return Object.values(COSEALG).indexOf(alg) >= 0;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9jb3NlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDRCQUE0QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMEJBQTBCO0FBQ3BCO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMEJBQTBCO0FBQ3BCO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywwQkFBMEI7QUFDcEI7QUFDUDtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcY29zZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gaXNDT1NFUHVibGljS2V5T0tQKGNvc2VQdWJsaWNLZXkpIHtcbiAgICBjb25zdCBrdHkgPSBjb3NlUHVibGljS2V5LmdldChDT1NFS0VZUy5rdHkpO1xuICAgIHJldHVybiBpc0NPU0VLdHkoa3R5KSAmJiBrdHkgPT09IENPU0VLVFkuT0tQO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzQ09TRVB1YmxpY0tleUVDMihjb3NlUHVibGljS2V5KSB7XG4gICAgY29uc3Qga3R5ID0gY29zZVB1YmxpY0tleS5nZXQoQ09TRUtFWVMua3R5KTtcbiAgICByZXR1cm4gaXNDT1NFS3R5KGt0eSkgJiYga3R5ID09PSBDT1NFS1RZLkVDMjtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpc0NPU0VQdWJsaWNLZXlSU0EoY29zZVB1YmxpY0tleSkge1xuICAgIGNvbnN0IGt0eSA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLmt0eSk7XG4gICAgcmV0dXJuIGlzQ09TRUt0eShrdHkpICYmIGt0eSA9PT0gQ09TRUtUWS5SU0E7XG59XG4vKipcbiAqIENPU0UgS2V5c1xuICpcbiAqIGh0dHBzOi8vd3d3LmlhbmEub3JnL2Fzc2lnbm1lbnRzL2Nvc2UvY29zZS54aHRtbCNrZXktY29tbW9uLXBhcmFtZXRlcnNcbiAqIGh0dHBzOi8vd3d3LmlhbmEub3JnL2Fzc2lnbm1lbnRzL2Nvc2UvY29zZS54aHRtbCNrZXktdHlwZS1wYXJhbWV0ZXJzXG4gKi9cbmV4cG9ydCB2YXIgQ09TRUtFWVM7XG4oZnVuY3Rpb24gKENPU0VLRVlTKSB7XG4gICAgQ09TRUtFWVNbQ09TRUtFWVNbXCJrdHlcIl0gPSAxXSA9IFwia3R5XCI7XG4gICAgQ09TRUtFWVNbQ09TRUtFWVNbXCJhbGdcIl0gPSAzXSA9IFwiYWxnXCI7XG4gICAgQ09TRUtFWVNbQ09TRUtFWVNbXCJjcnZcIl0gPSAtMV0gPSBcImNydlwiO1xuICAgIENPU0VLRVlTW0NPU0VLRVlTW1wieFwiXSA9IC0yXSA9IFwieFwiO1xuICAgIENPU0VLRVlTW0NPU0VLRVlTW1wieVwiXSA9IC0zXSA9IFwieVwiO1xuICAgIENPU0VLRVlTW0NPU0VLRVlTW1wiblwiXSA9IC0xXSA9IFwiblwiO1xuICAgIENPU0VLRVlTW0NPU0VLRVlTW1wiZVwiXSA9IC0yXSA9IFwiZVwiO1xufSkoQ09TRUtFWVMgfHwgKENPU0VLRVlTID0ge30pKTtcbi8qKlxuICogQ09TRSBLZXkgVHlwZXNcbiAqXG4gKiBodHRwczovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy9jb3NlL2Nvc2UueGh0bWwja2V5LXR5cGVcbiAqL1xuZXhwb3J0IHZhciBDT1NFS1RZO1xuKGZ1bmN0aW9uIChDT1NFS1RZKSB7XG4gICAgQ09TRUtUWVtDT1NFS1RZW1wiT0tQXCJdID0gMV0gPSBcIk9LUFwiO1xuICAgIENPU0VLVFlbQ09TRUtUWVtcIkVDMlwiXSA9IDJdID0gXCJFQzJcIjtcbiAgICBDT1NFS1RZW0NPU0VLVFlbXCJSU0FcIl0gPSAzXSA9IFwiUlNBXCI7XG59KShDT1NFS1RZIHx8IChDT1NFS1RZID0ge30pKTtcbmV4cG9ydCBmdW5jdGlvbiBpc0NPU0VLdHkoa3R5KSB7XG4gICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoQ09TRUtUWSkuaW5kZXhPZihrdHkpID49IDA7XG59XG4vKipcbiAqIENPU0UgQ3VydmVzXG4gKlxuICogaHR0cHM6Ly93d3cuaWFuYS5vcmcvYXNzaWdubWVudHMvY29zZS9jb3NlLnhodG1sI2VsbGlwdGljLWN1cnZlc1xuICovXG5leHBvcnQgdmFyIENPU0VDUlY7XG4oZnVuY3Rpb24gKENPU0VDUlYpIHtcbiAgICBDT1NFQ1JWW0NPU0VDUlZbXCJQMjU2XCJdID0gMV0gPSBcIlAyNTZcIjtcbiAgICBDT1NFQ1JWW0NPU0VDUlZbXCJQMzg0XCJdID0gMl0gPSBcIlAzODRcIjtcbiAgICBDT1NFQ1JWW0NPU0VDUlZbXCJQNTIxXCJdID0gM10gPSBcIlA1MjFcIjtcbiAgICBDT1NFQ1JWW0NPU0VDUlZbXCJFRDI1NTE5XCJdID0gNl0gPSBcIkVEMjU1MTlcIjtcbiAgICBDT1NFQ1JWW0NPU0VDUlZbXCJTRUNQMjU2SzFcIl0gPSA4XSA9IFwiU0VDUDI1NksxXCI7XG59KShDT1NFQ1JWIHx8IChDT1NFQ1JWID0ge30pKTtcbmV4cG9ydCBmdW5jdGlvbiBpc0NPU0VDcnYoY3J2KSB7XG4gICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoQ09TRUNSVikuaW5kZXhPZihjcnYpID49IDA7XG59XG4vKipcbiAqIENPU0UgQWxnb3JpdGhtc1xuICpcbiAqIGh0dHBzOi8vd3d3LmlhbmEub3JnL2Fzc2lnbm1lbnRzL2Nvc2UvY29zZS54aHRtbCNhbGdvcml0aG1zXG4gKi9cbmV4cG9ydCB2YXIgQ09TRUFMRztcbihmdW5jdGlvbiAoQ09TRUFMRykge1xuICAgIENPU0VBTEdbQ09TRUFMR1tcIkVTMjU2XCJdID0gLTddID0gXCJFUzI1NlwiO1xuICAgIENPU0VBTEdbQ09TRUFMR1tcIkVkRFNBXCJdID0gLThdID0gXCJFZERTQVwiO1xuICAgIENPU0VBTEdbQ09TRUFMR1tcIkVTMzg0XCJdID0gLTM1XSA9IFwiRVMzODRcIjtcbiAgICBDT1NFQUxHW0NPU0VBTEdbXCJFUzUxMlwiXSA9IC0zNl0gPSBcIkVTNTEyXCI7XG4gICAgQ09TRUFMR1tDT1NFQUxHW1wiUFMyNTZcIl0gPSAtMzddID0gXCJQUzI1NlwiO1xuICAgIENPU0VBTEdbQ09TRUFMR1tcIlBTMzg0XCJdID0gLTM4XSA9IFwiUFMzODRcIjtcbiAgICBDT1NFQUxHW0NPU0VBTEdbXCJQUzUxMlwiXSA9IC0zOV0gPSBcIlBTNTEyXCI7XG4gICAgQ09TRUFMR1tDT1NFQUxHW1wiRVMyNTZLXCJdID0gLTQ3XSA9IFwiRVMyNTZLXCI7XG4gICAgQ09TRUFMR1tDT1NFQUxHW1wiUlMyNTZcIl0gPSAtMjU3XSA9IFwiUlMyNTZcIjtcbiAgICBDT1NFQUxHW0NPU0VBTEdbXCJSUzM4NFwiXSA9IC0yNThdID0gXCJSUzM4NFwiO1xuICAgIENPU0VBTEdbQ09TRUFMR1tcIlJTNTEyXCJdID0gLTI1OV0gPSBcIlJTNTEyXCI7XG4gICAgQ09TRUFMR1tDT1NFQUxHW1wiUlMxXCJdID0gLTY1NTM1XSA9IFwiUlMxXCI7XG59KShDT1NFQUxHIHx8IChDT1NFQUxHID0ge30pKTtcbmV4cG9ydCBmdW5jdGlvbiBpc0NPU0VBbGcoYWxnKSB7XG4gICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoQ09TRUFMRykuaW5kZXhPZihhbGcpID49IDA7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeAttestationObject.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/decodeAttestationObject.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _decodeAttestationObjectInternals: () => (/* binding */ _decodeAttestationObjectInternals),\n/* harmony export */   decodeAttestationObject: () => (/* binding */ decodeAttestationObject)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Convert an AttestationObject buffer to a proper object\n *\n * @param base64AttestationObject Attestation Object buffer\n */\nfunction decodeAttestationObject(attestationObject) {\n    return _decodeAttestationObjectInternals.stubThis(_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoCBOR.decodeFirst(attestationObject));\n}\n// Make it possible to stub the return value during testing\nconst _decodeAttestationObjectInternals = {\n    stubThis: (value) => value,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9kZWNvZGVBdHRlc3RhdGlvbk9iamVjdC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1Asc0RBQXNELDhEQUFtQjtBQUN6RTtBQUNBO0FBQ087QUFDUDtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcZGVjb2RlQXR0ZXN0YXRpb25PYmplY3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNvQ0JPUiB9IGZyb20gJy4vaXNvL2luZGV4LmpzJztcbi8qKlxuICogQ29udmVydCBhbiBBdHRlc3RhdGlvbk9iamVjdCBidWZmZXIgdG8gYSBwcm9wZXIgb2JqZWN0XG4gKlxuICogQHBhcmFtIGJhc2U2NEF0dGVzdGF0aW9uT2JqZWN0IEF0dGVzdGF0aW9uIE9iamVjdCBidWZmZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZUF0dGVzdGF0aW9uT2JqZWN0KGF0dGVzdGF0aW9uT2JqZWN0KSB7XG4gICAgcmV0dXJuIF9kZWNvZGVBdHRlc3RhdGlvbk9iamVjdEludGVybmFscy5zdHViVGhpcyhpc29DQk9SLmRlY29kZUZpcnN0KGF0dGVzdGF0aW9uT2JqZWN0KSk7XG59XG4vLyBNYWtlIGl0IHBvc3NpYmxlIHRvIHN0dWIgdGhlIHJldHVybiB2YWx1ZSBkdXJpbmcgdGVzdGluZ1xuZXhwb3J0IGNvbnN0IF9kZWNvZGVBdHRlc3RhdGlvbk9iamVjdEludGVybmFscyA9IHtcbiAgICBzdHViVGhpczogKHZhbHVlKSA9PiB2YWx1ZSxcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeAttestationObject.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeAuthenticatorExtensions.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/decodeAuthenticatorExtensions.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decodeAuthenticatorExtensions: () => (/* binding */ decodeAuthenticatorExtensions)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Convert authenticator extension data buffer to a proper object\n *\n * @param extensionData Authenticator Extension Data buffer\n */\nfunction decodeAuthenticatorExtensions(extensionData) {\n    let toCBOR;\n    try {\n        toCBOR = _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoCBOR.decodeFirst(extensionData);\n    }\n    catch (err) {\n        const _err = err;\n        throw new Error(`Error decoding authenticator extensions: ${_err.message}`);\n    }\n    return convertMapToObjectDeep(toCBOR);\n}\n/**\n * CBOR-encoded extensions can be deeply-nested Maps, which are too deep for a simple\n * `Object.entries()`. This method will recursively make sure that all Maps are converted into\n * basic objects.\n */\nfunction convertMapToObjectDeep(input) {\n    const mapped = {};\n    for (const [key, value] of input) {\n        if (value instanceof Map) {\n            mapped[key] = convertMapToObjectDeep(value);\n        }\n        else {\n            mapped[key] = value;\n        }\n    }\n    return mapped;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9kZWNvZGVBdXRoZW50aWNhdG9yRXh0ZW5zaW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EsaUJBQWlCLDhEQUFtQjtBQUNwQztBQUNBO0FBQ0E7QUFDQSxvRUFBb0UsYUFBYTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcZGVjb2RlQXV0aGVudGljYXRvckV4dGVuc2lvbnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNvQ0JPUiB9IGZyb20gJy4vaXNvL2luZGV4LmpzJztcbi8qKlxuICogQ29udmVydCBhdXRoZW50aWNhdG9yIGV4dGVuc2lvbiBkYXRhIGJ1ZmZlciB0byBhIHByb3BlciBvYmplY3RcbiAqXG4gKiBAcGFyYW0gZXh0ZW5zaW9uRGF0YSBBdXRoZW50aWNhdG9yIEV4dGVuc2lvbiBEYXRhIGJ1ZmZlclxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlQXV0aGVudGljYXRvckV4dGVuc2lvbnMoZXh0ZW5zaW9uRGF0YSkge1xuICAgIGxldCB0b0NCT1I7XG4gICAgdHJ5IHtcbiAgICAgICAgdG9DQk9SID0gaXNvQ0JPUi5kZWNvZGVGaXJzdChleHRlbnNpb25EYXRhKTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zdCBfZXJyID0gZXJyO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGRlY29kaW5nIGF1dGhlbnRpY2F0b3IgZXh0ZW5zaW9uczogJHtfZXJyLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIHJldHVybiBjb252ZXJ0TWFwVG9PYmplY3REZWVwKHRvQ0JPUik7XG59XG4vKipcbiAqIENCT1ItZW5jb2RlZCBleHRlbnNpb25zIGNhbiBiZSBkZWVwbHktbmVzdGVkIE1hcHMsIHdoaWNoIGFyZSB0b28gZGVlcCBmb3IgYSBzaW1wbGVcbiAqIGBPYmplY3QuZW50cmllcygpYC4gVGhpcyBtZXRob2Qgd2lsbCByZWN1cnNpdmVseSBtYWtlIHN1cmUgdGhhdCBhbGwgTWFwcyBhcmUgY29udmVydGVkIGludG9cbiAqIGJhc2ljIG9iamVjdHMuXG4gKi9cbmZ1bmN0aW9uIGNvbnZlcnRNYXBUb09iamVjdERlZXAoaW5wdXQpIHtcbiAgICBjb25zdCBtYXBwZWQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBpbnB1dCkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBNYXApIHtcbiAgICAgICAgICAgIG1hcHBlZFtrZXldID0gY29udmVydE1hcFRvT2JqZWN0RGVlcCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtYXBwZWRba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXBwZWQ7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeAuthenticatorExtensions.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeClientDataJSON.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/decodeClientDataJSON.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _decodeClientDataJSONInternals: () => (/* binding */ _decodeClientDataJSONInternals),\n/* harmony export */   decodeClientDataJSON: () => (/* binding */ decodeClientDataJSON)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Decode an authenticator's base64url-encoded clientDataJSON to JSON\n */\nfunction decodeClientDataJSON(data) {\n    const toString = _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.toUTF8String(data);\n    const clientData = JSON.parse(toString);\n    return _decodeClientDataJSONInternals.stubThis(clientData);\n}\n// Make it possible to stub the return value during testing\nconst _decodeClientDataJSONInternals = {\n    stubThis: (value) => value,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9kZWNvZGVDbGllbnREYXRhSlNPTi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ087QUFDUCxxQkFBcUIsb0VBQXlCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcZGVjb2RlQ2xpZW50RGF0YUpTT04uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNvQmFzZTY0VVJMIH0gZnJvbSAnLi9pc28vaW5kZXguanMnO1xuLyoqXG4gKiBEZWNvZGUgYW4gYXV0aGVudGljYXRvcidzIGJhc2U2NHVybC1lbmNvZGVkIGNsaWVudERhdGFKU09OIHRvIEpTT05cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZUNsaWVudERhdGFKU09OKGRhdGEpIHtcbiAgICBjb25zdCB0b1N0cmluZyA9IGlzb0Jhc2U2NFVSTC50b1VURjhTdHJpbmcoZGF0YSk7XG4gICAgY29uc3QgY2xpZW50RGF0YSA9IEpTT04ucGFyc2UodG9TdHJpbmcpO1xuICAgIHJldHVybiBfZGVjb2RlQ2xpZW50RGF0YUpTT05JbnRlcm5hbHMuc3R1YlRoaXMoY2xpZW50RGF0YSk7XG59XG4vLyBNYWtlIGl0IHBvc3NpYmxlIHRvIHN0dWIgdGhlIHJldHVybiB2YWx1ZSBkdXJpbmcgdGVzdGluZ1xuZXhwb3J0IGNvbnN0IF9kZWNvZGVDbGllbnREYXRhSlNPTkludGVybmFscyA9IHtcbiAgICBzdHViVGhpczogKHZhbHVlKSA9PiB2YWx1ZSxcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeClientDataJSON.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeCredentialPublicKey.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/decodeCredentialPublicKey.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _decodeCredentialPublicKeyInternals: () => (/* binding */ _decodeCredentialPublicKeyInternals),\n/* harmony export */   decodeCredentialPublicKey: () => (/* binding */ decodeCredentialPublicKey)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\nfunction decodeCredentialPublicKey(publicKey) {\n    return _decodeCredentialPublicKeyInternals.stubThis(_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoCBOR.decodeFirst(publicKey));\n}\n// Make it possible to stub the return value during testing\nconst _decodeCredentialPublicKeyInternals = {\n    stubThis: (value) => value,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9kZWNvZGVDcmVkZW50aWFsUHVibGljS2V5LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF5QztBQUNsQztBQUNQLHdEQUF3RCw4REFBbUI7QUFDM0U7QUFDQTtBQUNPO0FBQ1A7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGRlY29kZUNyZWRlbnRpYWxQdWJsaWNLZXkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNvQ0JPUiB9IGZyb20gJy4vaXNvL2luZGV4LmpzJztcbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGVDcmVkZW50aWFsUHVibGljS2V5KHB1YmxpY0tleSkge1xuICAgIHJldHVybiBfZGVjb2RlQ3JlZGVudGlhbFB1YmxpY0tleUludGVybmFscy5zdHViVGhpcyhpc29DQk9SLmRlY29kZUZpcnN0KHB1YmxpY0tleSkpO1xufVxuLy8gTWFrZSBpdCBwb3NzaWJsZSB0byBzdHViIHRoZSByZXR1cm4gdmFsdWUgZHVyaW5nIHRlc3RpbmdcbmV4cG9ydCBjb25zdCBfZGVjb2RlQ3JlZGVudGlhbFB1YmxpY0tleUludGVybmFscyA9IHtcbiAgICBzdHViVGhpczogKHZhbHVlKSA9PiB2YWx1ZSxcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeCredentialPublicKey.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/fetch.js":
/*!******************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/fetch.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _fetchInternals: () => (/* binding */ _fetchInternals),\n/* harmony export */   fetch: () => (/* binding */ fetch)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n\n/**\n * A simple method for requesting data via standard `fetch`. Should work\n * across multiple runtimes.\n */\nfunction fetch(url) {\n    return _fetchInternals.stubThis(url);\n}\n// Make it possible to stub the return value during testing\nconst _fetchInternals = {\n    stubThis: (url) => (0,_deps_js__WEBPACK_IMPORTED_MODULE_0__.crossFetch)(url),\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9mZXRjaC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsdUJBQXVCLG9EQUFVO0FBQ2pDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcZmV0Y2guanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3Jvc3NGZXRjaCB9IGZyb20gJy4uL2RlcHMuanMnO1xuLyoqXG4gKiBBIHNpbXBsZSBtZXRob2QgZm9yIHJlcXVlc3RpbmcgZGF0YSB2aWEgc3RhbmRhcmQgYGZldGNoYC4gU2hvdWxkIHdvcmtcbiAqIGFjcm9zcyBtdWx0aXBsZSBydW50aW1lcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZldGNoKHVybCkge1xuICAgIHJldHVybiBfZmV0Y2hJbnRlcm5hbHMuc3R1YlRoaXModXJsKTtcbn1cbi8vIE1ha2UgaXQgcG9zc2libGUgdG8gc3R1YiB0aGUgcmV0dXJuIHZhbHVlIGR1cmluZyB0ZXN0aW5nXG5leHBvcnQgY29uc3QgX2ZldGNoSW50ZXJuYWxzID0ge1xuICAgIHN0dWJUaGlzOiAodXJsKSA9PiBjcm9zc0ZldGNoKHVybCksXG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/fetch.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateChallenge.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/generateChallenge.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _generateChallengeInternals: () => (/* binding */ _generateChallengeInternals),\n/* harmony export */   generateChallenge: () => (/* binding */ generateChallenge)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Generate a suitably random value to be used as an attestation or assertion challenge\n */\nasync function generateChallenge() {\n    /**\n     * WebAuthn spec says that 16 bytes is a good minimum:\n     *\n     * \"In order to prevent replay attacks, the challenges MUST contain enough entropy to make\n     * guessing them infeasible. Challenges SHOULD therefore be at least 16 bytes long.\"\n     *\n     * Just in case, let's double it\n     */\n    const challenge = new Uint8Array(32);\n    await _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoCrypto.getRandomValues(challenge);\n    return _generateChallengeInternals.stubThis(challenge);\n}\n// Make it possible to stub the return value during testing\nconst _generateChallengeInternals = {\n    stubThis: (value) => value,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9nZW5lcmF0ZUNoYWxsZW5nZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG9FQUF5QjtBQUNuQztBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxnZW5lcmF0ZUNoYWxsZW5nZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc29DcnlwdG8gfSBmcm9tICcuL2lzby9pbmRleC5qcyc7XG4vKipcbiAqIEdlbmVyYXRlIGEgc3VpdGFibHkgcmFuZG9tIHZhbHVlIHRvIGJlIHVzZWQgYXMgYW4gYXR0ZXN0YXRpb24gb3IgYXNzZXJ0aW9uIGNoYWxsZW5nZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVDaGFsbGVuZ2UoKSB7XG4gICAgLyoqXG4gICAgICogV2ViQXV0aG4gc3BlYyBzYXlzIHRoYXQgMTYgYnl0ZXMgaXMgYSBnb29kIG1pbmltdW06XG4gICAgICpcbiAgICAgKiBcIkluIG9yZGVyIHRvIHByZXZlbnQgcmVwbGF5IGF0dGFja3MsIHRoZSBjaGFsbGVuZ2VzIE1VU1QgY29udGFpbiBlbm91Z2ggZW50cm9weSB0byBtYWtlXG4gICAgICogZ3Vlc3NpbmcgdGhlbSBpbmZlYXNpYmxlLiBDaGFsbGVuZ2VzIFNIT1VMRCB0aGVyZWZvcmUgYmUgYXQgbGVhc3QgMTYgYnl0ZXMgbG9uZy5cIlxuICAgICAqXG4gICAgICogSnVzdCBpbiBjYXNlLCBsZXQncyBkb3VibGUgaXRcbiAgICAgKi9cbiAgICBjb25zdCBjaGFsbGVuZ2UgPSBuZXcgVWludDhBcnJheSgzMik7XG4gICAgYXdhaXQgaXNvQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyhjaGFsbGVuZ2UpO1xuICAgIHJldHVybiBfZ2VuZXJhdGVDaGFsbGVuZ2VJbnRlcm5hbHMuc3R1YlRoaXMoY2hhbGxlbmdlKTtcbn1cbi8vIE1ha2UgaXQgcG9zc2libGUgdG8gc3R1YiB0aGUgcmV0dXJuIHZhbHVlIGR1cmluZyB0ZXN0aW5nXG5leHBvcnQgY29uc3QgX2dlbmVyYXRlQ2hhbGxlbmdlSW50ZXJuYWxzID0ge1xuICAgIHN0dWJUaGlzOiAodmFsdWUpID0+IHZhbHVlLFxufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateChallenge.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateUserID.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/generateUserID.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _generateUserIDInternals: () => (/* binding */ _generateUserIDInternals),\n/* harmony export */   generateUserID: () => (/* binding */ generateUserID)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Generate a suitably random value to be used as user ID\n */\nasync function generateUserID() {\n    /**\n     * WebAuthn spec says user.id has a max length of 64 bytes. I prefer how 32 random bytes look\n     * after they're base64url-encoded so I'm choosing to go with that here.\n     */\n    const newUserID = new Uint8Array(32);\n    await _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoCrypto.getRandomValues(newUserID);\n    return _generateUserIDInternals.stubThis(newUserID);\n}\n// Make it possible to stub the return value during testing\nconst _generateUserIDInternals = {\n    stubThis: (value) => value,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9nZW5lcmF0ZVVzZXJJRC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxvRUFBeUI7QUFDbkM7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcZ2VuZXJhdGVVc2VySUQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNvQ3J5cHRvIH0gZnJvbSAnLi9pc28vaW5kZXguanMnO1xuLyoqXG4gKiBHZW5lcmF0ZSBhIHN1aXRhYmx5IHJhbmRvbSB2YWx1ZSB0byBiZSB1c2VkIGFzIHVzZXIgSURcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlVXNlcklEKCkge1xuICAgIC8qKlxuICAgICAqIFdlYkF1dGhuIHNwZWMgc2F5cyB1c2VyLmlkIGhhcyBhIG1heCBsZW5ndGggb2YgNjQgYnl0ZXMuIEkgcHJlZmVyIGhvdyAzMiByYW5kb20gYnl0ZXMgbG9va1xuICAgICAqIGFmdGVyIHRoZXkncmUgYmFzZTY0dXJsLWVuY29kZWQgc28gSSdtIGNob29zaW5nIHRvIGdvIHdpdGggdGhhdCBoZXJlLlxuICAgICAqL1xuICAgIGNvbnN0IG5ld1VzZXJJRCA9IG5ldyBVaW50OEFycmF5KDMyKTtcbiAgICBhd2FpdCBpc29DcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKG5ld1VzZXJJRCk7XG4gICAgcmV0dXJuIF9nZW5lcmF0ZVVzZXJJREludGVybmFscy5zdHViVGhpcyhuZXdVc2VySUQpO1xufVxuLy8gTWFrZSBpdCBwb3NzaWJsZSB0byBzdHViIHRoZSByZXR1cm4gdmFsdWUgZHVyaW5nIHRlc3RpbmdcbmV4cG9ydCBjb25zdCBfZ2VuZXJhdGVVc2VySURJbnRlcm5hbHMgPSB7XG4gICAgc3R1YlRoaXM6ICh2YWx1ZSkgPT4gdmFsdWUsXG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateUserID.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/getCertificateInfo.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/getCertificateInfo.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCertificateInfo: () => (/* binding */ getCertificateInfo)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n\nconst issuerSubjectIDKey = {\n    '2.5.4.6': 'C',\n    '2.5.4.10': 'O',\n    '2.5.4.11': 'OU',\n    '2.5.4.3': 'CN',\n};\n/**\n * Extract PEM certificate info\n *\n * @param pemCertificate Result from call to `convertASN1toPEM(x5c[0])`\n */\nfunction getCertificateInfo(leafCertBuffer) {\n    const x509 = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(leafCertBuffer, _deps_js__WEBPACK_IMPORTED_MODULE_0__.Certificate);\n    const parsedCert = x509.tbsCertificate;\n    // Issuer\n    const issuer = { combined: '' };\n    parsedCert.issuer.forEach(([iss]) => {\n        const key = issuerSubjectIDKey[iss.type];\n        if (key) {\n            issuer[key] = iss.value.toString();\n        }\n    });\n    issuer.combined = issuerSubjectToString(issuer);\n    // Subject\n    const subject = { combined: '' };\n    parsedCert.subject.forEach(([iss]) => {\n        const key = issuerSubjectIDKey[iss.type];\n        if (key) {\n            subject[key] = iss.value.toString();\n        }\n    });\n    subject.combined = issuerSubjectToString(subject);\n    let basicConstraintsCA = false;\n    if (parsedCert.extensions) {\n        // console.log(parsedCert.extensions);\n        for (const ext of parsedCert.extensions) {\n            if (ext.extnID === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_ce_basicConstraints) {\n                const basicConstraints = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(ext.extnValue, _deps_js__WEBPACK_IMPORTED_MODULE_0__.BasicConstraints);\n                basicConstraintsCA = basicConstraints.cA;\n            }\n        }\n    }\n    return {\n        issuer,\n        subject,\n        version: parsedCert.version,\n        basicConstraintsCA,\n        notBefore: parsedCert.validity.notBefore.getTime(),\n        notAfter: parsedCert.validity.notAfter.getTime(),\n        parsedCertificate: x509,\n    };\n}\n/**\n * Stringify the parts of Issuer or Subject info for easier comparison of subject issuers with\n * issuer subjects.\n *\n * The order might seem arbitrary, because it is. It should be enough that the two are stringified\n * in the same order.\n */\nfunction issuerSubjectToString(input) {\n    const parts = [];\n    if (input.C) {\n        parts.push(input.C);\n    }\n    if (input.O) {\n        parts.push(input.O);\n    }\n    if (input.OU) {\n        parts.push(input.OU);\n    }\n    if (input.CN) {\n        parts.push(input.CN);\n    }\n    return parts.join(' : ');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9nZXRDZXJ0aWZpY2F0ZUluZm8uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBOEY7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsaUJBQWlCLCtDQUFTLHVCQUF1QixpREFBVztBQUM1RDtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsNERBQXNCO0FBQ3JELHlDQUF5QywrQ0FBUyxzQkFBc0Isc0RBQWdCO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcZ2V0Q2VydGlmaWNhdGVJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzblBhcnNlciwgQmFzaWNDb25zdHJhaW50cywgQ2VydGlmaWNhdGUsIGlkX2NlX2Jhc2ljQ29uc3RyYWludHMgfSBmcm9tICcuLi9kZXBzLmpzJztcbmNvbnN0IGlzc3VlclN1YmplY3RJREtleSA9IHtcbiAgICAnMi41LjQuNic6ICdDJyxcbiAgICAnMi41LjQuMTAnOiAnTycsXG4gICAgJzIuNS40LjExJzogJ09VJyxcbiAgICAnMi41LjQuMyc6ICdDTicsXG59O1xuLyoqXG4gKiBFeHRyYWN0IFBFTSBjZXJ0aWZpY2F0ZSBpbmZvXG4gKlxuICogQHBhcmFtIHBlbUNlcnRpZmljYXRlIFJlc3VsdCBmcm9tIGNhbGwgdG8gYGNvbnZlcnRBU04xdG9QRU0oeDVjWzBdKWBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENlcnRpZmljYXRlSW5mbyhsZWFmQ2VydEJ1ZmZlcikge1xuICAgIGNvbnN0IHg1MDkgPSBBc25QYXJzZXIucGFyc2UobGVhZkNlcnRCdWZmZXIsIENlcnRpZmljYXRlKTtcbiAgICBjb25zdCBwYXJzZWRDZXJ0ID0geDUwOS50YnNDZXJ0aWZpY2F0ZTtcbiAgICAvLyBJc3N1ZXJcbiAgICBjb25zdCBpc3N1ZXIgPSB7IGNvbWJpbmVkOiAnJyB9O1xuICAgIHBhcnNlZENlcnQuaXNzdWVyLmZvckVhY2goKFtpc3NdKSA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9IGlzc3VlclN1YmplY3RJREtleVtpc3MudHlwZV07XG4gICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICAgIGlzc3VlcltrZXldID0gaXNzLnZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpc3N1ZXIuY29tYmluZWQgPSBpc3N1ZXJTdWJqZWN0VG9TdHJpbmcoaXNzdWVyKTtcbiAgICAvLyBTdWJqZWN0XG4gICAgY29uc3Qgc3ViamVjdCA9IHsgY29tYmluZWQ6ICcnIH07XG4gICAgcGFyc2VkQ2VydC5zdWJqZWN0LmZvckVhY2goKFtpc3NdKSA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9IGlzc3VlclN1YmplY3RJREtleVtpc3MudHlwZV07XG4gICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICAgIHN1YmplY3Rba2V5XSA9IGlzcy52YWx1ZS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgc3ViamVjdC5jb21iaW5lZCA9IGlzc3VlclN1YmplY3RUb1N0cmluZyhzdWJqZWN0KTtcbiAgICBsZXQgYmFzaWNDb25zdHJhaW50c0NBID0gZmFsc2U7XG4gICAgaWYgKHBhcnNlZENlcnQuZXh0ZW5zaW9ucykge1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhwYXJzZWRDZXJ0LmV4dGVuc2lvbnMpO1xuICAgICAgICBmb3IgKGNvbnN0IGV4dCBvZiBwYXJzZWRDZXJ0LmV4dGVuc2lvbnMpIHtcbiAgICAgICAgICAgIGlmIChleHQuZXh0bklEID09PSBpZF9jZV9iYXNpY0NvbnN0cmFpbnRzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYmFzaWNDb25zdHJhaW50cyA9IEFzblBhcnNlci5wYXJzZShleHQuZXh0blZhbHVlLCBCYXNpY0NvbnN0cmFpbnRzKTtcbiAgICAgICAgICAgICAgICBiYXNpY0NvbnN0cmFpbnRzQ0EgPSBiYXNpY0NvbnN0cmFpbnRzLmNBO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGlzc3VlcixcbiAgICAgICAgc3ViamVjdCxcbiAgICAgICAgdmVyc2lvbjogcGFyc2VkQ2VydC52ZXJzaW9uLFxuICAgICAgICBiYXNpY0NvbnN0cmFpbnRzQ0EsXG4gICAgICAgIG5vdEJlZm9yZTogcGFyc2VkQ2VydC52YWxpZGl0eS5ub3RCZWZvcmUuZ2V0VGltZSgpLFxuICAgICAgICBub3RBZnRlcjogcGFyc2VkQ2VydC52YWxpZGl0eS5ub3RBZnRlci5nZXRUaW1lKCksXG4gICAgICAgIHBhcnNlZENlcnRpZmljYXRlOiB4NTA5LFxuICAgIH07XG59XG4vKipcbiAqIFN0cmluZ2lmeSB0aGUgcGFydHMgb2YgSXNzdWVyIG9yIFN1YmplY3QgaW5mbyBmb3IgZWFzaWVyIGNvbXBhcmlzb24gb2Ygc3ViamVjdCBpc3N1ZXJzIHdpdGhcbiAqIGlzc3VlciBzdWJqZWN0cy5cbiAqXG4gKiBUaGUgb3JkZXIgbWlnaHQgc2VlbSBhcmJpdHJhcnksIGJlY2F1c2UgaXQgaXMuIEl0IHNob3VsZCBiZSBlbm91Z2ggdGhhdCB0aGUgdHdvIGFyZSBzdHJpbmdpZmllZFxuICogaW4gdGhlIHNhbWUgb3JkZXIuXG4gKi9cbmZ1bmN0aW9uIGlzc3VlclN1YmplY3RUb1N0cmluZyhpbnB1dCkge1xuICAgIGNvbnN0IHBhcnRzID0gW107XG4gICAgaWYgKGlucHV0LkMpIHtcbiAgICAgICAgcGFydHMucHVzaChpbnB1dC5DKTtcbiAgICB9XG4gICAgaWYgKGlucHV0Lk8pIHtcbiAgICAgICAgcGFydHMucHVzaChpbnB1dC5PKTtcbiAgICB9XG4gICAgaWYgKGlucHV0Lk9VKSB7XG4gICAgICAgIHBhcnRzLnB1c2goaW5wdXQuT1UpO1xuICAgIH1cbiAgICBpZiAoaW5wdXQuQ04pIHtcbiAgICAgICAgcGFydHMucHVzaChpbnB1dC5DTik7XG4gICAgfVxuICAgIHJldHVybiBwYXJ0cy5qb2luKCcgOiAnKTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/getCertificateInfo.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/index.js":
/*!******************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/index.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertAAGUIDToString: () => (/* reexport safe */ _convertAAGUIDToString_js__WEBPACK_IMPORTED_MODULE_0__.convertAAGUIDToString),\n/* harmony export */   convertCOSEtoPKCS: () => (/* reexport safe */ _convertCOSEtoPKCS_js__WEBPACK_IMPORTED_MODULE_2__.convertCOSEtoPKCS),\n/* harmony export */   convertCertBufferToPEM: () => (/* reexport safe */ _convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__.convertCertBufferToPEM),\n/* harmony export */   cose: () => (/* reexport module object */ _cose_js__WEBPACK_IMPORTED_MODULE_15__),\n/* harmony export */   decodeAttestationObject: () => (/* reexport safe */ _decodeAttestationObject_js__WEBPACK_IMPORTED_MODULE_3__.decodeAttestationObject),\n/* harmony export */   decodeClientDataJSON: () => (/* reexport safe */ _decodeClientDataJSON_js__WEBPACK_IMPORTED_MODULE_4__.decodeClientDataJSON),\n/* harmony export */   decodeCredentialPublicKey: () => (/* reexport safe */ _decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_5__.decodeCredentialPublicKey),\n/* harmony export */   generateChallenge: () => (/* reexport safe */ _generateChallenge_js__WEBPACK_IMPORTED_MODULE_6__.generateChallenge),\n/* harmony export */   generateUserID: () => (/* reexport safe */ _generateUserID_js__WEBPACK_IMPORTED_MODULE_7__.generateUserID),\n/* harmony export */   getCertificateInfo: () => (/* reexport safe */ _getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_8__.getCertificateInfo),\n/* harmony export */   isCertRevoked: () => (/* reexport safe */ _isCertRevoked_js__WEBPACK_IMPORTED_MODULE_9__.isCertRevoked),\n/* harmony export */   isoBase64URL: () => (/* reexport safe */ _iso_index_js__WEBPACK_IMPORTED_MODULE_14__.isoBase64URL),\n/* harmony export */   isoCBOR: () => (/* reexport safe */ _iso_index_js__WEBPACK_IMPORTED_MODULE_14__.isoCBOR),\n/* harmony export */   isoCrypto: () => (/* reexport safe */ _iso_index_js__WEBPACK_IMPORTED_MODULE_14__.isoCrypto),\n/* harmony export */   isoUint8Array: () => (/* reexport safe */ _iso_index_js__WEBPACK_IMPORTED_MODULE_14__.isoUint8Array),\n/* harmony export */   parseAuthenticatorData: () => (/* reexport safe */ _parseAuthenticatorData_js__WEBPACK_IMPORTED_MODULE_10__.parseAuthenticatorData),\n/* harmony export */   toHash: () => (/* reexport safe */ _toHash_js__WEBPACK_IMPORTED_MODULE_11__.toHash),\n/* harmony export */   validateCertificatePath: () => (/* reexport safe */ _validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_12__.validateCertificatePath),\n/* harmony export */   verifySignature: () => (/* reexport safe */ _verifySignature_js__WEBPACK_IMPORTED_MODULE_13__.verifySignature)\n/* harmony export */ });\n/* harmony import */ var _convertAAGUIDToString_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./convertAAGUIDToString.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertAAGUIDToString.js\");\n/* harmony import */ var _convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _convertCOSEtoPKCS_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./convertCOSEtoPKCS.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCOSEtoPKCS.js\");\n/* harmony import */ var _decodeAttestationObject_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./decodeAttestationObject.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeAttestationObject.js\");\n/* harmony import */ var _decodeClientDataJSON_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./decodeClientDataJSON.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeClientDataJSON.js\");\n/* harmony import */ var _decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./decodeCredentialPublicKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeCredentialPublicKey.js\");\n/* harmony import */ var _generateChallenge_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./generateChallenge.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateChallenge.js\");\n/* harmony import */ var _generateUserID_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./generateUserID.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateUserID.js\");\n/* harmony import */ var _getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./getCertificateInfo.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/getCertificateInfo.js\");\n/* harmony import */ var _isCertRevoked_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./isCertRevoked.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/isCertRevoked.js\");\n/* harmony import */ var _parseAuthenticatorData_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./parseAuthenticatorData.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseAuthenticatorData.js\");\n/* harmony import */ var _toHash_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./toHash.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js\");\n/* harmony import */ var _validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _verifySignature_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./verifySignature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\");\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFtRTtBQUNFO0FBQ1Y7QUFDWTtBQUNOO0FBQ1U7QUFDaEI7QUFDTjtBQUNRO0FBQ1Y7QUFDa0I7QUFDaEM7QUFDa0M7QUFDaEI7QUFDMEI7QUFDL0M7QUFDNFQiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb252ZXJ0QUFHVUlEVG9TdHJpbmcgfSBmcm9tICcuL2NvbnZlcnRBQUdVSURUb1N0cmluZy5qcyc7XG5pbXBvcnQgeyBjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNIH0gZnJvbSAnLi9jb252ZXJ0Q2VydEJ1ZmZlclRvUEVNLmpzJztcbmltcG9ydCB7IGNvbnZlcnRDT1NFdG9QS0NTIH0gZnJvbSAnLi9jb252ZXJ0Q09TRXRvUEtDUy5qcyc7XG5pbXBvcnQgeyBkZWNvZGVBdHRlc3RhdGlvbk9iamVjdCB9IGZyb20gJy4vZGVjb2RlQXR0ZXN0YXRpb25PYmplY3QuanMnO1xuaW1wb3J0IHsgZGVjb2RlQ2xpZW50RGF0YUpTT04gfSBmcm9tICcuL2RlY29kZUNsaWVudERhdGFKU09OLmpzJztcbmltcG9ydCB7IGRlY29kZUNyZWRlbnRpYWxQdWJsaWNLZXkgfSBmcm9tICcuL2RlY29kZUNyZWRlbnRpYWxQdWJsaWNLZXkuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVDaGFsbGVuZ2UgfSBmcm9tICcuL2dlbmVyYXRlQ2hhbGxlbmdlLmpzJztcbmltcG9ydCB7IGdlbmVyYXRlVXNlcklEIH0gZnJvbSAnLi9nZW5lcmF0ZVVzZXJJRC5qcyc7XG5pbXBvcnQgeyBnZXRDZXJ0aWZpY2F0ZUluZm8gfSBmcm9tICcuL2dldENlcnRpZmljYXRlSW5mby5qcyc7XG5pbXBvcnQgeyBpc0NlcnRSZXZva2VkIH0gZnJvbSAnLi9pc0NlcnRSZXZva2VkLmpzJztcbmltcG9ydCB7IHBhcnNlQXV0aGVudGljYXRvckRhdGEgfSBmcm9tICcuL3BhcnNlQXV0aGVudGljYXRvckRhdGEuanMnO1xuaW1wb3J0IHsgdG9IYXNoIH0gZnJvbSAnLi90b0hhc2guanMnO1xuaW1wb3J0IHsgdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGggfSBmcm9tICcuL3ZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoLmpzJztcbmltcG9ydCB7IHZlcmlmeVNpZ25hdHVyZSB9IGZyb20gJy4vdmVyaWZ5U2lnbmF0dXJlLmpzJztcbmltcG9ydCB7IGlzb0Jhc2U2NFVSTCwgaXNvQ0JPUiwgaXNvQ3J5cHRvLCBpc29VaW50OEFycmF5IH0gZnJvbSAnLi9pc28vaW5kZXguanMnO1xuaW1wb3J0ICogYXMgY29zZSBmcm9tICcuL2Nvc2UuanMnO1xuZXhwb3J0IHsgY29udmVydEFBR1VJRFRvU3RyaW5nLCBjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNLCBjb252ZXJ0Q09TRXRvUEtDUywgY29zZSwgZGVjb2RlQXR0ZXN0YXRpb25PYmplY3QsIGRlY29kZUNsaWVudERhdGFKU09OLCBkZWNvZGVDcmVkZW50aWFsUHVibGljS2V5LCBnZW5lcmF0ZUNoYWxsZW5nZSwgZ2VuZXJhdGVVc2VySUQsIGdldENlcnRpZmljYXRlSW5mbywgaXNDZXJ0UmV2b2tlZCwgaXNvQmFzZTY0VVJMLCBpc29DQk9SLCBpc29DcnlwdG8sIGlzb1VpbnQ4QXJyYXksIHBhcnNlQXV0aGVudGljYXRvckRhdGEsIHRvSGFzaCwgdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGgsIHZlcmlmeVNpZ25hdHVyZSwgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/isCertRevoked.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/isCertRevoked.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isCertRevoked: () => (/* binding */ isCertRevoked)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _fetch_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./fetch.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/fetch.js\");\n\n\n\nconst cacheRevokedCerts = {};\n/**\n * A method to pull a CRL from a certificate and compare its serial number to the list of revoked\n * certificate serial numbers within the CRL.\n *\n * CRL certificate structure referenced from https://tools.ietf.org/html/rfc5280#page-117\n */\nasync function isCertRevoked(cert) {\n    const { extensions } = cert.tbsCertificate;\n    if (!extensions) {\n        return false;\n    }\n    let extAuthorityKeyID;\n    let extSubjectKeyID;\n    let extCRLDistributionPoints;\n    extensions.forEach((ext) => {\n        if (ext.extnID === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_ce_authorityKeyIdentifier) {\n            extAuthorityKeyID = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(ext.extnValue, _deps_js__WEBPACK_IMPORTED_MODULE_0__.AuthorityKeyIdentifier);\n        }\n        else if (ext.extnID === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_ce_subjectKeyIdentifier) {\n            extSubjectKeyID = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(ext.extnValue, _deps_js__WEBPACK_IMPORTED_MODULE_0__.SubjectKeyIdentifier);\n        }\n        else if (ext.extnID === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_ce_cRLDistributionPoints) {\n            extCRLDistributionPoints = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(ext.extnValue, _deps_js__WEBPACK_IMPORTED_MODULE_0__.CRLDistributionPoints);\n        }\n    });\n    // Check to see if we've got cached info for the cert's CA\n    let keyIdentifier = undefined;\n    if (extAuthorityKeyID && extAuthorityKeyID.keyIdentifier) {\n        keyIdentifier = _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.toHex(new Uint8Array(extAuthorityKeyID.keyIdentifier.buffer));\n    }\n    else if (extSubjectKeyID) {\n        /**\n         * We might be dealing with a self-signed root certificate. Check the\n         * Subject key Identifier extension next.\n         */\n        keyIdentifier = _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.toHex(new Uint8Array(extSubjectKeyID.buffer));\n    }\n    const certSerialHex = _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.toHex(new Uint8Array(cert.tbsCertificate.serialNumber));\n    if (keyIdentifier) {\n        const cached = cacheRevokedCerts[keyIdentifier];\n        if (cached) {\n            const now = new Date();\n            // If there's a nextUpdate then make sure we're before it\n            if (!cached.nextUpdate || cached.nextUpdate > now) {\n                return cached.revokedCerts.indexOf(certSerialHex) >= 0;\n            }\n        }\n    }\n    const crlURL = extCRLDistributionPoints?.[0].distributionPoint?.fullName?.[0]\n        .uniformResourceIdentifier;\n    // If no URL is provided then we have nothing to check\n    if (!crlURL) {\n        return false;\n    }\n    // Download and read the CRL\n    let certListBytes;\n    try {\n        const respCRL = await (0,_fetch_js__WEBPACK_IMPORTED_MODULE_2__.fetch)(crlURL);\n        certListBytes = await respCRL.arrayBuffer();\n    }\n    catch (_err) {\n        return false;\n    }\n    let data;\n    try {\n        data = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(certListBytes, _deps_js__WEBPACK_IMPORTED_MODULE_0__.CertificateList);\n    }\n    catch (_err) {\n        // Something was malformed with the CRL, so pass\n        return false;\n    }\n    const newCached = {\n        revokedCerts: [],\n        nextUpdate: undefined,\n    };\n    // nextUpdate\n    if (data.tbsCertList.nextUpdate) {\n        newCached.nextUpdate = data.tbsCertList.nextUpdate.getTime();\n    }\n    // revokedCertificates\n    const revokedCerts = data.tbsCertList.revokedCertificates;\n    if (revokedCerts) {\n        for (const cert of revokedCerts) {\n            const revokedHex = _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.toHex(new Uint8Array(cert.userCertificate));\n            newCached.revokedCerts.push(revokedHex);\n        }\n        // Cache the results\n        if (keyIdentifier) {\n            cacheRevokedCerts[keyIdentifier] = newCached;\n        }\n        return newCached.revokedCerts.indexOf(certSerialHex) >= 0;\n    }\n    return false;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc0NlcnRSZXZva2VkLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBcU47QUFDdEs7QUFDWjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsWUFBWSxhQUFhO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGtFQUE0QjtBQUN2RCxnQ0FBZ0MsK0NBQVMsc0JBQXNCLDREQUFzQjtBQUNyRjtBQUNBLGdDQUFnQyxnRUFBMEI7QUFDMUQsOEJBQThCLCtDQUFTLHNCQUFzQiwwREFBb0I7QUFDakY7QUFDQSxnQ0FBZ0MsaUVBQTJCO0FBQzNELHVDQUF1QywrQ0FBUyxzQkFBc0IsMkRBQXFCO0FBQzNGO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qiw4REFBbUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDhEQUFtQjtBQUMzQztBQUNBLDBCQUEwQiw4REFBbUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsZ0RBQUs7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLCtDQUFTLHNCQUFzQixxREFBZTtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDhEQUFtQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGlzQ2VydFJldm9rZWQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXNuUGFyc2VyLCBBdXRob3JpdHlLZXlJZGVudGlmaWVyLCBDZXJ0aWZpY2F0ZUxpc3QsIENSTERpc3RyaWJ1dGlvblBvaW50cywgaWRfY2VfYXV0aG9yaXR5S2V5SWRlbnRpZmllciwgaWRfY2VfY1JMRGlzdHJpYnV0aW9uUG9pbnRzLCBpZF9jZV9zdWJqZWN0S2V5SWRlbnRpZmllciwgU3ViamVjdEtleUlkZW50aWZpZXIsIH0gZnJvbSAnLi4vZGVwcy5qcyc7XG5pbXBvcnQgeyBpc29VaW50OEFycmF5IH0gZnJvbSAnLi9pc28vaW5kZXguanMnO1xuaW1wb3J0IHsgZmV0Y2ggfSBmcm9tICcuL2ZldGNoLmpzJztcbmNvbnN0IGNhY2hlUmV2b2tlZENlcnRzID0ge307XG4vKipcbiAqIEEgbWV0aG9kIHRvIHB1bGwgYSBDUkwgZnJvbSBhIGNlcnRpZmljYXRlIGFuZCBjb21wYXJlIGl0cyBzZXJpYWwgbnVtYmVyIHRvIHRoZSBsaXN0IG9mIHJldm9rZWRcbiAqIGNlcnRpZmljYXRlIHNlcmlhbCBudW1iZXJzIHdpdGhpbiB0aGUgQ1JMLlxuICpcbiAqIENSTCBjZXJ0aWZpY2F0ZSBzdHJ1Y3R1cmUgcmVmZXJlbmNlZCBmcm9tIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM1MjgwI3BhZ2UtMTE3XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc0NlcnRSZXZva2VkKGNlcnQpIHtcbiAgICBjb25zdCB7IGV4dGVuc2lvbnMgfSA9IGNlcnQudGJzQ2VydGlmaWNhdGU7XG4gICAgaWYgKCFleHRlbnNpb25zKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IGV4dEF1dGhvcml0eUtleUlEO1xuICAgIGxldCBleHRTdWJqZWN0S2V5SUQ7XG4gICAgbGV0IGV4dENSTERpc3RyaWJ1dGlvblBvaW50cztcbiAgICBleHRlbnNpb25zLmZvckVhY2goKGV4dCkgPT4ge1xuICAgICAgICBpZiAoZXh0LmV4dG5JRCA9PT0gaWRfY2VfYXV0aG9yaXR5S2V5SWRlbnRpZmllcikge1xuICAgICAgICAgICAgZXh0QXV0aG9yaXR5S2V5SUQgPSBBc25QYXJzZXIucGFyc2UoZXh0LmV4dG5WYWx1ZSwgQXV0aG9yaXR5S2V5SWRlbnRpZmllcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXh0LmV4dG5JRCA9PT0gaWRfY2Vfc3ViamVjdEtleUlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIGV4dFN1YmplY3RLZXlJRCA9IEFzblBhcnNlci5wYXJzZShleHQuZXh0blZhbHVlLCBTdWJqZWN0S2V5SWRlbnRpZmllcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXh0LmV4dG5JRCA9PT0gaWRfY2VfY1JMRGlzdHJpYnV0aW9uUG9pbnRzKSB7XG4gICAgICAgICAgICBleHRDUkxEaXN0cmlidXRpb25Qb2ludHMgPSBBc25QYXJzZXIucGFyc2UoZXh0LmV4dG5WYWx1ZSwgQ1JMRGlzdHJpYnV0aW9uUG9pbnRzKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8vIENoZWNrIHRvIHNlZSBpZiB3ZSd2ZSBnb3QgY2FjaGVkIGluZm8gZm9yIHRoZSBjZXJ0J3MgQ0FcbiAgICBsZXQga2V5SWRlbnRpZmllciA9IHVuZGVmaW5lZDtcbiAgICBpZiAoZXh0QXV0aG9yaXR5S2V5SUQgJiYgZXh0QXV0aG9yaXR5S2V5SUQua2V5SWRlbnRpZmllcikge1xuICAgICAgICBrZXlJZGVudGlmaWVyID0gaXNvVWludDhBcnJheS50b0hleChuZXcgVWludDhBcnJheShleHRBdXRob3JpdHlLZXlJRC5rZXlJZGVudGlmaWVyLmJ1ZmZlcikpO1xuICAgIH1cbiAgICBlbHNlIGlmIChleHRTdWJqZWN0S2V5SUQpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdlIG1pZ2h0IGJlIGRlYWxpbmcgd2l0aCBhIHNlbGYtc2lnbmVkIHJvb3QgY2VydGlmaWNhdGUuIENoZWNrIHRoZVxuICAgICAgICAgKiBTdWJqZWN0IGtleSBJZGVudGlmaWVyIGV4dGVuc2lvbiBuZXh0LlxuICAgICAgICAgKi9cbiAgICAgICAga2V5SWRlbnRpZmllciA9IGlzb1VpbnQ4QXJyYXkudG9IZXgobmV3IFVpbnQ4QXJyYXkoZXh0U3ViamVjdEtleUlELmJ1ZmZlcikpO1xuICAgIH1cbiAgICBjb25zdCBjZXJ0U2VyaWFsSGV4ID0gaXNvVWludDhBcnJheS50b0hleChuZXcgVWludDhBcnJheShjZXJ0LnRic0NlcnRpZmljYXRlLnNlcmlhbE51bWJlcikpO1xuICAgIGlmIChrZXlJZGVudGlmaWVyKSB7XG4gICAgICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlUmV2b2tlZENlcnRzW2tleUlkZW50aWZpZXJdO1xuICAgICAgICBpZiAoY2FjaGVkKSB7XG4gICAgICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgLy8gSWYgdGhlcmUncyBhIG5leHRVcGRhdGUgdGhlbiBtYWtlIHN1cmUgd2UncmUgYmVmb3JlIGl0XG4gICAgICAgICAgICBpZiAoIWNhY2hlZC5uZXh0VXBkYXRlIHx8IGNhY2hlZC5uZXh0VXBkYXRlID4gbm93KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZC5yZXZva2VkQ2VydHMuaW5kZXhPZihjZXJ0U2VyaWFsSGV4KSA+PSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGNybFVSTCA9IGV4dENSTERpc3RyaWJ1dGlvblBvaW50cz8uWzBdLmRpc3RyaWJ1dGlvblBvaW50Py5mdWxsTmFtZT8uWzBdXG4gICAgICAgIC51bmlmb3JtUmVzb3VyY2VJZGVudGlmaWVyO1xuICAgIC8vIElmIG5vIFVSTCBpcyBwcm92aWRlZCB0aGVuIHdlIGhhdmUgbm90aGluZyB0byBjaGVja1xuICAgIGlmICghY3JsVVJMKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gRG93bmxvYWQgYW5kIHJlYWQgdGhlIENSTFxuICAgIGxldCBjZXJ0TGlzdEJ5dGVzO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BDUkwgPSBhd2FpdCBmZXRjaChjcmxVUkwpO1xuICAgICAgICBjZXJ0TGlzdEJ5dGVzID0gYXdhaXQgcmVzcENSTC5hcnJheUJ1ZmZlcigpO1xuICAgIH1cbiAgICBjYXRjaCAoX2Vycikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGxldCBkYXRhO1xuICAgIHRyeSB7XG4gICAgICAgIGRhdGEgPSBBc25QYXJzZXIucGFyc2UoY2VydExpc3RCeXRlcywgQ2VydGlmaWNhdGVMaXN0KTtcbiAgICB9XG4gICAgY2F0Y2ggKF9lcnIpIHtcbiAgICAgICAgLy8gU29tZXRoaW5nIHdhcyBtYWxmb3JtZWQgd2l0aCB0aGUgQ1JMLCBzbyBwYXNzXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgbmV3Q2FjaGVkID0ge1xuICAgICAgICByZXZva2VkQ2VydHM6IFtdLFxuICAgICAgICBuZXh0VXBkYXRlOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgICAvLyBuZXh0VXBkYXRlXG4gICAgaWYgKGRhdGEudGJzQ2VydExpc3QubmV4dFVwZGF0ZSkge1xuICAgICAgICBuZXdDYWNoZWQubmV4dFVwZGF0ZSA9IGRhdGEudGJzQ2VydExpc3QubmV4dFVwZGF0ZS5nZXRUaW1lKCk7XG4gICAgfVxuICAgIC8vIHJldm9rZWRDZXJ0aWZpY2F0ZXNcbiAgICBjb25zdCByZXZva2VkQ2VydHMgPSBkYXRhLnRic0NlcnRMaXN0LnJldm9rZWRDZXJ0aWZpY2F0ZXM7XG4gICAgaWYgKHJldm9rZWRDZXJ0cykge1xuICAgICAgICBmb3IgKGNvbnN0IGNlcnQgb2YgcmV2b2tlZENlcnRzKSB7XG4gICAgICAgICAgICBjb25zdCByZXZva2VkSGV4ID0gaXNvVWludDhBcnJheS50b0hleChuZXcgVWludDhBcnJheShjZXJ0LnVzZXJDZXJ0aWZpY2F0ZSkpO1xuICAgICAgICAgICAgbmV3Q2FjaGVkLnJldm9rZWRDZXJ0cy5wdXNoKHJldm9rZWRIZXgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENhY2hlIHRoZSByZXN1bHRzXG4gICAgICAgIGlmIChrZXlJZGVudGlmaWVyKSB7XG4gICAgICAgICAgICBjYWNoZVJldm9rZWRDZXJ0c1trZXlJZGVudGlmaWVyXSA9IG5ld0NhY2hlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3Q2FjaGVkLnJldm9rZWRDZXJ0cy5pbmRleE9mKGNlcnRTZXJpYWxIZXgpID49IDA7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/isCertRevoked.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isoBase64URL: () => (/* reexport module object */ _isoBase64URL_js__WEBPACK_IMPORTED_MODULE_0__),\n/* harmony export */   isoCBOR: () => (/* reexport module object */ _isoCBOR_js__WEBPACK_IMPORTED_MODULE_1__),\n/* harmony export */   isoCrypto: () => (/* reexport module object */ _isoCrypto_index_js__WEBPACK_IMPORTED_MODULE_2__),\n/* harmony export */   isoUint8Array: () => (/* reexport module object */ _isoUint8Array_js__WEBPACK_IMPORTED_MODULE_3__)\n/* harmony export */ });\n/* harmony import */ var _isoBase64URL_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isoBase64URL.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoBase64URL.js\");\n/* harmony import */ var _isoCBOR_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./isoCBOR.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCBOR.js\");\n/* harmony import */ var _isoCrypto_index_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./isoCrypto/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/index.js\");\n/* harmony import */ var _isoUint8Array_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./isoUint8Array.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoUint8Array.js\");\n/**\n * A collection of methods for isomorphic manipulation of trickier data types\n *\n * The goal with these is to make it easier to replace dependencies later that might not play well\n * with specific server-like runtimes that expose global Web APIs (CloudFlare Workers, Deno, Bun,\n * etc...), while also supporting execution in Node.\n */\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNrRDtBQUNWO0FBQ1U7QUFDRSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGlzb1xcaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBIGNvbGxlY3Rpb24gb2YgbWV0aG9kcyBmb3IgaXNvbW9ycGhpYyBtYW5pcHVsYXRpb24gb2YgdHJpY2tpZXIgZGF0YSB0eXBlc1xuICpcbiAqIFRoZSBnb2FsIHdpdGggdGhlc2UgaXMgdG8gbWFrZSBpdCBlYXNpZXIgdG8gcmVwbGFjZSBkZXBlbmRlbmNpZXMgbGF0ZXIgdGhhdCBtaWdodCBub3QgcGxheSB3ZWxsXG4gKiB3aXRoIHNwZWNpZmljIHNlcnZlci1saWtlIHJ1bnRpbWVzIHRoYXQgZXhwb3NlIGdsb2JhbCBXZWIgQVBJcyAoQ2xvdWRGbGFyZSBXb3JrZXJzLCBEZW5vLCBCdW4sXG4gKiBldGMuLi4pLCB3aGlsZSBhbHNvIHN1cHBvcnRpbmcgZXhlY3V0aW9uIGluIE5vZGUuXG4gKi9cbmV4cG9ydCAqIGFzIGlzb0Jhc2U2NFVSTCBmcm9tICcuL2lzb0Jhc2U2NFVSTC5qcyc7XG5leHBvcnQgKiBhcyBpc29DQk9SIGZyb20gJy4vaXNvQ0JPUi5qcyc7XG5leHBvcnQgKiBhcyBpc29DcnlwdG8gZnJvbSAnLi9pc29DcnlwdG8vaW5kZXguanMnO1xuZXhwb3J0ICogYXMgaXNvVWludDhBcnJheSBmcm9tICcuL2lzb1VpbnQ4QXJyYXkuanMnO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoBase64URL.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoBase64URL.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fromBuffer: () => (/* binding */ fromBuffer),\n/* harmony export */   fromUTF8String: () => (/* binding */ fromUTF8String),\n/* harmony export */   isBase64: () => (/* binding */ isBase64),\n/* harmony export */   isBase64URL: () => (/* binding */ isBase64URL),\n/* harmony export */   toBase64: () => (/* binding */ toBase64),\n/* harmony export */   toBuffer: () => (/* binding */ toBuffer),\n/* harmony export */   toUTF8String: () => (/* binding */ toUTF8String),\n/* harmony export */   trimPadding: () => (/* binding */ trimPadding)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n\n/**\n * Decode from a Base64URL-encoded string to an ArrayBuffer. Best used when converting a\n * credential ID from a JSON string to an ArrayBuffer, like in allowCredentials or\n * excludeCredentials.\n *\n * @param buffer Value to decode from base64\n * @param to (optional) The decoding to use, in case it's desirable to decode from base64 instead\n */\nfunction toBuffer(base64urlString, from = 'base64url') {\n    const _buffer = _deps_js__WEBPACK_IMPORTED_MODULE_0__.base64.toArrayBuffer(base64urlString, from === 'base64url');\n    return new Uint8Array(_buffer);\n}\n/**\n * Encode the given array buffer into a Base64URL-encoded string. Ideal for converting various\n * credential response ArrayBuffers to string for sending back to the server as JSON.\n *\n * @param buffer Value to encode to base64\n * @param to (optional) The encoding to use, in case it's desirable to encode to base64 instead\n */\nfunction fromBuffer(buffer, to = 'base64url') {\n    return _deps_js__WEBPACK_IMPORTED_MODULE_0__.base64.fromArrayBuffer(buffer, to === 'base64url');\n}\n/**\n * Convert a base64url string into base64\n */\nfunction toBase64(base64urlString) {\n    const fromBase64Url = _deps_js__WEBPACK_IMPORTED_MODULE_0__.base64.toArrayBuffer(base64urlString, true);\n    const toBase64 = _deps_js__WEBPACK_IMPORTED_MODULE_0__.base64.fromArrayBuffer(fromBase64Url);\n    return toBase64;\n}\n/**\n * Encode a UTF-8 string to base64url\n */\nfunction fromUTF8String(utf8String) {\n    return _deps_js__WEBPACK_IMPORTED_MODULE_0__.base64.fromString(utf8String, true);\n}\n/**\n * Decode a base64url string into its original UTF-8 string\n */\nfunction toUTF8String(base64urlString) {\n    return _deps_js__WEBPACK_IMPORTED_MODULE_0__.base64.toString(base64urlString, true);\n}\n/**\n * Confirm that the string is encoded into base64\n */\nfunction isBase64(input) {\n    return _deps_js__WEBPACK_IMPORTED_MODULE_0__.base64.validate(input, false);\n}\n/**\n * Confirm that the string is encoded into base64url, with support for optional padding\n */\nfunction isBase64URL(input) {\n    // Trim padding characters from the string if present\n    input = trimPadding(input);\n    return _deps_js__WEBPACK_IMPORTED_MODULE_0__.base64.validate(input, true);\n}\n/**\n * Remove optional padding from a base64url-encoded string\n */\nfunction trimPadding(input) {\n    return input.replace(/=/g, '');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQmFzZTY0VVJMLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxvQkFBb0IsNENBQU07QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxXQUFXLDRDQUFNO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCwwQkFBMEIsNENBQU07QUFDaEMscUJBQXFCLDRDQUFNO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLFdBQVcsNENBQU07QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLFdBQVcsNENBQU07QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLFdBQVcsNENBQU07QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQSxXQUFXLDRDQUFNO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcaXNvXFxpc29CYXNlNjRVUkwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYmFzZTY0IH0gZnJvbSAnLi4vLi4vZGVwcy5qcyc7XG4vKipcbiAqIERlY29kZSBmcm9tIGEgQmFzZTY0VVJMLWVuY29kZWQgc3RyaW5nIHRvIGFuIEFycmF5QnVmZmVyLiBCZXN0IHVzZWQgd2hlbiBjb252ZXJ0aW5nIGFcbiAqIGNyZWRlbnRpYWwgSUQgZnJvbSBhIEpTT04gc3RyaW5nIHRvIGFuIEFycmF5QnVmZmVyLCBsaWtlIGluIGFsbG93Q3JlZGVudGlhbHMgb3JcbiAqIGV4Y2x1ZGVDcmVkZW50aWFscy5cbiAqXG4gKiBAcGFyYW0gYnVmZmVyIFZhbHVlIHRvIGRlY29kZSBmcm9tIGJhc2U2NFxuICogQHBhcmFtIHRvIChvcHRpb25hbCkgVGhlIGRlY29kaW5nIHRvIHVzZSwgaW4gY2FzZSBpdCdzIGRlc2lyYWJsZSB0byBkZWNvZGUgZnJvbSBiYXNlNjQgaW5zdGVhZFxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9CdWZmZXIoYmFzZTY0dXJsU3RyaW5nLCBmcm9tID0gJ2Jhc2U2NHVybCcpIHtcbiAgICBjb25zdCBfYnVmZmVyID0gYmFzZTY0LnRvQXJyYXlCdWZmZXIoYmFzZTY0dXJsU3RyaW5nLCBmcm9tID09PSAnYmFzZTY0dXJsJyk7XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KF9idWZmZXIpO1xufVxuLyoqXG4gKiBFbmNvZGUgdGhlIGdpdmVuIGFycmF5IGJ1ZmZlciBpbnRvIGEgQmFzZTY0VVJMLWVuY29kZWQgc3RyaW5nLiBJZGVhbCBmb3IgY29udmVydGluZyB2YXJpb3VzXG4gKiBjcmVkZW50aWFsIHJlc3BvbnNlIEFycmF5QnVmZmVycyB0byBzdHJpbmcgZm9yIHNlbmRpbmcgYmFjayB0byB0aGUgc2VydmVyIGFzIEpTT04uXG4gKlxuICogQHBhcmFtIGJ1ZmZlciBWYWx1ZSB0byBlbmNvZGUgdG8gYmFzZTY0XG4gKiBAcGFyYW0gdG8gKG9wdGlvbmFsKSBUaGUgZW5jb2RpbmcgdG8gdXNlLCBpbiBjYXNlIGl0J3MgZGVzaXJhYmxlIHRvIGVuY29kZSB0byBiYXNlNjQgaW5zdGVhZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbUJ1ZmZlcihidWZmZXIsIHRvID0gJ2Jhc2U2NHVybCcpIHtcbiAgICByZXR1cm4gYmFzZTY0LmZyb21BcnJheUJ1ZmZlcihidWZmZXIsIHRvID09PSAnYmFzZTY0dXJsJyk7XG59XG4vKipcbiAqIENvbnZlcnQgYSBiYXNlNjR1cmwgc3RyaW5nIGludG8gYmFzZTY0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b0Jhc2U2NChiYXNlNjR1cmxTdHJpbmcpIHtcbiAgICBjb25zdCBmcm9tQmFzZTY0VXJsID0gYmFzZTY0LnRvQXJyYXlCdWZmZXIoYmFzZTY0dXJsU3RyaW5nLCB0cnVlKTtcbiAgICBjb25zdCB0b0Jhc2U2NCA9IGJhc2U2NC5mcm9tQXJyYXlCdWZmZXIoZnJvbUJhc2U2NFVybCk7XG4gICAgcmV0dXJuIHRvQmFzZTY0O1xufVxuLyoqXG4gKiBFbmNvZGUgYSBVVEYtOCBzdHJpbmcgdG8gYmFzZTY0dXJsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tVVRGOFN0cmluZyh1dGY4U3RyaW5nKSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tU3RyaW5nKHV0ZjhTdHJpbmcsIHRydWUpO1xufVxuLyoqXG4gKiBEZWNvZGUgYSBiYXNlNjR1cmwgc3RyaW5nIGludG8gaXRzIG9yaWdpbmFsIFVURi04IHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gdG9VVEY4U3RyaW5nKGJhc2U2NHVybFN0cmluZykge1xuICAgIHJldHVybiBiYXNlNjQudG9TdHJpbmcoYmFzZTY0dXJsU3RyaW5nLCB0cnVlKTtcbn1cbi8qKlxuICogQ29uZmlybSB0aGF0IHRoZSBzdHJpbmcgaXMgZW5jb2RlZCBpbnRvIGJhc2U2NFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNCYXNlNjQoaW5wdXQpIHtcbiAgICByZXR1cm4gYmFzZTY0LnZhbGlkYXRlKGlucHV0LCBmYWxzZSk7XG59XG4vKipcbiAqIENvbmZpcm0gdGhhdCB0aGUgc3RyaW5nIGlzIGVuY29kZWQgaW50byBiYXNlNjR1cmwsIHdpdGggc3VwcG9ydCBmb3Igb3B0aW9uYWwgcGFkZGluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNCYXNlNjRVUkwoaW5wdXQpIHtcbiAgICAvLyBUcmltIHBhZGRpbmcgY2hhcmFjdGVycyBmcm9tIHRoZSBzdHJpbmcgaWYgcHJlc2VudFxuICAgIGlucHV0ID0gdHJpbVBhZGRpbmcoaW5wdXQpO1xuICAgIHJldHVybiBiYXNlNjQudmFsaWRhdGUoaW5wdXQsIHRydWUpO1xufVxuLyoqXG4gKiBSZW1vdmUgb3B0aW9uYWwgcGFkZGluZyBmcm9tIGEgYmFzZTY0dXJsLWVuY29kZWQgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0cmltUGFkZGluZyhpbnB1dCkge1xuICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKC89L2csICcnKTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoBase64URL.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCBOR.js":
/*!************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCBOR.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decodeFirst: () => (/* binding */ decodeFirst),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n\n/**\n * Whatever CBOR encoder is used should keep CBOR data the same length when data is re-encoded\n *\n * MOST CRITICALLY, this means the following needs to be true of whatever CBOR library we use:\n * - CBOR Map type values MUST decode to JavaScript Maps\n * - CBOR tag 64 (uint8 Typed Array) MUST NOT be used when encoding Uint8Arrays back to CBOR\n *\n * So long as these requirements are maintained, then CBOR sequences can be encoded and decoded\n * freely while maintaining their lengths for the most accurate pointer movement across them.\n */\n/**\n * Decode and return the first item in a sequence of CBOR-encoded values\n *\n * @param input The CBOR data to decode\n * @param asObject (optional) Whether to convert any CBOR Maps into JavaScript Objects. Defaults to\n * `false`\n */\nfunction decodeFirst(input) {\n    // Make a copy so we don't mutate the original\n    const _input = new Uint8Array(input);\n    const decoded = _deps_js__WEBPACK_IMPORTED_MODULE_0__.tinyCbor.decodePartialCBOR(_input, 0);\n    const [first] = decoded;\n    return first;\n}\n/**\n * Encode data to CBOR\n */\nfunction encode(input) {\n    return _deps_js__WEBPACK_IMPORTED_MODULE_0__.tinyCbor.encodeCBOR(input);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ0JPUi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLG9CQUFvQixnRUFBMEI7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxXQUFXLHlEQUFtQjtBQUM5QiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGlzb1xcaXNvQ0JPUi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0aW55Q2JvciB9IGZyb20gJy4uLy4uL2RlcHMuanMnO1xuLyoqXG4gKiBXaGF0ZXZlciBDQk9SIGVuY29kZXIgaXMgdXNlZCBzaG91bGQga2VlcCBDQk9SIGRhdGEgdGhlIHNhbWUgbGVuZ3RoIHdoZW4gZGF0YSBpcyByZS1lbmNvZGVkXG4gKlxuICogTU9TVCBDUklUSUNBTExZLCB0aGlzIG1lYW5zIHRoZSBmb2xsb3dpbmcgbmVlZHMgdG8gYmUgdHJ1ZSBvZiB3aGF0ZXZlciBDQk9SIGxpYnJhcnkgd2UgdXNlOlxuICogLSBDQk9SIE1hcCB0eXBlIHZhbHVlcyBNVVNUIGRlY29kZSB0byBKYXZhU2NyaXB0IE1hcHNcbiAqIC0gQ0JPUiB0YWcgNjQgKHVpbnQ4IFR5cGVkIEFycmF5KSBNVVNUIE5PVCBiZSB1c2VkIHdoZW4gZW5jb2RpbmcgVWludDhBcnJheXMgYmFjayB0byBDQk9SXG4gKlxuICogU28gbG9uZyBhcyB0aGVzZSByZXF1aXJlbWVudHMgYXJlIG1haW50YWluZWQsIHRoZW4gQ0JPUiBzZXF1ZW5jZXMgY2FuIGJlIGVuY29kZWQgYW5kIGRlY29kZWRcbiAqIGZyZWVseSB3aGlsZSBtYWludGFpbmluZyB0aGVpciBsZW5ndGhzIGZvciB0aGUgbW9zdCBhY2N1cmF0ZSBwb2ludGVyIG1vdmVtZW50IGFjcm9zcyB0aGVtLlxuICovXG4vKipcbiAqIERlY29kZSBhbmQgcmV0dXJuIHRoZSBmaXJzdCBpdGVtIGluIGEgc2VxdWVuY2Ugb2YgQ0JPUi1lbmNvZGVkIHZhbHVlc1xuICpcbiAqIEBwYXJhbSBpbnB1dCBUaGUgQ0JPUiBkYXRhIHRvIGRlY29kZVxuICogQHBhcmFtIGFzT2JqZWN0IChvcHRpb25hbCkgV2hldGhlciB0byBjb252ZXJ0IGFueSBDQk9SIE1hcHMgaW50byBKYXZhU2NyaXB0IE9iamVjdHMuIERlZmF1bHRzIHRvXG4gKiBgZmFsc2VgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGVGaXJzdChpbnB1dCkge1xuICAgIC8vIE1ha2UgYSBjb3B5IHNvIHdlIGRvbid0IG11dGF0ZSB0aGUgb3JpZ2luYWxcbiAgICBjb25zdCBfaW5wdXQgPSBuZXcgVWludDhBcnJheShpbnB1dCk7XG4gICAgY29uc3QgZGVjb2RlZCA9IHRpbnlDYm9yLmRlY29kZVBhcnRpYWxDQk9SKF9pbnB1dCwgMCk7XG4gICAgY29uc3QgW2ZpcnN0XSA9IGRlY29kZWQ7XG4gICAgcmV0dXJuIGZpcnN0O1xufVxuLyoqXG4gKiBFbmNvZGUgZGF0YSB0byBDQk9SXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbmNvZGUoaW5wdXQpIHtcbiAgICByZXR1cm4gdGlueUNib3IuZW5jb2RlQ0JPUihpbnB1dCk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCBOR.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/digest.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/digest.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   digest: () => (/* binding */ digest)\n/* harmony export */ });\n/* harmony import */ var _mapCoseAlgToWebCryptoAlg_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mapCoseAlgToWebCryptoAlg.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoAlg.js\");\n/* harmony import */ var _getWebCrypto_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./getWebCrypto.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js\");\n\n\n/**\n * Generate a digest of the provided data.\n *\n * @param data The data to generate a digest of\n * @param algorithm A COSE algorithm ID that maps to a desired SHA algorithm\n */\nasync function digest(data, algorithm) {\n    const WebCrypto = await (0,_getWebCrypto_js__WEBPACK_IMPORTED_MODULE_1__.getWebCrypto)();\n    const subtleAlgorithm = (0,_mapCoseAlgToWebCryptoAlg_js__WEBPACK_IMPORTED_MODULE_0__.mapCoseAlgToWebCryptoAlg)(algorithm);\n    const hashed = await WebCrypto.subtle.digest(subtleAlgorithm, data);\n    return new Uint8Array(hashed);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL2RpZ2VzdC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBeUU7QUFDeEI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCw0QkFBNEIsOERBQVk7QUFDeEMsNEJBQTRCLHNGQUF3QjtBQUNwRDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxpc29cXGlzb0NyeXB0b1xcZGlnZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1hcENvc2VBbGdUb1dlYkNyeXB0b0FsZyB9IGZyb20gJy4vbWFwQ29zZUFsZ1RvV2ViQ3J5cHRvQWxnLmpzJztcbmltcG9ydCB7IGdldFdlYkNyeXB0byB9IGZyb20gJy4vZ2V0V2ViQ3J5cHRvLmpzJztcbi8qKlxuICogR2VuZXJhdGUgYSBkaWdlc3Qgb2YgdGhlIHByb3ZpZGVkIGRhdGEuXG4gKlxuICogQHBhcmFtIGRhdGEgVGhlIGRhdGEgdG8gZ2VuZXJhdGUgYSBkaWdlc3Qgb2ZcbiAqIEBwYXJhbSBhbGdvcml0aG0gQSBDT1NFIGFsZ29yaXRobSBJRCB0aGF0IG1hcHMgdG8gYSBkZXNpcmVkIFNIQSBhbGdvcml0aG1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRpZ2VzdChkYXRhLCBhbGdvcml0aG0pIHtcbiAgICBjb25zdCBXZWJDcnlwdG8gPSBhd2FpdCBnZXRXZWJDcnlwdG8oKTtcbiAgICBjb25zdCBzdWJ0bGVBbGdvcml0aG0gPSBtYXBDb3NlQWxnVG9XZWJDcnlwdG9BbGcoYWxnb3JpdGhtKTtcbiAgICBjb25zdCBoYXNoZWQgPSBhd2FpdCBXZWJDcnlwdG8uc3VidGxlLmRpZ2VzdChzdWJ0bGVBbGdvcml0aG0sIGRhdGEpO1xuICAgIHJldHVybiBuZXcgVWludDhBcnJheShoYXNoZWQpO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/digest.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getRandomValues.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getRandomValues.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getRandomValues: () => (/* binding */ getRandomValues)\n/* harmony export */ });\n/* harmony import */ var _getWebCrypto_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getWebCrypto.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js\");\n\n/**\n * Fill up the provided bytes array with random bytes equal to its length.\n *\n * @returns the same bytes array passed into the method\n */\nasync function getRandomValues(array) {\n    const WebCrypto = await (0,_getWebCrypto_js__WEBPACK_IMPORTED_MODULE_0__.getWebCrypto)();\n    WebCrypto.getRandomValues(array);\n    return array;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL2dldFJhbmRvbVZhbHVlcy5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFpRDtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCw0QkFBNEIsOERBQVk7QUFDeEM7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcaXNvXFxpc29DcnlwdG9cXGdldFJhbmRvbVZhbHVlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRXZWJDcnlwdG8gfSBmcm9tICcuL2dldFdlYkNyeXB0by5qcyc7XG4vKipcbiAqIEZpbGwgdXAgdGhlIHByb3ZpZGVkIGJ5dGVzIGFycmF5IHdpdGggcmFuZG9tIGJ5dGVzIGVxdWFsIHRvIGl0cyBsZW5ndGguXG4gKlxuICogQHJldHVybnMgdGhlIHNhbWUgYnl0ZXMgYXJyYXkgcGFzc2VkIGludG8gdGhlIG1ldGhvZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmFuZG9tVmFsdWVzKGFycmF5KSB7XG4gICAgY29uc3QgV2ViQ3J5cHRvID0gYXdhaXQgZ2V0V2ViQ3J5cHRvKCk7XG4gICAgV2ViQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyhhcnJheSk7XG4gICAgcmV0dXJuIGFycmF5O1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getRandomValues.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MissingWebCrypto: () => (/* binding */ MissingWebCrypto),\n/* harmony export */   _getWebCryptoInternals: () => (/* binding */ _getWebCryptoInternals),\n/* harmony export */   getWebCrypto: () => (/* binding */ getWebCrypto)\n/* harmony export */ });\nlet webCrypto = undefined;\n/**\n * Try to get an instance of the Crypto API from the current runtime. Should support Node,\n * as well as others, like Deno, that implement Web APIs.\n */\nfunction getWebCrypto() {\n    /**\n     * Hello there! If you came here wondering why this method is asynchronous when use of\n     * `globalThis.crypto` is not, it's to minimize a bunch of refactor related to making this\n     * synchronous. For example, `generateRegistrationOptions()` and `generateAuthenticationOptions()`\n     * become synchronous if we make this synchronous (since nothing else in that method is async)\n     * which represents a breaking API change in this library's core API.\n     *\n     * TODO: If it's after February 2025 when you read this then consider whether it still makes sense\n     * to keep this method asynchronous.\n     */\n    const toResolve = new Promise((resolve, reject) => {\n        if (webCrypto) {\n            return resolve(webCrypto);\n        }\n        /**\n         * Naively attempt to access Crypto as a global object, which popular ESM-centric run-times\n         * support (and Node v20+)\n         */\n        const _globalThisCrypto = _getWebCryptoInternals.stubThisGlobalThisCrypto();\n        if (_globalThisCrypto) {\n            webCrypto = _globalThisCrypto;\n            return resolve(webCrypto);\n        }\n        // We tried to access it both in Node and globally, so bail out\n        return reject(new MissingWebCrypto());\n    });\n    return toResolve;\n}\nclass MissingWebCrypto extends Error {\n    constructor() {\n        const message = 'An instance of the Crypto API could not be located';\n        super(message);\n        this.name = 'MissingWebCrypto';\n    }\n}\n// Make it possible to stub return values during testing\nconst _getWebCryptoInternals = {\n    stubThisGlobalThisCrypto: () => globalThis.crypto,\n    // Make it possible to reset the `webCrypto` at the top of the file\n    setCachedCrypto: (newCrypto) => {\n        webCrypto = newCrypto;\n    },\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL2dldFdlYkNyeXB0by5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxpc29cXGlzb0NyeXB0b1xcZ2V0V2ViQ3J5cHRvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImxldCB3ZWJDcnlwdG8gPSB1bmRlZmluZWQ7XG4vKipcbiAqIFRyeSB0byBnZXQgYW4gaW5zdGFuY2Ugb2YgdGhlIENyeXB0byBBUEkgZnJvbSB0aGUgY3VycmVudCBydW50aW1lLiBTaG91bGQgc3VwcG9ydCBOb2RlLFxuICogYXMgd2VsbCBhcyBvdGhlcnMsIGxpa2UgRGVubywgdGhhdCBpbXBsZW1lbnQgV2ViIEFQSXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRXZWJDcnlwdG8oKSB7XG4gICAgLyoqXG4gICAgICogSGVsbG8gdGhlcmUhIElmIHlvdSBjYW1lIGhlcmUgd29uZGVyaW5nIHdoeSB0aGlzIG1ldGhvZCBpcyBhc3luY2hyb25vdXMgd2hlbiB1c2Ugb2ZcbiAgICAgKiBgZ2xvYmFsVGhpcy5jcnlwdG9gIGlzIG5vdCwgaXQncyB0byBtaW5pbWl6ZSBhIGJ1bmNoIG9mIHJlZmFjdG9yIHJlbGF0ZWQgdG8gbWFraW5nIHRoaXNcbiAgICAgKiBzeW5jaHJvbm91cy4gRm9yIGV4YW1wbGUsIGBnZW5lcmF0ZVJlZ2lzdHJhdGlvbk9wdGlvbnMoKWAgYW5kIGBnZW5lcmF0ZUF1dGhlbnRpY2F0aW9uT3B0aW9ucygpYFxuICAgICAqIGJlY29tZSBzeW5jaHJvbm91cyBpZiB3ZSBtYWtlIHRoaXMgc3luY2hyb25vdXMgKHNpbmNlIG5vdGhpbmcgZWxzZSBpbiB0aGF0IG1ldGhvZCBpcyBhc3luYylcbiAgICAgKiB3aGljaCByZXByZXNlbnRzIGEgYnJlYWtpbmcgQVBJIGNoYW5nZSBpbiB0aGlzIGxpYnJhcnkncyBjb3JlIEFQSS5cbiAgICAgKlxuICAgICAqIFRPRE86IElmIGl0J3MgYWZ0ZXIgRmVicnVhcnkgMjAyNSB3aGVuIHlvdSByZWFkIHRoaXMgdGhlbiBjb25zaWRlciB3aGV0aGVyIGl0IHN0aWxsIG1ha2VzIHNlbnNlXG4gICAgICogdG8ga2VlcCB0aGlzIG1ldGhvZCBhc3luY2hyb25vdXMuXG4gICAgICovXG4gICAgY29uc3QgdG9SZXNvbHZlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBpZiAod2ViQ3J5cHRvKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh3ZWJDcnlwdG8pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBOYWl2ZWx5IGF0dGVtcHQgdG8gYWNjZXNzIENyeXB0byBhcyBhIGdsb2JhbCBvYmplY3QsIHdoaWNoIHBvcHVsYXIgRVNNLWNlbnRyaWMgcnVuLXRpbWVzXG4gICAgICAgICAqIHN1cHBvcnQgKGFuZCBOb2RlIHYyMCspXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdCBfZ2xvYmFsVGhpc0NyeXB0byA9IF9nZXRXZWJDcnlwdG9JbnRlcm5hbHMuc3R1YlRoaXNHbG9iYWxUaGlzQ3J5cHRvKCk7XG4gICAgICAgIGlmIChfZ2xvYmFsVGhpc0NyeXB0bykge1xuICAgICAgICAgICAgd2ViQ3J5cHRvID0gX2dsb2JhbFRoaXNDcnlwdG87XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh3ZWJDcnlwdG8pO1xuICAgICAgICB9XG4gICAgICAgIC8vIFdlIHRyaWVkIHRvIGFjY2VzcyBpdCBib3RoIGluIE5vZGUgYW5kIGdsb2JhbGx5LCBzbyBiYWlsIG91dFxuICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBNaXNzaW5nV2ViQ3J5cHRvKCkpO1xuICAgIH0pO1xuICAgIHJldHVybiB0b1Jlc29sdmU7XG59XG5leHBvcnQgY2xhc3MgTWlzc2luZ1dlYkNyeXB0byBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9ICdBbiBpbnN0YW5jZSBvZiB0aGUgQ3J5cHRvIEFQSSBjb3VsZCBub3QgYmUgbG9jYXRlZCc7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLm5hbWUgPSAnTWlzc2luZ1dlYkNyeXB0byc7XG4gICAgfVxufVxuLy8gTWFrZSBpdCBwb3NzaWJsZSB0byBzdHViIHJldHVybiB2YWx1ZXMgZHVyaW5nIHRlc3RpbmdcbmV4cG9ydCBjb25zdCBfZ2V0V2ViQ3J5cHRvSW50ZXJuYWxzID0ge1xuICAgIHN0dWJUaGlzR2xvYmFsVGhpc0NyeXB0bzogKCkgPT4gZ2xvYmFsVGhpcy5jcnlwdG8sXG4gICAgLy8gTWFrZSBpdCBwb3NzaWJsZSB0byByZXNldCB0aGUgYHdlYkNyeXB0b2AgYXQgdGhlIHRvcCBvZiB0aGUgZmlsZVxuICAgIHNldENhY2hlZENyeXB0bzogKG5ld0NyeXB0bykgPT4ge1xuICAgICAgICB3ZWJDcnlwdG8gPSBuZXdDcnlwdG87XG4gICAgfSxcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/importKey.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/importKey.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   importKey: () => (/* binding */ importKey)\n/* harmony export */ });\n/* harmony import */ var _getWebCrypto_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getWebCrypto.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js\");\n\nasync function importKey(opts) {\n    const WebCrypto = await (0,_getWebCrypto_js__WEBPACK_IMPORTED_MODULE_0__.getWebCrypto)();\n    const { keyData, algorithm } = opts;\n    return WebCrypto.subtle.importKey('jwk', keyData, algorithm, false, [\n        'verify',\n    ]);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL2ltcG9ydEtleS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFpRDtBQUMxQztBQUNQLDRCQUE0Qiw4REFBWTtBQUN4QyxZQUFZLHFCQUFxQjtBQUNqQztBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGlzb1xcaXNvQ3J5cHRvXFxpbXBvcnRLZXkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0V2ViQ3J5cHRvIH0gZnJvbSAnLi9nZXRXZWJDcnlwdG8uanMnO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGltcG9ydEtleShvcHRzKSB7XG4gICAgY29uc3QgV2ViQ3J5cHRvID0gYXdhaXQgZ2V0V2ViQ3J5cHRvKCk7XG4gICAgY29uc3QgeyBrZXlEYXRhLCBhbGdvcml0aG0gfSA9IG9wdHM7XG4gICAgcmV0dXJuIFdlYkNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KCdqd2snLCBrZXlEYXRhLCBhbGdvcml0aG0sIGZhbHNlLCBbXG4gICAgICAgICd2ZXJpZnknLFxuICAgIF0pO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/importKey.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/index.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/index.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   digest: () => (/* reexport safe */ _digest_js__WEBPACK_IMPORTED_MODULE_0__.digest),\n/* harmony export */   getRandomValues: () => (/* reexport safe */ _getRandomValues_js__WEBPACK_IMPORTED_MODULE_1__.getRandomValues),\n/* harmony export */   verify: () => (/* reexport safe */ _verify_js__WEBPACK_IMPORTED_MODULE_2__.verify)\n/* harmony export */ });\n/* harmony import */ var _digest_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./digest.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/digest.js\");\n/* harmony import */ var _getRandomValues_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./getRandomValues.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getRandomValues.js\");\n/* harmony import */ var _verify_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./verify.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verify.js\");\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFxQztBQUNrQjtBQUNsQiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGlzb1xcaXNvQ3J5cHRvXFxpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyBkaWdlc3QgfSBmcm9tICcuL2RpZ2VzdC5qcyc7XG5leHBvcnQgeyBnZXRSYW5kb21WYWx1ZXMgfSBmcm9tICcuL2dldFJhbmRvbVZhbHVlcy5qcyc7XG5leHBvcnQgeyB2ZXJpZnkgfSBmcm9tICcuL3ZlcmlmeS5qcyc7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoAlg.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoAlg.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   mapCoseAlgToWebCryptoAlg: () => (/* binding */ mapCoseAlgToWebCryptoAlg)\n/* harmony export */ });\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n\n/**\n * Convert a COSE alg ID into a corresponding string value that WebCrypto APIs expect\n */\nfunction mapCoseAlgToWebCryptoAlg(alg) {\n    if ([_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS1].indexOf(alg) >= 0) {\n        return 'SHA-1';\n    }\n    else if ([_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES256, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.PS256, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS256].indexOf(alg) >= 0) {\n        return 'SHA-256';\n    }\n    else if ([_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES384, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.PS384, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS384].indexOf(alg) >= 0) {\n        return 'SHA-384';\n    }\n    else if ([_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES512, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.PS512, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS512, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.EdDSA].indexOf(alg) >=\n        0) {\n        return 'SHA-512';\n    }\n    throw new Error(`Could not map COSE alg value of ${alg} to a WebCrypto alg`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL21hcENvc2VBbGdUb1dlYkNyeXB0b0FsZy5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDTztBQUNQLFNBQVMsNkNBQU87QUFDaEI7QUFDQTtBQUNBLGNBQWMsNkNBQU8sUUFBUSw2Q0FBTyxRQUFRLDZDQUFPO0FBQ25EO0FBQ0E7QUFDQSxjQUFjLDZDQUFPLFFBQVEsNkNBQU8sUUFBUSw2Q0FBTztBQUNuRDtBQUNBO0FBQ0EsY0FBYyw2Q0FBTyxRQUFRLDZDQUFPLFFBQVEsNkNBQU8sUUFBUSw2Q0FBTztBQUNsRTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsS0FBSztBQUM1RCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGlzb1xcaXNvQ3J5cHRvXFxtYXBDb3NlQWxnVG9XZWJDcnlwdG9BbGcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ09TRUFMRyB9IGZyb20gJy4uLy4uL2Nvc2UuanMnO1xuLyoqXG4gKiBDb252ZXJ0IGEgQ09TRSBhbGcgSUQgaW50byBhIGNvcnJlc3BvbmRpbmcgc3RyaW5nIHZhbHVlIHRoYXQgV2ViQ3J5cHRvIEFQSXMgZXhwZWN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXBDb3NlQWxnVG9XZWJDcnlwdG9BbGcoYWxnKSB7XG4gICAgaWYgKFtDT1NFQUxHLlJTMV0uaW5kZXhPZihhbGcpID49IDApIHtcbiAgICAgICAgcmV0dXJuICdTSEEtMSc7XG4gICAgfVxuICAgIGVsc2UgaWYgKFtDT1NFQUxHLkVTMjU2LCBDT1NFQUxHLlBTMjU2LCBDT1NFQUxHLlJTMjU2XS5pbmRleE9mKGFsZykgPj0gMCkge1xuICAgICAgICByZXR1cm4gJ1NIQS0yNTYnO1xuICAgIH1cbiAgICBlbHNlIGlmIChbQ09TRUFMRy5FUzM4NCwgQ09TRUFMRy5QUzM4NCwgQ09TRUFMRy5SUzM4NF0uaW5kZXhPZihhbGcpID49IDApIHtcbiAgICAgICAgcmV0dXJuICdTSEEtMzg0JztcbiAgICB9XG4gICAgZWxzZSBpZiAoW0NPU0VBTEcuRVM1MTIsIENPU0VBTEcuUFM1MTIsIENPU0VBTEcuUlM1MTIsIENPU0VBTEcuRWREU0FdLmluZGV4T2YoYWxnKSA+PVxuICAgICAgICAwKSB7XG4gICAgICAgIHJldHVybiAnU0hBLTUxMic7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IG1hcCBDT1NFIGFsZyB2YWx1ZSBvZiAke2FsZ30gdG8gYSBXZWJDcnlwdG8gYWxnYCk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoAlg.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoKeyAlgName.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoKeyAlgName.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   mapCoseAlgToWebCryptoKeyAlgName: () => (/* binding */ mapCoseAlgToWebCryptoKeyAlgName)\n/* harmony export */ });\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n\n/**\n * Convert a COSE alg ID into a corresponding key algorithm string value that WebCrypto APIs expect\n */\nfunction mapCoseAlgToWebCryptoKeyAlgName(alg) {\n    if ([_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.EdDSA].indexOf(alg) >= 0) {\n        return 'Ed25519';\n    }\n    else if ([_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES256, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES384, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES512, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES256K].indexOf(alg) >= 0) {\n        return 'ECDSA';\n    }\n    else if ([_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS256, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS384, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS512, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS1].indexOf(alg) >= 0) {\n        return 'RSASSA-PKCS1-v1_5';\n    }\n    else if ([_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.PS256, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.PS384, _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.PS512].indexOf(alg) >= 0) {\n        return 'RSA-PSS';\n    }\n    throw new Error(`Could not map COSE alg value of ${alg} to a WebCrypto key alg name`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL21hcENvc2VBbGdUb1dlYkNyeXB0b0tleUFsZ05hbWUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ087QUFDUCxTQUFTLDZDQUFPO0FBQ2hCO0FBQ0E7QUFDQSxjQUFjLDZDQUFPLFFBQVEsNkNBQU8sUUFBUSw2Q0FBTyxRQUFRLDZDQUFPO0FBQ2xFO0FBQ0E7QUFDQSxjQUFjLDZDQUFPLFFBQVEsNkNBQU8sUUFBUSw2Q0FBTyxRQUFRLDZDQUFPO0FBQ2xFO0FBQ0E7QUFDQSxjQUFjLDZDQUFPLFFBQVEsNkNBQU8sUUFBUSw2Q0FBTztBQUNuRDtBQUNBO0FBQ0EsdURBQXVELEtBQUs7QUFDNUQiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxpc29cXGlzb0NyeXB0b1xcbWFwQ29zZUFsZ1RvV2ViQ3J5cHRvS2V5QWxnTmFtZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDT1NFQUxHIH0gZnJvbSAnLi4vLi4vY29zZS5qcyc7XG4vKipcbiAqIENvbnZlcnQgYSBDT1NFIGFsZyBJRCBpbnRvIGEgY29ycmVzcG9uZGluZyBrZXkgYWxnb3JpdGhtIHN0cmluZyB2YWx1ZSB0aGF0IFdlYkNyeXB0byBBUElzIGV4cGVjdFxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFwQ29zZUFsZ1RvV2ViQ3J5cHRvS2V5QWxnTmFtZShhbGcpIHtcbiAgICBpZiAoW0NPU0VBTEcuRWREU0FdLmluZGV4T2YoYWxnKSA+PSAwKSB7XG4gICAgICAgIHJldHVybiAnRWQyNTUxOSc7XG4gICAgfVxuICAgIGVsc2UgaWYgKFtDT1NFQUxHLkVTMjU2LCBDT1NFQUxHLkVTMzg0LCBDT1NFQUxHLkVTNTEyLCBDT1NFQUxHLkVTMjU2S10uaW5kZXhPZihhbGcpID49IDApIHtcbiAgICAgICAgcmV0dXJuICdFQ0RTQSc7XG4gICAgfVxuICAgIGVsc2UgaWYgKFtDT1NFQUxHLlJTMjU2LCBDT1NFQUxHLlJTMzg0LCBDT1NFQUxHLlJTNTEyLCBDT1NFQUxHLlJTMV0uaW5kZXhPZihhbGcpID49IDApIHtcbiAgICAgICAgcmV0dXJuICdSU0FTU0EtUEtDUzEtdjFfNSc7XG4gICAgfVxuICAgIGVsc2UgaWYgKFtDT1NFQUxHLlBTMjU2LCBDT1NFQUxHLlBTMzg0LCBDT1NFQUxHLlBTNTEyXS5pbmRleE9mKGFsZykgPj0gMCkge1xuICAgICAgICByZXR1cm4gJ1JTQS1QU1MnO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBtYXAgQ09TRSBhbGcgdmFsdWUgb2YgJHthbGd9IHRvIGEgV2ViQ3J5cHRvIGtleSBhbGcgbmFtZWApO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoKeyAlgName.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/unwrapEC2Signature.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/unwrapEC2Signature.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   unwrapEC2Signature: () => (/* binding */ unwrapEC2Signature)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n/* harmony import */ var _index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n\n/**\n * In WebAuthn, EC2 signatures are wrapped in ASN.1 structure so we need to peel r and s apart.\n *\n * See https://www.w3.org/TR/webauthn-2/#sctn-signature-attestation-types\n */\nfunction unwrapEC2Signature(signature) {\n    const parsedSignature = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(signature, _deps_js__WEBPACK_IMPORTED_MODULE_0__.ECDSASigValue);\n    let rBytes = new Uint8Array(parsedSignature.r);\n    let sBytes = new Uint8Array(parsedSignature.s);\n    if (shouldRemoveLeadingZero(rBytes)) {\n        rBytes = rBytes.slice(1);\n    }\n    if (shouldRemoveLeadingZero(sBytes)) {\n        sBytes = sBytes.slice(1);\n    }\n    const finalSignature = _index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.concat([rBytes, sBytes]);\n    return finalSignature;\n}\n/**\n * Determine if the DER-specific `00` byte at the start of an ECDSA signature byte sequence\n * should be removed based on the following logic:\n *\n * \"If the leading byte is 0x0, and the the high order bit on the second byte is not set to 0,\n * then remove the leading 0x0 byte\"\n */\nfunction shouldRemoveLeadingZero(bytes) {\n    return bytes[0] === 0x0 && (bytes[1] & (1 << 7)) !== 0;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL3Vud3JhcEVDMlNpZ25hdHVyZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNEQ7QUFDaEI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsNEJBQTRCLCtDQUFTLGtCQUFrQixtREFBYTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDJEQUFvQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxpc29cXGlzb0NyeXB0b1xcdW53cmFwRUMyU2lnbmF0dXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzblBhcnNlciwgRUNEU0FTaWdWYWx1ZSB9IGZyb20gJy4uLy4uLy4uL2RlcHMuanMnO1xuaW1wb3J0IHsgaXNvVWludDhBcnJheSB9IGZyb20gJy4uL2luZGV4LmpzJztcbi8qKlxuICogSW4gV2ViQXV0aG4sIEVDMiBzaWduYXR1cmVzIGFyZSB3cmFwcGVkIGluIEFTTi4xIHN0cnVjdHVyZSBzbyB3ZSBuZWVkIHRvIHBlZWwgciBhbmQgcyBhcGFydC5cbiAqXG4gKiBTZWUgaHR0cHM6Ly93d3cudzMub3JnL1RSL3dlYmF1dGhuLTIvI3NjdG4tc2lnbmF0dXJlLWF0dGVzdGF0aW9uLXR5cGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bndyYXBFQzJTaWduYXR1cmUoc2lnbmF0dXJlKSB7XG4gICAgY29uc3QgcGFyc2VkU2lnbmF0dXJlID0gQXNuUGFyc2VyLnBhcnNlKHNpZ25hdHVyZSwgRUNEU0FTaWdWYWx1ZSk7XG4gICAgbGV0IHJCeXRlcyA9IG5ldyBVaW50OEFycmF5KHBhcnNlZFNpZ25hdHVyZS5yKTtcbiAgICBsZXQgc0J5dGVzID0gbmV3IFVpbnQ4QXJyYXkocGFyc2VkU2lnbmF0dXJlLnMpO1xuICAgIGlmIChzaG91bGRSZW1vdmVMZWFkaW5nWmVybyhyQnl0ZXMpKSB7XG4gICAgICAgIHJCeXRlcyA9IHJCeXRlcy5zbGljZSgxKTtcbiAgICB9XG4gICAgaWYgKHNob3VsZFJlbW92ZUxlYWRpbmdaZXJvKHNCeXRlcykpIHtcbiAgICAgICAgc0J5dGVzID0gc0J5dGVzLnNsaWNlKDEpO1xuICAgIH1cbiAgICBjb25zdCBmaW5hbFNpZ25hdHVyZSA9IGlzb1VpbnQ4QXJyYXkuY29uY2F0KFtyQnl0ZXMsIHNCeXRlc10pO1xuICAgIHJldHVybiBmaW5hbFNpZ25hdHVyZTtcbn1cbi8qKlxuICogRGV0ZXJtaW5lIGlmIHRoZSBERVItc3BlY2lmaWMgYDAwYCBieXRlIGF0IHRoZSBzdGFydCBvZiBhbiBFQ0RTQSBzaWduYXR1cmUgYnl0ZSBzZXF1ZW5jZVxuICogc2hvdWxkIGJlIHJlbW92ZWQgYmFzZWQgb24gdGhlIGZvbGxvd2luZyBsb2dpYzpcbiAqXG4gKiBcIklmIHRoZSBsZWFkaW5nIGJ5dGUgaXMgMHgwLCBhbmQgdGhlIHRoZSBoaWdoIG9yZGVyIGJpdCBvbiB0aGUgc2Vjb25kIGJ5dGUgaXMgbm90IHNldCB0byAwLFxuICogdGhlbiByZW1vdmUgdGhlIGxlYWRpbmcgMHgwIGJ5dGVcIlxuICovXG5mdW5jdGlvbiBzaG91bGRSZW1vdmVMZWFkaW5nWmVybyhieXRlcykge1xuICAgIHJldHVybiBieXRlc1swXSA9PT0gMHgwICYmIChieXRlc1sxXSAmICgxIDw8IDcpKSAhPT0gMDtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/unwrapEC2Signature.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verify.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verify.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verify: () => (/* binding */ verify)\n/* harmony export */ });\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _verifyEC2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./verifyEC2.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyEC2.js\");\n/* harmony import */ var _verifyRSA_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./verifyRSA.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyRSA.js\");\n/* harmony import */ var _verifyOKP_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./verifyOKP.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyOKP.js\");\n/* harmony import */ var _unwrapEC2Signature_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./unwrapEC2Signature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/unwrapEC2Signature.js\");\n\n\n\n\n\n/**\n * Verify signatures with their public key. Supports EC2 and RSA public keys.\n */\nfunction verify(opts) {\n    const { cosePublicKey, signature, data, shaHashOverride } = opts;\n    if ((0,_cose_js__WEBPACK_IMPORTED_MODULE_0__.isCOSEPublicKeyEC2)(cosePublicKey)) {\n        const unwrappedSignature = (0,_unwrapEC2Signature_js__WEBPACK_IMPORTED_MODULE_4__.unwrapEC2Signature)(signature);\n        return (0,_verifyEC2_js__WEBPACK_IMPORTED_MODULE_1__.verifyEC2)({\n            cosePublicKey,\n            signature: unwrappedSignature,\n            data,\n            shaHashOverride,\n        });\n    }\n    else if ((0,_cose_js__WEBPACK_IMPORTED_MODULE_0__.isCOSEPublicKeyRSA)(cosePublicKey)) {\n        return (0,_verifyRSA_js__WEBPACK_IMPORTED_MODULE_2__.verifyRSA)({ cosePublicKey, signature, data, shaHashOverride });\n    }\n    else if ((0,_cose_js__WEBPACK_IMPORTED_MODULE_0__.isCOSEPublicKeyOKP)(cosePublicKey)) {\n        return (0,_verifyOKP_js__WEBPACK_IMPORTED_MODULE_3__.verifyOKP)({ cosePublicKey, signature, data });\n    }\n    const kty = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.kty);\n    throw new Error(`Signature verification with public key of kty ${kty} is not supported by this method`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL3ZlcmlmeS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBc0c7QUFDM0Q7QUFDQTtBQUNBO0FBQ2tCO0FBQzdEO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsWUFBWSxrREFBa0Q7QUFDOUQsUUFBUSw0REFBa0I7QUFDMUIsbUNBQW1DLDBFQUFrQjtBQUNyRCxlQUFlLHdEQUFTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsYUFBYSw0REFBa0I7QUFDL0IsZUFBZSx3REFBUyxHQUFHLGlEQUFpRDtBQUM1RTtBQUNBLGFBQWEsNERBQWtCO0FBQy9CLGVBQWUsd0RBQVMsR0FBRyxnQ0FBZ0M7QUFDM0Q7QUFDQSxrQ0FBa0MsOENBQVE7QUFDMUMscUVBQXFFLEtBQUs7QUFDMUUiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxpc29cXGlzb0NyeXB0b1xcdmVyaWZ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENPU0VLRVlTLCBpc0NPU0VQdWJsaWNLZXlFQzIsIGlzQ09TRVB1YmxpY0tleU9LUCwgaXNDT1NFUHVibGljS2V5UlNBLCB9IGZyb20gJy4uLy4uL2Nvc2UuanMnO1xuaW1wb3J0IHsgdmVyaWZ5RUMyIH0gZnJvbSAnLi92ZXJpZnlFQzIuanMnO1xuaW1wb3J0IHsgdmVyaWZ5UlNBIH0gZnJvbSAnLi92ZXJpZnlSU0EuanMnO1xuaW1wb3J0IHsgdmVyaWZ5T0tQIH0gZnJvbSAnLi92ZXJpZnlPS1AuanMnO1xuaW1wb3J0IHsgdW53cmFwRUMyU2lnbmF0dXJlIH0gZnJvbSAnLi91bndyYXBFQzJTaWduYXR1cmUuanMnO1xuLyoqXG4gKiBWZXJpZnkgc2lnbmF0dXJlcyB3aXRoIHRoZWlyIHB1YmxpYyBrZXkuIFN1cHBvcnRzIEVDMiBhbmQgUlNBIHB1YmxpYyBrZXlzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5KG9wdHMpIHtcbiAgICBjb25zdCB7IGNvc2VQdWJsaWNLZXksIHNpZ25hdHVyZSwgZGF0YSwgc2hhSGFzaE92ZXJyaWRlIH0gPSBvcHRzO1xuICAgIGlmIChpc0NPU0VQdWJsaWNLZXlFQzIoY29zZVB1YmxpY0tleSkpIHtcbiAgICAgICAgY29uc3QgdW53cmFwcGVkU2lnbmF0dXJlID0gdW53cmFwRUMyU2lnbmF0dXJlKHNpZ25hdHVyZSk7XG4gICAgICAgIHJldHVybiB2ZXJpZnlFQzIoe1xuICAgICAgICAgICAgY29zZVB1YmxpY0tleSxcbiAgICAgICAgICAgIHNpZ25hdHVyZTogdW53cmFwcGVkU2lnbmF0dXJlLFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgIHNoYUhhc2hPdmVycmlkZSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzQ09TRVB1YmxpY0tleVJTQShjb3NlUHVibGljS2V5KSkge1xuICAgICAgICByZXR1cm4gdmVyaWZ5UlNBKHsgY29zZVB1YmxpY0tleSwgc2lnbmF0dXJlLCBkYXRhLCBzaGFIYXNoT3ZlcnJpZGUgfSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzQ09TRVB1YmxpY0tleU9LUChjb3NlUHVibGljS2V5KSkge1xuICAgICAgICByZXR1cm4gdmVyaWZ5T0tQKHsgY29zZVB1YmxpY0tleSwgc2lnbmF0dXJlLCBkYXRhIH0pO1xuICAgIH1cbiAgICBjb25zdCBrdHkgPSBjb3NlUHVibGljS2V5LmdldChDT1NFS0VZUy5rdHkpO1xuICAgIHRocm93IG5ldyBFcnJvcihgU2lnbmF0dXJlIHZlcmlmaWNhdGlvbiB3aXRoIHB1YmxpYyBrZXkgb2Yga3R5ICR7a3R5fSBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgbWV0aG9kYCk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verify.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyEC2.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyEC2.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyEC2: () => (/* binding */ verifyEC2)\n/* harmony export */ });\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _mapCoseAlgToWebCryptoAlg_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mapCoseAlgToWebCryptoAlg.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoAlg.js\");\n/* harmony import */ var _importKey_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./importKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/importKey.js\");\n/* harmony import */ var _index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _getWebCrypto_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./getWebCrypto.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js\");\n\n\n\n\n\n/**\n * Verify a signature using an EC2 public key\n */\nasync function verifyEC2(opts) {\n    const { cosePublicKey, signature, data, shaHashOverride } = opts;\n    const WebCrypto = await (0,_getWebCrypto_js__WEBPACK_IMPORTED_MODULE_4__.getWebCrypto)();\n    // Import the public key\n    const alg = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.alg);\n    const crv = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.crv);\n    const x = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.x);\n    const y = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.y);\n    if (!alg) {\n        throw new Error('Public key was missing alg (EC2)');\n    }\n    if (!crv) {\n        throw new Error('Public key was missing crv (EC2)');\n    }\n    if (!x) {\n        throw new Error('Public key was missing x (EC2)');\n    }\n    if (!y) {\n        throw new Error('Public key was missing y (EC2)');\n    }\n    let _crv;\n    if (crv === _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSECRV.P256) {\n        _crv = 'P-256';\n    }\n    else if (crv === _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSECRV.P384) {\n        _crv = 'P-384';\n    }\n    else if (crv === _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSECRV.P521) {\n        _crv = 'P-521';\n    }\n    else {\n        throw new Error(`Unexpected COSE crv value of ${crv} (EC2)`);\n    }\n    const keyData = {\n        kty: 'EC',\n        crv: _crv,\n        x: _index_js__WEBPACK_IMPORTED_MODULE_3__.isoBase64URL.fromBuffer(x),\n        y: _index_js__WEBPACK_IMPORTED_MODULE_3__.isoBase64URL.fromBuffer(y),\n        ext: false,\n    };\n    const keyAlgorithm = {\n        /**\n         * Note to future self: you can't use `mapCoseAlgToWebCryptoKeyAlgName()` here because some\n         * leaf certs from actual devices specified an RSA SHA value for `alg` (e.g. `-257`) which\n         * would then map here to `'RSASSA-PKCS1-v1_5'`. We always want `'ECDSA'` here so we'll\n         * hard-code this.\n         */\n        name: 'ECDSA',\n        namedCurve: _crv,\n    };\n    const key = await (0,_importKey_js__WEBPACK_IMPORTED_MODULE_2__.importKey)({\n        keyData,\n        algorithm: keyAlgorithm,\n    });\n    // Determine which SHA algorithm to use for signature verification\n    let subtleAlg = (0,_mapCoseAlgToWebCryptoAlg_js__WEBPACK_IMPORTED_MODULE_1__.mapCoseAlgToWebCryptoAlg)(alg);\n    if (shaHashOverride) {\n        subtleAlg = (0,_mapCoseAlgToWebCryptoAlg_js__WEBPACK_IMPORTED_MODULE_1__.mapCoseAlgToWebCryptoAlg)(shaHashOverride);\n    }\n    const verifyAlgorithm = {\n        name: 'ECDSA',\n        hash: { name: subtleAlg },\n    };\n    return WebCrypto.subtle.verify(verifyAlgorithm, key, signature, data);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL3ZlcmlmeUVDMi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBa0Q7QUFDdUI7QUFDOUI7QUFDQTtBQUNNO0FBQ2pEO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsWUFBWSxrREFBa0Q7QUFDOUQsNEJBQTRCLDhEQUFZO0FBQ3hDO0FBQ0Esa0NBQWtDLDhDQUFRO0FBQzFDLGtDQUFrQyw4Q0FBUTtBQUMxQyxnQ0FBZ0MsOENBQVE7QUFDeEMsZ0NBQWdDLDhDQUFRO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDZDQUFPO0FBQ3ZCO0FBQ0E7QUFDQSxxQkFBcUIsNkNBQU87QUFDNUI7QUFDQTtBQUNBLHFCQUFxQiw2Q0FBTztBQUM1QjtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsS0FBSztBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsOERBQXVCO0FBQ2xDLFdBQVcsOERBQXVCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix3REFBUztBQUMvQjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esb0JBQW9CLHNGQUF3QjtBQUM1QztBQUNBLG9CQUFvQixzRkFBd0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlCQUFpQjtBQUNqQztBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxpc29cXGlzb0NyeXB0b1xcdmVyaWZ5RUMyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENPU0VDUlYsIENPU0VLRVlTIH0gZnJvbSAnLi4vLi4vY29zZS5qcyc7XG5pbXBvcnQgeyBtYXBDb3NlQWxnVG9XZWJDcnlwdG9BbGcgfSBmcm9tICcuL21hcENvc2VBbGdUb1dlYkNyeXB0b0FsZy5qcyc7XG5pbXBvcnQgeyBpbXBvcnRLZXkgfSBmcm9tICcuL2ltcG9ydEtleS5qcyc7XG5pbXBvcnQgeyBpc29CYXNlNjRVUkwgfSBmcm9tICcuLi9pbmRleC5qcyc7XG5pbXBvcnQgeyBnZXRXZWJDcnlwdG8gfSBmcm9tICcuL2dldFdlYkNyeXB0by5qcyc7XG4vKipcbiAqIFZlcmlmeSBhIHNpZ25hdHVyZSB1c2luZyBhbiBFQzIgcHVibGljIGtleVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5RUMyKG9wdHMpIHtcbiAgICBjb25zdCB7IGNvc2VQdWJsaWNLZXksIHNpZ25hdHVyZSwgZGF0YSwgc2hhSGFzaE92ZXJyaWRlIH0gPSBvcHRzO1xuICAgIGNvbnN0IFdlYkNyeXB0byA9IGF3YWl0IGdldFdlYkNyeXB0bygpO1xuICAgIC8vIEltcG9ydCB0aGUgcHVibGljIGtleVxuICAgIGNvbnN0IGFsZyA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLmFsZyk7XG4gICAgY29uc3QgY3J2ID0gY29zZVB1YmxpY0tleS5nZXQoQ09TRUtFWVMuY3J2KTtcbiAgICBjb25zdCB4ID0gY29zZVB1YmxpY0tleS5nZXQoQ09TRUtFWVMueCk7XG4gICAgY29uc3QgeSA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLnkpO1xuICAgIGlmICghYWxnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUHVibGljIGtleSB3YXMgbWlzc2luZyBhbGcgKEVDMiknKTtcbiAgICB9XG4gICAgaWYgKCFjcnYpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQdWJsaWMga2V5IHdhcyBtaXNzaW5nIGNydiAoRUMyKScpO1xuICAgIH1cbiAgICBpZiAoIXgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQdWJsaWMga2V5IHdhcyBtaXNzaW5nIHggKEVDMiknKTtcbiAgICB9XG4gICAgaWYgKCF5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUHVibGljIGtleSB3YXMgbWlzc2luZyB5IChFQzIpJyk7XG4gICAgfVxuICAgIGxldCBfY3J2O1xuICAgIGlmIChjcnYgPT09IENPU0VDUlYuUDI1Nikge1xuICAgICAgICBfY3J2ID0gJ1AtMjU2JztcbiAgICB9XG4gICAgZWxzZSBpZiAoY3J2ID09PSBDT1NFQ1JWLlAzODQpIHtcbiAgICAgICAgX2NydiA9ICdQLTM4NCc7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNydiA9PT0gQ09TRUNSVi5QNTIxKSB7XG4gICAgICAgIF9jcnYgPSAnUC01MjEnO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIENPU0UgY3J2IHZhbHVlIG9mICR7Y3J2fSAoRUMyKWApO1xuICAgIH1cbiAgICBjb25zdCBrZXlEYXRhID0ge1xuICAgICAgICBrdHk6ICdFQycsXG4gICAgICAgIGNydjogX2NydixcbiAgICAgICAgeDogaXNvQmFzZTY0VVJMLmZyb21CdWZmZXIoeCksXG4gICAgICAgIHk6IGlzb0Jhc2U2NFVSTC5mcm9tQnVmZmVyKHkpLFxuICAgICAgICBleHQ6IGZhbHNlLFxuICAgIH07XG4gICAgY29uc3Qga2V5QWxnb3JpdGhtID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogTm90ZSB0byBmdXR1cmUgc2VsZjogeW91IGNhbid0IHVzZSBgbWFwQ29zZUFsZ1RvV2ViQ3J5cHRvS2V5QWxnTmFtZSgpYCBoZXJlIGJlY2F1c2Ugc29tZVxuICAgICAgICAgKiBsZWFmIGNlcnRzIGZyb20gYWN0dWFsIGRldmljZXMgc3BlY2lmaWVkIGFuIFJTQSBTSEEgdmFsdWUgZm9yIGBhbGdgIChlLmcuIGAtMjU3YCkgd2hpY2hcbiAgICAgICAgICogd291bGQgdGhlbiBtYXAgaGVyZSB0byBgJ1JTQVNTQS1QS0NTMS12MV81J2AuIFdlIGFsd2F5cyB3YW50IGAnRUNEU0EnYCBoZXJlIHNvIHdlJ2xsXG4gICAgICAgICAqIGhhcmQtY29kZSB0aGlzLlxuICAgICAgICAgKi9cbiAgICAgICAgbmFtZTogJ0VDRFNBJyxcbiAgICAgICAgbmFtZWRDdXJ2ZTogX2NydixcbiAgICB9O1xuICAgIGNvbnN0IGtleSA9IGF3YWl0IGltcG9ydEtleSh7XG4gICAgICAgIGtleURhdGEsXG4gICAgICAgIGFsZ29yaXRobToga2V5QWxnb3JpdGhtLFxuICAgIH0pO1xuICAgIC8vIERldGVybWluZSB3aGljaCBTSEEgYWxnb3JpdGhtIHRvIHVzZSBmb3Igc2lnbmF0dXJlIHZlcmlmaWNhdGlvblxuICAgIGxldCBzdWJ0bGVBbGcgPSBtYXBDb3NlQWxnVG9XZWJDcnlwdG9BbGcoYWxnKTtcbiAgICBpZiAoc2hhSGFzaE92ZXJyaWRlKSB7XG4gICAgICAgIHN1YnRsZUFsZyA9IG1hcENvc2VBbGdUb1dlYkNyeXB0b0FsZyhzaGFIYXNoT3ZlcnJpZGUpO1xuICAgIH1cbiAgICBjb25zdCB2ZXJpZnlBbGdvcml0aG0gPSB7XG4gICAgICAgIG5hbWU6ICdFQ0RTQScsXG4gICAgICAgIGhhc2g6IHsgbmFtZTogc3VidGxlQWxnIH0sXG4gICAgfTtcbiAgICByZXR1cm4gV2ViQ3J5cHRvLnN1YnRsZS52ZXJpZnkodmVyaWZ5QWxnb3JpdGhtLCBrZXksIHNpZ25hdHVyZSwgZGF0YSk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyEC2.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyOKP.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyOKP.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyOKP: () => (/* binding */ verifyOKP)\n/* harmony export */ });\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/index.js\");\n/* harmony import */ var _importKey_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./importKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/importKey.js\");\n/* harmony import */ var _getWebCrypto_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./getWebCrypto.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js\");\n\n\n\n\nasync function verifyOKP(opts) {\n    const { cosePublicKey, signature, data } = opts;\n    const WebCrypto = await (0,_getWebCrypto_js__WEBPACK_IMPORTED_MODULE_3__.getWebCrypto)();\n    const alg = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.alg);\n    const crv = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.crv);\n    const x = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.x);\n    if (!alg) {\n        throw new Error('Public key was missing alg (OKP)');\n    }\n    if (!(0,_cose_js__WEBPACK_IMPORTED_MODULE_0__.isCOSEAlg)(alg)) {\n        throw new Error(`Public key had invalid alg ${alg} (OKP)`);\n    }\n    if (!crv) {\n        throw new Error('Public key was missing crv (OKP)');\n    }\n    if (!x) {\n        throw new Error('Public key was missing x (OKP)');\n    }\n    // Pulled key import steps from here:\n    // https://wicg.github.io/webcrypto-secure-curves/#ed25519-operations\n    let _crv;\n    if (crv === _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSECRV.ED25519) {\n        _crv = 'Ed25519';\n    }\n    else {\n        throw new Error(`Unexpected COSE crv value of ${crv} (OKP)`);\n    }\n    const keyData = {\n        kty: 'OKP',\n        crv: _crv,\n        alg: 'EdDSA',\n        x: _index_js__WEBPACK_IMPORTED_MODULE_1__.isoBase64URL.fromBuffer(x),\n        ext: false,\n    };\n    const keyAlgorithm = {\n        name: _crv,\n        namedCurve: _crv,\n    };\n    const key = await (0,_importKey_js__WEBPACK_IMPORTED_MODULE_2__.importKey)({\n        keyData,\n        algorithm: keyAlgorithm,\n    });\n    const verifyAlgorithm = {\n        name: _crv,\n    };\n    return WebCrypto.subtle.verify(verifyAlgorithm, key, signature, data);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL3ZlcmlmeU9LUC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUE2RDtBQUNmO0FBQ0g7QUFDTTtBQUMxQztBQUNQLFlBQVksaUNBQWlDO0FBQzdDLDRCQUE0Qiw4REFBWTtBQUN4QyxrQ0FBa0MsOENBQVE7QUFDMUMsa0NBQWtDLDhDQUFRO0FBQzFDLGdDQUFnQyw4Q0FBUTtBQUN4QztBQUNBO0FBQ0E7QUFDQSxTQUFTLG1EQUFTO0FBQ2xCLHNEQUFzRCxLQUFLO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLDZDQUFPO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxLQUFLO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDhEQUF1QjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVM7QUFDL0I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcaXNvXFxpc29DcnlwdG9cXHZlcmlmeU9LUC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDT1NFQ1JWLCBDT1NFS0VZUywgaXNDT1NFQWxnIH0gZnJvbSAnLi4vLi4vY29zZS5qcyc7XG5pbXBvcnQgeyBpc29CYXNlNjRVUkwgfSBmcm9tICcuLi8uLi9pbmRleC5qcyc7XG5pbXBvcnQgeyBpbXBvcnRLZXkgfSBmcm9tICcuL2ltcG9ydEtleS5qcyc7XG5pbXBvcnQgeyBnZXRXZWJDcnlwdG8gfSBmcm9tICcuL2dldFdlYkNyeXB0by5qcyc7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5T0tQKG9wdHMpIHtcbiAgICBjb25zdCB7IGNvc2VQdWJsaWNLZXksIHNpZ25hdHVyZSwgZGF0YSB9ID0gb3B0cztcbiAgICBjb25zdCBXZWJDcnlwdG8gPSBhd2FpdCBnZXRXZWJDcnlwdG8oKTtcbiAgICBjb25zdCBhbGcgPSBjb3NlUHVibGljS2V5LmdldChDT1NFS0VZUy5hbGcpO1xuICAgIGNvbnN0IGNydiA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLmNydik7XG4gICAgY29uc3QgeCA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLngpO1xuICAgIGlmICghYWxnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUHVibGljIGtleSB3YXMgbWlzc2luZyBhbGcgKE9LUCknKTtcbiAgICB9XG4gICAgaWYgKCFpc0NPU0VBbGcoYWxnKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFB1YmxpYyBrZXkgaGFkIGludmFsaWQgYWxnICR7YWxnfSAoT0tQKWApO1xuICAgIH1cbiAgICBpZiAoIWNydikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1B1YmxpYyBrZXkgd2FzIG1pc3NpbmcgY3J2IChPS1ApJyk7XG4gICAgfVxuICAgIGlmICgheCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1B1YmxpYyBrZXkgd2FzIG1pc3NpbmcgeCAoT0tQKScpO1xuICAgIH1cbiAgICAvLyBQdWxsZWQga2V5IGltcG9ydCBzdGVwcyBmcm9tIGhlcmU6XG4gICAgLy8gaHR0cHM6Ly93aWNnLmdpdGh1Yi5pby93ZWJjcnlwdG8tc2VjdXJlLWN1cnZlcy8jZWQyNTUxOS1vcGVyYXRpb25zXG4gICAgbGV0IF9jcnY7XG4gICAgaWYgKGNydiA9PT0gQ09TRUNSVi5FRDI1NTE5KSB7XG4gICAgICAgIF9jcnYgPSAnRWQyNTUxOSc7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgQ09TRSBjcnYgdmFsdWUgb2YgJHtjcnZ9IChPS1ApYCk7XG4gICAgfVxuICAgIGNvbnN0IGtleURhdGEgPSB7XG4gICAgICAgIGt0eTogJ09LUCcsXG4gICAgICAgIGNydjogX2NydixcbiAgICAgICAgYWxnOiAnRWREU0EnLFxuICAgICAgICB4OiBpc29CYXNlNjRVUkwuZnJvbUJ1ZmZlcih4KSxcbiAgICAgICAgZXh0OiBmYWxzZSxcbiAgICB9O1xuICAgIGNvbnN0IGtleUFsZ29yaXRobSA9IHtcbiAgICAgICAgbmFtZTogX2NydixcbiAgICAgICAgbmFtZWRDdXJ2ZTogX2NydixcbiAgICB9O1xuICAgIGNvbnN0IGtleSA9IGF3YWl0IGltcG9ydEtleSh7XG4gICAgICAgIGtleURhdGEsXG4gICAgICAgIGFsZ29yaXRobToga2V5QWxnb3JpdGhtLFxuICAgIH0pO1xuICAgIGNvbnN0IHZlcmlmeUFsZ29yaXRobSA9IHtcbiAgICAgICAgbmFtZTogX2NydixcbiAgICB9O1xuICAgIHJldHVybiBXZWJDcnlwdG8uc3VidGxlLnZlcmlmeSh2ZXJpZnlBbGdvcml0aG0sIGtleSwgc2lnbmF0dXJlLCBkYXRhKTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyOKP.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyRSA.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyRSA.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyRSA: () => (/* binding */ verifyRSA)\n/* harmony export */ });\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _mapCoseAlgToWebCryptoAlg_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mapCoseAlgToWebCryptoAlg.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoAlg.js\");\n/* harmony import */ var _importKey_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./importKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/importKey.js\");\n/* harmony import */ var _index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _mapCoseAlgToWebCryptoKeyAlgName_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mapCoseAlgToWebCryptoKeyAlgName.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/mapCoseAlgToWebCryptoKeyAlgName.js\");\n/* harmony import */ var _getWebCrypto_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./getWebCrypto.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/getWebCrypto.js\");\n\n\n\n\n\n\n/**\n * Verify a signature using an RSA public key\n */\nasync function verifyRSA(opts) {\n    const { cosePublicKey, signature, data, shaHashOverride } = opts;\n    const WebCrypto = await (0,_getWebCrypto_js__WEBPACK_IMPORTED_MODULE_5__.getWebCrypto)();\n    const alg = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.alg);\n    const n = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.n);\n    const e = cosePublicKey.get(_cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEKEYS.e);\n    if (!alg) {\n        throw new Error('Public key was missing alg (RSA)');\n    }\n    if (!(0,_cose_js__WEBPACK_IMPORTED_MODULE_0__.isCOSEAlg)(alg)) {\n        throw new Error(`Public key had invalid alg ${alg} (RSA)`);\n    }\n    if (!n) {\n        throw new Error('Public key was missing n (RSA)');\n    }\n    if (!e) {\n        throw new Error('Public key was missing e (RSA)');\n    }\n    const keyData = {\n        kty: 'RSA',\n        alg: '',\n        n: _index_js__WEBPACK_IMPORTED_MODULE_3__.isoBase64URL.fromBuffer(n),\n        e: _index_js__WEBPACK_IMPORTED_MODULE_3__.isoBase64URL.fromBuffer(e),\n        ext: false,\n    };\n    const keyAlgorithm = {\n        name: (0,_mapCoseAlgToWebCryptoKeyAlgName_js__WEBPACK_IMPORTED_MODULE_4__.mapCoseAlgToWebCryptoKeyAlgName)(alg),\n        hash: { name: (0,_mapCoseAlgToWebCryptoAlg_js__WEBPACK_IMPORTED_MODULE_1__.mapCoseAlgToWebCryptoAlg)(alg) },\n    };\n    const verifyAlgorithm = {\n        name: (0,_mapCoseAlgToWebCryptoKeyAlgName_js__WEBPACK_IMPORTED_MODULE_4__.mapCoseAlgToWebCryptoKeyAlgName)(alg),\n    };\n    if (shaHashOverride) {\n        keyAlgorithm.hash.name = (0,_mapCoseAlgToWebCryptoAlg_js__WEBPACK_IMPORTED_MODULE_1__.mapCoseAlgToWebCryptoAlg)(shaHashOverride);\n    }\n    if (keyAlgorithm.name === 'RSASSA-PKCS1-v1_5') {\n        if (keyAlgorithm.hash.name === 'SHA-256') {\n            keyData.alg = 'RS256';\n        }\n        else if (keyAlgorithm.hash.name === 'SHA-384') {\n            keyData.alg = 'RS384';\n        }\n        else if (keyAlgorithm.hash.name === 'SHA-512') {\n            keyData.alg = 'RS512';\n        }\n        else if (keyAlgorithm.hash.name === 'SHA-1') {\n            keyData.alg = 'RS1';\n        }\n    }\n    else if (keyAlgorithm.name === 'RSA-PSS') {\n        /**\n         * salt length. The default value is 20 but the convention is to use hLen, the length of the\n         * output of the hash function in bytes. A salt length of zero is permitted and will result in\n         * a deterministic signature value. The actual salt length used can be determined from the\n         * signature value.\n         *\n         * From https://www.cryptosys.net/pki/manpki/pki_rsaschemes.html\n         */\n        let saltLength = 0;\n        if (keyAlgorithm.hash.name === 'SHA-256') {\n            keyData.alg = 'PS256';\n            saltLength = 32; // 256 bits => 32 bytes\n        }\n        else if (keyAlgorithm.hash.name === 'SHA-384') {\n            keyData.alg = 'PS384';\n            saltLength = 48; // 384 bits => 48 bytes\n        }\n        else if (keyAlgorithm.hash.name === 'SHA-512') {\n            keyData.alg = 'PS512';\n            saltLength = 64; // 512 bits => 64 bytes\n        }\n        verifyAlgorithm.saltLength = saltLength;\n    }\n    else {\n        throw new Error(`Unexpected RSA key algorithm ${alg} (${keyAlgorithm.name})`);\n    }\n    const key = await (0,_importKey_js__WEBPACK_IMPORTED_MODULE_2__.importKey)({\n        keyData,\n        algorithm: keyAlgorithm,\n    });\n    return WebCrypto.subtle.verify(verifyAlgorithm, key, signature, data);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvQ3J5cHRvL3ZlcmlmeVJTQS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQW9EO0FBQ3FCO0FBQzlCO0FBQ0E7QUFDNEM7QUFDdEM7QUFDakQ7QUFDQTtBQUNBO0FBQ087QUFDUCxZQUFZLGtEQUFrRDtBQUM5RCw0QkFBNEIsOERBQVk7QUFDeEMsa0NBQWtDLDhDQUFRO0FBQzFDLGdDQUFnQyw4Q0FBUTtBQUN4QyxnQ0FBZ0MsOENBQVE7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsU0FBUyxtREFBUztBQUNsQixzREFBc0QsS0FBSztBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsOERBQXVCO0FBQ2xDLFdBQVcsOERBQXVCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLGNBQWMsb0dBQStCO0FBQzdDLGdCQUFnQixNQUFNLHNGQUF3QixPQUFPO0FBQ3JEO0FBQ0E7QUFDQSxjQUFjLG9HQUErQjtBQUM3QztBQUNBO0FBQ0EsaUNBQWlDLHNGQUF3QjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxLQUFLLEdBQUcsa0JBQWtCO0FBQ2xGO0FBQ0Esc0JBQXNCLHdEQUFTO0FBQy9CO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGlzb1xcaXNvQ3J5cHRvXFx2ZXJpZnlSU0EuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ09TRUtFWVMsIGlzQ09TRUFsZyB9IGZyb20gJy4uLy4uL2Nvc2UuanMnO1xuaW1wb3J0IHsgbWFwQ29zZUFsZ1RvV2ViQ3J5cHRvQWxnIH0gZnJvbSAnLi9tYXBDb3NlQWxnVG9XZWJDcnlwdG9BbGcuanMnO1xuaW1wb3J0IHsgaW1wb3J0S2V5IH0gZnJvbSAnLi9pbXBvcnRLZXkuanMnO1xuaW1wb3J0IHsgaXNvQmFzZTY0VVJMIH0gZnJvbSAnLi4vaW5kZXguanMnO1xuaW1wb3J0IHsgbWFwQ29zZUFsZ1RvV2ViQ3J5cHRvS2V5QWxnTmFtZSB9IGZyb20gJy4vbWFwQ29zZUFsZ1RvV2ViQ3J5cHRvS2V5QWxnTmFtZS5qcyc7XG5pbXBvcnQgeyBnZXRXZWJDcnlwdG8gfSBmcm9tICcuL2dldFdlYkNyeXB0by5qcyc7XG4vKipcbiAqIFZlcmlmeSBhIHNpZ25hdHVyZSB1c2luZyBhbiBSU0EgcHVibGljIGtleVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UlNBKG9wdHMpIHtcbiAgICBjb25zdCB7IGNvc2VQdWJsaWNLZXksIHNpZ25hdHVyZSwgZGF0YSwgc2hhSGFzaE92ZXJyaWRlIH0gPSBvcHRzO1xuICAgIGNvbnN0IFdlYkNyeXB0byA9IGF3YWl0IGdldFdlYkNyeXB0bygpO1xuICAgIGNvbnN0IGFsZyA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLmFsZyk7XG4gICAgY29uc3QgbiA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLm4pO1xuICAgIGNvbnN0IGUgPSBjb3NlUHVibGljS2V5LmdldChDT1NFS0VZUy5lKTtcbiAgICBpZiAoIWFsZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1B1YmxpYyBrZXkgd2FzIG1pc3NpbmcgYWxnIChSU0EpJyk7XG4gICAgfVxuICAgIGlmICghaXNDT1NFQWxnKGFsZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQdWJsaWMga2V5IGhhZCBpbnZhbGlkIGFsZyAke2FsZ30gKFJTQSlgKTtcbiAgICB9XG4gICAgaWYgKCFuKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUHVibGljIGtleSB3YXMgbWlzc2luZyBuIChSU0EpJyk7XG4gICAgfVxuICAgIGlmICghZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1B1YmxpYyBrZXkgd2FzIG1pc3NpbmcgZSAoUlNBKScpO1xuICAgIH1cbiAgICBjb25zdCBrZXlEYXRhID0ge1xuICAgICAgICBrdHk6ICdSU0EnLFxuICAgICAgICBhbGc6ICcnLFxuICAgICAgICBuOiBpc29CYXNlNjRVUkwuZnJvbUJ1ZmZlcihuKSxcbiAgICAgICAgZTogaXNvQmFzZTY0VVJMLmZyb21CdWZmZXIoZSksXG4gICAgICAgIGV4dDogZmFsc2UsXG4gICAgfTtcbiAgICBjb25zdCBrZXlBbGdvcml0aG0gPSB7XG4gICAgICAgIG5hbWU6IG1hcENvc2VBbGdUb1dlYkNyeXB0b0tleUFsZ05hbWUoYWxnKSxcbiAgICAgICAgaGFzaDogeyBuYW1lOiBtYXBDb3NlQWxnVG9XZWJDcnlwdG9BbGcoYWxnKSB9LFxuICAgIH07XG4gICAgY29uc3QgdmVyaWZ5QWxnb3JpdGhtID0ge1xuICAgICAgICBuYW1lOiBtYXBDb3NlQWxnVG9XZWJDcnlwdG9LZXlBbGdOYW1lKGFsZyksXG4gICAgfTtcbiAgICBpZiAoc2hhSGFzaE92ZXJyaWRlKSB7XG4gICAgICAgIGtleUFsZ29yaXRobS5oYXNoLm5hbWUgPSBtYXBDb3NlQWxnVG9XZWJDcnlwdG9BbGcoc2hhSGFzaE92ZXJyaWRlKTtcbiAgICB9XG4gICAgaWYgKGtleUFsZ29yaXRobS5uYW1lID09PSAnUlNBU1NBLVBLQ1MxLXYxXzUnKSB7XG4gICAgICAgIGlmIChrZXlBbGdvcml0aG0uaGFzaC5uYW1lID09PSAnU0hBLTI1NicpIHtcbiAgICAgICAgICAgIGtleURhdGEuYWxnID0gJ1JTMjU2JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXlBbGdvcml0aG0uaGFzaC5uYW1lID09PSAnU0hBLTM4NCcpIHtcbiAgICAgICAgICAgIGtleURhdGEuYWxnID0gJ1JTMzg0JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXlBbGdvcml0aG0uaGFzaC5uYW1lID09PSAnU0hBLTUxMicpIHtcbiAgICAgICAgICAgIGtleURhdGEuYWxnID0gJ1JTNTEyJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXlBbGdvcml0aG0uaGFzaC5uYW1lID09PSAnU0hBLTEnKSB7XG4gICAgICAgICAgICBrZXlEYXRhLmFsZyA9ICdSUzEnO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGtleUFsZ29yaXRobS5uYW1lID09PSAnUlNBLVBTUycpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHNhbHQgbGVuZ3RoLiBUaGUgZGVmYXVsdCB2YWx1ZSBpcyAyMCBidXQgdGhlIGNvbnZlbnRpb24gaXMgdG8gdXNlIGhMZW4sIHRoZSBsZW5ndGggb2YgdGhlXG4gICAgICAgICAqIG91dHB1dCBvZiB0aGUgaGFzaCBmdW5jdGlvbiBpbiBieXRlcy4gQSBzYWx0IGxlbmd0aCBvZiB6ZXJvIGlzIHBlcm1pdHRlZCBhbmQgd2lsbCByZXN1bHQgaW5cbiAgICAgICAgICogYSBkZXRlcm1pbmlzdGljIHNpZ25hdHVyZSB2YWx1ZS4gVGhlIGFjdHVhbCBzYWx0IGxlbmd0aCB1c2VkIGNhbiBiZSBkZXRlcm1pbmVkIGZyb20gdGhlXG4gICAgICAgICAqIHNpZ25hdHVyZSB2YWx1ZS5cbiAgICAgICAgICpcbiAgICAgICAgICogRnJvbSBodHRwczovL3d3dy5jcnlwdG9zeXMubmV0L3BraS9tYW5wa2kvcGtpX3JzYXNjaGVtZXMuaHRtbFxuICAgICAgICAgKi9cbiAgICAgICAgbGV0IHNhbHRMZW5ndGggPSAwO1xuICAgICAgICBpZiAoa2V5QWxnb3JpdGhtLmhhc2gubmFtZSA9PT0gJ1NIQS0yNTYnKSB7XG4gICAgICAgICAgICBrZXlEYXRhLmFsZyA9ICdQUzI1Nic7XG4gICAgICAgICAgICBzYWx0TGVuZ3RoID0gMzI7IC8vIDI1NiBiaXRzID0+IDMyIGJ5dGVzXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5QWxnb3JpdGhtLmhhc2gubmFtZSA9PT0gJ1NIQS0zODQnKSB7XG4gICAgICAgICAgICBrZXlEYXRhLmFsZyA9ICdQUzM4NCc7XG4gICAgICAgICAgICBzYWx0TGVuZ3RoID0gNDg7IC8vIDM4NCBiaXRzID0+IDQ4IGJ5dGVzXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5QWxnb3JpdGhtLmhhc2gubmFtZSA9PT0gJ1NIQS01MTInKSB7XG4gICAgICAgICAgICBrZXlEYXRhLmFsZyA9ICdQUzUxMic7XG4gICAgICAgICAgICBzYWx0TGVuZ3RoID0gNjQ7IC8vIDUxMiBiaXRzID0+IDY0IGJ5dGVzXG4gICAgICAgIH1cbiAgICAgICAgdmVyaWZ5QWxnb3JpdGhtLnNhbHRMZW5ndGggPSBzYWx0TGVuZ3RoO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIFJTQSBrZXkgYWxnb3JpdGhtICR7YWxnfSAoJHtrZXlBbGdvcml0aG0ubmFtZX0pYCk7XG4gICAgfVxuICAgIGNvbnN0IGtleSA9IGF3YWl0IGltcG9ydEtleSh7XG4gICAgICAgIGtleURhdGEsXG4gICAgICAgIGFsZ29yaXRobToga2V5QWxnb3JpdGhtLFxuICAgIH0pO1xuICAgIHJldHVybiBXZWJDcnlwdG8uc3VidGxlLnZlcmlmeSh2ZXJpZnlBbGdvcml0aG0sIGtleSwgc2lnbmF0dXJlLCBkYXRhKTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyRSA.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoUint8Array.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/iso/isoUint8Array.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   areEqual: () => (/* binding */ areEqual),\n/* harmony export */   concat: () => (/* binding */ concat),\n/* harmony export */   fromASCIIString: () => (/* binding */ fromASCIIString),\n/* harmony export */   fromHex: () => (/* binding */ fromHex),\n/* harmony export */   fromUTF8String: () => (/* binding */ fromUTF8String),\n/* harmony export */   toDataView: () => (/* binding */ toDataView),\n/* harmony export */   toHex: () => (/* binding */ toHex),\n/* harmony export */   toUTF8String: () => (/* binding */ toUTF8String)\n/* harmony export */ });\n/**\n * Make sure two Uint8Arrays are deeply equivalent\n */\nfunction areEqual(array1, array2) {\n    if (array1.length != array2.length) {\n        return false;\n    }\n    return array1.every((val, i) => val === array2[i]);\n}\n/**\n * Convert a Uint8Array to Hexadecimal.\n *\n * A replacement for `Buffer.toString('hex')`\n */\nfunction toHex(array) {\n    const hexParts = Array.from(array, (i) => i.toString(16).padStart(2, '0'));\n    // adce000235bcc60a648b0b25f1f05503\n    return hexParts.join('');\n}\n/**\n * Convert a hexadecimal string to isoUint8Array.\n *\n * A replacement for `Buffer.from('...', 'hex')`\n */\nfunction fromHex(hex) {\n    if (!hex) {\n        return Uint8Array.from([]);\n    }\n    const isValid = hex.length !== 0 && hex.length % 2 === 0 &&\n        !/[^a-fA-F0-9]/u.test(hex);\n    if (!isValid) {\n        throw new Error('Invalid hex string');\n    }\n    const byteStrings = hex.match(/.{1,2}/g) ?? [];\n    return Uint8Array.from(byteStrings.map((byte) => parseInt(byte, 16)));\n}\n/**\n * Combine multiple Uint8Arrays into a single Uint8Array\n */\nfunction concat(arrays) {\n    let pointer = 0;\n    const totalLength = arrays.reduce((prev, curr) => prev + curr.length, 0);\n    const toReturn = new Uint8Array(totalLength);\n    arrays.forEach((arr) => {\n        toReturn.set(arr, pointer);\n        pointer += arr.length;\n    });\n    return toReturn;\n}\n/**\n * Convert bytes into a UTF-8 string\n */\nfunction toUTF8String(array) {\n    const decoder = new globalThis.TextDecoder('utf-8');\n    return decoder.decode(array);\n}\n/**\n * Convert a UTF-8 string back into bytes\n */\nfunction fromUTF8String(utf8String) {\n    const encoder = new globalThis.TextEncoder();\n    return encoder.encode(utf8String);\n}\n/**\n * Convert an ASCII string to Uint8Array\n */\nfunction fromASCIIString(value) {\n    return Uint8Array.from(value.split('').map((x) => x.charCodeAt(0)));\n}\n/**\n * Prepare a DataView we can slice our way around in as we parse the bytes in a Uint8Array\n */\nfunction toDataView(array) {\n    return new DataView(array.buffer, array.byteOffset, array.length);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9pc28vaXNvVWludDhBcnJheS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxJQUFJO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXGlzb1xcaXNvVWludDhBcnJheS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1ha2Ugc3VyZSB0d28gVWludDhBcnJheXMgYXJlIGRlZXBseSBlcXVpdmFsZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhcmVFcXVhbChhcnJheTEsIGFycmF5Mikge1xuICAgIGlmIChhcnJheTEubGVuZ3RoICE9IGFycmF5Mi5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXkxLmV2ZXJ5KCh2YWwsIGkpID0+IHZhbCA9PT0gYXJyYXkyW2ldKTtcbn1cbi8qKlxuICogQ29udmVydCBhIFVpbnQ4QXJyYXkgdG8gSGV4YWRlY2ltYWwuXG4gKlxuICogQSByZXBsYWNlbWVudCBmb3IgYEJ1ZmZlci50b1N0cmluZygnaGV4JylgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b0hleChhcnJheSkge1xuICAgIGNvbnN0IGhleFBhcnRzID0gQXJyYXkuZnJvbShhcnJheSwgKGkpID0+IGkudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpO1xuICAgIC8vIGFkY2UwMDAyMzViY2M2MGE2NDhiMGIyNWYxZjA1NTAzXG4gICAgcmV0dXJuIGhleFBhcnRzLmpvaW4oJycpO1xufVxuLyoqXG4gKiBDb252ZXJ0IGEgaGV4YWRlY2ltYWwgc3RyaW5nIHRvIGlzb1VpbnQ4QXJyYXkuXG4gKlxuICogQSByZXBsYWNlbWVudCBmb3IgYEJ1ZmZlci5mcm9tKCcuLi4nLCAnaGV4JylgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tSGV4KGhleCkge1xuICAgIGlmICghaGV4KSB7XG4gICAgICAgIHJldHVybiBVaW50OEFycmF5LmZyb20oW10pO1xuICAgIH1cbiAgICBjb25zdCBpc1ZhbGlkID0gaGV4Lmxlbmd0aCAhPT0gMCAmJiBoZXgubGVuZ3RoICUgMiA9PT0gMCAmJlxuICAgICAgICAhL1teYS1mQS1GMC05XS91LnRlc3QoaGV4KTtcbiAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGhleCBzdHJpbmcnKTtcbiAgICB9XG4gICAgY29uc3QgYnl0ZVN0cmluZ3MgPSBoZXgubWF0Y2goLy57MSwyfS9nKSA/PyBbXTtcbiAgICByZXR1cm4gVWludDhBcnJheS5mcm9tKGJ5dGVTdHJpbmdzLm1hcCgoYnl0ZSkgPT4gcGFyc2VJbnQoYnl0ZSwgMTYpKSk7XG59XG4vKipcbiAqIENvbWJpbmUgbXVsdGlwbGUgVWludDhBcnJheXMgaW50byBhIHNpbmdsZSBVaW50OEFycmF5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb25jYXQoYXJyYXlzKSB7XG4gICAgbGV0IHBvaW50ZXIgPSAwO1xuICAgIGNvbnN0IHRvdGFsTGVuZ3RoID0gYXJyYXlzLnJlZHVjZSgocHJldiwgY3VycikgPT4gcHJldiArIGN1cnIubGVuZ3RoLCAwKTtcbiAgICBjb25zdCB0b1JldHVybiA9IG5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTtcbiAgICBhcnJheXMuZm9yRWFjaCgoYXJyKSA9PiB7XG4gICAgICAgIHRvUmV0dXJuLnNldChhcnIsIHBvaW50ZXIpO1xuICAgICAgICBwb2ludGVyICs9IGFyci5sZW5ndGg7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRvUmV0dXJuO1xufVxuLyoqXG4gKiBDb252ZXJ0IGJ5dGVzIGludG8gYSBVVEYtOCBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRvVVRGOFN0cmluZyhhcnJheSkge1xuICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgZ2xvYmFsVGhpcy5UZXh0RGVjb2RlcigndXRmLTgnKTtcbiAgICByZXR1cm4gZGVjb2Rlci5kZWNvZGUoYXJyYXkpO1xufVxuLyoqXG4gKiBDb252ZXJ0IGEgVVRGLTggc3RyaW5nIGJhY2sgaW50byBieXRlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbVVURjhTdHJpbmcodXRmOFN0cmluZykge1xuICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgZ2xvYmFsVGhpcy5UZXh0RW5jb2RlcigpO1xuICAgIHJldHVybiBlbmNvZGVyLmVuY29kZSh1dGY4U3RyaW5nKTtcbn1cbi8qKlxuICogQ29udmVydCBhbiBBU0NJSSBzdHJpbmcgdG8gVWludDhBcnJheVxuICovXG5leHBvcnQgZnVuY3Rpb24gZnJvbUFTQ0lJU3RyaW5nKHZhbHVlKSB7XG4gICAgcmV0dXJuIFVpbnQ4QXJyYXkuZnJvbSh2YWx1ZS5zcGxpdCgnJykubWFwKCh4KSA9PiB4LmNoYXJDb2RlQXQoMCkpKTtcbn1cbi8qKlxuICogUHJlcGFyZSBhIERhdGFWaWV3IHdlIGNhbiBzbGljZSBvdXIgd2F5IGFyb3VuZCBpbiBhcyB3ZSBwYXJzZSB0aGUgYnl0ZXMgaW4gYSBVaW50OEFycmF5XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0b0RhdGFWaWV3KGFycmF5KSB7XG4gICAgcmV0dXJuIG5ldyBEYXRhVmlldyhhcnJheS5idWZmZXIsIGFycmF5LmJ5dGVPZmZzZXQsIGFycmF5Lmxlbmd0aCk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoUint8Array.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/logging.js":
/*!********************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/logging.js ***!
  \********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getLogger: () => (/* binding */ getLogger)\n/* harmony export */ });\n// import { debug, Debugger } from '../deps.ts';\n// const defaultLogger = debug('SimpleWebAuthn');\n/**\n * Generate an instance of a `debug` logger that extends off of the \"simplewebauthn\" namespace for\n * consistent naming.\n *\n * See https://www.npmjs.com/package/debug for information on how to control logging output when\n * using @simplewebauthn/server\n *\n * Example:\n *\n * ```\n * const log = getLogger('mds');\n * log('hello'); // simplewebauthn:mds hello +0ms\n * ```\n */\nfunction getLogger(_name) {\n    // This is a noop for now while I search for a better debug logger technique\n    return (_message, ..._rest) => { };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9sb2dnaW5nLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxZQUFZLGtCQUFrQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcbG9nZ2luZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBkZWJ1ZywgRGVidWdnZXIgfSBmcm9tICcuLi9kZXBzLnRzJztcbi8vIGNvbnN0IGRlZmF1bHRMb2dnZXIgPSBkZWJ1ZygnU2ltcGxlV2ViQXV0aG4nKTtcbi8qKlxuICogR2VuZXJhdGUgYW4gaW5zdGFuY2Ugb2YgYSBgZGVidWdgIGxvZ2dlciB0aGF0IGV4dGVuZHMgb2ZmIG9mIHRoZSBcInNpbXBsZXdlYmF1dGhuXCIgbmFtZXNwYWNlIGZvclxuICogY29uc2lzdGVudCBuYW1pbmcuXG4gKlxuICogU2VlIGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL2RlYnVnIGZvciBpbmZvcm1hdGlvbiBvbiBob3cgdG8gY29udHJvbCBsb2dnaW5nIG91dHB1dCB3aGVuXG4gKiB1c2luZyBAc2ltcGxld2ViYXV0aG4vc2VydmVyXG4gKlxuICogRXhhbXBsZTpcbiAqXG4gKiBgYGBcbiAqIGNvbnN0IGxvZyA9IGdldExvZ2dlcignbWRzJyk7XG4gKiBsb2coJ2hlbGxvJyk7IC8vIHNpbXBsZXdlYmF1dGhuOm1kcyBoZWxsbyArMG1zXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExvZ2dlcihfbmFtZSkge1xuICAgIC8vIFRoaXMgaXMgYSBub29wIGZvciBub3cgd2hpbGUgSSBzZWFyY2ggZm9yIGEgYmV0dGVyIGRlYnVnIGxvZ2dlciB0ZWNobmlxdWVcbiAgICByZXR1cm4gKF9tZXNzYWdlLCAuLi5fcmVzdCkgPT4geyB9O1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/logging.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/mapX509SignatureAlgToCOSEAlg.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/mapX509SignatureAlgToCOSEAlg.js ***!
  \*****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   mapX509SignatureAlgToCOSEAlg: () => (/* binding */ mapX509SignatureAlgToCOSEAlg)\n/* harmony export */ });\n/* harmony import */ var _cose_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n\n/**\n * Map X.509 signature algorithm OIDs to COSE algorithm IDs\n *\n * - EC2 OIDs: https://oidref.com/1.2.840.10045.4.3\n * - RSA OIDs: https://oidref.com/1.2.840.113549.1.1\n */\nfunction mapX509SignatureAlgToCOSEAlg(signatureAlgorithm) {\n    let alg;\n    if (signatureAlgorithm === '1.2.840.10045.4.3.2') {\n        alg = _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES256;\n    }\n    else if (signatureAlgorithm === '1.2.840.10045.4.3.3') {\n        alg = _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES384;\n    }\n    else if (signatureAlgorithm === '1.2.840.10045.4.3.4') {\n        alg = _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.ES512;\n    }\n    else if (signatureAlgorithm === '1.2.840.113549.1.1.11') {\n        alg = _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS256;\n    }\n    else if (signatureAlgorithm === '1.2.840.113549.1.1.12') {\n        alg = _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS384;\n    }\n    else if (signatureAlgorithm === '1.2.840.113549.1.1.13') {\n        alg = _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS512;\n    }\n    else if (signatureAlgorithm === '1.2.840.113549.1.1.5') {\n        alg = _cose_js__WEBPACK_IMPORTED_MODULE_0__.COSEALG.RS1;\n    }\n    else {\n        throw new Error(`Unable to map X.509 signature algorithm ${signatureAlgorithm} to a COSE algorithm`);\n    }\n    return alg;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9tYXBYNTA5U2lnbmF0dXJlQWxnVG9DT1NFQWxnLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLGNBQWMsNkNBQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsNkNBQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsNkNBQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsNkNBQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsNkNBQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsNkNBQU87QUFDckI7QUFDQTtBQUNBLGNBQWMsNkNBQU87QUFDckI7QUFDQTtBQUNBLG1FQUFtRSxvQkFBb0I7QUFDdkY7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcbWFwWDUwOVNpZ25hdHVyZUFsZ1RvQ09TRUFsZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDT1NFQUxHIH0gZnJvbSAnLi9jb3NlLmpzJztcbi8qKlxuICogTWFwIFguNTA5IHNpZ25hdHVyZSBhbGdvcml0aG0gT0lEcyB0byBDT1NFIGFsZ29yaXRobSBJRHNcbiAqXG4gKiAtIEVDMiBPSURzOiBodHRwczovL29pZHJlZi5jb20vMS4yLjg0MC4xMDA0NS40LjNcbiAqIC0gUlNBIE9JRHM6IGh0dHBzOi8vb2lkcmVmLmNvbS8xLjIuODQwLjExMzU0OS4xLjFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcFg1MDlTaWduYXR1cmVBbGdUb0NPU0VBbGcoc2lnbmF0dXJlQWxnb3JpdGhtKSB7XG4gICAgbGV0IGFsZztcbiAgICBpZiAoc2lnbmF0dXJlQWxnb3JpdGhtID09PSAnMS4yLjg0MC4xMDA0NS40LjMuMicpIHtcbiAgICAgICAgYWxnID0gQ09TRUFMRy5FUzI1NjtcbiAgICB9XG4gICAgZWxzZSBpZiAoc2lnbmF0dXJlQWxnb3JpdGhtID09PSAnMS4yLjg0MC4xMDA0NS40LjMuMycpIHtcbiAgICAgICAgYWxnID0gQ09TRUFMRy5FUzM4NDtcbiAgICB9XG4gICAgZWxzZSBpZiAoc2lnbmF0dXJlQWxnb3JpdGhtID09PSAnMS4yLjg0MC4xMDA0NS40LjMuNCcpIHtcbiAgICAgICAgYWxnID0gQ09TRUFMRy5FUzUxMjtcbiAgICB9XG4gICAgZWxzZSBpZiAoc2lnbmF0dXJlQWxnb3JpdGhtID09PSAnMS4yLjg0MC4xMTM1NDkuMS4xLjExJykge1xuICAgICAgICBhbGcgPSBDT1NFQUxHLlJTMjU2O1xuICAgIH1cbiAgICBlbHNlIGlmIChzaWduYXR1cmVBbGdvcml0aG0gPT09ICcxLjIuODQwLjExMzU0OS4xLjEuMTInKSB7XG4gICAgICAgIGFsZyA9IENPU0VBTEcuUlMzODQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKHNpZ25hdHVyZUFsZ29yaXRobSA9PT0gJzEuMi44NDAuMTEzNTQ5LjEuMS4xMycpIHtcbiAgICAgICAgYWxnID0gQ09TRUFMRy5SUzUxMjtcbiAgICB9XG4gICAgZWxzZSBpZiAoc2lnbmF0dXJlQWxnb3JpdGhtID09PSAnMS4yLjg0MC4xMTM1NDkuMS4xLjUnKSB7XG4gICAgICAgIGFsZyA9IENPU0VBTEcuUlMxO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gbWFwIFguNTA5IHNpZ25hdHVyZSBhbGdvcml0aG0gJHtzaWduYXR1cmVBbGdvcml0aG19IHRvIGEgQ09TRSBhbGdvcml0aG1gKTtcbiAgICB9XG4gICAgcmV0dXJuIGFsZztcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/mapX509SignatureAlgToCOSEAlg.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/matchExpectedRPID.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/matchExpectedRPID.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   matchExpectedRPID: () => (/* binding */ matchExpectedRPID)\n/* harmony export */ });\n/* harmony import */ var _toHash_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./toHash.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js\");\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n\n/**\n * Go through each expected RP ID and try to find one that matches. Returns the unhashed RP ID\n * that matched the hash in the response.\n *\n * Raises an `UnexpectedRPIDHash` error if no match is found\n */\nasync function matchExpectedRPID(rpIDHash, expectedRPIDs) {\n    try {\n        const matchedRPID = await Promise.any(expectedRPIDs.map((expected) => {\n            return new Promise((resolve, reject) => {\n                (0,_toHash_js__WEBPACK_IMPORTED_MODULE_0__.toHash)(_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.fromASCIIString(expected)).then((expectedRPIDHash) => {\n                    if (_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.areEqual(rpIDHash, expectedRPIDHash)) {\n                        resolve(expected);\n                    }\n                    else {\n                        reject();\n                    }\n                });\n            });\n        }));\n        return matchedRPID;\n    }\n    catch (err) {\n        const _err = err;\n        // This means no matches were found\n        if (_err.name === 'AggregateError') {\n            throw new UnexpectedRPIDHash();\n        }\n        // An unexpected error occurred\n        throw err;\n    }\n}\nclass UnexpectedRPIDHash extends Error {\n    constructor() {\n        const message = 'Unexpected RP ID hash';\n        super(message);\n        this.name = 'UnexpectedRPIDHash';\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9tYXRjaEV4cGVjdGVkUlBJRC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBcUM7QUFDVTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrREFBTSxDQUFDLHdFQUE2QjtBQUNwRCx3QkFBd0IsaUVBQXNCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXG1hdGNoRXhwZWN0ZWRSUElELmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRvSGFzaCB9IGZyb20gJy4vdG9IYXNoLmpzJztcbmltcG9ydCB7IGlzb1VpbnQ4QXJyYXkgfSBmcm9tICcuL2lzby9pbmRleC5qcyc7XG4vKipcbiAqIEdvIHRocm91Z2ggZWFjaCBleHBlY3RlZCBSUCBJRCBhbmQgdHJ5IHRvIGZpbmQgb25lIHRoYXQgbWF0Y2hlcy4gUmV0dXJucyB0aGUgdW5oYXNoZWQgUlAgSURcbiAqIHRoYXQgbWF0Y2hlZCB0aGUgaGFzaCBpbiB0aGUgcmVzcG9uc2UuXG4gKlxuICogUmFpc2VzIGFuIGBVbmV4cGVjdGVkUlBJREhhc2hgIGVycm9yIGlmIG5vIG1hdGNoIGlzIGZvdW5kXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtYXRjaEV4cGVjdGVkUlBJRChycElESGFzaCwgZXhwZWN0ZWRSUElEcykge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1hdGNoZWRSUElEID0gYXdhaXQgUHJvbWlzZS5hbnkoZXhwZWN0ZWRSUElEcy5tYXAoKGV4cGVjdGVkKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgICAgIHRvSGFzaChpc29VaW50OEFycmF5LmZyb21BU0NJSVN0cmluZyhleHBlY3RlZCkpLnRoZW4oKGV4cGVjdGVkUlBJREhhc2gpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzb1VpbnQ4QXJyYXkuYXJlRXF1YWwocnBJREhhc2gsIGV4cGVjdGVkUlBJREhhc2gpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGV4cGVjdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gbWF0Y2hlZFJQSUQ7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc3QgX2VyciA9IGVycjtcbiAgICAgICAgLy8gVGhpcyBtZWFucyBubyBtYXRjaGVzIHdlcmUgZm91bmRcbiAgICAgICAgaWYgKF9lcnIubmFtZSA9PT0gJ0FnZ3JlZ2F0ZUVycm9yJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRSUElESGFzaCgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWRcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn1cbmNsYXNzIFVuZXhwZWN0ZWRSUElESGFzaCBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9ICdVbmV4cGVjdGVkIFJQIElEIGhhc2gnO1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gJ1VuZXhwZWN0ZWRSUElESGFzaCc7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/matchExpectedRPID.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseAuthenticatorData.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/parseAuthenticatorData.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _parseAuthenticatorDataInternals: () => (/* binding */ _parseAuthenticatorDataInternals),\n/* harmony export */   parseAuthenticatorData: () => (/* binding */ parseAuthenticatorData)\n/* harmony export */ });\n/* harmony import */ var _decodeAuthenticatorExtensions_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./decodeAuthenticatorExtensions.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeAuthenticatorExtensions.js\");\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n\n/**\n * Make sense of the authData buffer contained in an Attestation\n */\nfunction parseAuthenticatorData(authData) {\n    if (authData.byteLength < 37) {\n        throw new Error(`Authenticator data was ${authData.byteLength} bytes, expected at least 37 bytes`);\n    }\n    let pointer = 0;\n    const dataView = _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.toDataView(authData);\n    const rpIdHash = authData.slice(pointer, pointer += 32);\n    const flagsBuf = authData.slice(pointer, pointer += 1);\n    const flagsInt = flagsBuf[0];\n    // Bit positions can be referenced here:\n    // https://www.w3.org/TR/webauthn-2/#flags\n    const flags = {\n        up: !!(flagsInt & (1 << 0)),\n        uv: !!(flagsInt & (1 << 2)),\n        be: !!(flagsInt & (1 << 3)),\n        bs: !!(flagsInt & (1 << 4)),\n        at: !!(flagsInt & (1 << 6)),\n        ed: !!(flagsInt & (1 << 7)),\n        flagsInt,\n    };\n    const counterBuf = authData.slice(pointer, pointer + 4);\n    const counter = dataView.getUint32(pointer, false);\n    pointer += 4;\n    let aaguid = undefined;\n    let credentialID = undefined;\n    let credentialPublicKey = undefined;\n    if (flags.at) {\n        aaguid = authData.slice(pointer, pointer += 16);\n        const credIDLen = dataView.getUint16(pointer);\n        pointer += 2;\n        credentialID = authData.slice(pointer, pointer += credIDLen);\n        /**\n         * Firefox 117 incorrectly CBOR-encodes authData when EdDSA (-8) is used for the public key.\n         * A CBOR \"Map of 3 items\" (0xa3) should be \"Map of 4 items\" (0xa4), and if we manually adjust\n         * the single byte there's a good chance the authData can be correctly parsed.\n         *\n         * This browser release also incorrectly uses the string labels \"OKP\" and \"Ed25519\" instead of\n         * their integer representations for kty and crv respectively. That's why the COSE public key\n         * in the hex below looks so odd.\n         */\n        // Bytes decode to `{ 1: \"OKP\", 3: -8, -1: \"Ed25519\" }` (it's missing key -2 a.k.a. COSEKEYS.x)\n        const badEdDSACBOR = _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.fromHex('a301634f4b500327206745643235353139');\n        const bytesAtCurrentPosition = authData.slice(pointer, pointer + badEdDSACBOR.byteLength);\n        let foundBadCBOR = false;\n        if (_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.areEqual(badEdDSACBOR, bytesAtCurrentPosition)) {\n            // Change the bad CBOR 0xa3 to 0xa4 so that the credential public key can be recognized\n            foundBadCBOR = true;\n            authData[pointer] = 0xa4;\n        }\n        // Decode the next CBOR item in the buffer, then re-encode it back to a Buffer\n        const firstDecoded = _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoCBOR.decodeFirst(authData.slice(pointer));\n        const firstEncoded = Uint8Array.from(\n        /**\n         * Casting to `Map` via `as unknown` here because TS doesn't make it possible to define Maps\n         * with discrete keys and properties with known types per pair, and CBOR libs typically parse\n         * CBOR Major Type 5 to `Map` because you can have numbers for keys. A `COSEPublicKey` can be\n         * generalized as \"a Map with numbers for keys and either numbers or bytes for values\" though.\n         * If this presumption falls apart then other parts of verification later on will fail so we\n         * should be safe doing this here.\n         */\n        _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoCBOR.encode(firstDecoded));\n        if (foundBadCBOR) {\n            // Restore the bit we changed so that `authData` is the same as it came in and won't break\n            // signature verification.\n            authData[pointer] = 0xa3;\n        }\n        credentialPublicKey = firstEncoded;\n        pointer += firstEncoded.byteLength;\n    }\n    let extensionsData = undefined;\n    let extensionsDataBuffer = undefined;\n    if (flags.ed) {\n        const firstDecoded = _iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoCBOR.decodeFirst(authData.slice(pointer));\n        extensionsDataBuffer = Uint8Array.from(_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoCBOR.encode(firstDecoded));\n        extensionsData = (0,_decodeAuthenticatorExtensions_js__WEBPACK_IMPORTED_MODULE_0__.decodeAuthenticatorExtensions)(extensionsDataBuffer);\n        pointer += extensionsDataBuffer.byteLength;\n    }\n    // Pointer should be at the end of the authenticator data, otherwise too much data was sent\n    if (authData.byteLength > pointer) {\n        throw new Error('Leftover bytes detected while parsing authenticator data');\n    }\n    return _parseAuthenticatorDataInternals.stubThis({\n        rpIdHash,\n        flagsBuf,\n        flags,\n        counter,\n        counterBuf,\n        aaguid,\n        credentialID,\n        credentialPublicKey,\n        extensionsData,\n        extensionsDataBuffer,\n    });\n}\n// Make it possible to stub the return value during testing\nconst _parseAuthenticatorDataInternals = {\n    stubThis: (value) => value,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9wYXJzZUF1dGhlbnRpY2F0b3JEYXRhLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBb0Y7QUFDNUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBLGtEQUFrRCxxQkFBcUI7QUFDdkU7QUFDQTtBQUNBLHFCQUFxQixtRUFBd0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsZ0NBQWdDO0FBQzlELDZCQUE2QixnRUFBcUI7QUFDbEQ7QUFDQTtBQUNBLFlBQVksaUVBQXNCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsOERBQW1CO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEseURBQWM7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qiw4REFBbUI7QUFDaEQsK0NBQStDLHlEQUFjO0FBQzdELHlCQUF5QixnR0FBNkI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ087QUFDUDtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xccGFyc2VBdXRoZW50aWNhdG9yRGF0YS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWNvZGVBdXRoZW50aWNhdG9yRXh0ZW5zaW9ucywgfSBmcm9tICcuL2RlY29kZUF1dGhlbnRpY2F0b3JFeHRlbnNpb25zLmpzJztcbmltcG9ydCB7IGlzb0NCT1IsIGlzb1VpbnQ4QXJyYXkgfSBmcm9tICcuL2lzby9pbmRleC5qcyc7XG4vKipcbiAqIE1ha2Ugc2Vuc2Ugb2YgdGhlIGF1dGhEYXRhIGJ1ZmZlciBjb250YWluZWQgaW4gYW4gQXR0ZXN0YXRpb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQXV0aGVudGljYXRvckRhdGEoYXV0aERhdGEpIHtcbiAgICBpZiAoYXV0aERhdGEuYnl0ZUxlbmd0aCA8IDM3KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQXV0aGVudGljYXRvciBkYXRhIHdhcyAke2F1dGhEYXRhLmJ5dGVMZW5ndGh9IGJ5dGVzLCBleHBlY3RlZCBhdCBsZWFzdCAzNyBieXRlc2ApO1xuICAgIH1cbiAgICBsZXQgcG9pbnRlciA9IDA7XG4gICAgY29uc3QgZGF0YVZpZXcgPSBpc29VaW50OEFycmF5LnRvRGF0YVZpZXcoYXV0aERhdGEpO1xuICAgIGNvbnN0IHJwSWRIYXNoID0gYXV0aERhdGEuc2xpY2UocG9pbnRlciwgcG9pbnRlciArPSAzMik7XG4gICAgY29uc3QgZmxhZ3NCdWYgPSBhdXRoRGF0YS5zbGljZShwb2ludGVyLCBwb2ludGVyICs9IDEpO1xuICAgIGNvbnN0IGZsYWdzSW50ID0gZmxhZ3NCdWZbMF07XG4gICAgLy8gQml0IHBvc2l0aW9ucyBjYW4gYmUgcmVmZXJlbmNlZCBoZXJlOlxuICAgIC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93ZWJhdXRobi0yLyNmbGFnc1xuICAgIGNvbnN0IGZsYWdzID0ge1xuICAgICAgICB1cDogISEoZmxhZ3NJbnQgJiAoMSA8PCAwKSksXG4gICAgICAgIHV2OiAhIShmbGFnc0ludCAmICgxIDw8IDIpKSxcbiAgICAgICAgYmU6ICEhKGZsYWdzSW50ICYgKDEgPDwgMykpLFxuICAgICAgICBiczogISEoZmxhZ3NJbnQgJiAoMSA8PCA0KSksXG4gICAgICAgIGF0OiAhIShmbGFnc0ludCAmICgxIDw8IDYpKSxcbiAgICAgICAgZWQ6ICEhKGZsYWdzSW50ICYgKDEgPDwgNykpLFxuICAgICAgICBmbGFnc0ludCxcbiAgICB9O1xuICAgIGNvbnN0IGNvdW50ZXJCdWYgPSBhdXRoRGF0YS5zbGljZShwb2ludGVyLCBwb2ludGVyICsgNCk7XG4gICAgY29uc3QgY291bnRlciA9IGRhdGFWaWV3LmdldFVpbnQzMihwb2ludGVyLCBmYWxzZSk7XG4gICAgcG9pbnRlciArPSA0O1xuICAgIGxldCBhYWd1aWQgPSB1bmRlZmluZWQ7XG4gICAgbGV0IGNyZWRlbnRpYWxJRCA9IHVuZGVmaW5lZDtcbiAgICBsZXQgY3JlZGVudGlhbFB1YmxpY0tleSA9IHVuZGVmaW5lZDtcbiAgICBpZiAoZmxhZ3MuYXQpIHtcbiAgICAgICAgYWFndWlkID0gYXV0aERhdGEuc2xpY2UocG9pbnRlciwgcG9pbnRlciArPSAxNik7XG4gICAgICAgIGNvbnN0IGNyZWRJRExlbiA9IGRhdGFWaWV3LmdldFVpbnQxNihwb2ludGVyKTtcbiAgICAgICAgcG9pbnRlciArPSAyO1xuICAgICAgICBjcmVkZW50aWFsSUQgPSBhdXRoRGF0YS5zbGljZShwb2ludGVyLCBwb2ludGVyICs9IGNyZWRJRExlbik7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlZm94IDExNyBpbmNvcnJlY3RseSBDQk9SLWVuY29kZXMgYXV0aERhdGEgd2hlbiBFZERTQSAoLTgpIGlzIHVzZWQgZm9yIHRoZSBwdWJsaWMga2V5LlxuICAgICAgICAgKiBBIENCT1IgXCJNYXAgb2YgMyBpdGVtc1wiICgweGEzKSBzaG91bGQgYmUgXCJNYXAgb2YgNCBpdGVtc1wiICgweGE0KSwgYW5kIGlmIHdlIG1hbnVhbGx5IGFkanVzdFxuICAgICAgICAgKiB0aGUgc2luZ2xlIGJ5dGUgdGhlcmUncyBhIGdvb2QgY2hhbmNlIHRoZSBhdXRoRGF0YSBjYW4gYmUgY29ycmVjdGx5IHBhcnNlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhpcyBicm93c2VyIHJlbGVhc2UgYWxzbyBpbmNvcnJlY3RseSB1c2VzIHRoZSBzdHJpbmcgbGFiZWxzIFwiT0tQXCIgYW5kIFwiRWQyNTUxOVwiIGluc3RlYWQgb2ZcbiAgICAgICAgICogdGhlaXIgaW50ZWdlciByZXByZXNlbnRhdGlvbnMgZm9yIGt0eSBhbmQgY3J2IHJlc3BlY3RpdmVseS4gVGhhdCdzIHdoeSB0aGUgQ09TRSBwdWJsaWMga2V5XG4gICAgICAgICAqIGluIHRoZSBoZXggYmVsb3cgbG9va3Mgc28gb2RkLlxuICAgICAgICAgKi9cbiAgICAgICAgLy8gQnl0ZXMgZGVjb2RlIHRvIGB7IDE6IFwiT0tQXCIsIDM6IC04LCAtMTogXCJFZDI1NTE5XCIgfWAgKGl0J3MgbWlzc2luZyBrZXkgLTIgYS5rLmEuIENPU0VLRVlTLngpXG4gICAgICAgIGNvbnN0IGJhZEVkRFNBQ0JPUiA9IGlzb1VpbnQ4QXJyYXkuZnJvbUhleCgnYTMwMTYzNGY0YjUwMDMyNzIwNjc0NTY0MzIzNTM1MzEzOScpO1xuICAgICAgICBjb25zdCBieXRlc0F0Q3VycmVudFBvc2l0aW9uID0gYXV0aERhdGEuc2xpY2UocG9pbnRlciwgcG9pbnRlciArIGJhZEVkRFNBQ0JPUi5ieXRlTGVuZ3RoKTtcbiAgICAgICAgbGV0IGZvdW5kQmFkQ0JPUiA9IGZhbHNlO1xuICAgICAgICBpZiAoaXNvVWludDhBcnJheS5hcmVFcXVhbChiYWRFZERTQUNCT1IsIGJ5dGVzQXRDdXJyZW50UG9zaXRpb24pKSB7XG4gICAgICAgICAgICAvLyBDaGFuZ2UgdGhlIGJhZCBDQk9SIDB4YTMgdG8gMHhhNCBzbyB0aGF0IHRoZSBjcmVkZW50aWFsIHB1YmxpYyBrZXkgY2FuIGJlIHJlY29nbml6ZWRcbiAgICAgICAgICAgIGZvdW5kQmFkQ0JPUiA9IHRydWU7XG4gICAgICAgICAgICBhdXRoRGF0YVtwb2ludGVyXSA9IDB4YTQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRGVjb2RlIHRoZSBuZXh0IENCT1IgaXRlbSBpbiB0aGUgYnVmZmVyLCB0aGVuIHJlLWVuY29kZSBpdCBiYWNrIHRvIGEgQnVmZmVyXG4gICAgICAgIGNvbnN0IGZpcnN0RGVjb2RlZCA9IGlzb0NCT1IuZGVjb2RlRmlyc3QoYXV0aERhdGEuc2xpY2UocG9pbnRlcikpO1xuICAgICAgICBjb25zdCBmaXJzdEVuY29kZWQgPSBVaW50OEFycmF5LmZyb20oXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYXN0aW5nIHRvIGBNYXBgIHZpYSBgYXMgdW5rbm93bmAgaGVyZSBiZWNhdXNlIFRTIGRvZXNuJ3QgbWFrZSBpdCBwb3NzaWJsZSB0byBkZWZpbmUgTWFwc1xuICAgICAgICAgKiB3aXRoIGRpc2NyZXRlIGtleXMgYW5kIHByb3BlcnRpZXMgd2l0aCBrbm93biB0eXBlcyBwZXIgcGFpciwgYW5kIENCT1IgbGlicyB0eXBpY2FsbHkgcGFyc2VcbiAgICAgICAgICogQ0JPUiBNYWpvciBUeXBlIDUgdG8gYE1hcGAgYmVjYXVzZSB5b3UgY2FuIGhhdmUgbnVtYmVycyBmb3Iga2V5cy4gQSBgQ09TRVB1YmxpY0tleWAgY2FuIGJlXG4gICAgICAgICAqIGdlbmVyYWxpemVkIGFzIFwiYSBNYXAgd2l0aCBudW1iZXJzIGZvciBrZXlzIGFuZCBlaXRoZXIgbnVtYmVycyBvciBieXRlcyBmb3IgdmFsdWVzXCIgdGhvdWdoLlxuICAgICAgICAgKiBJZiB0aGlzIHByZXN1bXB0aW9uIGZhbGxzIGFwYXJ0IHRoZW4gb3RoZXIgcGFydHMgb2YgdmVyaWZpY2F0aW9uIGxhdGVyIG9uIHdpbGwgZmFpbCBzbyB3ZVxuICAgICAgICAgKiBzaG91bGQgYmUgc2FmZSBkb2luZyB0aGlzIGhlcmUuXG4gICAgICAgICAqL1xuICAgICAgICBpc29DQk9SLmVuY29kZShmaXJzdERlY29kZWQpKTtcbiAgICAgICAgaWYgKGZvdW5kQmFkQ0JPUikge1xuICAgICAgICAgICAgLy8gUmVzdG9yZSB0aGUgYml0IHdlIGNoYW5nZWQgc28gdGhhdCBgYXV0aERhdGFgIGlzIHRoZSBzYW1lIGFzIGl0IGNhbWUgaW4gYW5kIHdvbid0IGJyZWFrXG4gICAgICAgICAgICAvLyBzaWduYXR1cmUgdmVyaWZpY2F0aW9uLlxuICAgICAgICAgICAgYXV0aERhdGFbcG9pbnRlcl0gPSAweGEzO1xuICAgICAgICB9XG4gICAgICAgIGNyZWRlbnRpYWxQdWJsaWNLZXkgPSBmaXJzdEVuY29kZWQ7XG4gICAgICAgIHBvaW50ZXIgKz0gZmlyc3RFbmNvZGVkLmJ5dGVMZW5ndGg7XG4gICAgfVxuICAgIGxldCBleHRlbnNpb25zRGF0YSA9IHVuZGVmaW5lZDtcbiAgICBsZXQgZXh0ZW5zaW9uc0RhdGFCdWZmZXIgPSB1bmRlZmluZWQ7XG4gICAgaWYgKGZsYWdzLmVkKSB7XG4gICAgICAgIGNvbnN0IGZpcnN0RGVjb2RlZCA9IGlzb0NCT1IuZGVjb2RlRmlyc3QoYXV0aERhdGEuc2xpY2UocG9pbnRlcikpO1xuICAgICAgICBleHRlbnNpb25zRGF0YUJ1ZmZlciA9IFVpbnQ4QXJyYXkuZnJvbShpc29DQk9SLmVuY29kZShmaXJzdERlY29kZWQpKTtcbiAgICAgICAgZXh0ZW5zaW9uc0RhdGEgPSBkZWNvZGVBdXRoZW50aWNhdG9yRXh0ZW5zaW9ucyhleHRlbnNpb25zRGF0YUJ1ZmZlcik7XG4gICAgICAgIHBvaW50ZXIgKz0gZXh0ZW5zaW9uc0RhdGFCdWZmZXIuYnl0ZUxlbmd0aDtcbiAgICB9XG4gICAgLy8gUG9pbnRlciBzaG91bGQgYmUgYXQgdGhlIGVuZCBvZiB0aGUgYXV0aGVudGljYXRvciBkYXRhLCBvdGhlcndpc2UgdG9vIG11Y2ggZGF0YSB3YXMgc2VudFxuICAgIGlmIChhdXRoRGF0YS5ieXRlTGVuZ3RoID4gcG9pbnRlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xlZnRvdmVyIGJ5dGVzIGRldGVjdGVkIHdoaWxlIHBhcnNpbmcgYXV0aGVudGljYXRvciBkYXRhJyk7XG4gICAgfVxuICAgIHJldHVybiBfcGFyc2VBdXRoZW50aWNhdG9yRGF0YUludGVybmFscy5zdHViVGhpcyh7XG4gICAgICAgIHJwSWRIYXNoLFxuICAgICAgICBmbGFnc0J1ZixcbiAgICAgICAgZmxhZ3MsXG4gICAgICAgIGNvdW50ZXIsXG4gICAgICAgIGNvdW50ZXJCdWYsXG4gICAgICAgIGFhZ3VpZCxcbiAgICAgICAgY3JlZGVudGlhbElELFxuICAgICAgICBjcmVkZW50aWFsUHVibGljS2V5LFxuICAgICAgICBleHRlbnNpb25zRGF0YSxcbiAgICAgICAgZXh0ZW5zaW9uc0RhdGFCdWZmZXIsXG4gICAgfSk7XG59XG4vLyBNYWtlIGl0IHBvc3NpYmxlIHRvIHN0dWIgdGhlIHJldHVybiB2YWx1ZSBkdXJpbmcgdGVzdGluZ1xuZXhwb3J0IGNvbnN0IF9wYXJzZUF1dGhlbnRpY2F0b3JEYXRhSW50ZXJuYWxzID0ge1xuICAgIHN0dWJUaGlzOiAodmFsdWUpID0+IHZhbHVlLFxufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseAuthenticatorData.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseBackupFlags.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/parseBackupFlags.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InvalidBackupFlags: () => (/* binding */ InvalidBackupFlags),\n/* harmony export */   parseBackupFlags: () => (/* binding */ parseBackupFlags)\n/* harmony export */ });\n/**\n * Make sense of Bits 3 and 4 in authenticator indicating:\n *\n * - Whether the credential can be used on multiple devices\n * - Whether the credential is backed up or not\n *\n * Invalid configurations will raise an `Error`\n */\nfunction parseBackupFlags({ be, bs }) {\n    const credentialBackedUp = bs;\n    let credentialDeviceType = 'singleDevice';\n    if (be) {\n        credentialDeviceType = 'multiDevice';\n    }\n    if (credentialDeviceType === 'singleDevice' && credentialBackedUp) {\n        throw new InvalidBackupFlags('Single-device credential indicated that it was backed up, which should be impossible.');\n    }\n    return { credentialDeviceType, credentialBackedUp };\n}\nclass InvalidBackupFlags extends Error {\n    constructor(message) {\n        super(message);\n        this.name = 'InvalidBackupFlags';\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy9wYXJzZUJhY2t1cEZsYWdzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLDRCQUE0QixRQUFRO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFxwYXJzZUJhY2t1cEZsYWdzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTWFrZSBzZW5zZSBvZiBCaXRzIDMgYW5kIDQgaW4gYXV0aGVudGljYXRvciBpbmRpY2F0aW5nOlxuICpcbiAqIC0gV2hldGhlciB0aGUgY3JlZGVudGlhbCBjYW4gYmUgdXNlZCBvbiBtdWx0aXBsZSBkZXZpY2VzXG4gKiAtIFdoZXRoZXIgdGhlIGNyZWRlbnRpYWwgaXMgYmFja2VkIHVwIG9yIG5vdFxuICpcbiAqIEludmFsaWQgY29uZmlndXJhdGlvbnMgd2lsbCByYWlzZSBhbiBgRXJyb3JgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUJhY2t1cEZsYWdzKHsgYmUsIGJzIH0pIHtcbiAgICBjb25zdCBjcmVkZW50aWFsQmFja2VkVXAgPSBicztcbiAgICBsZXQgY3JlZGVudGlhbERldmljZVR5cGUgPSAnc2luZ2xlRGV2aWNlJztcbiAgICBpZiAoYmUpIHtcbiAgICAgICAgY3JlZGVudGlhbERldmljZVR5cGUgPSAnbXVsdGlEZXZpY2UnO1xuICAgIH1cbiAgICBpZiAoY3JlZGVudGlhbERldmljZVR5cGUgPT09ICdzaW5nbGVEZXZpY2UnICYmIGNyZWRlbnRpYWxCYWNrZWRVcCkge1xuICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEJhY2t1cEZsYWdzKCdTaW5nbGUtZGV2aWNlIGNyZWRlbnRpYWwgaW5kaWNhdGVkIHRoYXQgaXQgd2FzIGJhY2tlZCB1cCwgd2hpY2ggc2hvdWxkIGJlIGltcG9zc2libGUuJyk7XG4gICAgfVxuICAgIHJldHVybiB7IGNyZWRlbnRpYWxEZXZpY2VUeXBlLCBjcmVkZW50aWFsQmFja2VkVXAgfTtcbn1cbmV4cG9ydCBjbGFzcyBJbnZhbGlkQmFja3VwRmxhZ3MgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gJ0ludmFsaWRCYWNrdXBGbGFncyc7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseBackupFlags.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/toHash.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   toHash: () => (/* binding */ toHash)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Returns hash digest of the given data, using the given algorithm when provided. Defaults to using\n * SHA-256.\n */\nfunction toHash(data, algorithm = -7) {\n    if (typeof data === 'string') {\n        data = _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoUint8Array.fromUTF8String(data);\n    }\n    const digest = _iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoCrypto.digest(data, algorithm);\n    return digest;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy90b0hhc2guanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBMEQ7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0EsZUFBZSx1RUFBNEI7QUFDM0M7QUFDQSxtQkFBbUIsMkRBQWdCO0FBQ25DO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxoZWxwZXJzXFx0b0hhc2guanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNvQ3J5cHRvLCBpc29VaW50OEFycmF5IH0gZnJvbSAnLi9pc28vaW5kZXguanMnO1xuLyoqXG4gKiBSZXR1cm5zIGhhc2ggZGlnZXN0IG9mIHRoZSBnaXZlbiBkYXRhLCB1c2luZyB0aGUgZ2l2ZW4gYWxnb3JpdGhtIHdoZW4gcHJvdmlkZWQuIERlZmF1bHRzIHRvIHVzaW5nXG4gKiBTSEEtMjU2LlxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9IYXNoKGRhdGEsIGFsZ29yaXRobSA9IC03KSB7XG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgICBkYXRhID0gaXNvVWludDhBcnJheS5mcm9tVVRGOFN0cmluZyhkYXRhKTtcbiAgICB9XG4gICAgY29uc3QgZGlnZXN0ID0gaXNvQ3J5cHRvLmRpZ2VzdChkYXRhLCBhbGdvcml0aG0pO1xuICAgIHJldHVybiBkaWdlc3Q7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   validateCertificatePath: () => (/* binding */ validateCertificatePath)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n/* harmony import */ var _isCertRevoked_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./isCertRevoked.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/isCertRevoked.js\");\n/* harmony import */ var _verifySignature_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./verifySignature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\");\n/* harmony import */ var _mapX509SignatureAlgToCOSEAlg_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mapX509SignatureAlgToCOSEAlg.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/mapX509SignatureAlgToCOSEAlg.js\");\n/* harmony import */ var _getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./getCertificateInfo.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/getCertificateInfo.js\");\n/* harmony import */ var _convertPEMToBytes_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./convertPEMToBytes.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertPEMToBytes.js\");\n\n\n\n\n\n\n/**\n * Traverse an array of PEM certificates and ensure they form a proper chain\n * @param certificates Typically the result of `x5c.map(convertASN1toPEM)`\n * @param rootCertificates Possible root certificates to complete the path\n */\nasync function validateCertificatePath(certificates, rootCertificates = []) {\n    if (rootCertificates.length === 0) {\n        // We have no root certs with which to create a full path, so skip path validation\n        // TODO: Is this going to be acceptable default behavior??\n        return true;\n    }\n    let invalidSubjectAndIssuerError = false;\n    let certificateNotYetValidOrExpiredErrorMessage = undefined;\n    for (const rootCert of rootCertificates) {\n        try {\n            const certsWithRoot = certificates.concat([rootCert]);\n            await _validatePath(certsWithRoot);\n            // If we successfully validated a path then there's no need to continue. Reset any existing\n            // errors that were thrown by earlier root certificates\n            invalidSubjectAndIssuerError = false;\n            certificateNotYetValidOrExpiredErrorMessage = undefined;\n            break;\n        }\n        catch (err) {\n            if (err instanceof InvalidSubjectAndIssuer) {\n                invalidSubjectAndIssuerError = true;\n            }\n            else if (err instanceof CertificateNotYetValidOrExpired) {\n                certificateNotYetValidOrExpiredErrorMessage = err.message;\n            }\n            else {\n                throw err;\n            }\n        }\n    }\n    // We tried multiple root certs and none of them worked\n    if (invalidSubjectAndIssuerError) {\n        throw new InvalidSubjectAndIssuer();\n    }\n    else if (certificateNotYetValidOrExpiredErrorMessage) {\n        throw new CertificateNotYetValidOrExpired(certificateNotYetValidOrExpiredErrorMessage);\n    }\n    return true;\n}\nasync function _validatePath(certificates) {\n    if (new Set(certificates).size !== certificates.length) {\n        throw new Error('Invalid certificate path: found duplicate certificates');\n    }\n    // From leaf to root, make sure each cert is issued by the next certificate in the chain\n    for (let i = 0; i < certificates.length; i += 1) {\n        const subjectPem = certificates[i];\n        const isLeafCert = i === 0;\n        const isRootCert = i + 1 >= certificates.length;\n        let issuerPem = '';\n        if (isRootCert) {\n            issuerPem = subjectPem;\n        }\n        else {\n            issuerPem = certificates[i + 1];\n        }\n        const subjectInfo = (0,_getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_4__.getCertificateInfo)((0,_convertPEMToBytes_js__WEBPACK_IMPORTED_MODULE_5__.convertPEMToBytes)(subjectPem));\n        const issuerInfo = (0,_getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_4__.getCertificateInfo)((0,_convertPEMToBytes_js__WEBPACK_IMPORTED_MODULE_5__.convertPEMToBytes)(issuerPem));\n        const x509Subject = subjectInfo.parsedCertificate;\n        // Check for certificate revocation\n        const subjectCertRevoked = await (0,_isCertRevoked_js__WEBPACK_IMPORTED_MODULE_1__.isCertRevoked)(x509Subject);\n        if (subjectCertRevoked) {\n            throw new Error(`Found revoked certificate in certificate path`);\n        }\n        // Check that intermediate certificate is within its valid time window\n        const { notBefore, notAfter } = issuerInfo;\n        const now = new Date(Date.now());\n        if (notBefore > now || notAfter < now) {\n            if (isLeafCert) {\n                throw new CertificateNotYetValidOrExpired(`Leaf certificate is not yet valid or expired: ${issuerPem}`);\n            }\n            else if (isRootCert) {\n                throw new CertificateNotYetValidOrExpired(`Root certificate is not yet valid or expired: ${issuerPem}`);\n            }\n            else {\n                throw new CertificateNotYetValidOrExpired(`Intermediate certificate is not yet valid or expired: ${issuerPem}`);\n            }\n        }\n        if (subjectInfo.issuer.combined !== issuerInfo.subject.combined) {\n            throw new InvalidSubjectAndIssuer();\n        }\n        // Verify the subject certificate's signature with the issuer cert's public key\n        const data = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnSerializer.serialize(x509Subject.tbsCertificate);\n        const signature = x509Subject.signatureValue;\n        const signatureAlgorithm = (0,_mapX509SignatureAlgToCOSEAlg_js__WEBPACK_IMPORTED_MODULE_3__.mapX509SignatureAlgToCOSEAlg)(x509Subject.signatureAlgorithm.algorithm);\n        const issuerCertBytes = (0,_convertPEMToBytes_js__WEBPACK_IMPORTED_MODULE_5__.convertPEMToBytes)(issuerPem);\n        const verified = await (0,_verifySignature_js__WEBPACK_IMPORTED_MODULE_2__.verifySignature)({\n            data: new Uint8Array(data),\n            signature: new Uint8Array(signature),\n            x509Certificate: issuerCertBytes,\n            hashAlgorithm: signatureAlgorithm,\n        });\n        if (!verified) {\n            throw new Error('Invalid certificate path: invalid signature');\n        }\n    }\n    return true;\n}\n// Custom errors to help pass on certain errors\nclass InvalidSubjectAndIssuer extends Error {\n    constructor() {\n        const message = 'Subject issuer did not match issuer subject';\n        super(message);\n        this.name = 'InvalidSubjectAndIssuer';\n    }\n}\nclass CertificateNotYetValidOrExpired extends Error {\n    constructor(message) {\n        super(message);\n        this.name = 'CertificateNotYetValidOrExpired';\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy92YWxpZGF0ZUNlcnRpZmljYXRlUGF0aC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQTJDO0FBQ1E7QUFDSTtBQUMwQjtBQUNwQjtBQUNGO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHlCQUF5QjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwwRUFBa0IsQ0FBQyx3RUFBaUI7QUFDaEUsMkJBQTJCLDBFQUFrQixDQUFDLHdFQUFpQjtBQUMvRDtBQUNBO0FBQ0EseUNBQXlDLGdFQUFhO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHNCQUFzQjtBQUN0QztBQUNBO0FBQ0E7QUFDQSwyR0FBMkcsVUFBVTtBQUNySDtBQUNBO0FBQ0EsMkdBQTJHLFVBQVU7QUFDckg7QUFDQTtBQUNBLG1IQUFtSCxVQUFVO0FBQzdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixtREFBYTtBQUNsQztBQUNBLG1DQUFtQyw4RkFBNEI7QUFDL0QsZ0NBQWdDLHdFQUFpQjtBQUNqRCwrQkFBK0Isb0VBQWU7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGhlbHBlcnNcXHZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzblNlcmlhbGl6ZXIgfSBmcm9tICcuLi9kZXBzLmpzJztcbmltcG9ydCB7IGlzQ2VydFJldm9rZWQgfSBmcm9tICcuL2lzQ2VydFJldm9rZWQuanMnO1xuaW1wb3J0IHsgdmVyaWZ5U2lnbmF0dXJlIH0gZnJvbSAnLi92ZXJpZnlTaWduYXR1cmUuanMnO1xuaW1wb3J0IHsgbWFwWDUwOVNpZ25hdHVyZUFsZ1RvQ09TRUFsZyB9IGZyb20gJy4vbWFwWDUwOVNpZ25hdHVyZUFsZ1RvQ09TRUFsZy5qcyc7XG5pbXBvcnQgeyBnZXRDZXJ0aWZpY2F0ZUluZm8gfSBmcm9tICcuL2dldENlcnRpZmljYXRlSW5mby5qcyc7XG5pbXBvcnQgeyBjb252ZXJ0UEVNVG9CeXRlcyB9IGZyb20gJy4vY29udmVydFBFTVRvQnl0ZXMuanMnO1xuLyoqXG4gKiBUcmF2ZXJzZSBhbiBhcnJheSBvZiBQRU0gY2VydGlmaWNhdGVzIGFuZCBlbnN1cmUgdGhleSBmb3JtIGEgcHJvcGVyIGNoYWluXG4gKiBAcGFyYW0gY2VydGlmaWNhdGVzIFR5cGljYWxseSB0aGUgcmVzdWx0IG9mIGB4NWMubWFwKGNvbnZlcnRBU04xdG9QRU0pYFxuICogQHBhcmFtIHJvb3RDZXJ0aWZpY2F0ZXMgUG9zc2libGUgcm9vdCBjZXJ0aWZpY2F0ZXMgdG8gY29tcGxldGUgdGhlIHBhdGhcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoKGNlcnRpZmljYXRlcywgcm9vdENlcnRpZmljYXRlcyA9IFtdKSB7XG4gICAgaWYgKHJvb3RDZXJ0aWZpY2F0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIC8vIFdlIGhhdmUgbm8gcm9vdCBjZXJ0cyB3aXRoIHdoaWNoIHRvIGNyZWF0ZSBhIGZ1bGwgcGF0aCwgc28gc2tpcCBwYXRoIHZhbGlkYXRpb25cbiAgICAgICAgLy8gVE9ETzogSXMgdGhpcyBnb2luZyB0byBiZSBhY2NlcHRhYmxlIGRlZmF1bHQgYmVoYXZpb3I/P1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgbGV0IGludmFsaWRTdWJqZWN0QW5kSXNzdWVyRXJyb3IgPSBmYWxzZTtcbiAgICBsZXQgY2VydGlmaWNhdGVOb3RZZXRWYWxpZE9yRXhwaXJlZEVycm9yTWVzc2FnZSA9IHVuZGVmaW5lZDtcbiAgICBmb3IgKGNvbnN0IHJvb3RDZXJ0IG9mIHJvb3RDZXJ0aWZpY2F0ZXMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNlcnRzV2l0aFJvb3QgPSBjZXJ0aWZpY2F0ZXMuY29uY2F0KFtyb290Q2VydF0pO1xuICAgICAgICAgICAgYXdhaXQgX3ZhbGlkYXRlUGF0aChjZXJ0c1dpdGhSb290KTtcbiAgICAgICAgICAgIC8vIElmIHdlIHN1Y2Nlc3NmdWxseSB2YWxpZGF0ZWQgYSBwYXRoIHRoZW4gdGhlcmUncyBubyBuZWVkIHRvIGNvbnRpbnVlLiBSZXNldCBhbnkgZXhpc3RpbmdcbiAgICAgICAgICAgIC8vIGVycm9ycyB0aGF0IHdlcmUgdGhyb3duIGJ5IGVhcmxpZXIgcm9vdCBjZXJ0aWZpY2F0ZXNcbiAgICAgICAgICAgIGludmFsaWRTdWJqZWN0QW5kSXNzdWVyRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIGNlcnRpZmljYXRlTm90WWV0VmFsaWRPckV4cGlyZWRFcnJvck1lc3NhZ2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgSW52YWxpZFN1YmplY3RBbmRJc3N1ZXIpIHtcbiAgICAgICAgICAgICAgICBpbnZhbGlkU3ViamVjdEFuZElzc3VlckVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVyciBpbnN0YW5jZW9mIENlcnRpZmljYXRlTm90WWV0VmFsaWRPckV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZU5vdFlldFZhbGlkT3JFeHBpcmVkRXJyb3JNZXNzYWdlID0gZXJyLm1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gV2UgdHJpZWQgbXVsdGlwbGUgcm9vdCBjZXJ0cyBhbmQgbm9uZSBvZiB0aGVtIHdvcmtlZFxuICAgIGlmIChpbnZhbGlkU3ViamVjdEFuZElzc3VlckVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3ViamVjdEFuZElzc3VlcigpO1xuICAgIH1cbiAgICBlbHNlIGlmIChjZXJ0aWZpY2F0ZU5vdFlldFZhbGlkT3JFeHBpcmVkRXJyb3JNZXNzYWdlKSB7XG4gICAgICAgIHRocm93IG5ldyBDZXJ0aWZpY2F0ZU5vdFlldFZhbGlkT3JFeHBpcmVkKGNlcnRpZmljYXRlTm90WWV0VmFsaWRPckV4cGlyZWRFcnJvck1lc3NhZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmFzeW5jIGZ1bmN0aW9uIF92YWxpZGF0ZVBhdGgoY2VydGlmaWNhdGVzKSB7XG4gICAgaWYgKG5ldyBTZXQoY2VydGlmaWNhdGVzKS5zaXplICE9PSBjZXJ0aWZpY2F0ZXMubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjZXJ0aWZpY2F0ZSBwYXRoOiBmb3VuZCBkdXBsaWNhdGUgY2VydGlmaWNhdGVzJyk7XG4gICAgfVxuICAgIC8vIEZyb20gbGVhZiB0byByb290LCBtYWtlIHN1cmUgZWFjaCBjZXJ0IGlzIGlzc3VlZCBieSB0aGUgbmV4dCBjZXJ0aWZpY2F0ZSBpbiB0aGUgY2hhaW5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNlcnRpZmljYXRlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBzdWJqZWN0UGVtID0gY2VydGlmaWNhdGVzW2ldO1xuICAgICAgICBjb25zdCBpc0xlYWZDZXJ0ID0gaSA9PT0gMDtcbiAgICAgICAgY29uc3QgaXNSb290Q2VydCA9IGkgKyAxID49IGNlcnRpZmljYXRlcy5sZW5ndGg7XG4gICAgICAgIGxldCBpc3N1ZXJQZW0gPSAnJztcbiAgICAgICAgaWYgKGlzUm9vdENlcnQpIHtcbiAgICAgICAgICAgIGlzc3VlclBlbSA9IHN1YmplY3RQZW07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpc3N1ZXJQZW0gPSBjZXJ0aWZpY2F0ZXNbaSArIDFdO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN1YmplY3RJbmZvID0gZ2V0Q2VydGlmaWNhdGVJbmZvKGNvbnZlcnRQRU1Ub0J5dGVzKHN1YmplY3RQZW0pKTtcbiAgICAgICAgY29uc3QgaXNzdWVySW5mbyA9IGdldENlcnRpZmljYXRlSW5mbyhjb252ZXJ0UEVNVG9CeXRlcyhpc3N1ZXJQZW0pKTtcbiAgICAgICAgY29uc3QgeDUwOVN1YmplY3QgPSBzdWJqZWN0SW5mby5wYXJzZWRDZXJ0aWZpY2F0ZTtcbiAgICAgICAgLy8gQ2hlY2sgZm9yIGNlcnRpZmljYXRlIHJldm9jYXRpb25cbiAgICAgICAgY29uc3Qgc3ViamVjdENlcnRSZXZva2VkID0gYXdhaXQgaXNDZXJ0UmV2b2tlZCh4NTA5U3ViamVjdCk7XG4gICAgICAgIGlmIChzdWJqZWN0Q2VydFJldm9rZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRm91bmQgcmV2b2tlZCBjZXJ0aWZpY2F0ZSBpbiBjZXJ0aWZpY2F0ZSBwYXRoYCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2hlY2sgdGhhdCBpbnRlcm1lZGlhdGUgY2VydGlmaWNhdGUgaXMgd2l0aGluIGl0cyB2YWxpZCB0aW1lIHdpbmRvd1xuICAgICAgICBjb25zdCB7IG5vdEJlZm9yZSwgbm90QWZ0ZXIgfSA9IGlzc3VlckluZm87XG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKERhdGUubm93KCkpO1xuICAgICAgICBpZiAobm90QmVmb3JlID4gbm93IHx8IG5vdEFmdGVyIDwgbm93KSB7XG4gICAgICAgICAgICBpZiAoaXNMZWFmQ2VydCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDZXJ0aWZpY2F0ZU5vdFlldFZhbGlkT3JFeHBpcmVkKGBMZWFmIGNlcnRpZmljYXRlIGlzIG5vdCB5ZXQgdmFsaWQgb3IgZXhwaXJlZDogJHtpc3N1ZXJQZW19YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpc1Jvb3RDZXJ0KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IENlcnRpZmljYXRlTm90WWV0VmFsaWRPckV4cGlyZWQoYFJvb3QgY2VydGlmaWNhdGUgaXMgbm90IHlldCB2YWxpZCBvciBleHBpcmVkOiAke2lzc3VlclBlbX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDZXJ0aWZpY2F0ZU5vdFlldFZhbGlkT3JFeHBpcmVkKGBJbnRlcm1lZGlhdGUgY2VydGlmaWNhdGUgaXMgbm90IHlldCB2YWxpZCBvciBleHBpcmVkOiAke2lzc3VlclBlbX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3ViamVjdEluZm8uaXNzdWVyLmNvbWJpbmVkICE9PSBpc3N1ZXJJbmZvLnN1YmplY3QuY29tYmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3ViamVjdEFuZElzc3VlcigpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFZlcmlmeSB0aGUgc3ViamVjdCBjZXJ0aWZpY2F0ZSdzIHNpZ25hdHVyZSB3aXRoIHRoZSBpc3N1ZXIgY2VydCdzIHB1YmxpYyBrZXlcbiAgICAgICAgY29uc3QgZGF0YSA9IEFzblNlcmlhbGl6ZXIuc2VyaWFsaXplKHg1MDlTdWJqZWN0LnRic0NlcnRpZmljYXRlKTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0geDUwOVN1YmplY3Quc2lnbmF0dXJlVmFsdWU7XG4gICAgICAgIGNvbnN0IHNpZ25hdHVyZUFsZ29yaXRobSA9IG1hcFg1MDlTaWduYXR1cmVBbGdUb0NPU0VBbGcoeDUwOVN1YmplY3Quc2lnbmF0dXJlQWxnb3JpdGhtLmFsZ29yaXRobSk7XG4gICAgICAgIGNvbnN0IGlzc3VlckNlcnRCeXRlcyA9IGNvbnZlcnRQRU1Ub0J5dGVzKGlzc3VlclBlbSk7XG4gICAgICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgdmVyaWZ5U2lnbmF0dXJlKHtcbiAgICAgICAgICAgIGRhdGE6IG5ldyBVaW50OEFycmF5KGRhdGEpLFxuICAgICAgICAgICAgc2lnbmF0dXJlOiBuZXcgVWludDhBcnJheShzaWduYXR1cmUpLFxuICAgICAgICAgICAgeDUwOUNlcnRpZmljYXRlOiBpc3N1ZXJDZXJ0Qnl0ZXMsXG4gICAgICAgICAgICBoYXNoQWxnb3JpdGhtOiBzaWduYXR1cmVBbGdvcml0aG0sXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXZlcmlmaWVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY2VydGlmaWNhdGUgcGF0aDogaW52YWxpZCBzaWduYXR1cmUnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbi8vIEN1c3RvbSBlcnJvcnMgdG8gaGVscCBwYXNzIG9uIGNlcnRhaW4gZXJyb3JzXG5jbGFzcyBJbnZhbGlkU3ViamVjdEFuZElzc3VlciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9ICdTdWJqZWN0IGlzc3VlciBkaWQgbm90IG1hdGNoIGlzc3VlciBzdWJqZWN0JztcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubmFtZSA9ICdJbnZhbGlkU3ViamVjdEFuZElzc3Vlcic7XG4gICAgfVxufVxuY2xhc3MgQ2VydGlmaWNhdGVOb3RZZXRWYWxpZE9yRXhwaXJlZCBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLm5hbWUgPSAnQ2VydGlmaWNhdGVOb3RZZXRWYWxpZE9yRXhwaXJlZCc7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   _verifySignatureInternals: () => (/* binding */ _verifySignatureInternals),\n/* harmony export */   verifySignature: () => (/* binding */ verifySignature)\n/* harmony export */ });\n/* harmony import */ var _iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./decodeCredentialPublicKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeCredentialPublicKey.js\");\n/* harmony import */ var _convertX509PublicKeyToCOSE_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./convertX509PublicKeyToCOSE.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertX509PublicKeyToCOSE.js\");\n\n\n\n/**\n * Verify an authenticator's signature\n */\nfunction verifySignature(opts) {\n    const { signature, data, credentialPublicKey, x509Certificate, hashAlgorithm, } = opts;\n    if (!x509Certificate && !credentialPublicKey) {\n        throw new Error('Must declare either \"leafCert\" or \"credentialPublicKey\"');\n    }\n    if (x509Certificate && credentialPublicKey) {\n        throw new Error('Must not declare both \"leafCert\" and \"credentialPublicKey\"');\n    }\n    let cosePublicKey = new Map();\n    if (credentialPublicKey) {\n        cosePublicKey = (0,_decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_1__.decodeCredentialPublicKey)(credentialPublicKey);\n    }\n    else if (x509Certificate) {\n        cosePublicKey = (0,_convertX509PublicKeyToCOSE_js__WEBPACK_IMPORTED_MODULE_2__.convertX509PublicKeyToCOSE)(x509Certificate);\n    }\n    return _verifySignatureInternals.stubThis(_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoCrypto.verify({\n        cosePublicKey,\n        signature,\n        data,\n        shaHashOverride: hashAlgorithm,\n    }));\n}\n// Make it possible to stub the return value during testing\nconst _verifySignatureInternals = {\n    stubThis: (value) => value,\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaGVscGVycy92ZXJpZnlTaWduYXR1cmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkM7QUFDZ0M7QUFDRTtBQUM3RTtBQUNBO0FBQ0E7QUFDTztBQUNQLFlBQVksd0VBQXdFO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0ZBQXlCO0FBQ2pEO0FBQ0E7QUFDQSx3QkFBd0IsMEZBQTBCO0FBQ2xEO0FBQ0EsOENBQThDLDJEQUFnQjtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ087QUFDUDtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcaGVscGVyc1xcdmVyaWZ5U2lnbmF0dXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzb0NyeXB0byB9IGZyb20gJy4vaXNvL2luZGV4LmpzJztcbmltcG9ydCB7IGRlY29kZUNyZWRlbnRpYWxQdWJsaWNLZXkgfSBmcm9tICcuL2RlY29kZUNyZWRlbnRpYWxQdWJsaWNLZXkuanMnO1xuaW1wb3J0IHsgY29udmVydFg1MDlQdWJsaWNLZXlUb0NPU0UgfSBmcm9tICcuL2NvbnZlcnRYNTA5UHVibGljS2V5VG9DT1NFLmpzJztcbi8qKlxuICogVmVyaWZ5IGFuIGF1dGhlbnRpY2F0b3IncyBzaWduYXR1cmVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeVNpZ25hdHVyZShvcHRzKSB7XG4gICAgY29uc3QgeyBzaWduYXR1cmUsIGRhdGEsIGNyZWRlbnRpYWxQdWJsaWNLZXksIHg1MDlDZXJ0aWZpY2F0ZSwgaGFzaEFsZ29yaXRobSwgfSA9IG9wdHM7XG4gICAgaWYgKCF4NTA5Q2VydGlmaWNhdGUgJiYgIWNyZWRlbnRpYWxQdWJsaWNLZXkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IGRlY2xhcmUgZWl0aGVyIFwibGVhZkNlcnRcIiBvciBcImNyZWRlbnRpYWxQdWJsaWNLZXlcIicpO1xuICAgIH1cbiAgICBpZiAoeDUwOUNlcnRpZmljYXRlICYmIGNyZWRlbnRpYWxQdWJsaWNLZXkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IG5vdCBkZWNsYXJlIGJvdGggXCJsZWFmQ2VydFwiIGFuZCBcImNyZWRlbnRpYWxQdWJsaWNLZXlcIicpO1xuICAgIH1cbiAgICBsZXQgY29zZVB1YmxpY0tleSA9IG5ldyBNYXAoKTtcbiAgICBpZiAoY3JlZGVudGlhbFB1YmxpY0tleSkge1xuICAgICAgICBjb3NlUHVibGljS2V5ID0gZGVjb2RlQ3JlZGVudGlhbFB1YmxpY0tleShjcmVkZW50aWFsUHVibGljS2V5KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoeDUwOUNlcnRpZmljYXRlKSB7XG4gICAgICAgIGNvc2VQdWJsaWNLZXkgPSBjb252ZXJ0WDUwOVB1YmxpY0tleVRvQ09TRSh4NTA5Q2VydGlmaWNhdGUpO1xuICAgIH1cbiAgICByZXR1cm4gX3ZlcmlmeVNpZ25hdHVyZUludGVybmFscy5zdHViVGhpcyhpc29DcnlwdG8udmVyaWZ5KHtcbiAgICAgICAgY29zZVB1YmxpY0tleSxcbiAgICAgICAgc2lnbmF0dXJlLFxuICAgICAgICBkYXRhLFxuICAgICAgICBzaGFIYXNoT3ZlcnJpZGU6IGhhc2hBbGdvcml0aG0sXG4gICAgfSkpO1xufVxuLy8gTWFrZSBpdCBwb3NzaWJsZSB0byBzdHViIHRoZSByZXR1cm4gdmFsdWUgZHVyaW5nIHRlc3RpbmdcbmV4cG9ydCBjb25zdCBfdmVyaWZ5U2lnbmF0dXJlSW50ZXJuYWxzID0ge1xuICAgIHN0dWJUaGlzOiAodmFsdWUpID0+IHZhbHVlLFxufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/index.js ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MetadataService: () => (/* reexport safe */ _services_metadataService_js__WEBPACK_IMPORTED_MODULE_4__.MetadataService),\n/* harmony export */   SettingsService: () => (/* reexport safe */ _services_settingsService_js__WEBPACK_IMPORTED_MODULE_5__.SettingsService),\n/* harmony export */   generateAuthenticationOptions: () => (/* reexport safe */ _authentication_generateAuthenticationOptions_js__WEBPACK_IMPORTED_MODULE_2__.generateAuthenticationOptions),\n/* harmony export */   generateRegistrationOptions: () => (/* reexport safe */ _registration_generateRegistrationOptions_js__WEBPACK_IMPORTED_MODULE_0__.generateRegistrationOptions),\n/* harmony export */   verifyAuthenticationResponse: () => (/* reexport safe */ _authentication_verifyAuthenticationResponse_js__WEBPACK_IMPORTED_MODULE_3__.verifyAuthenticationResponse),\n/* harmony export */   verifyRegistrationResponse: () => (/* reexport safe */ _registration_verifyRegistrationResponse_js__WEBPACK_IMPORTED_MODULE_1__.verifyRegistrationResponse)\n/* harmony export */ });\n/* harmony import */ var _registration_generateRegistrationOptions_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registration/generateRegistrationOptions.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/generateRegistrationOptions.js\");\n/* harmony import */ var _registration_verifyRegistrationResponse_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./registration/verifyRegistrationResponse.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifyRegistrationResponse.js\");\n/* harmony import */ var _authentication_generateAuthenticationOptions_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./authentication/generateAuthenticationOptions.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/authentication/generateAuthenticationOptions.js\");\n/* harmony import */ var _authentication_verifyAuthenticationResponse_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./authentication/verifyAuthenticationResponse.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/authentication/verifyAuthenticationResponse.js\");\n/* harmony import */ var _services_metadataService_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./services/metadataService.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/metadataService.js\");\n/* harmony import */ var _services_settingsService_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./services/settingsService.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/settingsService.js\");\n/**\n * @packageDocumentation\n * @module @simplewebauthn/server\n */\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDNEY7QUFDRjtBQUNRO0FBQ0Y7QUFDaEM7QUFDQTtBQUNtRyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXGluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQHBhY2thZ2VEb2N1bWVudGF0aW9uXG4gKiBAbW9kdWxlIEBzaW1wbGV3ZWJhdXRobi9zZXJ2ZXJcbiAqL1xuaW1wb3J0IHsgZ2VuZXJhdGVSZWdpc3RyYXRpb25PcHRpb25zIH0gZnJvbSAnLi9yZWdpc3RyYXRpb24vZ2VuZXJhdGVSZWdpc3RyYXRpb25PcHRpb25zLmpzJztcbmltcG9ydCB7IHZlcmlmeVJlZ2lzdHJhdGlvblJlc3BvbnNlIH0gZnJvbSAnLi9yZWdpc3RyYXRpb24vdmVyaWZ5UmVnaXN0cmF0aW9uUmVzcG9uc2UuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVBdXRoZW50aWNhdGlvbk9wdGlvbnMgfSBmcm9tICcuL2F1dGhlbnRpY2F0aW9uL2dlbmVyYXRlQXV0aGVudGljYXRpb25PcHRpb25zLmpzJztcbmltcG9ydCB7IHZlcmlmeUF1dGhlbnRpY2F0aW9uUmVzcG9uc2UgfSBmcm9tICcuL2F1dGhlbnRpY2F0aW9uL3ZlcmlmeUF1dGhlbnRpY2F0aW9uUmVzcG9uc2UuanMnO1xuaW1wb3J0IHsgTWV0YWRhdGFTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9tZXRhZGF0YVNlcnZpY2UuanMnO1xuaW1wb3J0IHsgU2V0dGluZ3NTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9zZXR0aW5nc1NlcnZpY2UuanMnO1xuZXhwb3J0IHsgZ2VuZXJhdGVBdXRoZW50aWNhdGlvbk9wdGlvbnMsIGdlbmVyYXRlUmVnaXN0cmF0aW9uT3B0aW9ucywgTWV0YWRhdGFTZXJ2aWNlLCBTZXR0aW5nc1NlcnZpY2UsIHZlcmlmeUF1dGhlbnRpY2F0aW9uUmVzcG9uc2UsIHZlcmlmeVJlZ2lzdHJhdGlvblJlc3BvbnNlLCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/parseJWT.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/metadata/parseJWT.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseJWT: () => (/* binding */ parseJWT)\n/* harmony export */ });\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n/**\n * Process a JWT into Javascript-friendly data structures\n */\nfunction parseJWT(jwt) {\n    const parts = jwt.split('.');\n    return [\n        JSON.parse(_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.toUTF8String(parts[0])),\n        JSON.parse(_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_0__.isoBase64URL.toUTF8String(parts[1])),\n        parts[2],\n    ];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vbWV0YWRhdGEvcGFyc2VKV1QuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBdUQ7QUFDdkQ7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EsbUJBQW1CLDRFQUF5QjtBQUM1QyxtQkFBbUIsNEVBQXlCO0FBQzVDO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXG1ldGFkYXRhXFxwYXJzZUpXVC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc29CYXNlNjRVUkwgfSBmcm9tICcuLi9oZWxwZXJzL2lzby9pbmRleC5qcyc7XG4vKipcbiAqIFByb2Nlc3MgYSBKV1QgaW50byBKYXZhc2NyaXB0LWZyaWVuZGx5IGRhdGEgc3RydWN0dXJlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKV1Qoand0KSB7XG4gICAgY29uc3QgcGFydHMgPSBqd3Quc3BsaXQoJy4nKTtcbiAgICByZXR1cm4gW1xuICAgICAgICBKU09OLnBhcnNlKGlzb0Jhc2U2NFVSTC50b1VURjhTdHJpbmcocGFydHNbMF0pKSxcbiAgICAgICAgSlNPTi5wYXJzZShpc29CYXNlNjRVUkwudG9VVEY4U3RyaW5nKHBhcnRzWzFdKSksXG4gICAgICAgIHBhcnRzWzJdLFxuICAgIF07XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/parseJWT.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyAttestationWithMetadata.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/metadata/verifyAttestationWithMetadata.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   algSignToCOSEInfoMap: () => (/* binding */ algSignToCOSEInfoMap),\n/* harmony export */   verifyAttestationWithMetadata: () => (/* binding */ verifyAttestationWithMetadata)\n/* harmony export */ });\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _helpers_decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/decodeCredentialPublicKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeCredentialPublicKey.js\");\n/* harmony import */ var _helpers_cose_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../helpers/cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n\n\n\n\n/**\n * Match properties of the authenticator's attestation statement against expected values as\n * registered with the FIDO Alliance Metadata Service\n */\nasync function verifyAttestationWithMetadata({ statement, credentialPublicKey, x5c, attestationStatementAlg, }) {\n    const { authenticationAlgorithms, authenticatorGetInfo, attestationRootCertificates, } = statement;\n    // Make sure the alg in the attestation statement matches one of the ones specified in metadata\n    const keypairCOSEAlgs = new Set();\n    authenticationAlgorithms.forEach((algSign) => {\n        // Map algSign string to { kty, alg, crv }\n        const algSignCOSEINFO = algSignToCOSEInfoMap[algSign];\n        // Keeping this statement here just in case MDS returns something unexpected\n        if (algSignCOSEINFO) {\n            keypairCOSEAlgs.add(algSignCOSEINFO);\n        }\n    });\n    // Extract the public key's COSE info for comparison\n    const decodedPublicKey = (0,_helpers_decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_2__.decodeCredentialPublicKey)(credentialPublicKey);\n    const kty = decodedPublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_3__.COSEKEYS.kty);\n    const alg = decodedPublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_3__.COSEKEYS.alg);\n    if (!kty) {\n        throw new Error('Credential public key was missing kty');\n    }\n    if (!alg) {\n        throw new Error('Credential public key was missing alg');\n    }\n    if (!kty) {\n        throw new Error('Credential public key was missing kty');\n    }\n    // Assume everything is a number because these values should be\n    const publicKeyCOSEInfo = { kty, alg };\n    if ((0,_helpers_cose_js__WEBPACK_IMPORTED_MODULE_3__.isCOSEPublicKeyEC2)(decodedPublicKey)) {\n        const crv = decodedPublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_3__.COSEKEYS.crv);\n        publicKeyCOSEInfo.crv = crv;\n    }\n    /**\n     * Attempt to match the credential public key's algorithm to one specified in the device's\n     * metadata\n     */\n    let foundMatch = false;\n    for (const keypairAlg of keypairCOSEAlgs) {\n        // Make sure algorithm and key type match\n        if (keypairAlg.alg === publicKeyCOSEInfo.alg &&\n            keypairAlg.kty === publicKeyCOSEInfo.kty) {\n            // If not an RSA keypair then make sure curve numbers match too\n            if ((keypairAlg.kty === _helpers_cose_js__WEBPACK_IMPORTED_MODULE_3__.COSEKTY.EC2 || keypairAlg.kty === _helpers_cose_js__WEBPACK_IMPORTED_MODULE_3__.COSEKTY.OKP) &&\n                keypairAlg.crv === publicKeyCOSEInfo.crv) {\n                foundMatch = true;\n            }\n            else {\n                // We've matched an RSA public key's properties\n                foundMatch = true;\n            }\n        }\n        if (foundMatch) {\n            break;\n        }\n    }\n    // Make sure the public key is one of the allowed algorithms\n    if (!foundMatch) {\n        /**\n         * Craft some useful error output from the MDS algorithms\n         *\n         * Example:\n         *\n         * ```\n         * [\n         *   'rsassa_pss_sha256_raw' (COSE info: { kty: 3, alg: -37 }),\n         *   'secp256k1_ecdsa_sha256_raw' (COSE info: { kty: 2, alg: -47, crv: 8 })\n         * ]\n         * ```\n         */\n        const debugMDSAlgs = authenticationAlgorithms.map((algSign) => `'${algSign}' (COSE info: ${stringifyCOSEInfo(algSignToCOSEInfoMap[algSign])})`);\n        const strMDSAlgs = JSON.stringify(debugMDSAlgs, null, 2).replace(/\"/g, '');\n        /**\n         * Construct useful error output about the public key\n         */\n        const strPubKeyAlg = stringifyCOSEInfo(publicKeyCOSEInfo);\n        throw new Error(`Public key parameters ${strPubKeyAlg} did not match any of the following metadata algorithms:\\n${strMDSAlgs}`);\n    }\n    /**\n     * Confirm the attestation statement's algorithm is one supported according to metadata\n     */\n    if (attestationStatementAlg !== undefined &&\n        authenticatorGetInfo?.algorithms !== undefined) {\n        const getInfoAlgs = authenticatorGetInfo.algorithms.map((_alg) => _alg.alg);\n        if (getInfoAlgs.indexOf(attestationStatementAlg) < 0) {\n            throw new Error(`Attestation statement alg ${attestationStatementAlg} did not match one of ${getInfoAlgs}`);\n        }\n    }\n    // Prepare to check the certificate chain\n    const authenticatorCerts = x5c.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_0__.convertCertBufferToPEM);\n    const statementRootCerts = attestationRootCertificates.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_0__.convertCertBufferToPEM);\n    /**\n     * If an authenticator returns exactly one certificate in its x5c, and that cert is found in the\n     * metadata statement then the authenticator is \"self-referencing\". In this case we forego\n     * certificate chain validation.\n     */\n    let authenticatorIsSelfReferencing = false;\n    if (authenticatorCerts.length === 1 &&\n        statementRootCerts.indexOf(authenticatorCerts[0]) >= 0) {\n        authenticatorIsSelfReferencing = true;\n    }\n    if (!authenticatorIsSelfReferencing) {\n        try {\n            await (0,_helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_1__.validateCertificatePath)(authenticatorCerts, statementRootCerts);\n        }\n        catch (err) {\n            const _err = err;\n            throw new Error(`Could not validate certificate path with any metadata root certificates: ${_err.message}`);\n        }\n    }\n    return true;\n}\n/**\n * Convert ALG_SIGN values to COSE info\n *\n * Values pulled from `ALG_KEY_COSE` definitions in the FIDO Registry of Predefined Values\n *\n * https://fidoalliance.org/specs/common-specs/fido-registry-v2.2-ps-20220523.html#authentication-algorithms\n */\nconst algSignToCOSEInfoMap = {\n    secp256r1_ecdsa_sha256_raw: { kty: 2, alg: -7, crv: 1 },\n    secp256r1_ecdsa_sha256_der: { kty: 2, alg: -7, crv: 1 },\n    rsassa_pss_sha256_raw: { kty: 3, alg: -37 },\n    rsassa_pss_sha256_der: { kty: 3, alg: -37 },\n    secp256k1_ecdsa_sha256_raw: { kty: 2, alg: -47, crv: 8 },\n    secp256k1_ecdsa_sha256_der: { kty: 2, alg: -47, crv: 8 },\n    rsassa_pss_sha384_raw: { kty: 3, alg: -38 },\n    rsassa_pkcsv15_sha256_raw: { kty: 3, alg: -257 },\n    rsassa_pkcsv15_sha384_raw: { kty: 3, alg: -258 },\n    rsassa_pkcsv15_sha512_raw: { kty: 3, alg: -259 },\n    rsassa_pkcsv15_sha1_raw: { kty: 3, alg: -65535 },\n    secp384r1_ecdsa_sha384_raw: { kty: 2, alg: -35, crv: 2 },\n    secp512r1_ecdsa_sha256_raw: { kty: 2, alg: -36, crv: 3 },\n    ed25519_eddsa_sha512_raw: { kty: 1, alg: -8, crv: 6 },\n};\n/**\n * A helper to format COSEInfo a little nicer than we can achieve with JSON.stringify()\n *\n * Input: `{ \"kty\": 3, \"alg\": -257 }`\n *\n * Output: `\"{ kty: 3, alg: -257 }\"`\n */\nfunction stringifyCOSEInfo(info) {\n    const { kty, alg, crv } = info;\n    let toReturn = '';\n    if (kty !== _helpers_cose_js__WEBPACK_IMPORTED_MODULE_3__.COSEKTY.RSA) {\n        toReturn = `{ kty: ${kty}, alg: ${alg}, crv: ${crv} }`;\n    }\n    else {\n        toReturn = `{ kty: ${kty}, alg: ${alg} }`;\n    }\n    return toReturn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vbWV0YWRhdGEvdmVyaWZ5QXR0ZXN0YXRpb25XaXRoTWV0YWRhdGEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQThFO0FBQ0U7QUFDSTtBQUNUO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ08sK0NBQStDLCtEQUErRDtBQUNySCxZQUFZLCtFQUErRTtBQUMzRjtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDZCQUE2QixnR0FBeUI7QUFDdEQscUNBQXFDLHNEQUFRO0FBQzdDLHFDQUFxQyxzREFBUTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQyxRQUFRLG9FQUFrQjtBQUMxQix5Q0FBeUMsc0RBQVE7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLHFEQUFPLDJCQUEyQixxREFBTztBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsa0JBQWtCO0FBQ3JFLHdEQUF3RCwwQkFBMEI7QUFDbEY7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLFFBQVEsZ0JBQWdCLGlEQUFpRDtBQUNwSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELGNBQWMsMkRBQTJELFdBQVc7QUFDckk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCx5QkFBeUIsdUJBQXVCLFlBQVk7QUFDckg7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLHNGQUFzQjtBQUM3RCwrREFBK0Qsc0ZBQXNCO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw0RkFBdUI7QUFDekM7QUFDQTtBQUNBO0FBQ0Esd0dBQXdHLGFBQWE7QUFDckg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1Asa0NBQWtDLHlCQUF5QjtBQUMzRCxrQ0FBa0MseUJBQXlCO0FBQzNELDZCQUE2QixrQkFBa0I7QUFDL0MsNkJBQTZCLGtCQUFrQjtBQUMvQyxrQ0FBa0MsMEJBQTBCO0FBQzVELGtDQUFrQywwQkFBMEI7QUFDNUQsNkJBQTZCLGtCQUFrQjtBQUMvQyxpQ0FBaUMsbUJBQW1CO0FBQ3BELGlDQUFpQyxtQkFBbUI7QUFDcEQsaUNBQWlDLG1CQUFtQjtBQUNwRCwrQkFBK0IscUJBQXFCO0FBQ3BELGtDQUFrQywwQkFBMEI7QUFDNUQsa0NBQWtDLDBCQUEwQjtBQUM1RCxnQ0FBZ0MseUJBQXlCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1QkFBdUI7QUFDcEM7QUFDQSxlQUFlLG1CQUFtQjtBQUNsQztBQUNBO0FBQ0EsWUFBWSxnQkFBZ0I7QUFDNUI7QUFDQSxnQkFBZ0IscURBQU87QUFDdkIsc0JBQXNCLE9BQU8sSUFBSSxTQUFTLElBQUksU0FBUyxNQUFNO0FBQzdEO0FBQ0E7QUFDQSxzQkFBc0IsT0FBTyxJQUFJLFNBQVMsTUFBTTtBQUNoRDtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxtZXRhZGF0YVxcdmVyaWZ5QXR0ZXN0YXRpb25XaXRoTWV0YWRhdGEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29udmVydENlcnRCdWZmZXJUb1BFTSB9IGZyb20gJy4uL2hlbHBlcnMvY29udmVydENlcnRCdWZmZXJUb1BFTS5qcyc7XG5pbXBvcnQgeyB2YWxpZGF0ZUNlcnRpZmljYXRlUGF0aCB9IGZyb20gJy4uL2hlbHBlcnMvdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGguanMnO1xuaW1wb3J0IHsgZGVjb2RlQ3JlZGVudGlhbFB1YmxpY0tleSB9IGZyb20gJy4uL2hlbHBlcnMvZGVjb2RlQ3JlZGVudGlhbFB1YmxpY0tleS5qcyc7XG5pbXBvcnQgeyBDT1NFS0VZUywgQ09TRUtUWSwgaXNDT1NFUHVibGljS2V5RUMyIH0gZnJvbSAnLi4vaGVscGVycy9jb3NlLmpzJztcbi8qKlxuICogTWF0Y2ggcHJvcGVydGllcyBvZiB0aGUgYXV0aGVudGljYXRvcidzIGF0dGVzdGF0aW9uIHN0YXRlbWVudCBhZ2FpbnN0IGV4cGVjdGVkIHZhbHVlcyBhc1xuICogcmVnaXN0ZXJlZCB3aXRoIHRoZSBGSURPIEFsbGlhbmNlIE1ldGFkYXRhIFNlcnZpY2VcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUF0dGVzdGF0aW9uV2l0aE1ldGFkYXRhKHsgc3RhdGVtZW50LCBjcmVkZW50aWFsUHVibGljS2V5LCB4NWMsIGF0dGVzdGF0aW9uU3RhdGVtZW50QWxnLCB9KSB7XG4gICAgY29uc3QgeyBhdXRoZW50aWNhdGlvbkFsZ29yaXRobXMsIGF1dGhlbnRpY2F0b3JHZXRJbmZvLCBhdHRlc3RhdGlvblJvb3RDZXJ0aWZpY2F0ZXMsIH0gPSBzdGF0ZW1lbnQ7XG4gICAgLy8gTWFrZSBzdXJlIHRoZSBhbGcgaW4gdGhlIGF0dGVzdGF0aW9uIHN0YXRlbWVudCBtYXRjaGVzIG9uZSBvZiB0aGUgb25lcyBzcGVjaWZpZWQgaW4gbWV0YWRhdGFcbiAgICBjb25zdCBrZXlwYWlyQ09TRUFsZ3MgPSBuZXcgU2V0KCk7XG4gICAgYXV0aGVudGljYXRpb25BbGdvcml0aG1zLmZvckVhY2goKGFsZ1NpZ24pID0+IHtcbiAgICAgICAgLy8gTWFwIGFsZ1NpZ24gc3RyaW5nIHRvIHsga3R5LCBhbGcsIGNydiB9XG4gICAgICAgIGNvbnN0IGFsZ1NpZ25DT1NFSU5GTyA9IGFsZ1NpZ25Ub0NPU0VJbmZvTWFwW2FsZ1NpZ25dO1xuICAgICAgICAvLyBLZWVwaW5nIHRoaXMgc3RhdGVtZW50IGhlcmUganVzdCBpbiBjYXNlIE1EUyByZXR1cm5zIHNvbWV0aGluZyB1bmV4cGVjdGVkXG4gICAgICAgIGlmIChhbGdTaWduQ09TRUlORk8pIHtcbiAgICAgICAgICAgIGtleXBhaXJDT1NFQWxncy5hZGQoYWxnU2lnbkNPU0VJTkZPKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8vIEV4dHJhY3QgdGhlIHB1YmxpYyBrZXkncyBDT1NFIGluZm8gZm9yIGNvbXBhcmlzb25cbiAgICBjb25zdCBkZWNvZGVkUHVibGljS2V5ID0gZGVjb2RlQ3JlZGVudGlhbFB1YmxpY0tleShjcmVkZW50aWFsUHVibGljS2V5KTtcbiAgICBjb25zdCBrdHkgPSBkZWNvZGVkUHVibGljS2V5LmdldChDT1NFS0VZUy5rdHkpO1xuICAgIGNvbnN0IGFsZyA9IGRlY29kZWRQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLmFsZyk7XG4gICAgaWYgKCFrdHkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDcmVkZW50aWFsIHB1YmxpYyBrZXkgd2FzIG1pc3Npbmcga3R5Jyk7XG4gICAgfVxuICAgIGlmICghYWxnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ3JlZGVudGlhbCBwdWJsaWMga2V5IHdhcyBtaXNzaW5nIGFsZycpO1xuICAgIH1cbiAgICBpZiAoIWt0eSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyZWRlbnRpYWwgcHVibGljIGtleSB3YXMgbWlzc2luZyBrdHknKTtcbiAgICB9XG4gICAgLy8gQXNzdW1lIGV2ZXJ5dGhpbmcgaXMgYSBudW1iZXIgYmVjYXVzZSB0aGVzZSB2YWx1ZXMgc2hvdWxkIGJlXG4gICAgY29uc3QgcHVibGljS2V5Q09TRUluZm8gPSB7IGt0eSwgYWxnIH07XG4gICAgaWYgKGlzQ09TRVB1YmxpY0tleUVDMihkZWNvZGVkUHVibGljS2V5KSkge1xuICAgICAgICBjb25zdCBjcnYgPSBkZWNvZGVkUHVibGljS2V5LmdldChDT1NFS0VZUy5jcnYpO1xuICAgICAgICBwdWJsaWNLZXlDT1NFSW5mby5jcnYgPSBjcnY7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEF0dGVtcHQgdG8gbWF0Y2ggdGhlIGNyZWRlbnRpYWwgcHVibGljIGtleSdzIGFsZ29yaXRobSB0byBvbmUgc3BlY2lmaWVkIGluIHRoZSBkZXZpY2Unc1xuICAgICAqIG1ldGFkYXRhXG4gICAgICovXG4gICAgbGV0IGZvdW5kTWF0Y2ggPSBmYWxzZTtcbiAgICBmb3IgKGNvbnN0IGtleXBhaXJBbGcgb2Yga2V5cGFpckNPU0VBbGdzKSB7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSBhbGdvcml0aG0gYW5kIGtleSB0eXBlIG1hdGNoXG4gICAgICAgIGlmIChrZXlwYWlyQWxnLmFsZyA9PT0gcHVibGljS2V5Q09TRUluZm8uYWxnICYmXG4gICAgICAgICAgICBrZXlwYWlyQWxnLmt0eSA9PT0gcHVibGljS2V5Q09TRUluZm8ua3R5KSB7XG4gICAgICAgICAgICAvLyBJZiBub3QgYW4gUlNBIGtleXBhaXIgdGhlbiBtYWtlIHN1cmUgY3VydmUgbnVtYmVycyBtYXRjaCB0b29cbiAgICAgICAgICAgIGlmICgoa2V5cGFpckFsZy5rdHkgPT09IENPU0VLVFkuRUMyIHx8IGtleXBhaXJBbGcua3R5ID09PSBDT1NFS1RZLk9LUCkgJiZcbiAgICAgICAgICAgICAgICBrZXlwYWlyQWxnLmNydiA9PT0gcHVibGljS2V5Q09TRUluZm8uY3J2KSB7XG4gICAgICAgICAgICAgICAgZm91bmRNYXRjaCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBXZSd2ZSBtYXRjaGVkIGFuIFJTQSBwdWJsaWMga2V5J3MgcHJvcGVydGllc1xuICAgICAgICAgICAgICAgIGZvdW5kTWF0Y2ggPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChmb3VuZE1hdGNoKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBNYWtlIHN1cmUgdGhlIHB1YmxpYyBrZXkgaXMgb25lIG9mIHRoZSBhbGxvd2VkIGFsZ29yaXRobXNcbiAgICBpZiAoIWZvdW5kTWF0Y2gpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENyYWZ0IHNvbWUgdXNlZnVsIGVycm9yIG91dHB1dCBmcm9tIHRoZSBNRFMgYWxnb3JpdGhtc1xuICAgICAgICAgKlxuICAgICAgICAgKiBFeGFtcGxlOlxuICAgICAgICAgKlxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICogW1xuICAgICAgICAgKiAgICdyc2Fzc2FfcHNzX3NoYTI1Nl9yYXcnIChDT1NFIGluZm86IHsga3R5OiAzLCBhbGc6IC0zNyB9KSxcbiAgICAgICAgICogICAnc2VjcDI1NmsxX2VjZHNhX3NoYTI1Nl9yYXcnIChDT1NFIGluZm86IHsga3R5OiAyLCBhbGc6IC00NywgY3J2OiA4IH0pXG4gICAgICAgICAqIF1cbiAgICAgICAgICogYGBgXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdCBkZWJ1Z01EU0FsZ3MgPSBhdXRoZW50aWNhdGlvbkFsZ29yaXRobXMubWFwKChhbGdTaWduKSA9PiBgJyR7YWxnU2lnbn0nIChDT1NFIGluZm86ICR7c3RyaW5naWZ5Q09TRUluZm8oYWxnU2lnblRvQ09TRUluZm9NYXBbYWxnU2lnbl0pfSlgKTtcbiAgICAgICAgY29uc3Qgc3RyTURTQWxncyA9IEpTT04uc3RyaW5naWZ5KGRlYnVnTURTQWxncywgbnVsbCwgMikucmVwbGFjZSgvXCIvZywgJycpO1xuICAgICAgICAvKipcbiAgICAgICAgICogQ29uc3RydWN0IHVzZWZ1bCBlcnJvciBvdXRwdXQgYWJvdXQgdGhlIHB1YmxpYyBrZXlcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0IHN0clB1YktleUFsZyA9IHN0cmluZ2lmeUNPU0VJbmZvKHB1YmxpY0tleUNPU0VJbmZvKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQdWJsaWMga2V5IHBhcmFtZXRlcnMgJHtzdHJQdWJLZXlBbGd9IGRpZCBub3QgbWF0Y2ggYW55IG9mIHRoZSBmb2xsb3dpbmcgbWV0YWRhdGEgYWxnb3JpdGhtczpcXG4ke3N0ck1EU0FsZ3N9YCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbmZpcm0gdGhlIGF0dGVzdGF0aW9uIHN0YXRlbWVudCdzIGFsZ29yaXRobSBpcyBvbmUgc3VwcG9ydGVkIGFjY29yZGluZyB0byBtZXRhZGF0YVxuICAgICAqL1xuICAgIGlmIChhdHRlc3RhdGlvblN0YXRlbWVudEFsZyAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgIGF1dGhlbnRpY2F0b3JHZXRJbmZvPy5hbGdvcml0aG1zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3QgZ2V0SW5mb0FsZ3MgPSBhdXRoZW50aWNhdG9yR2V0SW5mby5hbGdvcml0aG1zLm1hcCgoX2FsZykgPT4gX2FsZy5hbGcpO1xuICAgICAgICBpZiAoZ2V0SW5mb0FsZ3MuaW5kZXhPZihhdHRlc3RhdGlvblN0YXRlbWVudEFsZykgPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEF0dGVzdGF0aW9uIHN0YXRlbWVudCBhbGcgJHthdHRlc3RhdGlvblN0YXRlbWVudEFsZ30gZGlkIG5vdCBtYXRjaCBvbmUgb2YgJHtnZXRJbmZvQWxnc31gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBQcmVwYXJlIHRvIGNoZWNrIHRoZSBjZXJ0aWZpY2F0ZSBjaGFpblxuICAgIGNvbnN0IGF1dGhlbnRpY2F0b3JDZXJ0cyA9IHg1Yy5tYXAoY29udmVydENlcnRCdWZmZXJUb1BFTSk7XG4gICAgY29uc3Qgc3RhdGVtZW50Um9vdENlcnRzID0gYXR0ZXN0YXRpb25Sb290Q2VydGlmaWNhdGVzLm1hcChjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNKTtcbiAgICAvKipcbiAgICAgKiBJZiBhbiBhdXRoZW50aWNhdG9yIHJldHVybnMgZXhhY3RseSBvbmUgY2VydGlmaWNhdGUgaW4gaXRzIHg1YywgYW5kIHRoYXQgY2VydCBpcyBmb3VuZCBpbiB0aGVcbiAgICAgKiBtZXRhZGF0YSBzdGF0ZW1lbnQgdGhlbiB0aGUgYXV0aGVudGljYXRvciBpcyBcInNlbGYtcmVmZXJlbmNpbmdcIi4gSW4gdGhpcyBjYXNlIHdlIGZvcmVnb1xuICAgICAqIGNlcnRpZmljYXRlIGNoYWluIHZhbGlkYXRpb24uXG4gICAgICovXG4gICAgbGV0IGF1dGhlbnRpY2F0b3JJc1NlbGZSZWZlcmVuY2luZyA9IGZhbHNlO1xuICAgIGlmIChhdXRoZW50aWNhdG9yQ2VydHMubGVuZ3RoID09PSAxICYmXG4gICAgICAgIHN0YXRlbWVudFJvb3RDZXJ0cy5pbmRleE9mKGF1dGhlbnRpY2F0b3JDZXJ0c1swXSkgPj0gMCkge1xuICAgICAgICBhdXRoZW50aWNhdG9ySXNTZWxmUmVmZXJlbmNpbmcgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoIWF1dGhlbnRpY2F0b3JJc1NlbGZSZWZlcmVuY2luZykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGgoYXV0aGVudGljYXRvckNlcnRzLCBzdGF0ZW1lbnRSb290Q2VydHMpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnN0IF9lcnIgPSBlcnI7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCB2YWxpZGF0ZSBjZXJ0aWZpY2F0ZSBwYXRoIHdpdGggYW55IG1ldGFkYXRhIHJvb3QgY2VydGlmaWNhdGVzOiAke19lcnIubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbi8qKlxuICogQ29udmVydCBBTEdfU0lHTiB2YWx1ZXMgdG8gQ09TRSBpbmZvXG4gKlxuICogVmFsdWVzIHB1bGxlZCBmcm9tIGBBTEdfS0VZX0NPU0VgIGRlZmluaXRpb25zIGluIHRoZSBGSURPIFJlZ2lzdHJ5IG9mIFByZWRlZmluZWQgVmFsdWVzXG4gKlxuICogaHR0cHM6Ly9maWRvYWxsaWFuY2Uub3JnL3NwZWNzL2NvbW1vbi1zcGVjcy9maWRvLXJlZ2lzdHJ5LXYyLjItcHMtMjAyMjA1MjMuaHRtbCNhdXRoZW50aWNhdGlvbi1hbGdvcml0aG1zXG4gKi9cbmV4cG9ydCBjb25zdCBhbGdTaWduVG9DT1NFSW5mb01hcCA9IHtcbiAgICBzZWNwMjU2cjFfZWNkc2Ffc2hhMjU2X3JhdzogeyBrdHk6IDIsIGFsZzogLTcsIGNydjogMSB9LFxuICAgIHNlY3AyNTZyMV9lY2RzYV9zaGEyNTZfZGVyOiB7IGt0eTogMiwgYWxnOiAtNywgY3J2OiAxIH0sXG4gICAgcnNhc3NhX3Bzc19zaGEyNTZfcmF3OiB7IGt0eTogMywgYWxnOiAtMzcgfSxcbiAgICByc2Fzc2FfcHNzX3NoYTI1Nl9kZXI6IHsga3R5OiAzLCBhbGc6IC0zNyB9LFxuICAgIHNlY3AyNTZrMV9lY2RzYV9zaGEyNTZfcmF3OiB7IGt0eTogMiwgYWxnOiAtNDcsIGNydjogOCB9LFxuICAgIHNlY3AyNTZrMV9lY2RzYV9zaGEyNTZfZGVyOiB7IGt0eTogMiwgYWxnOiAtNDcsIGNydjogOCB9LFxuICAgIHJzYXNzYV9wc3Nfc2hhMzg0X3JhdzogeyBrdHk6IDMsIGFsZzogLTM4IH0sXG4gICAgcnNhc3NhX3BrY3N2MTVfc2hhMjU2X3JhdzogeyBrdHk6IDMsIGFsZzogLTI1NyB9LFxuICAgIHJzYXNzYV9wa2NzdjE1X3NoYTM4NF9yYXc6IHsga3R5OiAzLCBhbGc6IC0yNTggfSxcbiAgICByc2Fzc2FfcGtjc3YxNV9zaGE1MTJfcmF3OiB7IGt0eTogMywgYWxnOiAtMjU5IH0sXG4gICAgcnNhc3NhX3BrY3N2MTVfc2hhMV9yYXc6IHsga3R5OiAzLCBhbGc6IC02NTUzNSB9LFxuICAgIHNlY3AzODRyMV9lY2RzYV9zaGEzODRfcmF3OiB7IGt0eTogMiwgYWxnOiAtMzUsIGNydjogMiB9LFxuICAgIHNlY3A1MTJyMV9lY2RzYV9zaGEyNTZfcmF3OiB7IGt0eTogMiwgYWxnOiAtMzYsIGNydjogMyB9LFxuICAgIGVkMjU1MTlfZWRkc2Ffc2hhNTEyX3JhdzogeyBrdHk6IDEsIGFsZzogLTgsIGNydjogNiB9LFxufTtcbi8qKlxuICogQSBoZWxwZXIgdG8gZm9ybWF0IENPU0VJbmZvIGEgbGl0dGxlIG5pY2VyIHRoYW4gd2UgY2FuIGFjaGlldmUgd2l0aCBKU09OLnN0cmluZ2lmeSgpXG4gKlxuICogSW5wdXQ6IGB7IFwia3R5XCI6IDMsIFwiYWxnXCI6IC0yNTcgfWBcbiAqXG4gKiBPdXRwdXQ6IGBcInsga3R5OiAzLCBhbGc6IC0yNTcgfVwiYFxuICovXG5mdW5jdGlvbiBzdHJpbmdpZnlDT1NFSW5mbyhpbmZvKSB7XG4gICAgY29uc3QgeyBrdHksIGFsZywgY3J2IH0gPSBpbmZvO1xuICAgIGxldCB0b1JldHVybiA9ICcnO1xuICAgIGlmIChrdHkgIT09IENPU0VLVFkuUlNBKSB7XG4gICAgICAgIHRvUmV0dXJuID0gYHsga3R5OiAke2t0eX0sIGFsZzogJHthbGd9LCBjcnY6ICR7Y3J2fSB9YDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRvUmV0dXJuID0gYHsga3R5OiAke2t0eX0sIGFsZzogJHthbGd9IH1gO1xuICAgIH1cbiAgICByZXR1cm4gdG9SZXR1cm47XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyAttestationWithMetadata.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyJWT.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/metadata/verifyJWT.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyJWT: () => (/* binding */ verifyJWT)\n/* harmony export */ });\n/* harmony import */ var _helpers_convertX509PublicKeyToCOSE_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/convertX509PublicKeyToCOSE.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertX509PublicKeyToCOSE.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _helpers_iso_isoCrypto_verifyEC2_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../helpers/iso/isoCrypto/verifyEC2.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyEC2.js\");\n/* harmony import */ var _helpers_iso_isoCrypto_verifyRSA_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/iso/isoCrypto/verifyRSA.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/isoCrypto/verifyRSA.js\");\n\n\n\n\n\n/**\n * Lightweight verification for FIDO MDS JWTs. Supports use of EC2 and RSA.\n *\n * If this ever needs to support more JWS algorithms, here's the list of them:\n *\n * https://www.rfc-editor.org/rfc/rfc7518.html#section-3.1\n *\n * (Pulled from https://www.rfc-editor.org/rfc/rfc7515#section-4.1.1)\n */\nfunction verifyJWT(jwt, leafCert) {\n    const [header, payload, signature] = jwt.split('.');\n    const certCOSE = (0,_helpers_convertX509PublicKeyToCOSE_js__WEBPACK_IMPORTED_MODULE_0__.convertX509PublicKeyToCOSE)(leafCert);\n    const data = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.fromUTF8String(`${header}.${payload}`);\n    const signatureBytes = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoBase64URL.toBuffer(signature);\n    if ((0,_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.isCOSEPublicKeyEC2)(certCOSE)) {\n        return (0,_helpers_iso_isoCrypto_verifyEC2_js__WEBPACK_IMPORTED_MODULE_3__.verifyEC2)({\n            data,\n            signature: signatureBytes,\n            cosePublicKey: certCOSE,\n            shaHashOverride: _helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEALG.ES256,\n        });\n    }\n    else if ((0,_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.isCOSEPublicKeyRSA)(certCOSE)) {\n        return (0,_helpers_iso_isoCrypto_verifyRSA_js__WEBPACK_IMPORTED_MODULE_4__.verifyRSA)({\n            data,\n            signature: signatureBytes,\n            cosePublicKey: certCOSE,\n        });\n    }\n    const kty = certCOSE.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEKEYS.kty);\n    throw new Error(`JWT verification with public key of kty ${kty} is not supported by this method`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vbWV0YWRhdGEvdmVyaWZ5SldULmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFzRjtBQUNoQjtBQUN5QjtBQUM3QjtBQUNBO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQSxxQkFBcUIsa0dBQTBCO0FBQy9DLGlCQUFpQiwrRUFBNEIsSUFBSSxPQUFPLEdBQUcsUUFBUTtBQUNuRSwyQkFBMkIsd0VBQXFCO0FBQ2hELFFBQVEsb0VBQWtCO0FBQzFCLGVBQWUsOEVBQVM7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHFEQUFPO0FBQ3BDLFNBQVM7QUFDVDtBQUNBLGFBQWEsb0VBQWtCO0FBQy9CLGVBQWUsOEVBQVM7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsNkJBQTZCLHNEQUFRO0FBQ3JDLCtEQUErRCxLQUFLO0FBQ3BFIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcbWV0YWRhdGFcXHZlcmlmeUpXVC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb252ZXJ0WDUwOVB1YmxpY0tleVRvQ09TRSB9IGZyb20gJy4uL2hlbHBlcnMvY29udmVydFg1MDlQdWJsaWNLZXlUb0NPU0UuanMnO1xuaW1wb3J0IHsgaXNvQmFzZTY0VVJMLCBpc29VaW50OEFycmF5IH0gZnJvbSAnLi4vaGVscGVycy9pc28vaW5kZXguanMnO1xuaW1wb3J0IHsgQ09TRUFMRywgQ09TRUtFWVMsIGlzQ09TRVB1YmxpY0tleUVDMiwgaXNDT1NFUHVibGljS2V5UlNBIH0gZnJvbSAnLi4vaGVscGVycy9jb3NlLmpzJztcbmltcG9ydCB7IHZlcmlmeUVDMiB9IGZyb20gJy4uL2hlbHBlcnMvaXNvL2lzb0NyeXB0by92ZXJpZnlFQzIuanMnO1xuaW1wb3J0IHsgdmVyaWZ5UlNBIH0gZnJvbSAnLi4vaGVscGVycy9pc28vaXNvQ3J5cHRvL3ZlcmlmeVJTQS5qcyc7XG4vKipcbiAqIExpZ2h0d2VpZ2h0IHZlcmlmaWNhdGlvbiBmb3IgRklETyBNRFMgSldUcy4gU3VwcG9ydHMgdXNlIG9mIEVDMiBhbmQgUlNBLlxuICpcbiAqIElmIHRoaXMgZXZlciBuZWVkcyB0byBzdXBwb3J0IG1vcmUgSldTIGFsZ29yaXRobXMsIGhlcmUncyB0aGUgbGlzdCBvZiB0aGVtOlxuICpcbiAqIGh0dHBzOi8vd3d3LnJmYy1lZGl0b3Iub3JnL3JmYy9yZmM3NTE4Lmh0bWwjc2VjdGlvbi0zLjFcbiAqXG4gKiAoUHVsbGVkIGZyb20gaHR0cHM6Ly93d3cucmZjLWVkaXRvci5vcmcvcmZjL3JmYzc1MTUjc2VjdGlvbi00LjEuMSlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeUpXVChqd3QsIGxlYWZDZXJ0KSB7XG4gICAgY29uc3QgW2hlYWRlciwgcGF5bG9hZCwgc2lnbmF0dXJlXSA9IGp3dC5zcGxpdCgnLicpO1xuICAgIGNvbnN0IGNlcnRDT1NFID0gY29udmVydFg1MDlQdWJsaWNLZXlUb0NPU0UobGVhZkNlcnQpO1xuICAgIGNvbnN0IGRhdGEgPSBpc29VaW50OEFycmF5LmZyb21VVEY4U3RyaW5nKGAke2hlYWRlcn0uJHtwYXlsb2FkfWApO1xuICAgIGNvbnN0IHNpZ25hdHVyZUJ5dGVzID0gaXNvQmFzZTY0VVJMLnRvQnVmZmVyKHNpZ25hdHVyZSk7XG4gICAgaWYgKGlzQ09TRVB1YmxpY0tleUVDMihjZXJ0Q09TRSkpIHtcbiAgICAgICAgcmV0dXJuIHZlcmlmeUVDMih7XG4gICAgICAgICAgICBkYXRhLFxuICAgICAgICAgICAgc2lnbmF0dXJlOiBzaWduYXR1cmVCeXRlcyxcbiAgICAgICAgICAgIGNvc2VQdWJsaWNLZXk6IGNlcnRDT1NFLFxuICAgICAgICAgICAgc2hhSGFzaE92ZXJyaWRlOiBDT1NFQUxHLkVTMjU2LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoaXNDT1NFUHVibGljS2V5UlNBKGNlcnRDT1NFKSkge1xuICAgICAgICByZXR1cm4gdmVyaWZ5UlNBKHtcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICBzaWduYXR1cmU6IHNpZ25hdHVyZUJ5dGVzLFxuICAgICAgICAgICAgY29zZVB1YmxpY0tleTogY2VydENPU0UsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBrdHkgPSBjZXJ0Q09TRS5nZXQoQ09TRUtFWVMua3R5KTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEpXVCB2ZXJpZmljYXRpb24gd2l0aCBwdWJsaWMga2V5IG9mIGt0eSAke2t0eX0gaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIG1ldGhvZGApO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyJWT.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/generateRegistrationOptions.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/generateRegistrationOptions.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateRegistrationOptions: () => (/* binding */ generateRegistrationOptions),\n/* harmony export */   supportedCOSEAlgorithmIdentifiers: () => (/* binding */ supportedCOSEAlgorithmIdentifiers)\n/* harmony export */ });\n/* harmony import */ var _helpers_generateChallenge_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/generateChallenge.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateChallenge.js\");\n/* harmony import */ var _helpers_generateUserID_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/generateUserID.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/generateUserID.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n\n\n/**\n * Supported crypto algo identifiers\n * See https://w3c.github.io/webauthn/#sctn-alg-identifier\n * and https://www.iana.org/assignments/cose/cose.xhtml#algorithms\n */\nconst supportedCOSEAlgorithmIdentifiers = [\n    // EdDSA (In first position to encourage authenticators to use this over ES256)\n    -8,\n    // ECDSA w/ SHA-256\n    -7,\n    // ECDSA w/ SHA-512\n    -36,\n    // RSASSA-PSS w/ SHA-256\n    -37,\n    // RSASSA-PSS w/ SHA-384\n    -38,\n    // RSASSA-PSS w/ SHA-512\n    -39,\n    // RSASSA-PKCS1-v1_5 w/ SHA-256\n    -257,\n    // RSASSA-PKCS1-v1_5 w/ SHA-384\n    -258,\n    // RSASSA-PKCS1-v1_5 w/ SHA-512\n    -259,\n    // RSASSA-PKCS1-v1_5 w/ SHA-1 (Deprecated; here for legacy support)\n    -65535,\n];\n/**\n * Set up some default authenticator selection options as per the latest spec:\n * https://www.w3.org/TR/webauthn-2/#dictdef-authenticatorselectioncriteria\n *\n * Helps with some older platforms (e.g. Android 7.0 Nougat) that may not be aware of these\n * defaults.\n */\nconst defaultAuthenticatorSelection = {\n    residentKey: 'preferred',\n    userVerification: 'preferred',\n};\n/**\n * Use the most commonly-supported algorithms\n * See the following:\n *   - https://www.iana.org/assignments/cose/cose.xhtml#algorithms\n *   - https://w3c.github.io/webauthn/#dom-publickeycredentialcreationoptions-pubkeycredparams\n */\nconst defaultSupportedAlgorithmIDs = [-8, -7, -257];\n/**\n * Prepare a value to pass into navigator.credentials.create(...) for authenticator registration\n *\n * **Options:**\n *\n * @param rpName - User-visible, \"friendly\" website/service name\n * @param rpID - Valid domain name (after `https://`)\n * @param userName - User's website-specific username (email, etc...)\n * @param userID **(Optional)** - User's website-specific unique ID. Defaults to generating a random identifier\n * @param challenge **(Optional)** - Random value the authenticator needs to sign and pass back. Defaults to generating a random value\n * @param userDisplayName **(Optional)** - User's actual name. Defaults to `\"\"`\n * @param timeout **(Optional)** - How long (in ms) the user can take to complete attestation. Defaults to `60000`\n * @param attestationType **(Optional)** - Specific attestation statement. Defaults to `\"none\"`\n * @param excludeCredentials **(Optional)** - Authenticators registered by the user so the user can't register the same credential multiple times. Defaults to `[]`\n * @param authenticatorSelection **(Optional)** - Advanced criteria for restricting the types of authenticators that may be used. Defaults to `{ residentKey: 'preferred', userVerification: 'preferred' }`\n * @param extensions **(Optional)** - Additional plugins the authenticator or browser should use during attestation\n * @param supportedAlgorithmIDs **(Optional)** - Array of numeric COSE algorithm identifiers supported for attestation by this RP. See https://www.iana.org/assignments/cose/cose.xhtml#algorithms. Defaults to `[-8, -7, -257]`\n */\nasync function generateRegistrationOptions(options) {\n    const { rpName, rpID, userName, userID, challenge = await (0,_helpers_generateChallenge_js__WEBPACK_IMPORTED_MODULE_0__.generateChallenge)(), userDisplayName = '', timeout = 60000, attestationType = 'none', excludeCredentials = [], authenticatorSelection = defaultAuthenticatorSelection, extensions, supportedAlgorithmIDs = defaultSupportedAlgorithmIDs, } = options;\n    /**\n     * Prepare pubKeyCredParams from the array of algorithm ID's\n     */\n    const pubKeyCredParams = supportedAlgorithmIDs.map((id) => ({\n        alg: id,\n        type: 'public-key',\n    }));\n    /**\n     * Capture some of the nuances of how `residentKey` and `requireResidentKey` how either is set\n     * depending on when either is defined in the options\n     */\n    if (authenticatorSelection.residentKey === undefined) {\n        /**\n         * `residentKey`: \"If no value is given then the effective value is `required` if\n         * requireResidentKey is true or `discouraged` if it is false or absent.\"\n         *\n         * See https://www.w3.org/TR/webauthn-2/#dom-authenticatorselectioncriteria-residentkey\n         */\n        if (authenticatorSelection.requireResidentKey) {\n            authenticatorSelection.residentKey = 'required';\n        }\n        else {\n            /**\n             * FIDO Conformance v1.7.2 fails the first test if we do this, even though this is\n             * technically compatible with the WebAuthn L2 spec...\n             */\n            // authenticatorSelection.residentKey = 'discouraged';\n        }\n    }\n    else {\n        /**\n         * `requireResidentKey`: \"Relying Parties SHOULD set it to true if, and only if, residentKey is\n         * set to \"required\"\"\n         *\n         * Spec says this property defaults to `false` so we should still be okay to assign `false` too\n         *\n         * See https://www.w3.org/TR/webauthn-2/#dom-authenticatorselectioncriteria-requireresidentkey\n         */\n        authenticatorSelection.requireResidentKey = authenticatorSelection.residentKey === 'required';\n    }\n    /**\n     * Preserve ability to specify `string` values for challenges\n     */\n    let _challenge = challenge;\n    if (typeof _challenge === 'string') {\n        _challenge = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_2__.isoUint8Array.fromUTF8String(_challenge);\n    }\n    /**\n     * Explicitly disallow use of strings for userID anymore because `isoBase64URL.fromBuffer()` below\n     * will return an empty string if one gets through!\n     */\n    if (typeof userID === 'string') {\n        throw new Error(`String values for \\`userID\\` are no longer supported. See https://simplewebauthn.dev/docs/advanced/server/custom-user-ids`);\n    }\n    /**\n     * Generate a user ID if one is not provided\n     */\n    let _userID = userID;\n    if (!_userID) {\n        _userID = await (0,_helpers_generateUserID_js__WEBPACK_IMPORTED_MODULE_1__.generateUserID)();\n    }\n    return {\n        challenge: _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_2__.isoBase64URL.fromBuffer(_challenge),\n        rp: {\n            name: rpName,\n            id: rpID,\n        },\n        user: {\n            id: _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_2__.isoBase64URL.fromBuffer(_userID),\n            name: userName,\n            displayName: userDisplayName,\n        },\n        pubKeyCredParams,\n        timeout,\n        attestation: attestationType,\n        excludeCredentials: excludeCredentials.map((cred) => {\n            if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_2__.isoBase64URL.isBase64URL(cred.id)) {\n                throw new Error(`excludeCredential id \"${cred.id}\" is not a valid base64url string`);\n            }\n            return {\n                ...cred,\n                id: _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_2__.isoBase64URL.trimPadding(cred.id),\n                type: 'public-key',\n            };\n        }),\n        authenticatorSelection,\n        extensions: {\n            ...extensions,\n            credProps: true,\n        },\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL2dlbmVyYXRlUmVnaXN0cmF0aW9uT3B0aW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFvRTtBQUNOO0FBQ1E7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUpBQWlKLHlEQUF5RDtBQUMxTTtBQUNBO0FBQ0E7QUFDTztBQUNQLFlBQVksa0RBQWtELGdGQUFpQiwwTkFBME47QUFDelM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsK0VBQTRCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDBFQUFjO0FBQ3RDO0FBQ0E7QUFDQSxtQkFBbUIsMEVBQXVCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLGdCQUFnQiwwRUFBdUI7QUFDdkM7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwyRUFBd0I7QUFDekMseURBQXlELFFBQVE7QUFDakU7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLDJFQUF3QjtBQUM1QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxyZWdpc3RyYXRpb25cXGdlbmVyYXRlUmVnaXN0cmF0aW9uT3B0aW9ucy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZW5lcmF0ZUNoYWxsZW5nZSB9IGZyb20gJy4uL2hlbHBlcnMvZ2VuZXJhdGVDaGFsbGVuZ2UuanMnO1xuaW1wb3J0IHsgZ2VuZXJhdGVVc2VySUQgfSBmcm9tICcuLi9oZWxwZXJzL2dlbmVyYXRlVXNlcklELmpzJztcbmltcG9ydCB7IGlzb0Jhc2U2NFVSTCwgaXNvVWludDhBcnJheSB9IGZyb20gJy4uL2hlbHBlcnMvaXNvL2luZGV4LmpzJztcbi8qKlxuICogU3VwcG9ydGVkIGNyeXB0byBhbGdvIGlkZW50aWZpZXJzXG4gKiBTZWUgaHR0cHM6Ly93M2MuZ2l0aHViLmlvL3dlYmF1dGhuLyNzY3RuLWFsZy1pZGVudGlmaWVyXG4gKiBhbmQgaHR0cHM6Ly93d3cuaWFuYS5vcmcvYXNzaWdubWVudHMvY29zZS9jb3NlLnhodG1sI2FsZ29yaXRobXNcbiAqL1xuZXhwb3J0IGNvbnN0IHN1cHBvcnRlZENPU0VBbGdvcml0aG1JZGVudGlmaWVycyA9IFtcbiAgICAvLyBFZERTQSAoSW4gZmlyc3QgcG9zaXRpb24gdG8gZW5jb3VyYWdlIGF1dGhlbnRpY2F0b3JzIHRvIHVzZSB0aGlzIG92ZXIgRVMyNTYpXG4gICAgLTgsXG4gICAgLy8gRUNEU0Egdy8gU0hBLTI1NlxuICAgIC03LFxuICAgIC8vIEVDRFNBIHcvIFNIQS01MTJcbiAgICAtMzYsXG4gICAgLy8gUlNBU1NBLVBTUyB3LyBTSEEtMjU2XG4gICAgLTM3LFxuICAgIC8vIFJTQVNTQS1QU1Mgdy8gU0hBLTM4NFxuICAgIC0zOCxcbiAgICAvLyBSU0FTU0EtUFNTIHcvIFNIQS01MTJcbiAgICAtMzksXG4gICAgLy8gUlNBU1NBLVBLQ1MxLXYxXzUgdy8gU0hBLTI1NlxuICAgIC0yNTcsXG4gICAgLy8gUlNBU1NBLVBLQ1MxLXYxXzUgdy8gU0hBLTM4NFxuICAgIC0yNTgsXG4gICAgLy8gUlNBU1NBLVBLQ1MxLXYxXzUgdy8gU0hBLTUxMlxuICAgIC0yNTksXG4gICAgLy8gUlNBU1NBLVBLQ1MxLXYxXzUgdy8gU0hBLTEgKERlcHJlY2F0ZWQ7IGhlcmUgZm9yIGxlZ2FjeSBzdXBwb3J0KVxuICAgIC02NTUzNSxcbl07XG4vKipcbiAqIFNldCB1cCBzb21lIGRlZmF1bHQgYXV0aGVudGljYXRvciBzZWxlY3Rpb24gb3B0aW9ucyBhcyBwZXIgdGhlIGxhdGVzdCBzcGVjOlxuICogaHR0cHM6Ly93d3cudzMub3JnL1RSL3dlYmF1dGhuLTIvI2RpY3RkZWYtYXV0aGVudGljYXRvcnNlbGVjdGlvbmNyaXRlcmlhXG4gKlxuICogSGVscHMgd2l0aCBzb21lIG9sZGVyIHBsYXRmb3JtcyAoZS5nLiBBbmRyb2lkIDcuMCBOb3VnYXQpIHRoYXQgbWF5IG5vdCBiZSBhd2FyZSBvZiB0aGVzZVxuICogZGVmYXVsdHMuXG4gKi9cbmNvbnN0IGRlZmF1bHRBdXRoZW50aWNhdG9yU2VsZWN0aW9uID0ge1xuICAgIHJlc2lkZW50S2V5OiAncHJlZmVycmVkJyxcbiAgICB1c2VyVmVyaWZpY2F0aW9uOiAncHJlZmVycmVkJyxcbn07XG4vKipcbiAqIFVzZSB0aGUgbW9zdCBjb21tb25seS1zdXBwb3J0ZWQgYWxnb3JpdGhtc1xuICogU2VlIHRoZSBmb2xsb3dpbmc6XG4gKiAgIC0gaHR0cHM6Ly93d3cuaWFuYS5vcmcvYXNzaWdubWVudHMvY29zZS9jb3NlLnhodG1sI2FsZ29yaXRobXNcbiAqICAgLSBodHRwczovL3czYy5naXRodWIuaW8vd2ViYXV0aG4vI2RvbS1wdWJsaWNrZXljcmVkZW50aWFsY3JlYXRpb25vcHRpb25zLXB1YmtleWNyZWRwYXJhbXNcbiAqL1xuY29uc3QgZGVmYXVsdFN1cHBvcnRlZEFsZ29yaXRobUlEcyA9IFstOCwgLTcsIC0yNTddO1xuLyoqXG4gKiBQcmVwYXJlIGEgdmFsdWUgdG8gcGFzcyBpbnRvIG5hdmlnYXRvci5jcmVkZW50aWFscy5jcmVhdGUoLi4uKSBmb3IgYXV0aGVudGljYXRvciByZWdpc3RyYXRpb25cbiAqXG4gKiAqKk9wdGlvbnM6KipcbiAqXG4gKiBAcGFyYW0gcnBOYW1lIC0gVXNlci12aXNpYmxlLCBcImZyaWVuZGx5XCIgd2Vic2l0ZS9zZXJ2aWNlIG5hbWVcbiAqIEBwYXJhbSBycElEIC0gVmFsaWQgZG9tYWluIG5hbWUgKGFmdGVyIGBodHRwczovL2ApXG4gKiBAcGFyYW0gdXNlck5hbWUgLSBVc2VyJ3Mgd2Vic2l0ZS1zcGVjaWZpYyB1c2VybmFtZSAoZW1haWwsIGV0Yy4uLilcbiAqIEBwYXJhbSB1c2VySUQgKiooT3B0aW9uYWwpKiogLSBVc2VyJ3Mgd2Vic2l0ZS1zcGVjaWZpYyB1bmlxdWUgSUQuIERlZmF1bHRzIHRvIGdlbmVyYXRpbmcgYSByYW5kb20gaWRlbnRpZmllclxuICogQHBhcmFtIGNoYWxsZW5nZSAqKihPcHRpb25hbCkqKiAtIFJhbmRvbSB2YWx1ZSB0aGUgYXV0aGVudGljYXRvciBuZWVkcyB0byBzaWduIGFuZCBwYXNzIGJhY2suIERlZmF1bHRzIHRvIGdlbmVyYXRpbmcgYSByYW5kb20gdmFsdWVcbiAqIEBwYXJhbSB1c2VyRGlzcGxheU5hbWUgKiooT3B0aW9uYWwpKiogLSBVc2VyJ3MgYWN0dWFsIG5hbWUuIERlZmF1bHRzIHRvIGBcIlwiYFxuICogQHBhcmFtIHRpbWVvdXQgKiooT3B0aW9uYWwpKiogLSBIb3cgbG9uZyAoaW4gbXMpIHRoZSB1c2VyIGNhbiB0YWtlIHRvIGNvbXBsZXRlIGF0dGVzdGF0aW9uLiBEZWZhdWx0cyB0byBgNjAwMDBgXG4gKiBAcGFyYW0gYXR0ZXN0YXRpb25UeXBlICoqKE9wdGlvbmFsKSoqIC0gU3BlY2lmaWMgYXR0ZXN0YXRpb24gc3RhdGVtZW50LiBEZWZhdWx0cyB0byBgXCJub25lXCJgXG4gKiBAcGFyYW0gZXhjbHVkZUNyZWRlbnRpYWxzICoqKE9wdGlvbmFsKSoqIC0gQXV0aGVudGljYXRvcnMgcmVnaXN0ZXJlZCBieSB0aGUgdXNlciBzbyB0aGUgdXNlciBjYW4ndCByZWdpc3RlciB0aGUgc2FtZSBjcmVkZW50aWFsIG11bHRpcGxlIHRpbWVzLiBEZWZhdWx0cyB0byBgW11gXG4gKiBAcGFyYW0gYXV0aGVudGljYXRvclNlbGVjdGlvbiAqKihPcHRpb25hbCkqKiAtIEFkdmFuY2VkIGNyaXRlcmlhIGZvciByZXN0cmljdGluZyB0aGUgdHlwZXMgb2YgYXV0aGVudGljYXRvcnMgdGhhdCBtYXkgYmUgdXNlZC4gRGVmYXVsdHMgdG8gYHsgcmVzaWRlbnRLZXk6ICdwcmVmZXJyZWQnLCB1c2VyVmVyaWZpY2F0aW9uOiAncHJlZmVycmVkJyB9YFxuICogQHBhcmFtIGV4dGVuc2lvbnMgKiooT3B0aW9uYWwpKiogLSBBZGRpdGlvbmFsIHBsdWdpbnMgdGhlIGF1dGhlbnRpY2F0b3Igb3IgYnJvd3NlciBzaG91bGQgdXNlIGR1cmluZyBhdHRlc3RhdGlvblxuICogQHBhcmFtIHN1cHBvcnRlZEFsZ29yaXRobUlEcyAqKihPcHRpb25hbCkqKiAtIEFycmF5IG9mIG51bWVyaWMgQ09TRSBhbGdvcml0aG0gaWRlbnRpZmllcnMgc3VwcG9ydGVkIGZvciBhdHRlc3RhdGlvbiBieSB0aGlzIFJQLiBTZWUgaHR0cHM6Ly93d3cuaWFuYS5vcmcvYXNzaWdubWVudHMvY29zZS9jb3NlLnhodG1sI2FsZ29yaXRobXMuIERlZmF1bHRzIHRvIGBbLTgsIC03LCAtMjU3XWBcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlUmVnaXN0cmF0aW9uT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgY29uc3QgeyBycE5hbWUsIHJwSUQsIHVzZXJOYW1lLCB1c2VySUQsIGNoYWxsZW5nZSA9IGF3YWl0IGdlbmVyYXRlQ2hhbGxlbmdlKCksIHVzZXJEaXNwbGF5TmFtZSA9ICcnLCB0aW1lb3V0ID0gNjAwMDAsIGF0dGVzdGF0aW9uVHlwZSA9ICdub25lJywgZXhjbHVkZUNyZWRlbnRpYWxzID0gW10sIGF1dGhlbnRpY2F0b3JTZWxlY3Rpb24gPSBkZWZhdWx0QXV0aGVudGljYXRvclNlbGVjdGlvbiwgZXh0ZW5zaW9ucywgc3VwcG9ydGVkQWxnb3JpdGhtSURzID0gZGVmYXVsdFN1cHBvcnRlZEFsZ29yaXRobUlEcywgfSA9IG9wdGlvbnM7XG4gICAgLyoqXG4gICAgICogUHJlcGFyZSBwdWJLZXlDcmVkUGFyYW1zIGZyb20gdGhlIGFycmF5IG9mIGFsZ29yaXRobSBJRCdzXG4gICAgICovXG4gICAgY29uc3QgcHViS2V5Q3JlZFBhcmFtcyA9IHN1cHBvcnRlZEFsZ29yaXRobUlEcy5tYXAoKGlkKSA9PiAoe1xuICAgICAgICBhbGc6IGlkLFxuICAgICAgICB0eXBlOiAncHVibGljLWtleScsXG4gICAgfSkpO1xuICAgIC8qKlxuICAgICAqIENhcHR1cmUgc29tZSBvZiB0aGUgbnVhbmNlcyBvZiBob3cgYHJlc2lkZW50S2V5YCBhbmQgYHJlcXVpcmVSZXNpZGVudEtleWAgaG93IGVpdGhlciBpcyBzZXRcbiAgICAgKiBkZXBlbmRpbmcgb24gd2hlbiBlaXRoZXIgaXMgZGVmaW5lZCBpbiB0aGUgb3B0aW9uc1xuICAgICAqL1xuICAgIGlmIChhdXRoZW50aWNhdG9yU2VsZWN0aW9uLnJlc2lkZW50S2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIGByZXNpZGVudEtleWA6IFwiSWYgbm8gdmFsdWUgaXMgZ2l2ZW4gdGhlbiB0aGUgZWZmZWN0aXZlIHZhbHVlIGlzIGByZXF1aXJlZGAgaWZcbiAgICAgICAgICogcmVxdWlyZVJlc2lkZW50S2V5IGlzIHRydWUgb3IgYGRpc2NvdXJhZ2VkYCBpZiBpdCBpcyBmYWxzZSBvciBhYnNlbnQuXCJcbiAgICAgICAgICpcbiAgICAgICAgICogU2VlIGh0dHBzOi8vd3d3LnczLm9yZy9UUi93ZWJhdXRobi0yLyNkb20tYXV0aGVudGljYXRvcnNlbGVjdGlvbmNyaXRlcmlhLXJlc2lkZW50a2V5XG4gICAgICAgICAqL1xuICAgICAgICBpZiAoYXV0aGVudGljYXRvclNlbGVjdGlvbi5yZXF1aXJlUmVzaWRlbnRLZXkpIHtcbiAgICAgICAgICAgIGF1dGhlbnRpY2F0b3JTZWxlY3Rpb24ucmVzaWRlbnRLZXkgPSAncmVxdWlyZWQnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBGSURPIENvbmZvcm1hbmNlIHYxLjcuMiBmYWlscyB0aGUgZmlyc3QgdGVzdCBpZiB3ZSBkbyB0aGlzLCBldmVuIHRob3VnaCB0aGlzIGlzXG4gICAgICAgICAgICAgKiB0ZWNobmljYWxseSBjb21wYXRpYmxlIHdpdGggdGhlIFdlYkF1dGhuIEwyIHNwZWMuLi5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLy8gYXV0aGVudGljYXRvclNlbGVjdGlvbi5yZXNpZGVudEtleSA9ICdkaXNjb3VyYWdlZCc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBgcmVxdWlyZVJlc2lkZW50S2V5YDogXCJSZWx5aW5nIFBhcnRpZXMgU0hPVUxEIHNldCBpdCB0byB0cnVlIGlmLCBhbmQgb25seSBpZiwgcmVzaWRlbnRLZXkgaXNcbiAgICAgICAgICogc2V0IHRvIFwicmVxdWlyZWRcIlwiXG4gICAgICAgICAqXG4gICAgICAgICAqIFNwZWMgc2F5cyB0aGlzIHByb3BlcnR5IGRlZmF1bHRzIHRvIGBmYWxzZWAgc28gd2Ugc2hvdWxkIHN0aWxsIGJlIG9rYXkgdG8gYXNzaWduIGBmYWxzZWAgdG9vXG4gICAgICAgICAqXG4gICAgICAgICAqIFNlZSBodHRwczovL3d3dy53My5vcmcvVFIvd2ViYXV0aG4tMi8jZG9tLWF1dGhlbnRpY2F0b3JzZWxlY3Rpb25jcml0ZXJpYS1yZXF1aXJlcmVzaWRlbnRrZXlcbiAgICAgICAgICovXG4gICAgICAgIGF1dGhlbnRpY2F0b3JTZWxlY3Rpb24ucmVxdWlyZVJlc2lkZW50S2V5ID0gYXV0aGVudGljYXRvclNlbGVjdGlvbi5yZXNpZGVudEtleSA9PT0gJ3JlcXVpcmVkJztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJlc2VydmUgYWJpbGl0eSB0byBzcGVjaWZ5IGBzdHJpbmdgIHZhbHVlcyBmb3IgY2hhbGxlbmdlc1xuICAgICAqL1xuICAgIGxldCBfY2hhbGxlbmdlID0gY2hhbGxlbmdlO1xuICAgIGlmICh0eXBlb2YgX2NoYWxsZW5nZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgX2NoYWxsZW5nZSA9IGlzb1VpbnQ4QXJyYXkuZnJvbVVURjhTdHJpbmcoX2NoYWxsZW5nZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4cGxpY2l0bHkgZGlzYWxsb3cgdXNlIG9mIHN0cmluZ3MgZm9yIHVzZXJJRCBhbnltb3JlIGJlY2F1c2UgYGlzb0Jhc2U2NFVSTC5mcm9tQnVmZmVyKClgIGJlbG93XG4gICAgICogd2lsbCByZXR1cm4gYW4gZW1wdHkgc3RyaW5nIGlmIG9uZSBnZXRzIHRocm91Z2ghXG4gICAgICovXG4gICAgaWYgKHR5cGVvZiB1c2VySUQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgU3RyaW5nIHZhbHVlcyBmb3IgXFxgdXNlcklEXFxgIGFyZSBubyBsb25nZXIgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9zaW1wbGV3ZWJhdXRobi5kZXYvZG9jcy9hZHZhbmNlZC9zZXJ2ZXIvY3VzdG9tLXVzZXItaWRzYCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlIGEgdXNlciBJRCBpZiBvbmUgaXMgbm90IHByb3ZpZGVkXG4gICAgICovXG4gICAgbGV0IF91c2VySUQgPSB1c2VySUQ7XG4gICAgaWYgKCFfdXNlcklEKSB7XG4gICAgICAgIF91c2VySUQgPSBhd2FpdCBnZW5lcmF0ZVVzZXJJRCgpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBjaGFsbGVuZ2U6IGlzb0Jhc2U2NFVSTC5mcm9tQnVmZmVyKF9jaGFsbGVuZ2UpLFxuICAgICAgICBycDoge1xuICAgICAgICAgICAgbmFtZTogcnBOYW1lLFxuICAgICAgICAgICAgaWQ6IHJwSUQsXG4gICAgICAgIH0sXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIGlkOiBpc29CYXNlNjRVUkwuZnJvbUJ1ZmZlcihfdXNlcklEKSxcbiAgICAgICAgICAgIG5hbWU6IHVzZXJOYW1lLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IHVzZXJEaXNwbGF5TmFtZSxcbiAgICAgICAgfSxcbiAgICAgICAgcHViS2V5Q3JlZFBhcmFtcyxcbiAgICAgICAgdGltZW91dCxcbiAgICAgICAgYXR0ZXN0YXRpb246IGF0dGVzdGF0aW9uVHlwZSxcbiAgICAgICAgZXhjbHVkZUNyZWRlbnRpYWxzOiBleGNsdWRlQ3JlZGVudGlhbHMubWFwKChjcmVkKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWlzb0Jhc2U2NFVSTC5pc0Jhc2U2NFVSTChjcmVkLmlkKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgZXhjbHVkZUNyZWRlbnRpYWwgaWQgXCIke2NyZWQuaWR9XCIgaXMgbm90IGEgdmFsaWQgYmFzZTY0dXJsIHN0cmluZ2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAuLi5jcmVkLFxuICAgICAgICAgICAgICAgIGlkOiBpc29CYXNlNjRVUkwudHJpbVBhZGRpbmcoY3JlZC5pZCksXG4gICAgICAgICAgICAgICAgdHlwZTogJ3B1YmxpYy1rZXknLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICAgIGF1dGhlbnRpY2F0b3JTZWxlY3Rpb24sXG4gICAgICAgIGV4dGVuc2lvbnM6IHtcbiAgICAgICAgICAgIC4uLmV4dGVuc2lvbnMsXG4gICAgICAgICAgICBjcmVkUHJvcHM6IHRydWUsXG4gICAgICAgIH0sXG4gICAgfTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/generateRegistrationOptions.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/constants.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/constants.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TPM_ALG: () => (/* binding */ TPM_ALG),\n/* harmony export */   TPM_ECC_CURVE: () => (/* binding */ TPM_ECC_CURVE),\n/* harmony export */   TPM_ECC_CURVE_COSE_CRV_MAP: () => (/* binding */ TPM_ECC_CURVE_COSE_CRV_MAP),\n/* harmony export */   TPM_MANUFACTURERS: () => (/* binding */ TPM_MANUFACTURERS),\n/* harmony export */   TPM_ST: () => (/* binding */ TPM_ST)\n/* harmony export */ });\n// deno-lint-ignore-file no-dupe-keys\n/**\n * A whole lotta domain knowledge is captured here, with hazy connections to source\n * documents. Good places to start searching for more info on these values are the\n * following Trusted Computing Group TPM Library docs linked in the WebAuthn API:\n *\n * - https://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-1-Architecture-01.38.pdf\n * - https://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-2-Structures-01.38.pdf\n * - https://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-3-Commands-01.38.pdf\n */\n/**\n * 6.9 TPM_ST (Structure Tags)\n */\nconst TPM_ST = {\n    0x00c4: 'TPM_ST_RSP_COMMAND',\n    0x8000: 'TPM_ST_NULL',\n    0x8001: 'TPM_ST_NO_SESSIONS',\n    0x8002: 'TPM_ST_SESSIONS',\n    0x8014: 'TPM_ST_ATTEST_NV',\n    0x8015: 'TPM_ST_ATTEST_COMMAND_AUDIT',\n    0x8016: 'TPM_ST_ATTEST_SESSION_AUDIT',\n    0x8017: 'TPM_ST_ATTEST_CERTIFY',\n    0x8018: 'TPM_ST_ATTEST_QUOTE',\n    0x8019: 'TPM_ST_ATTEST_TIME',\n    0x801a: 'TPM_ST_ATTEST_CREATION',\n    0x8021: 'TPM_ST_CREATION',\n    0x8022: 'TPM_ST_VERIFIED',\n    0x8023: 'TPM_ST_AUTH_SECRET',\n    0x8024: 'TPM_ST_HASHCHECK',\n    0x8025: 'TPM_ST_AUTH_SIGNED',\n    0x8029: 'TPM_ST_FU_MANIFEST',\n};\n/**\n * 6.3 TPM_ALG_ID\n */\nconst TPM_ALG = {\n    0x0000: 'TPM_ALG_ERROR',\n    0x0001: 'TPM_ALG_RSA',\n    0x0004: 'TPM_ALG_SHA',\n    // @ts-ignore 2300\n    0x0004: 'TPM_ALG_SHA1',\n    0x0005: 'TPM_ALG_HMAC',\n    0x0006: 'TPM_ALG_AES',\n    0x0007: 'TPM_ALG_MGF1',\n    0x0008: 'TPM_ALG_KEYEDHASH',\n    0x000a: 'TPM_ALG_XOR',\n    0x000b: 'TPM_ALG_SHA256',\n    0x000c: 'TPM_ALG_SHA384',\n    0x000d: 'TPM_ALG_SHA512',\n    0x0010: 'TPM_ALG_NULL',\n    0x0012: 'TPM_ALG_SM3_256',\n    0x0013: 'TPM_ALG_SM4',\n    0x0014: 'TPM_ALG_RSASSA',\n    0x0015: 'TPM_ALG_RSAES',\n    0x0016: 'TPM_ALG_RSAPSS',\n    0x0017: 'TPM_ALG_OAEP',\n    0x0018: 'TPM_ALG_ECDSA',\n    0x0019: 'TPM_ALG_ECDH',\n    0x001a: 'TPM_ALG_ECDAA',\n    0x001b: 'TPM_ALG_SM2',\n    0x001c: 'TPM_ALG_ECSCHNORR',\n    0x001d: 'TPM_ALG_ECMQV',\n    0x0020: 'TPM_ALG_KDF1_SP800_56A',\n    0x0021: 'TPM_ALG_KDF2',\n    0x0022: 'TPM_ALG_KDF1_SP800_108',\n    0x0023: 'TPM_ALG_ECC',\n    0x0025: 'TPM_ALG_SYMCIPHER',\n    0x0026: 'TPM_ALG_CAMELLIA',\n    0x0040: 'TPM_ALG_CTR',\n    0x0041: 'TPM_ALG_OFB',\n    0x0042: 'TPM_ALG_CBC',\n    0x0043: 'TPM_ALG_CFB',\n    0x0044: 'TPM_ALG_ECB',\n};\n/**\n * 6.4 TPM_ECC_CURVE\n */\nconst TPM_ECC_CURVE = {\n    0x0000: 'TPM_ECC_NONE',\n    0x0001: 'TPM_ECC_NIST_P192',\n    0x0002: 'TPM_ECC_NIST_P224',\n    0x0003: 'TPM_ECC_NIST_P256',\n    0x0004: 'TPM_ECC_NIST_P384',\n    0x0005: 'TPM_ECC_NIST_P521',\n    0x0010: 'TPM_ECC_BN_P256',\n    0x0011: 'TPM_ECC_BN_P638',\n    0x0020: 'TPM_ECC_SM2_P256',\n};\n/**\n * Sourced from https://trustedcomputinggroup.org/resource/vendor-id-registry/\n *\n * Latest version:\n * https://trustedcomputinggroup.org/wp-content/uploads/TCG-TPM-Vendor-ID-Registry-Version-1.02-Revision-1.00.pdf\n */\nconst TPM_MANUFACTURERS = {\n    'id:414D4400': {\n        name: 'AMD',\n        id: 'AMD',\n    },\n    'id:41544D4C': {\n        name: 'Atmel',\n        id: 'ATML',\n    },\n    'id:4252434D': {\n        name: 'Broadcom',\n        id: 'BRCM',\n    },\n    'id:49424d00': {\n        name: 'IBM',\n        id: 'IBM',\n    },\n    'id:49465800': {\n        name: 'Infineon',\n        id: 'IFX',\n    },\n    'id:494E5443': {\n        name: 'Intel',\n        id: 'INTC',\n    },\n    'id:4C454E00': {\n        name: 'Lenovo',\n        id: 'LEN',\n    },\n    'id:4E534D20': {\n        name: 'National Semiconductor',\n        id: 'NSM',\n    },\n    'id:4E545A00': {\n        name: 'Nationz',\n        id: 'NTZ',\n    },\n    'id:4E544300': {\n        name: 'Nuvoton Technology',\n        id: 'NTC',\n    },\n    'id:51434F4D': {\n        name: 'Qualcomm',\n        id: 'QCOM',\n    },\n    'id:534D5343': {\n        name: 'SMSC',\n        id: 'SMSC',\n    },\n    'id:53544D20': {\n        name: 'ST Microelectronics',\n        id: 'STM',\n    },\n    'id:534D534E': {\n        name: 'Samsung',\n        id: 'SMSN',\n    },\n    'id:534E5300': {\n        name: 'Sinosun',\n        id: 'SNS',\n    },\n    'id:54584E00': {\n        name: 'Texas Instruments',\n        id: 'TXN',\n    },\n    'id:57454300': {\n        name: 'Winbond',\n        id: 'WEC',\n    },\n    'id:524F4343': {\n        name: 'Fuzhouk Rockchip',\n        id: 'ROCC',\n    },\n    'id:FFFFF1D0': {\n        name: 'FIDO Alliance',\n        id: 'FIDO',\n    },\n};\n/**\n * Match TPM public area curve ID's to `crv` numbers used in COSE public keys\n */\nconst TPM_ECC_CURVE_COSE_CRV_MAP = {\n    TPM_ECC_NIST_P256: 1,\n    TPM_ECC_NIST_P384: 2,\n    TPM_ECC_NIST_P521: 3,\n    TPM_ECC_BN_P256: 1,\n    TPM_ECC_SM2_P256: 1, // p256\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdHBtL2NvbnN0YW50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXHJlZ2lzdHJhdGlvblxcdmVyaWZpY2F0aW9uc1xcdHBtXFxjb25zdGFudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gZGVuby1saW50LWlnbm9yZS1maWxlIG5vLWR1cGUta2V5c1xuLyoqXG4gKiBBIHdob2xlIGxvdHRhIGRvbWFpbiBrbm93bGVkZ2UgaXMgY2FwdHVyZWQgaGVyZSwgd2l0aCBoYXp5IGNvbm5lY3Rpb25zIHRvIHNvdXJjZVxuICogZG9jdW1lbnRzLiBHb29kIHBsYWNlcyB0byBzdGFydCBzZWFyY2hpbmcgZm9yIG1vcmUgaW5mbyBvbiB0aGVzZSB2YWx1ZXMgYXJlIHRoZVxuICogZm9sbG93aW5nIFRydXN0ZWQgQ29tcHV0aW5nIEdyb3VwIFRQTSBMaWJyYXJ5IGRvY3MgbGlua2VkIGluIHRoZSBXZWJBdXRobiBBUEk6XG4gKlxuICogLSBodHRwczovL3d3dy50cnVzdGVkY29tcHV0aW5nZ3JvdXAub3JnL3dwLWNvbnRlbnQvdXBsb2Fkcy9UUE0tUmV2LTIuMC1QYXJ0LTEtQXJjaGl0ZWN0dXJlLTAxLjM4LnBkZlxuICogLSBodHRwczovL3d3dy50cnVzdGVkY29tcHV0aW5nZ3JvdXAub3JnL3dwLWNvbnRlbnQvdXBsb2Fkcy9UUE0tUmV2LTIuMC1QYXJ0LTItU3RydWN0dXJlcy0wMS4zOC5wZGZcbiAqIC0gaHR0cHM6Ly93d3cudHJ1c3RlZGNvbXB1dGluZ2dyb3VwLm9yZy93cC1jb250ZW50L3VwbG9hZHMvVFBNLVJldi0yLjAtUGFydC0zLUNvbW1hbmRzLTAxLjM4LnBkZlxuICovXG4vKipcbiAqIDYuOSBUUE1fU1QgKFN0cnVjdHVyZSBUYWdzKVxuICovXG5leHBvcnQgY29uc3QgVFBNX1NUID0ge1xuICAgIDB4MDBjNDogJ1RQTV9TVF9SU1BfQ09NTUFORCcsXG4gICAgMHg4MDAwOiAnVFBNX1NUX05VTEwnLFxuICAgIDB4ODAwMTogJ1RQTV9TVF9OT19TRVNTSU9OUycsXG4gICAgMHg4MDAyOiAnVFBNX1NUX1NFU1NJT05TJyxcbiAgICAweDgwMTQ6ICdUUE1fU1RfQVRURVNUX05WJyxcbiAgICAweDgwMTU6ICdUUE1fU1RfQVRURVNUX0NPTU1BTkRfQVVESVQnLFxuICAgIDB4ODAxNjogJ1RQTV9TVF9BVFRFU1RfU0VTU0lPTl9BVURJVCcsXG4gICAgMHg4MDE3OiAnVFBNX1NUX0FUVEVTVF9DRVJUSUZZJyxcbiAgICAweDgwMTg6ICdUUE1fU1RfQVRURVNUX1FVT1RFJyxcbiAgICAweDgwMTk6ICdUUE1fU1RfQVRURVNUX1RJTUUnLFxuICAgIDB4ODAxYTogJ1RQTV9TVF9BVFRFU1RfQ1JFQVRJT04nLFxuICAgIDB4ODAyMTogJ1RQTV9TVF9DUkVBVElPTicsXG4gICAgMHg4MDIyOiAnVFBNX1NUX1ZFUklGSUVEJyxcbiAgICAweDgwMjM6ICdUUE1fU1RfQVVUSF9TRUNSRVQnLFxuICAgIDB4ODAyNDogJ1RQTV9TVF9IQVNIQ0hFQ0snLFxuICAgIDB4ODAyNTogJ1RQTV9TVF9BVVRIX1NJR05FRCcsXG4gICAgMHg4MDI5OiAnVFBNX1NUX0ZVX01BTklGRVNUJyxcbn07XG4vKipcbiAqIDYuMyBUUE1fQUxHX0lEXG4gKi9cbmV4cG9ydCBjb25zdCBUUE1fQUxHID0ge1xuICAgIDB4MDAwMDogJ1RQTV9BTEdfRVJST1InLFxuICAgIDB4MDAwMTogJ1RQTV9BTEdfUlNBJyxcbiAgICAweDAwMDQ6ICdUUE1fQUxHX1NIQScsXG4gICAgLy8gQHRzLWlnbm9yZSAyMzAwXG4gICAgMHgwMDA0OiAnVFBNX0FMR19TSEExJyxcbiAgICAweDAwMDU6ICdUUE1fQUxHX0hNQUMnLFxuICAgIDB4MDAwNjogJ1RQTV9BTEdfQUVTJyxcbiAgICAweDAwMDc6ICdUUE1fQUxHX01HRjEnLFxuICAgIDB4MDAwODogJ1RQTV9BTEdfS0VZRURIQVNIJyxcbiAgICAweDAwMGE6ICdUUE1fQUxHX1hPUicsXG4gICAgMHgwMDBiOiAnVFBNX0FMR19TSEEyNTYnLFxuICAgIDB4MDAwYzogJ1RQTV9BTEdfU0hBMzg0JyxcbiAgICAweDAwMGQ6ICdUUE1fQUxHX1NIQTUxMicsXG4gICAgMHgwMDEwOiAnVFBNX0FMR19OVUxMJyxcbiAgICAweDAwMTI6ICdUUE1fQUxHX1NNM18yNTYnLFxuICAgIDB4MDAxMzogJ1RQTV9BTEdfU000JyxcbiAgICAweDAwMTQ6ICdUUE1fQUxHX1JTQVNTQScsXG4gICAgMHgwMDE1OiAnVFBNX0FMR19SU0FFUycsXG4gICAgMHgwMDE2OiAnVFBNX0FMR19SU0FQU1MnLFxuICAgIDB4MDAxNzogJ1RQTV9BTEdfT0FFUCcsXG4gICAgMHgwMDE4OiAnVFBNX0FMR19FQ0RTQScsXG4gICAgMHgwMDE5OiAnVFBNX0FMR19FQ0RIJyxcbiAgICAweDAwMWE6ICdUUE1fQUxHX0VDREFBJyxcbiAgICAweDAwMWI6ICdUUE1fQUxHX1NNMicsXG4gICAgMHgwMDFjOiAnVFBNX0FMR19FQ1NDSE5PUlInLFxuICAgIDB4MDAxZDogJ1RQTV9BTEdfRUNNUVYnLFxuICAgIDB4MDAyMDogJ1RQTV9BTEdfS0RGMV9TUDgwMF81NkEnLFxuICAgIDB4MDAyMTogJ1RQTV9BTEdfS0RGMicsXG4gICAgMHgwMDIyOiAnVFBNX0FMR19LREYxX1NQODAwXzEwOCcsXG4gICAgMHgwMDIzOiAnVFBNX0FMR19FQ0MnLFxuICAgIDB4MDAyNTogJ1RQTV9BTEdfU1lNQ0lQSEVSJyxcbiAgICAweDAwMjY6ICdUUE1fQUxHX0NBTUVMTElBJyxcbiAgICAweDAwNDA6ICdUUE1fQUxHX0NUUicsXG4gICAgMHgwMDQxOiAnVFBNX0FMR19PRkInLFxuICAgIDB4MDA0MjogJ1RQTV9BTEdfQ0JDJyxcbiAgICAweDAwNDM6ICdUUE1fQUxHX0NGQicsXG4gICAgMHgwMDQ0OiAnVFBNX0FMR19FQ0InLFxufTtcbi8qKlxuICogNi40IFRQTV9FQ0NfQ1VSVkVcbiAqL1xuZXhwb3J0IGNvbnN0IFRQTV9FQ0NfQ1VSVkUgPSB7XG4gICAgMHgwMDAwOiAnVFBNX0VDQ19OT05FJyxcbiAgICAweDAwMDE6ICdUUE1fRUNDX05JU1RfUDE5MicsXG4gICAgMHgwMDAyOiAnVFBNX0VDQ19OSVNUX1AyMjQnLFxuICAgIDB4MDAwMzogJ1RQTV9FQ0NfTklTVF9QMjU2JyxcbiAgICAweDAwMDQ6ICdUUE1fRUNDX05JU1RfUDM4NCcsXG4gICAgMHgwMDA1OiAnVFBNX0VDQ19OSVNUX1A1MjEnLFxuICAgIDB4MDAxMDogJ1RQTV9FQ0NfQk5fUDI1NicsXG4gICAgMHgwMDExOiAnVFBNX0VDQ19CTl9QNjM4JyxcbiAgICAweDAwMjA6ICdUUE1fRUNDX1NNMl9QMjU2Jyxcbn07XG4vKipcbiAqIFNvdXJjZWQgZnJvbSBodHRwczovL3RydXN0ZWRjb21wdXRpbmdncm91cC5vcmcvcmVzb3VyY2UvdmVuZG9yLWlkLXJlZ2lzdHJ5L1xuICpcbiAqIExhdGVzdCB2ZXJzaW9uOlxuICogaHR0cHM6Ly90cnVzdGVkY29tcHV0aW5nZ3JvdXAub3JnL3dwLWNvbnRlbnQvdXBsb2Fkcy9UQ0ctVFBNLVZlbmRvci1JRC1SZWdpc3RyeS1WZXJzaW9uLTEuMDItUmV2aXNpb24tMS4wMC5wZGZcbiAqL1xuZXhwb3J0IGNvbnN0IFRQTV9NQU5VRkFDVFVSRVJTID0ge1xuICAgICdpZDo0MTRENDQwMCc6IHtcbiAgICAgICAgbmFtZTogJ0FNRCcsXG4gICAgICAgIGlkOiAnQU1EJyxcbiAgICB9LFxuICAgICdpZDo0MTU0NEQ0Qyc6IHtcbiAgICAgICAgbmFtZTogJ0F0bWVsJyxcbiAgICAgICAgaWQ6ICdBVE1MJyxcbiAgICB9LFxuICAgICdpZDo0MjUyNDM0RCc6IHtcbiAgICAgICAgbmFtZTogJ0Jyb2FkY29tJyxcbiAgICAgICAgaWQ6ICdCUkNNJyxcbiAgICB9LFxuICAgICdpZDo0OTQyNGQwMCc6IHtcbiAgICAgICAgbmFtZTogJ0lCTScsXG4gICAgICAgIGlkOiAnSUJNJyxcbiAgICB9LFxuICAgICdpZDo0OTQ2NTgwMCc6IHtcbiAgICAgICAgbmFtZTogJ0luZmluZW9uJyxcbiAgICAgICAgaWQ6ICdJRlgnLFxuICAgIH0sXG4gICAgJ2lkOjQ5NEU1NDQzJzoge1xuICAgICAgICBuYW1lOiAnSW50ZWwnLFxuICAgICAgICBpZDogJ0lOVEMnLFxuICAgIH0sXG4gICAgJ2lkOjRDNDU0RTAwJzoge1xuICAgICAgICBuYW1lOiAnTGVub3ZvJyxcbiAgICAgICAgaWQ6ICdMRU4nLFxuICAgIH0sXG4gICAgJ2lkOjRFNTM0RDIwJzoge1xuICAgICAgICBuYW1lOiAnTmF0aW9uYWwgU2VtaWNvbmR1Y3RvcicsXG4gICAgICAgIGlkOiAnTlNNJyxcbiAgICB9LFxuICAgICdpZDo0RTU0NUEwMCc6IHtcbiAgICAgICAgbmFtZTogJ05hdGlvbnonLFxuICAgICAgICBpZDogJ05UWicsXG4gICAgfSxcbiAgICAnaWQ6NEU1NDQzMDAnOiB7XG4gICAgICAgIG5hbWU6ICdOdXZvdG9uIFRlY2hub2xvZ3knLFxuICAgICAgICBpZDogJ05UQycsXG4gICAgfSxcbiAgICAnaWQ6NTE0MzRGNEQnOiB7XG4gICAgICAgIG5hbWU6ICdRdWFsY29tbScsXG4gICAgICAgIGlkOiAnUUNPTScsXG4gICAgfSxcbiAgICAnaWQ6NTM0RDUzNDMnOiB7XG4gICAgICAgIG5hbWU6ICdTTVNDJyxcbiAgICAgICAgaWQ6ICdTTVNDJyxcbiAgICB9LFxuICAgICdpZDo1MzU0NEQyMCc6IHtcbiAgICAgICAgbmFtZTogJ1NUIE1pY3JvZWxlY3Ryb25pY3MnLFxuICAgICAgICBpZDogJ1NUTScsXG4gICAgfSxcbiAgICAnaWQ6NTM0RDUzNEUnOiB7XG4gICAgICAgIG5hbWU6ICdTYW1zdW5nJyxcbiAgICAgICAgaWQ6ICdTTVNOJyxcbiAgICB9LFxuICAgICdpZDo1MzRFNTMwMCc6IHtcbiAgICAgICAgbmFtZTogJ1Npbm9zdW4nLFxuICAgICAgICBpZDogJ1NOUycsXG4gICAgfSxcbiAgICAnaWQ6NTQ1ODRFMDAnOiB7XG4gICAgICAgIG5hbWU6ICdUZXhhcyBJbnN0cnVtZW50cycsXG4gICAgICAgIGlkOiAnVFhOJyxcbiAgICB9LFxuICAgICdpZDo1NzQ1NDMwMCc6IHtcbiAgICAgICAgbmFtZTogJ1dpbmJvbmQnLFxuICAgICAgICBpZDogJ1dFQycsXG4gICAgfSxcbiAgICAnaWQ6NTI0RjQzNDMnOiB7XG4gICAgICAgIG5hbWU6ICdGdXpob3VrIFJvY2tjaGlwJyxcbiAgICAgICAgaWQ6ICdST0NDJyxcbiAgICB9LFxuICAgICdpZDpGRkZGRjFEMCc6IHtcbiAgICAgICAgbmFtZTogJ0ZJRE8gQWxsaWFuY2UnLFxuICAgICAgICBpZDogJ0ZJRE8nLFxuICAgIH0sXG59O1xuLyoqXG4gKiBNYXRjaCBUUE0gcHVibGljIGFyZWEgY3VydmUgSUQncyB0byBgY3J2YCBudW1iZXJzIHVzZWQgaW4gQ09TRSBwdWJsaWMga2V5c1xuICovXG5leHBvcnQgY29uc3QgVFBNX0VDQ19DVVJWRV9DT1NFX0NSVl9NQVAgPSB7XG4gICAgVFBNX0VDQ19OSVNUX1AyNTY6IDEsXG4gICAgVFBNX0VDQ19OSVNUX1AzODQ6IDIsXG4gICAgVFBNX0VDQ19OSVNUX1A1MjE6IDMsXG4gICAgVFBNX0VDQ19CTl9QMjU2OiAxLFxuICAgIFRQTV9FQ0NfU00yX1AyNTY6IDEsIC8vIHAyNTZcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/constants.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/parseCertInfo.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/parseCertInfo.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseCertInfo: () => (/* binding */ parseCertInfo)\n/* harmony export */ });\n/* harmony import */ var _constants_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/constants.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n\n/**\n * Cut up a TPM attestation's certInfo into intelligible chunks\n */\nfunction parseCertInfo(certInfo) {\n    let pointer = 0;\n    const dataView = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.toDataView(certInfo);\n    // Get a magic constant\n    const magic = dataView.getUint32(pointer);\n    pointer += 4;\n    // Determine the algorithm used for attestation\n    const typeBuffer = dataView.getUint16(pointer);\n    pointer += 2;\n    const type = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ST[typeBuffer];\n    // The name of a parent entity, can be ignored\n    const qualifiedSignerLength = dataView.getUint16(pointer);\n    pointer += 2;\n    const qualifiedSigner = certInfo.slice(pointer, pointer += qualifiedSignerLength);\n    // Get the expected hash of `attsToBeSigned`\n    const extraDataLength = dataView.getUint16(pointer);\n    pointer += 2;\n    const extraData = certInfo.slice(pointer, pointer += extraDataLength);\n    // Information about the TPM device's internal clock, can be ignored\n    const clock = certInfo.slice(pointer, pointer += 8);\n    const resetCount = dataView.getUint32(pointer);\n    pointer += 4;\n    const restartCount = dataView.getUint32(pointer);\n    pointer += 4;\n    const safe = !!certInfo.slice(pointer, pointer += 1);\n    const clockInfo = { clock, resetCount, restartCount, safe };\n    // TPM device firmware version\n    const firmwareVersion = certInfo.slice(pointer, pointer += 8);\n    // Attested Name\n    const attestedNameLength = dataView.getUint16(pointer);\n    pointer += 2;\n    const attestedName = certInfo.slice(pointer, pointer += attestedNameLength);\n    const attestedNameDataView = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.toDataView(attestedName);\n    // Attested qualified name, can be ignored\n    const qualifiedNameLength = dataView.getUint16(pointer);\n    pointer += 2;\n    const qualifiedName = certInfo.slice(pointer, pointer += qualifiedNameLength);\n    const attested = {\n        nameAlg: _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ALG[attestedNameDataView.getUint16(0)],\n        nameAlgBuffer: attestedName.slice(0, 2),\n        name: attestedName,\n        qualifiedName,\n    };\n    return {\n        magic,\n        type,\n        qualifiedSigner,\n        extraData,\n        clockInfo,\n        firmwareVersion,\n        attested,\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdHBtL3BhcnNlQ2VydEluZm8uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWlEO0FBQ2E7QUFDOUQ7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBLHFCQUFxQiwyRUFBd0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLGlEQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsMkVBQXdCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsa0RBQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXHJlZ2lzdHJhdGlvblxcdmVyaWZpY2F0aW9uc1xcdHBtXFxwYXJzZUNlcnRJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRQTV9BTEcsIFRQTV9TVCB9IGZyb20gJy4vY29uc3RhbnRzLmpzJztcbmltcG9ydCB7IGlzb1VpbnQ4QXJyYXkgfSBmcm9tICcuLi8uLi8uLi9oZWxwZXJzL2lzby9pbmRleC5qcyc7XG4vKipcbiAqIEN1dCB1cCBhIFRQTSBhdHRlc3RhdGlvbidzIGNlcnRJbmZvIGludG8gaW50ZWxsaWdpYmxlIGNodW5rc1xuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VDZXJ0SW5mbyhjZXJ0SW5mbykge1xuICAgIGxldCBwb2ludGVyID0gMDtcbiAgICBjb25zdCBkYXRhVmlldyA9IGlzb1VpbnQ4QXJyYXkudG9EYXRhVmlldyhjZXJ0SW5mbyk7XG4gICAgLy8gR2V0IGEgbWFnaWMgY29uc3RhbnRcbiAgICBjb25zdCBtYWdpYyA9IGRhdGFWaWV3LmdldFVpbnQzMihwb2ludGVyKTtcbiAgICBwb2ludGVyICs9IDQ7XG4gICAgLy8gRGV0ZXJtaW5lIHRoZSBhbGdvcml0aG0gdXNlZCBmb3IgYXR0ZXN0YXRpb25cbiAgICBjb25zdCB0eXBlQnVmZmVyID0gZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpO1xuICAgIHBvaW50ZXIgKz0gMjtcbiAgICBjb25zdCB0eXBlID0gVFBNX1NUW3R5cGVCdWZmZXJdO1xuICAgIC8vIFRoZSBuYW1lIG9mIGEgcGFyZW50IGVudGl0eSwgY2FuIGJlIGlnbm9yZWRcbiAgICBjb25zdCBxdWFsaWZpZWRTaWduZXJMZW5ndGggPSBkYXRhVmlldy5nZXRVaW50MTYocG9pbnRlcik7XG4gICAgcG9pbnRlciArPSAyO1xuICAgIGNvbnN0IHF1YWxpZmllZFNpZ25lciA9IGNlcnRJbmZvLnNsaWNlKHBvaW50ZXIsIHBvaW50ZXIgKz0gcXVhbGlmaWVkU2lnbmVyTGVuZ3RoKTtcbiAgICAvLyBHZXQgdGhlIGV4cGVjdGVkIGhhc2ggb2YgYGF0dHNUb0JlU2lnbmVkYFxuICAgIGNvbnN0IGV4dHJhRGF0YUxlbmd0aCA9IGRhdGFWaWV3LmdldFVpbnQxNihwb2ludGVyKTtcbiAgICBwb2ludGVyICs9IDI7XG4gICAgY29uc3QgZXh0cmFEYXRhID0gY2VydEluZm8uc2xpY2UocG9pbnRlciwgcG9pbnRlciArPSBleHRyYURhdGFMZW5ndGgpO1xuICAgIC8vIEluZm9ybWF0aW9uIGFib3V0IHRoZSBUUE0gZGV2aWNlJ3MgaW50ZXJuYWwgY2xvY2ssIGNhbiBiZSBpZ25vcmVkXG4gICAgY29uc3QgY2xvY2sgPSBjZXJ0SW5mby5zbGljZShwb2ludGVyLCBwb2ludGVyICs9IDgpO1xuICAgIGNvbnN0IHJlc2V0Q291bnQgPSBkYXRhVmlldy5nZXRVaW50MzIocG9pbnRlcik7XG4gICAgcG9pbnRlciArPSA0O1xuICAgIGNvbnN0IHJlc3RhcnRDb3VudCA9IGRhdGFWaWV3LmdldFVpbnQzMihwb2ludGVyKTtcbiAgICBwb2ludGVyICs9IDQ7XG4gICAgY29uc3Qgc2FmZSA9ICEhY2VydEluZm8uc2xpY2UocG9pbnRlciwgcG9pbnRlciArPSAxKTtcbiAgICBjb25zdCBjbG9ja0luZm8gPSB7IGNsb2NrLCByZXNldENvdW50LCByZXN0YXJ0Q291bnQsIHNhZmUgfTtcbiAgICAvLyBUUE0gZGV2aWNlIGZpcm13YXJlIHZlcnNpb25cbiAgICBjb25zdCBmaXJtd2FyZVZlcnNpb24gPSBjZXJ0SW5mby5zbGljZShwb2ludGVyLCBwb2ludGVyICs9IDgpO1xuICAgIC8vIEF0dGVzdGVkIE5hbWVcbiAgICBjb25zdCBhdHRlc3RlZE5hbWVMZW5ndGggPSBkYXRhVmlldy5nZXRVaW50MTYocG9pbnRlcik7XG4gICAgcG9pbnRlciArPSAyO1xuICAgIGNvbnN0IGF0dGVzdGVkTmFtZSA9IGNlcnRJbmZvLnNsaWNlKHBvaW50ZXIsIHBvaW50ZXIgKz0gYXR0ZXN0ZWROYW1lTGVuZ3RoKTtcbiAgICBjb25zdCBhdHRlc3RlZE5hbWVEYXRhVmlldyA9IGlzb1VpbnQ4QXJyYXkudG9EYXRhVmlldyhhdHRlc3RlZE5hbWUpO1xuICAgIC8vIEF0dGVzdGVkIHF1YWxpZmllZCBuYW1lLCBjYW4gYmUgaWdub3JlZFxuICAgIGNvbnN0IHF1YWxpZmllZE5hbWVMZW5ndGggPSBkYXRhVmlldy5nZXRVaW50MTYocG9pbnRlcik7XG4gICAgcG9pbnRlciArPSAyO1xuICAgIGNvbnN0IHF1YWxpZmllZE5hbWUgPSBjZXJ0SW5mby5zbGljZShwb2ludGVyLCBwb2ludGVyICs9IHF1YWxpZmllZE5hbWVMZW5ndGgpO1xuICAgIGNvbnN0IGF0dGVzdGVkID0ge1xuICAgICAgICBuYW1lQWxnOiBUUE1fQUxHW2F0dGVzdGVkTmFtZURhdGFWaWV3LmdldFVpbnQxNigwKV0sXG4gICAgICAgIG5hbWVBbGdCdWZmZXI6IGF0dGVzdGVkTmFtZS5zbGljZSgwLCAyKSxcbiAgICAgICAgbmFtZTogYXR0ZXN0ZWROYW1lLFxuICAgICAgICBxdWFsaWZpZWROYW1lLFxuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbWFnaWMsXG4gICAgICAgIHR5cGUsXG4gICAgICAgIHF1YWxpZmllZFNpZ25lcixcbiAgICAgICAgZXh0cmFEYXRhLFxuICAgICAgICBjbG9ja0luZm8sXG4gICAgICAgIGZpcm13YXJlVmVyc2lvbixcbiAgICAgICAgYXR0ZXN0ZWQsXG4gICAgfTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/parseCertInfo.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/parsePubArea.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/parsePubArea.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parsePubArea: () => (/* binding */ parsePubArea)\n/* harmony export */ });\n/* harmony import */ var _constants_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/constants.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n\n/**\n * Break apart a TPM attestation's pubArea buffer\n *\n * See 12.2.4 TPMT_PUBLIC here:\n * https://trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-2-Structures-00.96-130315.pdf\n */\nfunction parsePubArea(pubArea) {\n    let pointer = 0;\n    const dataView = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.toDataView(pubArea);\n    const type = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ALG[dataView.getUint16(pointer)];\n    pointer += 2;\n    const nameAlg = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ALG[dataView.getUint16(pointer)];\n    pointer += 2;\n    // Get some authenticator attributes(?)\n    // const objectAttributesInt = pubArea.slice(pointer, (pointer += 4)).readUInt32BE(0);\n    const objectAttributesInt = dataView.getUint32(pointer);\n    pointer += 4;\n    const objectAttributes = {\n        fixedTPM: !!(objectAttributesInt & 1),\n        stClear: !!(objectAttributesInt & 2),\n        fixedParent: !!(objectAttributesInt & 8),\n        sensitiveDataOrigin: !!(objectAttributesInt & 16),\n        userWithAuth: !!(objectAttributesInt & 32),\n        adminWithPolicy: !!(objectAttributesInt & 64),\n        noDA: !!(objectAttributesInt & 512),\n        encryptedDuplication: !!(objectAttributesInt & 1024),\n        restricted: !!(objectAttributesInt & 32768),\n        decrypt: !!(objectAttributesInt & 65536),\n        signOrEncrypt: !!(objectAttributesInt & 131072),\n    };\n    // Slice out the authPolicy of dynamic length\n    const authPolicyLength = dataView.getUint16(pointer);\n    pointer += 2;\n    const authPolicy = pubArea.slice(pointer, pointer += authPolicyLength);\n    // Extract additional curve params according to type\n    const parameters = {};\n    let unique = Uint8Array.from([]);\n    if (type === 'TPM_ALG_RSA') {\n        const symmetric = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ALG[dataView.getUint16(pointer)];\n        pointer += 2;\n        const scheme = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ALG[dataView.getUint16(pointer)];\n        pointer += 2;\n        const keyBits = dataView.getUint16(pointer);\n        pointer += 2;\n        const exponent = dataView.getUint32(pointer);\n        pointer += 4;\n        parameters.rsa = { symmetric, scheme, keyBits, exponent };\n        /**\n         * See 11.2.4.5 TPM2B_PUBLIC_KEY_RSA here:\n         * https://trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-2-Structures-00.96-130315.pdf\n         */\n        // const uniqueLength = pubArea.slice(pointer, (pointer += 2)).readUInt16BE(0);\n        const uniqueLength = dataView.getUint16(pointer);\n        pointer += 2;\n        unique = pubArea.slice(pointer, pointer += uniqueLength);\n    }\n    else if (type === 'TPM_ALG_ECC') {\n        const symmetric = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ALG[dataView.getUint16(pointer)];\n        pointer += 2;\n        const scheme = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ALG[dataView.getUint16(pointer)];\n        pointer += 2;\n        const curveID = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ECC_CURVE[dataView.getUint16(pointer)];\n        pointer += 2;\n        const kdf = _constants_js__WEBPACK_IMPORTED_MODULE_0__.TPM_ALG[dataView.getUint16(pointer)];\n        pointer += 2;\n        parameters.ecc = { symmetric, scheme, curveID, kdf };\n        /**\n         * See 11.2.5.1 TPM2B_ECC_PARAMETER here:\n         * https://trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-2-Structures-00.96-130315.pdf\n         */\n        // Retrieve X\n        const uniqueXLength = dataView.getUint16(pointer);\n        pointer += 2;\n        const uniqueX = pubArea.slice(pointer, pointer += uniqueXLength);\n        // Retrieve Y\n        const uniqueYLength = dataView.getUint16(pointer);\n        pointer += 2;\n        const uniqueY = pubArea.slice(pointer, pointer += uniqueYLength);\n        unique = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_1__.isoUint8Array.concat([uniqueX, uniqueY]);\n    }\n    else {\n        throw new Error(`Unexpected type \"${type}\" (TPM)`);\n    }\n    return {\n        type,\n        nameAlg,\n        objectAttributes,\n        authPolicy,\n        parameters,\n        unique,\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdHBtL3BhcnNlUHViQXJlYS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBd0Q7QUFDTTtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0EscUJBQXFCLDJFQUF3QjtBQUM3QyxpQkFBaUIsa0RBQU87QUFDeEI7QUFDQSxvQkFBb0Isa0RBQU87QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixrREFBTztBQUNqQztBQUNBLHVCQUF1QixrREFBTztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLGtEQUFPO0FBQ2pDO0FBQ0EsdUJBQXVCLGtEQUFPO0FBQzlCO0FBQ0Esd0JBQXdCLHdEQUFhO0FBQ3JDO0FBQ0Esb0JBQW9CLGtEQUFPO0FBQzNCO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix1RUFBb0I7QUFDckM7QUFDQTtBQUNBLDRDQUE0QyxLQUFLO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxccmVnaXN0cmF0aW9uXFx2ZXJpZmljYXRpb25zXFx0cG1cXHBhcnNlUHViQXJlYS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUUE1fQUxHLCBUUE1fRUNDX0NVUlZFIH0gZnJvbSAnLi9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgaXNvVWludDhBcnJheSB9IGZyb20gJy4uLy4uLy4uL2hlbHBlcnMvaXNvL2luZGV4LmpzJztcbi8qKlxuICogQnJlYWsgYXBhcnQgYSBUUE0gYXR0ZXN0YXRpb24ncyBwdWJBcmVhIGJ1ZmZlclxuICpcbiAqIFNlZSAxMi4yLjQgVFBNVF9QVUJMSUMgaGVyZTpcbiAqIGh0dHBzOi8vdHJ1c3RlZGNvbXB1dGluZ2dyb3VwLm9yZy93cC1jb250ZW50L3VwbG9hZHMvVFBNLVJldi0yLjAtUGFydC0yLVN0cnVjdHVyZXMtMDAuOTYtMTMwMzE1LnBkZlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VQdWJBcmVhKHB1YkFyZWEpIHtcbiAgICBsZXQgcG9pbnRlciA9IDA7XG4gICAgY29uc3QgZGF0YVZpZXcgPSBpc29VaW50OEFycmF5LnRvRGF0YVZpZXcocHViQXJlYSk7XG4gICAgY29uc3QgdHlwZSA9IFRQTV9BTEdbZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpXTtcbiAgICBwb2ludGVyICs9IDI7XG4gICAgY29uc3QgbmFtZUFsZyA9IFRQTV9BTEdbZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpXTtcbiAgICBwb2ludGVyICs9IDI7XG4gICAgLy8gR2V0IHNvbWUgYXV0aGVudGljYXRvciBhdHRyaWJ1dGVzKD8pXG4gICAgLy8gY29uc3Qgb2JqZWN0QXR0cmlidXRlc0ludCA9IHB1YkFyZWEuc2xpY2UocG9pbnRlciwgKHBvaW50ZXIgKz0gNCkpLnJlYWRVSW50MzJCRSgwKTtcbiAgICBjb25zdCBvYmplY3RBdHRyaWJ1dGVzSW50ID0gZGF0YVZpZXcuZ2V0VWludDMyKHBvaW50ZXIpO1xuICAgIHBvaW50ZXIgKz0gNDtcbiAgICBjb25zdCBvYmplY3RBdHRyaWJ1dGVzID0ge1xuICAgICAgICBmaXhlZFRQTTogISEob2JqZWN0QXR0cmlidXRlc0ludCAmIDEpLFxuICAgICAgICBzdENsZWFyOiAhIShvYmplY3RBdHRyaWJ1dGVzSW50ICYgMiksXG4gICAgICAgIGZpeGVkUGFyZW50OiAhIShvYmplY3RBdHRyaWJ1dGVzSW50ICYgOCksXG4gICAgICAgIHNlbnNpdGl2ZURhdGFPcmlnaW46ICEhKG9iamVjdEF0dHJpYnV0ZXNJbnQgJiAxNiksXG4gICAgICAgIHVzZXJXaXRoQXV0aDogISEob2JqZWN0QXR0cmlidXRlc0ludCAmIDMyKSxcbiAgICAgICAgYWRtaW5XaXRoUG9saWN5OiAhIShvYmplY3RBdHRyaWJ1dGVzSW50ICYgNjQpLFxuICAgICAgICBub0RBOiAhIShvYmplY3RBdHRyaWJ1dGVzSW50ICYgNTEyKSxcbiAgICAgICAgZW5jcnlwdGVkRHVwbGljYXRpb246ICEhKG9iamVjdEF0dHJpYnV0ZXNJbnQgJiAxMDI0KSxcbiAgICAgICAgcmVzdHJpY3RlZDogISEob2JqZWN0QXR0cmlidXRlc0ludCAmIDMyNzY4KSxcbiAgICAgICAgZGVjcnlwdDogISEob2JqZWN0QXR0cmlidXRlc0ludCAmIDY1NTM2KSxcbiAgICAgICAgc2lnbk9yRW5jcnlwdDogISEob2JqZWN0QXR0cmlidXRlc0ludCAmIDEzMTA3MiksXG4gICAgfTtcbiAgICAvLyBTbGljZSBvdXQgdGhlIGF1dGhQb2xpY3kgb2YgZHluYW1pYyBsZW5ndGhcbiAgICBjb25zdCBhdXRoUG9saWN5TGVuZ3RoID0gZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpO1xuICAgIHBvaW50ZXIgKz0gMjtcbiAgICBjb25zdCBhdXRoUG9saWN5ID0gcHViQXJlYS5zbGljZShwb2ludGVyLCBwb2ludGVyICs9IGF1dGhQb2xpY3lMZW5ndGgpO1xuICAgIC8vIEV4dHJhY3QgYWRkaXRpb25hbCBjdXJ2ZSBwYXJhbXMgYWNjb3JkaW5nIHRvIHR5cGVcbiAgICBjb25zdCBwYXJhbWV0ZXJzID0ge307XG4gICAgbGV0IHVuaXF1ZSA9IFVpbnQ4QXJyYXkuZnJvbShbXSk7XG4gICAgaWYgKHR5cGUgPT09ICdUUE1fQUxHX1JTQScpIHtcbiAgICAgICAgY29uc3Qgc3ltbWV0cmljID0gVFBNX0FMR1tkYXRhVmlldy5nZXRVaW50MTYocG9pbnRlcildO1xuICAgICAgICBwb2ludGVyICs9IDI7XG4gICAgICAgIGNvbnN0IHNjaGVtZSA9IFRQTV9BTEdbZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpXTtcbiAgICAgICAgcG9pbnRlciArPSAyO1xuICAgICAgICBjb25zdCBrZXlCaXRzID0gZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpO1xuICAgICAgICBwb2ludGVyICs9IDI7XG4gICAgICAgIGNvbnN0IGV4cG9uZW50ID0gZGF0YVZpZXcuZ2V0VWludDMyKHBvaW50ZXIpO1xuICAgICAgICBwb2ludGVyICs9IDQ7XG4gICAgICAgIHBhcmFtZXRlcnMucnNhID0geyBzeW1tZXRyaWMsIHNjaGVtZSwga2V5Qml0cywgZXhwb25lbnQgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNlZSAxMS4yLjQuNSBUUE0yQl9QVUJMSUNfS0VZX1JTQSBoZXJlOlxuICAgICAgICAgKiBodHRwczovL3RydXN0ZWRjb21wdXRpbmdncm91cC5vcmcvd3AtY29udGVudC91cGxvYWRzL1RQTS1SZXYtMi4wLVBhcnQtMi1TdHJ1Y3R1cmVzLTAwLjk2LTEzMDMxNS5wZGZcbiAgICAgICAgICovXG4gICAgICAgIC8vIGNvbnN0IHVuaXF1ZUxlbmd0aCA9IHB1YkFyZWEuc2xpY2UocG9pbnRlciwgKHBvaW50ZXIgKz0gMikpLnJlYWRVSW50MTZCRSgwKTtcbiAgICAgICAgY29uc3QgdW5pcXVlTGVuZ3RoID0gZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpO1xuICAgICAgICBwb2ludGVyICs9IDI7XG4gICAgICAgIHVuaXF1ZSA9IHB1YkFyZWEuc2xpY2UocG9pbnRlciwgcG9pbnRlciArPSB1bmlxdWVMZW5ndGgpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSAnVFBNX0FMR19FQ0MnKSB7XG4gICAgICAgIGNvbnN0IHN5bW1ldHJpYyA9IFRQTV9BTEdbZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpXTtcbiAgICAgICAgcG9pbnRlciArPSAyO1xuICAgICAgICBjb25zdCBzY2hlbWUgPSBUUE1fQUxHW2RhdGFWaWV3LmdldFVpbnQxNihwb2ludGVyKV07XG4gICAgICAgIHBvaW50ZXIgKz0gMjtcbiAgICAgICAgY29uc3QgY3VydmVJRCA9IFRQTV9FQ0NfQ1VSVkVbZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpXTtcbiAgICAgICAgcG9pbnRlciArPSAyO1xuICAgICAgICBjb25zdCBrZGYgPSBUUE1fQUxHW2RhdGFWaWV3LmdldFVpbnQxNihwb2ludGVyKV07XG4gICAgICAgIHBvaW50ZXIgKz0gMjtcbiAgICAgICAgcGFyYW1ldGVycy5lY2MgPSB7IHN5bW1ldHJpYywgc2NoZW1lLCBjdXJ2ZUlELCBrZGYgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNlZSAxMS4yLjUuMSBUUE0yQl9FQ0NfUEFSQU1FVEVSIGhlcmU6XG4gICAgICAgICAqIGh0dHBzOi8vdHJ1c3RlZGNvbXB1dGluZ2dyb3VwLm9yZy93cC1jb250ZW50L3VwbG9hZHMvVFBNLVJldi0yLjAtUGFydC0yLVN0cnVjdHVyZXMtMDAuOTYtMTMwMzE1LnBkZlxuICAgICAgICAgKi9cbiAgICAgICAgLy8gUmV0cmlldmUgWFxuICAgICAgICBjb25zdCB1bmlxdWVYTGVuZ3RoID0gZGF0YVZpZXcuZ2V0VWludDE2KHBvaW50ZXIpO1xuICAgICAgICBwb2ludGVyICs9IDI7XG4gICAgICAgIGNvbnN0IHVuaXF1ZVggPSBwdWJBcmVhLnNsaWNlKHBvaW50ZXIsIHBvaW50ZXIgKz0gdW5pcXVlWExlbmd0aCk7XG4gICAgICAgIC8vIFJldHJpZXZlIFlcbiAgICAgICAgY29uc3QgdW5pcXVlWUxlbmd0aCA9IGRhdGFWaWV3LmdldFVpbnQxNihwb2ludGVyKTtcbiAgICAgICAgcG9pbnRlciArPSAyO1xuICAgICAgICBjb25zdCB1bmlxdWVZID0gcHViQXJlYS5zbGljZShwb2ludGVyLCBwb2ludGVyICs9IHVuaXF1ZVlMZW5ndGgpO1xuICAgICAgICB1bmlxdWUgPSBpc29VaW50OEFycmF5LmNvbmNhdChbdW5pcXVlWCwgdW5pcXVlWV0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHR5cGUgXCIke3R5cGV9XCIgKFRQTSlgKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZSxcbiAgICAgICAgbmFtZUFsZyxcbiAgICAgICAgb2JqZWN0QXR0cmlidXRlcyxcbiAgICAgICAgYXV0aFBvbGljeSxcbiAgICAgICAgcGFyYW1ldGVycyxcbiAgICAgICAgdW5pcXVlLFxuICAgIH07XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/parsePubArea.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/verifyAttestationTPM.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/verifyAttestationTPM.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyAttestationTPM: () => (/* binding */ verifyAttestationTPM)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n/* harmony import */ var _helpers_decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../helpers/decodeCredentialPublicKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeCredentialPublicKey.js\");\n/* harmony import */ var _helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../helpers/cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _helpers_toHash_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../helpers/toHash.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js\");\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../helpers/validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _helpers_getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../helpers/getCertificateInfo.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/getCertificateInfo.js\");\n/* harmony import */ var _helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../helpers/verifySignature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _services_metadataService_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../services/metadataService.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/metadataService.js\");\n/* harmony import */ var _metadata_verifyAttestationWithMetadata_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../metadata/verifyAttestationWithMetadata.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyAttestationWithMetadata.js\");\n/* harmony import */ var _constants_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./constants.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/constants.js\");\n/* harmony import */ var _parseCertInfo_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./parseCertInfo.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/parseCertInfo.js\");\n/* harmony import */ var _parsePubArea_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./parsePubArea.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/parsePubArea.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nasync function verifyAttestationTPM(options) {\n    const { aaguid, attStmt, authData, credentialPublicKey, clientDataHash, rootCertificates, } = options;\n    const ver = attStmt.get('ver');\n    const sig = attStmt.get('sig');\n    const alg = attStmt.get('alg');\n    const x5c = attStmt.get('x5c');\n    const pubArea = attStmt.get('pubArea');\n    const certInfo = attStmt.get('certInfo');\n    /**\n     * Verify structures\n     */\n    if (ver !== '2.0') {\n        throw new Error(`Unexpected ver \"${ver}\", expected \"2.0\" (TPM)`);\n    }\n    if (!sig) {\n        throw new Error('No attestation signature provided in attestation statement (TPM)');\n    }\n    if (!alg) {\n        throw new Error(`Attestation statement did not contain alg (TPM)`);\n    }\n    if (!(0,_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.isCOSEAlg)(alg)) {\n        throw new Error(`Attestation statement contained invalid alg ${alg} (TPM)`);\n    }\n    if (!x5c) {\n        throw new Error('No attestation certificate provided in attestation statement (TPM)');\n    }\n    if (!pubArea) {\n        throw new Error('Attestation statement did not contain pubArea (TPM)');\n    }\n    if (!certInfo) {\n        throw new Error('Attestation statement did not contain certInfo (TPM)');\n    }\n    const parsedPubArea = (0,_parsePubArea_js__WEBPACK_IMPORTED_MODULE_13__.parsePubArea)(pubArea);\n    const { unique, type: pubType, parameters } = parsedPubArea;\n    // Verify that the public key specified by the parameters and unique fields of pubArea is\n    // identical to the credentialPublicKey in the attestedCredentialData in authenticatorData.\n    const cosePublicKey = (0,_helpers_decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_1__.decodeCredentialPublicKey)(credentialPublicKey);\n    if (pubType === 'TPM_ALG_RSA') {\n        if (!(0,_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.isCOSEPublicKeyRSA)(cosePublicKey)) {\n            throw new Error(`Credential public key with kty ${cosePublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEKEYS.kty)} did not match ${pubType}`);\n        }\n        const n = cosePublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEKEYS.n);\n        const e = cosePublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEKEYS.e);\n        if (!n) {\n            throw new Error('COSE public key missing n (TPM|RSA)');\n        }\n        if (!e) {\n            throw new Error('COSE public key missing e (TPM|RSA)');\n        }\n        if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_8__.isoUint8Array.areEqual(unique, n)) {\n            throw new Error('PubArea unique is not same as credentialPublicKey (TPM|RSA)');\n        }\n        if (!parameters.rsa) {\n            throw new Error(`Parsed pubArea type is RSA, but missing parameters.rsa (TPM|RSA)`);\n        }\n        const eBuffer = e;\n        // If `exponent` is equal to 0x00, then exponent is the default RSA exponent of 2^16+1 (65537)\n        const pubAreaExponent = parameters.rsa.exponent || 65537;\n        // Do some bit shifting to get to an integer\n        const eSum = eBuffer[0] + (eBuffer[1] << 8) + (eBuffer[2] << 16);\n        if (pubAreaExponent !== eSum) {\n            throw new Error(`Unexpected public key exp ${eSum}, expected ${pubAreaExponent} (TPM|RSA)`);\n        }\n    }\n    else if (pubType === 'TPM_ALG_ECC') {\n        if (!(0,_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.isCOSEPublicKeyEC2)(cosePublicKey)) {\n            throw new Error(`Credential public key with kty ${cosePublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEKEYS.kty)} did not match ${pubType}`);\n        }\n        const crv = cosePublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEKEYS.crv);\n        const x = cosePublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEKEYS.x);\n        const y = cosePublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEKEYS.y);\n        if (!crv) {\n            throw new Error('COSE public key missing crv (TPM|ECC)');\n        }\n        if (!x) {\n            throw new Error('COSE public key missing x (TPM|ECC)');\n        }\n        if (!y) {\n            throw new Error('COSE public key missing y (TPM|ECC)');\n        }\n        if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_8__.isoUint8Array.areEqual(unique, _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_8__.isoUint8Array.concat([x, y]))) {\n            throw new Error('PubArea unique is not same as public key x and y (TPM|ECC)');\n        }\n        if (!parameters.ecc) {\n            throw new Error(`Parsed pubArea type is ECC, but missing parameters.ecc (TPM|ECC)`);\n        }\n        const pubAreaCurveID = parameters.ecc.curveID;\n        const pubAreaCurveIDMapToCOSECRV = _constants_js__WEBPACK_IMPORTED_MODULE_11__.TPM_ECC_CURVE_COSE_CRV_MAP[pubAreaCurveID];\n        if (pubAreaCurveIDMapToCOSECRV !== crv) {\n            throw new Error(`Public area key curve ID \"${pubAreaCurveID}\" mapped to \"${pubAreaCurveIDMapToCOSECRV}\" which did not match public key crv of \"${crv}\" (TPM|ECC)`);\n        }\n    }\n    else {\n        throw new Error(`Unsupported pubArea.type \"${pubType}\"`);\n    }\n    const parsedCertInfo = (0,_parseCertInfo_js__WEBPACK_IMPORTED_MODULE_12__.parseCertInfo)(certInfo);\n    const { magic, type: certType, attested, extraData } = parsedCertInfo;\n    if (magic !== 0xff544347) {\n        throw new Error(`Unexpected magic value \"${magic}\", expected \"0xff544347\" (TPM)`);\n    }\n    if (certType !== 'TPM_ST_ATTEST_CERTIFY') {\n        throw new Error(`Unexpected type \"${certType}\", expected \"TPM_ST_ATTEST_CERTIFY\" (TPM)`);\n    }\n    // Hash pubArea to create pubAreaHash using the nameAlg in attested\n    const pubAreaHash = await (0,_helpers_toHash_js__WEBPACK_IMPORTED_MODULE_3__.toHash)(pubArea, attestedNameAlgToCOSEAlg(attested.nameAlg));\n    // Concatenate attested.nameAlg and pubAreaHash to create attestedName.\n    const attestedName = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_8__.isoUint8Array.concat([\n        attested.nameAlgBuffer,\n        pubAreaHash,\n    ]);\n    // Check that certInfo.attested.name is equals to attestedName.\n    if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_8__.isoUint8Array.areEqual(attested.name, attestedName)) {\n        throw new Error(`Attested name comparison failed (TPM)`);\n    }\n    // Concatenate authData with clientDataHash to create attToBeSigned\n    const attToBeSigned = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_8__.isoUint8Array.concat([authData, clientDataHash]);\n    // Hash attToBeSigned using the algorithm specified in attStmt.alg to create attToBeSignedHash\n    const attToBeSignedHash = await (0,_helpers_toHash_js__WEBPACK_IMPORTED_MODULE_3__.toHash)(attToBeSigned, alg);\n    // Check that certInfo.extraData is equals to attToBeSignedHash.\n    if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_8__.isoUint8Array.areEqual(extraData, attToBeSignedHash)) {\n        throw new Error('CertInfo extra data did not equal hashed attestation (TPM)');\n    }\n    /**\n     * Verify signature\n     */\n    if (x5c.length < 1) {\n        throw new Error('No certificates present in x5c array (TPM)');\n    }\n    // Pick a leaf AIK certificate of the x5c array and parse it.\n    const leafCertInfo = (0,_helpers_getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_6__.getCertificateInfo)(x5c[0]);\n    const { basicConstraintsCA, version, subject, notAfter, notBefore } = leafCertInfo;\n    if (basicConstraintsCA) {\n        throw new Error('Certificate basic constraints CA was not `false` (TPM)');\n    }\n    // Check that certificate is of version 3 (value must be set to 2).\n    if (version !== 2) {\n        throw new Error('Certificate version was not `3` (ASN.1 value of 2) (TPM)');\n    }\n    // Check that Subject sequence is empty.\n    if (subject.combined.length > 0) {\n        throw new Error('Certificate subject was not empty (TPM)');\n    }\n    // Check that certificate is currently valid\n    let now = new Date();\n    if (notBefore > now) {\n        throw new Error(`Certificate not good before \"${notBefore.toString()}\" (TPM)`);\n    }\n    // Check that certificate has not expired\n    now = new Date();\n    if (notAfter < now) {\n        throw new Error(`Certificate not good after \"${notAfter.toString()}\" (TPM)`);\n    }\n    /**\n     * Plumb the depths of the certificate's ASN.1-formatted data for some values we need to verify\n     */\n    const parsedCert = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(x5c[0], _deps_js__WEBPACK_IMPORTED_MODULE_0__.Certificate);\n    if (!parsedCert.tbsCertificate.extensions) {\n        throw new Error('Certificate was missing extensions (TPM)');\n    }\n    let subjectAltNamePresent;\n    let extKeyUsage;\n    parsedCert.tbsCertificate.extensions.forEach((ext) => {\n        if (ext.extnID === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_ce_subjectAltName) {\n            subjectAltNamePresent = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(ext.extnValue, _deps_js__WEBPACK_IMPORTED_MODULE_0__.SubjectAlternativeName);\n        }\n        else if (ext.extnID === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_ce_extKeyUsage) {\n            extKeyUsage = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(ext.extnValue, _deps_js__WEBPACK_IMPORTED_MODULE_0__.ExtendedKeyUsage);\n        }\n    });\n    // Check that certificate contains subjectAltName (2.5.29.17) extension,\n    if (!subjectAltNamePresent) {\n        throw new Error('Certificate did not contain subjectAltName extension (TPM)');\n    }\n    // TPM-specific values are buried within `directoryName`, so first make sure there are values\n    // there.\n    if (!subjectAltNamePresent[0].directoryName?.[0].length) {\n        throw new Error('Certificate subjectAltName extension directoryName was empty (TPM)');\n    }\n    const { tcgAtTpmManufacturer, tcgAtTpmModel, tcgAtTpmVersion } = getTcgAtTpmValues(subjectAltNamePresent[0].directoryName);\n    if (!tcgAtTpmManufacturer || !tcgAtTpmModel || !tcgAtTpmVersion) {\n        throw new Error('Certificate contained incomplete subjectAltName data (TPM)');\n    }\n    if (!extKeyUsage) {\n        throw new Error('Certificate did not contain ExtendedKeyUsage extension (TPM)');\n    }\n    // Check that tcpaTpmManufacturer (2.23.133.2.1) field is set to a valid manufacturer ID.\n    if (!_constants_js__WEBPACK_IMPORTED_MODULE_11__.TPM_MANUFACTURERS[tcgAtTpmManufacturer]) {\n        throw new Error(`Could not match TPM manufacturer \"${tcgAtTpmManufacturer}\" (TPM)`);\n    }\n    // Check that certificate contains extKeyUsage (2.5.29.37) extension and it must contain\n    // tcg-kp-AIKCertificate (2.23.133.8.3) OID.\n    if (extKeyUsage[0] !== '2.23.133.8.3') {\n        throw new Error(`Unexpected extKeyUsage \"${extKeyUsage[0]}\", expected \"2.23.133.8.3\" (TPM)`);\n    }\n    // TODO: If certificate contains id-fido-gen-ce-aaguid(1.3.6.1.4.1.45724.1.1.4) extension, check\n    // that its value is set to the same AAGUID as in authData.\n    // Run some metadata checks if a statement exists for this authenticator\n    const statement = await _services_metadataService_js__WEBPACK_IMPORTED_MODULE_9__.MetadataService.getStatement(aaguid);\n    if (statement) {\n        try {\n            await (0,_metadata_verifyAttestationWithMetadata_js__WEBPACK_IMPORTED_MODULE_10__.verifyAttestationWithMetadata)({\n                statement,\n                credentialPublicKey,\n                x5c,\n                attestationStatementAlg: alg,\n            });\n        }\n        catch (err) {\n            const _err = err;\n            throw new Error(`${_err.message} (TPM)`);\n        }\n    }\n    else {\n        try {\n            // Try validating the certificate path using the root certificates set via SettingsService\n            await (0,_helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_5__.validateCertificatePath)(x5c.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_4__.convertCertBufferToPEM), rootCertificates);\n        }\n        catch (err) {\n            const _err = err;\n            throw new Error(`${_err.message} (TPM)`);\n        }\n    }\n    // Verify signature over certInfo with the public key extracted from AIK certificate.\n    // In the wise words of Yuriy Ackermann: \"Get Martini friend, you are done!\"\n    return (0,_helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_7__.verifySignature)({\n        signature: sig,\n        data: certInfo,\n        x509Certificate: x5c[0],\n        hashAlgorithm: alg,\n    });\n}\n/**\n * Contain logic for pulling TPM-specific values out of subjectAlternativeName extension\n */\nfunction getTcgAtTpmValues(root) {\n    const oidManufacturer = '2.23.133.2.1';\n    const oidModel = '2.23.133.2.2';\n    const oidVersion = '2.23.133.2.3';\n    let tcgAtTpmManufacturer;\n    let tcgAtTpmModel;\n    let tcgAtTpmVersion;\n    /**\n     * Iterate through the following potential structures:\n     *\n     * (Good, follows the spec)\n     * https://trustedcomputinggroup.org/wp-content/uploads/TCG_IWG_EKCredentialProfile_v2p3_r2_pub.pdf (page 33)\n     * Name [\n     *   RelativeDistinguishedName [\n     *     AttributeTypeAndValue { type, value }\n     *   ]\n     *   RelativeDistinguishedName [\n     *     AttributeTypeAndValue { type, value }\n     *   ]\n     *   RelativeDistinguishedName [\n     *     AttributeTypeAndValue { type, value }\n     *   ]\n     * ]\n     *\n     * (Bad, does not follow the spec)\n     * Name [\n     *   RelativeDistinguishedName [\n     *     AttributeTypeAndValue { type, value }\n     *     AttributeTypeAndValue { type, value }\n     *     AttributeTypeAndValue { type, value }\n     *   ]\n     * ]\n     *\n     * Both structures have been seen in the wild and need to be supported\n     */\n    root.forEach((relName) => {\n        relName.forEach((attr) => {\n            if (attr.type === oidManufacturer) {\n                tcgAtTpmManufacturer = attr.value.toString();\n            }\n            else if (attr.type === oidModel) {\n                tcgAtTpmModel = attr.value.toString();\n            }\n            else if (attr.type === oidVersion) {\n                tcgAtTpmVersion = attr.value.toString();\n            }\n        });\n    });\n    return {\n        tcgAtTpmManufacturer,\n        tcgAtTpmModel,\n        tcgAtTpmVersion,\n    };\n}\n/**\n * Convert TPM-specific SHA algorithm ID's with COSE-specific equivalents. Note that the choice to\n * use ECDSA SHA IDs is arbitrary; any such COSEALG that would map to SHA-256 in\n * `mapCoseAlgToWebCryptoAlg()`\n *\n * SHA IDs referenced from here:\n *\n * https://trustedcomputinggroup.org/wp-content/uploads/TCG_TPM2_r1p59_Part2_Structures_pub.pdf\n */\nfunction attestedNameAlgToCOSEAlg(alg) {\n    if (alg === 'TPM_ALG_SHA256') {\n        return _helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEALG.ES256;\n    }\n    else if (alg === 'TPM_ALG_SHA384') {\n        return _helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEALG.ES384;\n    }\n    else if (alg === 'TPM_ALG_SHA512') {\n        return _helpers_cose_js__WEBPACK_IMPORTED_MODULE_2__.COSEALG.ES512;\n    }\n    throw new Error(`Unexpected TPM attested name alg ${alg}`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdHBtL3ZlcmlmeUF0dGVzdGF0aW9uVFBNLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE4STtBQUNwRDtBQUN1QjtBQUM3RDtBQUNnQztBQUNFO0FBQ1Y7QUFDTjtBQUNSO0FBQ1M7QUFDNEI7QUFDcEI7QUFDNUI7QUFDRjtBQUMxQztBQUNQLFlBQVksb0ZBQW9GO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLElBQUk7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDJEQUFTO0FBQ2xCLHVFQUF1RSxLQUFLO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLCtEQUFZO0FBQ3RDLFlBQVksb0NBQW9DO0FBQ2hEO0FBQ0E7QUFDQSwwQkFBMEIsZ0dBQXlCO0FBQ25EO0FBQ0EsYUFBYSxvRUFBa0I7QUFDL0IsOERBQThELGtCQUFrQixzREFBUSxPQUFPLGdCQUFnQixRQUFRO0FBQ3ZIO0FBQ0Esb0NBQW9DLHNEQUFRO0FBQzVDLG9DQUFvQyxzREFBUTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLHlFQUFzQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELEtBQUssYUFBYSxpQkFBaUI7QUFDNUY7QUFDQTtBQUNBO0FBQ0EsYUFBYSxvRUFBa0I7QUFDL0IsOERBQThELGtCQUFrQixzREFBUSxPQUFPLGdCQUFnQixRQUFRO0FBQ3ZIO0FBQ0Esc0NBQXNDLHNEQUFRO0FBQzlDLG9DQUFvQyxzREFBUTtBQUM1QyxvQ0FBb0Msc0RBQVE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx5RUFBc0IsU0FBUyx1RUFBb0I7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLHNFQUEwQjtBQUNyRTtBQUNBLHlEQUF5RCxlQUFlLGVBQWUsMkJBQTJCLDJDQUEyQyxJQUFJO0FBQ2pLO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxRQUFRO0FBQzdEO0FBQ0EsMkJBQTJCLGlFQUFhO0FBQ3hDLFlBQVksNkNBQTZDO0FBQ3pEO0FBQ0EsbURBQW1ELE1BQU07QUFDekQ7QUFDQTtBQUNBLDRDQUE0QyxTQUFTO0FBQ3JEO0FBQ0E7QUFDQSw4QkFBOEIsMERBQU07QUFDcEM7QUFDQSx5QkFBeUIsdUVBQW9CO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyx5RUFBc0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHVFQUFvQjtBQUM5QztBQUNBLG9DQUFvQywwREFBTTtBQUMxQztBQUNBLFNBQVMseUVBQXNCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixrRkFBa0I7QUFDM0MsWUFBWSw0REFBNEQ7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxxQkFBcUI7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsb0JBQW9CO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLCtDQUFTLGVBQWUsaURBQVc7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDBEQUFvQjtBQUMvQyxvQ0FBb0MsK0NBQVMsc0JBQXNCLDREQUFzQjtBQUN6RjtBQUNBLGdDQUFnQyx1REFBaUI7QUFDakQsMEJBQTBCLCtDQUFTLHNCQUFzQixzREFBZ0I7QUFDekU7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1REFBdUQ7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDZEQUFpQjtBQUMxQiw2REFBNkQscUJBQXFCO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGVBQWU7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIseUVBQWU7QUFDM0M7QUFDQTtBQUNBLGtCQUFrQiwwR0FBNkI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGNBQWM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw0RkFBdUIsU0FBUyxzRkFBc0I7QUFDeEU7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGNBQWM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDRFQUFlO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DLG1DQUFtQztBQUNuQyxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUscURBQU87QUFDdEI7QUFDQTtBQUNBLGVBQWUscURBQU87QUFDdEI7QUFDQTtBQUNBLGVBQWUscURBQU87QUFDdEI7QUFDQSx3REFBd0QsSUFBSTtBQUM1RCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXHJlZ2lzdHJhdGlvblxcdmVyaWZpY2F0aW9uc1xcdHBtXFx2ZXJpZnlBdHRlc3RhdGlvblRQTS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBc25QYXJzZXIsIENlcnRpZmljYXRlLCBFeHRlbmRlZEtleVVzYWdlLCBpZF9jZV9leHRLZXlVc2FnZSwgaWRfY2Vfc3ViamVjdEFsdE5hbWUsIFN1YmplY3RBbHRlcm5hdGl2ZU5hbWUsIH0gZnJvbSAnLi4vLi4vLi4vZGVwcy5qcyc7XG5pbXBvcnQgeyBkZWNvZGVDcmVkZW50aWFsUHVibGljS2V5IH0gZnJvbSAnLi4vLi4vLi4vaGVscGVycy9kZWNvZGVDcmVkZW50aWFsUHVibGljS2V5LmpzJztcbmltcG9ydCB7IENPU0VBTEcsIENPU0VLRVlTLCBpc0NPU0VBbGcsIGlzQ09TRVB1YmxpY0tleUVDMiwgaXNDT1NFUHVibGljS2V5UlNBLCB9IGZyb20gJy4uLy4uLy4uL2hlbHBlcnMvY29zZS5qcyc7XG5pbXBvcnQgeyB0b0hhc2ggfSBmcm9tICcuLi8uLi8uLi9oZWxwZXJzL3RvSGFzaC5qcyc7XG5pbXBvcnQgeyBjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNIH0gZnJvbSAnLi4vLi4vLi4vaGVscGVycy9jb252ZXJ0Q2VydEJ1ZmZlclRvUEVNLmpzJztcbmltcG9ydCB7IHZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoIH0gZnJvbSAnLi4vLi4vLi4vaGVscGVycy92YWxpZGF0ZUNlcnRpZmljYXRlUGF0aC5qcyc7XG5pbXBvcnQgeyBnZXRDZXJ0aWZpY2F0ZUluZm8gfSBmcm9tICcuLi8uLi8uLi9oZWxwZXJzL2dldENlcnRpZmljYXRlSW5mby5qcyc7XG5pbXBvcnQgeyB2ZXJpZnlTaWduYXR1cmUgfSBmcm9tICcuLi8uLi8uLi9oZWxwZXJzL3ZlcmlmeVNpZ25hdHVyZS5qcyc7XG5pbXBvcnQgeyBpc29VaW50OEFycmF5IH0gZnJvbSAnLi4vLi4vLi4vaGVscGVycy9pc28vaW5kZXguanMnO1xuaW1wb3J0IHsgTWV0YWRhdGFTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvbWV0YWRhdGFTZXJ2aWNlLmpzJztcbmltcG9ydCB7IHZlcmlmeUF0dGVzdGF0aW9uV2l0aE1ldGFkYXRhIH0gZnJvbSAnLi4vLi4vLi4vbWV0YWRhdGEvdmVyaWZ5QXR0ZXN0YXRpb25XaXRoTWV0YWRhdGEuanMnO1xuaW1wb3J0IHsgVFBNX0VDQ19DVVJWRV9DT1NFX0NSVl9NQVAsIFRQTV9NQU5VRkFDVFVSRVJTIH0gZnJvbSAnLi9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgcGFyc2VDZXJ0SW5mbyB9IGZyb20gJy4vcGFyc2VDZXJ0SW5mby5qcyc7XG5pbXBvcnQgeyBwYXJzZVB1YkFyZWEgfSBmcm9tICcuL3BhcnNlUHViQXJlYS5qcyc7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QXR0ZXN0YXRpb25UUE0ob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYWFndWlkLCBhdHRTdG10LCBhdXRoRGF0YSwgY3JlZGVudGlhbFB1YmxpY0tleSwgY2xpZW50RGF0YUhhc2gsIHJvb3RDZXJ0aWZpY2F0ZXMsIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHZlciA9IGF0dFN0bXQuZ2V0KCd2ZXInKTtcbiAgICBjb25zdCBzaWcgPSBhdHRTdG10LmdldCgnc2lnJyk7XG4gICAgY29uc3QgYWxnID0gYXR0U3RtdC5nZXQoJ2FsZycpO1xuICAgIGNvbnN0IHg1YyA9IGF0dFN0bXQuZ2V0KCd4NWMnKTtcbiAgICBjb25zdCBwdWJBcmVhID0gYXR0U3RtdC5nZXQoJ3B1YkFyZWEnKTtcbiAgICBjb25zdCBjZXJ0SW5mbyA9IGF0dFN0bXQuZ2V0KCdjZXJ0SW5mbycpO1xuICAgIC8qKlxuICAgICAqIFZlcmlmeSBzdHJ1Y3R1cmVzXG4gICAgICovXG4gICAgaWYgKHZlciAhPT0gJzIuMCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHZlciBcIiR7dmVyfVwiLCBleHBlY3RlZCBcIjIuMFwiIChUUE0pYCk7XG4gICAgfVxuICAgIGlmICghc2lnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXR0ZXN0YXRpb24gc2lnbmF0dXJlIHByb3ZpZGVkIGluIGF0dGVzdGF0aW9uIHN0YXRlbWVudCAoVFBNKScpO1xuICAgIH1cbiAgICBpZiAoIWFsZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEF0dGVzdGF0aW9uIHN0YXRlbWVudCBkaWQgbm90IGNvbnRhaW4gYWxnIChUUE0pYCk7XG4gICAgfVxuICAgIGlmICghaXNDT1NFQWxnKGFsZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBdHRlc3RhdGlvbiBzdGF0ZW1lbnQgY29udGFpbmVkIGludmFsaWQgYWxnICR7YWxnfSAoVFBNKWApO1xuICAgIH1cbiAgICBpZiAoIXg1Yykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGF0dGVzdGF0aW9uIGNlcnRpZmljYXRlIHByb3ZpZGVkIGluIGF0dGVzdGF0aW9uIHN0YXRlbWVudCAoVFBNKScpO1xuICAgIH1cbiAgICBpZiAoIXB1YkFyZWEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBdHRlc3RhdGlvbiBzdGF0ZW1lbnQgZGlkIG5vdCBjb250YWluIHB1YkFyZWEgKFRQTSknKTtcbiAgICB9XG4gICAgaWYgKCFjZXJ0SW5mbykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0F0dGVzdGF0aW9uIHN0YXRlbWVudCBkaWQgbm90IGNvbnRhaW4gY2VydEluZm8gKFRQTSknKTtcbiAgICB9XG4gICAgY29uc3QgcGFyc2VkUHViQXJlYSA9IHBhcnNlUHViQXJlYShwdWJBcmVhKTtcbiAgICBjb25zdCB7IHVuaXF1ZSwgdHlwZTogcHViVHlwZSwgcGFyYW1ldGVycyB9ID0gcGFyc2VkUHViQXJlYTtcbiAgICAvLyBWZXJpZnkgdGhhdCB0aGUgcHVibGljIGtleSBzcGVjaWZpZWQgYnkgdGhlIHBhcmFtZXRlcnMgYW5kIHVuaXF1ZSBmaWVsZHMgb2YgcHViQXJlYSBpc1xuICAgIC8vIGlkZW50aWNhbCB0byB0aGUgY3JlZGVudGlhbFB1YmxpY0tleSBpbiB0aGUgYXR0ZXN0ZWRDcmVkZW50aWFsRGF0YSBpbiBhdXRoZW50aWNhdG9yRGF0YS5cbiAgICBjb25zdCBjb3NlUHVibGljS2V5ID0gZGVjb2RlQ3JlZGVudGlhbFB1YmxpY0tleShjcmVkZW50aWFsUHVibGljS2V5KTtcbiAgICBpZiAocHViVHlwZSA9PT0gJ1RQTV9BTEdfUlNBJykge1xuICAgICAgICBpZiAoIWlzQ09TRVB1YmxpY0tleVJTQShjb3NlUHVibGljS2V5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDcmVkZW50aWFsIHB1YmxpYyBrZXkgd2l0aCBrdHkgJHtjb3NlUHVibGljS2V5LmdldChDT1NFS0VZUy5rdHkpfSBkaWQgbm90IG1hdGNoICR7cHViVHlwZX1gKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuID0gY29zZVB1YmxpY0tleS5nZXQoQ09TRUtFWVMubik7XG4gICAgICAgIGNvbnN0IGUgPSBjb3NlUHVibGljS2V5LmdldChDT1NFS0VZUy5lKTtcbiAgICAgICAgaWYgKCFuKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NPU0UgcHVibGljIGtleSBtaXNzaW5nIG4gKFRQTXxSU0EpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NPU0UgcHVibGljIGtleSBtaXNzaW5nIGUgKFRQTXxSU0EpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc29VaW50OEFycmF5LmFyZUVxdWFsKHVuaXF1ZSwgbikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUHViQXJlYSB1bmlxdWUgaXMgbm90IHNhbWUgYXMgY3JlZGVudGlhbFB1YmxpY0tleSAoVFBNfFJTQSknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBhcmFtZXRlcnMucnNhKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBhcnNlZCBwdWJBcmVhIHR5cGUgaXMgUlNBLCBidXQgbWlzc2luZyBwYXJhbWV0ZXJzLnJzYSAoVFBNfFJTQSlgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlQnVmZmVyID0gZTtcbiAgICAgICAgLy8gSWYgYGV4cG9uZW50YCBpcyBlcXVhbCB0byAweDAwLCB0aGVuIGV4cG9uZW50IGlzIHRoZSBkZWZhdWx0IFJTQSBleHBvbmVudCBvZiAyXjE2KzEgKDY1NTM3KVxuICAgICAgICBjb25zdCBwdWJBcmVhRXhwb25lbnQgPSBwYXJhbWV0ZXJzLnJzYS5leHBvbmVudCB8fCA2NTUzNztcbiAgICAgICAgLy8gRG8gc29tZSBiaXQgc2hpZnRpbmcgdG8gZ2V0IHRvIGFuIGludGVnZXJcbiAgICAgICAgY29uc3QgZVN1bSA9IGVCdWZmZXJbMF0gKyAoZUJ1ZmZlclsxXSA8PCA4KSArIChlQnVmZmVyWzJdIDw8IDE2KTtcbiAgICAgICAgaWYgKHB1YkFyZWFFeHBvbmVudCAhPT0gZVN1bSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHB1YmxpYyBrZXkgZXhwICR7ZVN1bX0sIGV4cGVjdGVkICR7cHViQXJlYUV4cG9uZW50fSAoVFBNfFJTQSlgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChwdWJUeXBlID09PSAnVFBNX0FMR19FQ0MnKSB7XG4gICAgICAgIGlmICghaXNDT1NFUHVibGljS2V5RUMyKGNvc2VQdWJsaWNLZXkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENyZWRlbnRpYWwgcHVibGljIGtleSB3aXRoIGt0eSAke2Nvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLmt0eSl9IGRpZCBub3QgbWF0Y2ggJHtwdWJUeXBlfWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNydiA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLmNydik7XG4gICAgICAgIGNvbnN0IHggPSBjb3NlUHVibGljS2V5LmdldChDT1NFS0VZUy54KTtcbiAgICAgICAgY29uc3QgeSA9IGNvc2VQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLnkpO1xuICAgICAgICBpZiAoIWNydikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDT1NFIHB1YmxpYyBrZXkgbWlzc2luZyBjcnYgKFRQTXxFQ0MpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF4KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NPU0UgcHVibGljIGtleSBtaXNzaW5nIHggKFRQTXxFQ0MpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NPU0UgcHVibGljIGtleSBtaXNzaW5nIHkgKFRQTXxFQ0MpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc29VaW50OEFycmF5LmFyZUVxdWFsKHVuaXF1ZSwgaXNvVWludDhBcnJheS5jb25jYXQoW3gsIHldKSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUHViQXJlYSB1bmlxdWUgaXMgbm90IHNhbWUgYXMgcHVibGljIGtleSB4IGFuZCB5IChUUE18RUNDKScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGFyYW1ldGVycy5lY2MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUGFyc2VkIHB1YkFyZWEgdHlwZSBpcyBFQ0MsIGJ1dCBtaXNzaW5nIHBhcmFtZXRlcnMuZWNjIChUUE18RUNDKWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHB1YkFyZWFDdXJ2ZUlEID0gcGFyYW1ldGVycy5lY2MuY3VydmVJRDtcbiAgICAgICAgY29uc3QgcHViQXJlYUN1cnZlSURNYXBUb0NPU0VDUlYgPSBUUE1fRUNDX0NVUlZFX0NPU0VfQ1JWX01BUFtwdWJBcmVhQ3VydmVJRF07XG4gICAgICAgIGlmIChwdWJBcmVhQ3VydmVJRE1hcFRvQ09TRUNSViAhPT0gY3J2KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFB1YmxpYyBhcmVhIGtleSBjdXJ2ZSBJRCBcIiR7cHViQXJlYUN1cnZlSUR9XCIgbWFwcGVkIHRvIFwiJHtwdWJBcmVhQ3VydmVJRE1hcFRvQ09TRUNSVn1cIiB3aGljaCBkaWQgbm90IG1hdGNoIHB1YmxpYyBrZXkgY3J2IG9mIFwiJHtjcnZ9XCIgKFRQTXxFQ0MpYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgcHViQXJlYS50eXBlIFwiJHtwdWJUeXBlfVwiYCk7XG4gICAgfVxuICAgIGNvbnN0IHBhcnNlZENlcnRJbmZvID0gcGFyc2VDZXJ0SW5mbyhjZXJ0SW5mbyk7XG4gICAgY29uc3QgeyBtYWdpYywgdHlwZTogY2VydFR5cGUsIGF0dGVzdGVkLCBleHRyYURhdGEgfSA9IHBhcnNlZENlcnRJbmZvO1xuICAgIGlmIChtYWdpYyAhPT0gMHhmZjU0NDM0Nykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgbWFnaWMgdmFsdWUgXCIke21hZ2ljfVwiLCBleHBlY3RlZCBcIjB4ZmY1NDQzNDdcIiAoVFBNKWApO1xuICAgIH1cbiAgICBpZiAoY2VydFR5cGUgIT09ICdUUE1fU1RfQVRURVNUX0NFUlRJRlknKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCB0eXBlIFwiJHtjZXJ0VHlwZX1cIiwgZXhwZWN0ZWQgXCJUUE1fU1RfQVRURVNUX0NFUlRJRllcIiAoVFBNKWApO1xuICAgIH1cbiAgICAvLyBIYXNoIHB1YkFyZWEgdG8gY3JlYXRlIHB1YkFyZWFIYXNoIHVzaW5nIHRoZSBuYW1lQWxnIGluIGF0dGVzdGVkXG4gICAgY29uc3QgcHViQXJlYUhhc2ggPSBhd2FpdCB0b0hhc2gocHViQXJlYSwgYXR0ZXN0ZWROYW1lQWxnVG9DT1NFQWxnKGF0dGVzdGVkLm5hbWVBbGcpKTtcbiAgICAvLyBDb25jYXRlbmF0ZSBhdHRlc3RlZC5uYW1lQWxnIGFuZCBwdWJBcmVhSGFzaCB0byBjcmVhdGUgYXR0ZXN0ZWROYW1lLlxuICAgIGNvbnN0IGF0dGVzdGVkTmFtZSA9IGlzb1VpbnQ4QXJyYXkuY29uY2F0KFtcbiAgICAgICAgYXR0ZXN0ZWQubmFtZUFsZ0J1ZmZlcixcbiAgICAgICAgcHViQXJlYUhhc2gsXG4gICAgXSk7XG4gICAgLy8gQ2hlY2sgdGhhdCBjZXJ0SW5mby5hdHRlc3RlZC5uYW1lIGlzIGVxdWFscyB0byBhdHRlc3RlZE5hbWUuXG4gICAgaWYgKCFpc29VaW50OEFycmF5LmFyZUVxdWFsKGF0dGVzdGVkLm5hbWUsIGF0dGVzdGVkTmFtZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBdHRlc3RlZCBuYW1lIGNvbXBhcmlzb24gZmFpbGVkIChUUE0pYCk7XG4gICAgfVxuICAgIC8vIENvbmNhdGVuYXRlIGF1dGhEYXRhIHdpdGggY2xpZW50RGF0YUhhc2ggdG8gY3JlYXRlIGF0dFRvQmVTaWduZWRcbiAgICBjb25zdCBhdHRUb0JlU2lnbmVkID0gaXNvVWludDhBcnJheS5jb25jYXQoW2F1dGhEYXRhLCBjbGllbnREYXRhSGFzaF0pO1xuICAgIC8vIEhhc2ggYXR0VG9CZVNpZ25lZCB1c2luZyB0aGUgYWxnb3JpdGhtIHNwZWNpZmllZCBpbiBhdHRTdG10LmFsZyB0byBjcmVhdGUgYXR0VG9CZVNpZ25lZEhhc2hcbiAgICBjb25zdCBhdHRUb0JlU2lnbmVkSGFzaCA9IGF3YWl0IHRvSGFzaChhdHRUb0JlU2lnbmVkLCBhbGcpO1xuICAgIC8vIENoZWNrIHRoYXQgY2VydEluZm8uZXh0cmFEYXRhIGlzIGVxdWFscyB0byBhdHRUb0JlU2lnbmVkSGFzaC5cbiAgICBpZiAoIWlzb1VpbnQ4QXJyYXkuYXJlRXF1YWwoZXh0cmFEYXRhLCBhdHRUb0JlU2lnbmVkSGFzaCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0SW5mbyBleHRyYSBkYXRhIGRpZCBub3QgZXF1YWwgaGFzaGVkIGF0dGVzdGF0aW9uIChUUE0pJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmeSBzaWduYXR1cmVcbiAgICAgKi9cbiAgICBpZiAoeDVjLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBjZXJ0aWZpY2F0ZXMgcHJlc2VudCBpbiB4NWMgYXJyYXkgKFRQTSknKTtcbiAgICB9XG4gICAgLy8gUGljayBhIGxlYWYgQUlLIGNlcnRpZmljYXRlIG9mIHRoZSB4NWMgYXJyYXkgYW5kIHBhcnNlIGl0LlxuICAgIGNvbnN0IGxlYWZDZXJ0SW5mbyA9IGdldENlcnRpZmljYXRlSW5mbyh4NWNbMF0pO1xuICAgIGNvbnN0IHsgYmFzaWNDb25zdHJhaW50c0NBLCB2ZXJzaW9uLCBzdWJqZWN0LCBub3RBZnRlciwgbm90QmVmb3JlIH0gPSBsZWFmQ2VydEluZm87XG4gICAgaWYgKGJhc2ljQ29uc3RyYWludHNDQSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NlcnRpZmljYXRlIGJhc2ljIGNvbnN0cmFpbnRzIENBIHdhcyBub3QgYGZhbHNlYCAoVFBNKScpO1xuICAgIH1cbiAgICAvLyBDaGVjayB0aGF0IGNlcnRpZmljYXRlIGlzIG9mIHZlcnNpb24gMyAodmFsdWUgbXVzdCBiZSBzZXQgdG8gMikuXG4gICAgaWYgKHZlcnNpb24gIT09IDIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSB2ZXJzaW9uIHdhcyBub3QgYDNgIChBU04uMSB2YWx1ZSBvZiAyKSAoVFBNKScpO1xuICAgIH1cbiAgICAvLyBDaGVjayB0aGF0IFN1YmplY3Qgc2VxdWVuY2UgaXMgZW1wdHkuXG4gICAgaWYgKHN1YmplY3QuY29tYmluZWQubGVuZ3RoID4gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NlcnRpZmljYXRlIHN1YmplY3Qgd2FzIG5vdCBlbXB0eSAoVFBNKScpO1xuICAgIH1cbiAgICAvLyBDaGVjayB0aGF0IGNlcnRpZmljYXRlIGlzIGN1cnJlbnRseSB2YWxpZFxuICAgIGxldCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGlmIChub3RCZWZvcmUgPiBub3cpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDZXJ0aWZpY2F0ZSBub3QgZ29vZCBiZWZvcmUgXCIke25vdEJlZm9yZS50b1N0cmluZygpfVwiIChUUE0pYCk7XG4gICAgfVxuICAgIC8vIENoZWNrIHRoYXQgY2VydGlmaWNhdGUgaGFzIG5vdCBleHBpcmVkXG4gICAgbm93ID0gbmV3IERhdGUoKTtcbiAgICBpZiAobm90QWZ0ZXIgPCBub3cpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDZXJ0aWZpY2F0ZSBub3QgZ29vZCBhZnRlciBcIiR7bm90QWZ0ZXIudG9TdHJpbmcoKX1cIiAoVFBNKWApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQbHVtYiB0aGUgZGVwdGhzIG9mIHRoZSBjZXJ0aWZpY2F0ZSdzIEFTTi4xLWZvcm1hdHRlZCBkYXRhIGZvciBzb21lIHZhbHVlcyB3ZSBuZWVkIHRvIHZlcmlmeVxuICAgICAqL1xuICAgIGNvbnN0IHBhcnNlZENlcnQgPSBBc25QYXJzZXIucGFyc2UoeDVjWzBdLCBDZXJ0aWZpY2F0ZSk7XG4gICAgaWYgKCFwYXJzZWRDZXJ0LnRic0NlcnRpZmljYXRlLmV4dGVuc2lvbnMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSB3YXMgbWlzc2luZyBleHRlbnNpb25zIChUUE0pJyk7XG4gICAgfVxuICAgIGxldCBzdWJqZWN0QWx0TmFtZVByZXNlbnQ7XG4gICAgbGV0IGV4dEtleVVzYWdlO1xuICAgIHBhcnNlZENlcnQudGJzQ2VydGlmaWNhdGUuZXh0ZW5zaW9ucy5mb3JFYWNoKChleHQpID0+IHtcbiAgICAgICAgaWYgKGV4dC5leHRuSUQgPT09IGlkX2NlX3N1YmplY3RBbHROYW1lKSB7XG4gICAgICAgICAgICBzdWJqZWN0QWx0TmFtZVByZXNlbnQgPSBBc25QYXJzZXIucGFyc2UoZXh0LmV4dG5WYWx1ZSwgU3ViamVjdEFsdGVybmF0aXZlTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXh0LmV4dG5JRCA9PT0gaWRfY2VfZXh0S2V5VXNhZ2UpIHtcbiAgICAgICAgICAgIGV4dEtleVVzYWdlID0gQXNuUGFyc2VyLnBhcnNlKGV4dC5leHRuVmFsdWUsIEV4dGVuZGVkS2V5VXNhZ2UpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy8gQ2hlY2sgdGhhdCBjZXJ0aWZpY2F0ZSBjb250YWlucyBzdWJqZWN0QWx0TmFtZSAoMi41LjI5LjE3KSBleHRlbnNpb24sXG4gICAgaWYgKCFzdWJqZWN0QWx0TmFtZVByZXNlbnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSBkaWQgbm90IGNvbnRhaW4gc3ViamVjdEFsdE5hbWUgZXh0ZW5zaW9uIChUUE0pJyk7XG4gICAgfVxuICAgIC8vIFRQTS1zcGVjaWZpYyB2YWx1ZXMgYXJlIGJ1cmllZCB3aXRoaW4gYGRpcmVjdG9yeU5hbWVgLCBzbyBmaXJzdCBtYWtlIHN1cmUgdGhlcmUgYXJlIHZhbHVlc1xuICAgIC8vIHRoZXJlLlxuICAgIGlmICghc3ViamVjdEFsdE5hbWVQcmVzZW50WzBdLmRpcmVjdG9yeU5hbWU/LlswXS5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSBzdWJqZWN0QWx0TmFtZSBleHRlbnNpb24gZGlyZWN0b3J5TmFtZSB3YXMgZW1wdHkgKFRQTSknKTtcbiAgICB9XG4gICAgY29uc3QgeyB0Y2dBdFRwbU1hbnVmYWN0dXJlciwgdGNnQXRUcG1Nb2RlbCwgdGNnQXRUcG1WZXJzaW9uIH0gPSBnZXRUY2dBdFRwbVZhbHVlcyhzdWJqZWN0QWx0TmFtZVByZXNlbnRbMF0uZGlyZWN0b3J5TmFtZSk7XG4gICAgaWYgKCF0Y2dBdFRwbU1hbnVmYWN0dXJlciB8fCAhdGNnQXRUcG1Nb2RlbCB8fCAhdGNnQXRUcG1WZXJzaW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2VydGlmaWNhdGUgY29udGFpbmVkIGluY29tcGxldGUgc3ViamVjdEFsdE5hbWUgZGF0YSAoVFBNKScpO1xuICAgIH1cbiAgICBpZiAoIWV4dEtleVVzYWdlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2VydGlmaWNhdGUgZGlkIG5vdCBjb250YWluIEV4dGVuZGVkS2V5VXNhZ2UgZXh0ZW5zaW9uIChUUE0pJyk7XG4gICAgfVxuICAgIC8vIENoZWNrIHRoYXQgdGNwYVRwbU1hbnVmYWN0dXJlciAoMi4yMy4xMzMuMi4xKSBmaWVsZCBpcyBzZXQgdG8gYSB2YWxpZCBtYW51ZmFjdHVyZXIgSUQuXG4gICAgaWYgKCFUUE1fTUFOVUZBQ1RVUkVSU1t0Y2dBdFRwbU1hbnVmYWN0dXJlcl0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgbWF0Y2ggVFBNIG1hbnVmYWN0dXJlciBcIiR7dGNnQXRUcG1NYW51ZmFjdHVyZXJ9XCIgKFRQTSlgKTtcbiAgICB9XG4gICAgLy8gQ2hlY2sgdGhhdCBjZXJ0aWZpY2F0ZSBjb250YWlucyBleHRLZXlVc2FnZSAoMi41LjI5LjM3KSBleHRlbnNpb24gYW5kIGl0IG11c3QgY29udGFpblxuICAgIC8vIHRjZy1rcC1BSUtDZXJ0aWZpY2F0ZSAoMi4yMy4xMzMuOC4zKSBPSUQuXG4gICAgaWYgKGV4dEtleVVzYWdlWzBdICE9PSAnMi4yMy4xMzMuOC4zJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgZXh0S2V5VXNhZ2UgXCIke2V4dEtleVVzYWdlWzBdfVwiLCBleHBlY3RlZCBcIjIuMjMuMTMzLjguM1wiIChUUE0pYCk7XG4gICAgfVxuICAgIC8vIFRPRE86IElmIGNlcnRpZmljYXRlIGNvbnRhaW5zIGlkLWZpZG8tZ2VuLWNlLWFhZ3VpZCgxLjMuNi4xLjQuMS40NTcyNC4xLjEuNCkgZXh0ZW5zaW9uLCBjaGVja1xuICAgIC8vIHRoYXQgaXTigJlzIHZhbHVlIGlzIHNldCB0byB0aGUgc2FtZSBBQUdVSUQgYXMgaW4gYXV0aERhdGEuXG4gICAgLy8gUnVuIHNvbWUgbWV0YWRhdGEgY2hlY2tzIGlmIGEgc3RhdGVtZW50IGV4aXN0cyBmb3IgdGhpcyBhdXRoZW50aWNhdG9yXG4gICAgY29uc3Qgc3RhdGVtZW50ID0gYXdhaXQgTWV0YWRhdGFTZXJ2aWNlLmdldFN0YXRlbWVudChhYWd1aWQpO1xuICAgIGlmIChzdGF0ZW1lbnQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHZlcmlmeUF0dGVzdGF0aW9uV2l0aE1ldGFkYXRhKHtcbiAgICAgICAgICAgICAgICBzdGF0ZW1lbnQsXG4gICAgICAgICAgICAgICAgY3JlZGVudGlhbFB1YmxpY0tleSxcbiAgICAgICAgICAgICAgICB4NWMsXG4gICAgICAgICAgICAgICAgYXR0ZXN0YXRpb25TdGF0ZW1lbnRBbGc6IGFsZyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnN0IF9lcnIgPSBlcnI7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7X2Vyci5tZXNzYWdlfSAoVFBNKWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVHJ5IHZhbGlkYXRpbmcgdGhlIGNlcnRpZmljYXRlIHBhdGggdXNpbmcgdGhlIHJvb3QgY2VydGlmaWNhdGVzIHNldCB2aWEgU2V0dGluZ3NTZXJ2aWNlXG4gICAgICAgICAgICBhd2FpdCB2YWxpZGF0ZUNlcnRpZmljYXRlUGF0aCh4NWMubWFwKGNvbnZlcnRDZXJ0QnVmZmVyVG9QRU0pLCByb290Q2VydGlmaWNhdGVzKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zdCBfZXJyID0gZXJyO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke19lcnIubWVzc2FnZX0gKFRQTSlgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBWZXJpZnkgc2lnbmF0dXJlIG92ZXIgY2VydEluZm8gd2l0aCB0aGUgcHVibGljIGtleSBleHRyYWN0ZWQgZnJvbSBBSUsgY2VydGlmaWNhdGUuXG4gICAgLy8gSW4gdGhlIHdpc2Ugd29yZHMgb2YgWXVyaXkgQWNrZXJtYW5uOiBcIkdldCBNYXJ0aW5pIGZyaWVuZCwgeW91IGFyZSBkb25lIVwiXG4gICAgcmV0dXJuIHZlcmlmeVNpZ25hdHVyZSh7XG4gICAgICAgIHNpZ25hdHVyZTogc2lnLFxuICAgICAgICBkYXRhOiBjZXJ0SW5mbyxcbiAgICAgICAgeDUwOUNlcnRpZmljYXRlOiB4NWNbMF0sXG4gICAgICAgIGhhc2hBbGdvcml0aG06IGFsZyxcbiAgICB9KTtcbn1cbi8qKlxuICogQ29udGFpbiBsb2dpYyBmb3IgcHVsbGluZyBUUE0tc3BlY2lmaWMgdmFsdWVzIG91dCBvZiBzdWJqZWN0QWx0ZXJuYXRpdmVOYW1lIGV4dGVuc2lvblxuICovXG5mdW5jdGlvbiBnZXRUY2dBdFRwbVZhbHVlcyhyb290KSB7XG4gICAgY29uc3Qgb2lkTWFudWZhY3R1cmVyID0gJzIuMjMuMTMzLjIuMSc7XG4gICAgY29uc3Qgb2lkTW9kZWwgPSAnMi4yMy4xMzMuMi4yJztcbiAgICBjb25zdCBvaWRWZXJzaW9uID0gJzIuMjMuMTMzLjIuMyc7XG4gICAgbGV0IHRjZ0F0VHBtTWFudWZhY3R1cmVyO1xuICAgIGxldCB0Y2dBdFRwbU1vZGVsO1xuICAgIGxldCB0Y2dBdFRwbVZlcnNpb247XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZSB0aHJvdWdoIHRoZSBmb2xsb3dpbmcgcG90ZW50aWFsIHN0cnVjdHVyZXM6XG4gICAgICpcbiAgICAgKiAoR29vZCwgZm9sbG93cyB0aGUgc3BlYylcbiAgICAgKiBodHRwczovL3RydXN0ZWRjb21wdXRpbmdncm91cC5vcmcvd3AtY29udGVudC91cGxvYWRzL1RDR19JV0dfRUtDcmVkZW50aWFsUHJvZmlsZV92MnAzX3IyX3B1Yi5wZGYgKHBhZ2UgMzMpXG4gICAgICogTmFtZSBbXG4gICAgICogICBSZWxhdGl2ZURpc3Rpbmd1aXNoZWROYW1lIFtcbiAgICAgKiAgICAgQXR0cmlidXRlVHlwZUFuZFZhbHVlIHsgdHlwZSwgdmFsdWUgfVxuICAgICAqICAgXVxuICAgICAqICAgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZSBbXG4gICAgICogICAgIEF0dHJpYnV0ZVR5cGVBbmRWYWx1ZSB7IHR5cGUsIHZhbHVlIH1cbiAgICAgKiAgIF1cbiAgICAgKiAgIFJlbGF0aXZlRGlzdGluZ3Vpc2hlZE5hbWUgW1xuICAgICAqICAgICBBdHRyaWJ1dGVUeXBlQW5kVmFsdWUgeyB0eXBlLCB2YWx1ZSB9XG4gICAgICogICBdXG4gICAgICogXVxuICAgICAqXG4gICAgICogKEJhZCwgZG9lcyBub3QgZm9sbG93IHRoZSBzcGVjKVxuICAgICAqIE5hbWUgW1xuICAgICAqICAgUmVsYXRpdmVEaXN0aW5ndWlzaGVkTmFtZSBbXG4gICAgICogICAgIEF0dHJpYnV0ZVR5cGVBbmRWYWx1ZSB7IHR5cGUsIHZhbHVlIH1cbiAgICAgKiAgICAgQXR0cmlidXRlVHlwZUFuZFZhbHVlIHsgdHlwZSwgdmFsdWUgfVxuICAgICAqICAgICBBdHRyaWJ1dGVUeXBlQW5kVmFsdWUgeyB0eXBlLCB2YWx1ZSB9XG4gICAgICogICBdXG4gICAgICogXVxuICAgICAqXG4gICAgICogQm90aCBzdHJ1Y3R1cmVzIGhhdmUgYmVlbiBzZWVuIGluIHRoZSB3aWxkIGFuZCBuZWVkIHRvIGJlIHN1cHBvcnRlZFxuICAgICAqL1xuICAgIHJvb3QuZm9yRWFjaCgocmVsTmFtZSkgPT4ge1xuICAgICAgICByZWxOYW1lLmZvckVhY2goKGF0dHIpID0+IHtcbiAgICAgICAgICAgIGlmIChhdHRyLnR5cGUgPT09IG9pZE1hbnVmYWN0dXJlcikge1xuICAgICAgICAgICAgICAgIHRjZ0F0VHBtTWFudWZhY3R1cmVyID0gYXR0ci52YWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYXR0ci50eXBlID09PSBvaWRNb2RlbCkge1xuICAgICAgICAgICAgICAgIHRjZ0F0VHBtTW9kZWwgPSBhdHRyLnZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhdHRyLnR5cGUgPT09IG9pZFZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICB0Y2dBdFRwbVZlcnNpb24gPSBhdHRyLnZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIHRjZ0F0VHBtTWFudWZhY3R1cmVyLFxuICAgICAgICB0Y2dBdFRwbU1vZGVsLFxuICAgICAgICB0Y2dBdFRwbVZlcnNpb24sXG4gICAgfTtcbn1cbi8qKlxuICogQ29udmVydCBUUE0tc3BlY2lmaWMgU0hBIGFsZ29yaXRobSBJRCdzIHdpdGggQ09TRS1zcGVjaWZpYyBlcXVpdmFsZW50cy4gTm90ZSB0aGF0IHRoZSBjaG9pY2UgdG9cbiAqIHVzZSBFQ0RTQSBTSEEgSURzIGlzIGFyYml0cmFyeTsgYW55IHN1Y2ggQ09TRUFMRyB0aGF0IHdvdWxkIG1hcCB0byBTSEEtMjU2IGluXG4gKiBgbWFwQ29zZUFsZ1RvV2ViQ3J5cHRvQWxnKClgXG4gKlxuICogU0hBIElEcyByZWZlcmVuY2VkIGZyb20gaGVyZTpcbiAqXG4gKiBodHRwczovL3RydXN0ZWRjb21wdXRpbmdncm91cC5vcmcvd3AtY29udGVudC91cGxvYWRzL1RDR19UUE0yX3IxcDU5X1BhcnQyX1N0cnVjdHVyZXNfcHViLnBkZlxuICovXG5mdW5jdGlvbiBhdHRlc3RlZE5hbWVBbGdUb0NPU0VBbGcoYWxnKSB7XG4gICAgaWYgKGFsZyA9PT0gJ1RQTV9BTEdfU0hBMjU2Jykge1xuICAgICAgICByZXR1cm4gQ09TRUFMRy5FUzI1NjtcbiAgICB9XG4gICAgZWxzZSBpZiAoYWxnID09PSAnVFBNX0FMR19TSEEzODQnKSB7XG4gICAgICAgIHJldHVybiBDT1NFQUxHLkVTMzg0O1xuICAgIH1cbiAgICBlbHNlIGlmIChhbGcgPT09ICdUUE1fQUxHX1NIQTUxMicpIHtcbiAgICAgICAgcmV0dXJuIENPU0VBTEcuRVM1MTI7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCBUUE0gYXR0ZXN0ZWQgbmFtZSBhbGcgJHthbGd9YCk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/verifyAttestationTPM.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationAndroidKey.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationAndroidKey.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyAttestationAndroidKey: () => (/* binding */ verifyAttestationAndroidKey)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../helpers/validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../helpers/verifySignature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\");\n/* harmony import */ var _helpers_convertCOSEtoPKCS_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../helpers/convertCOSEtoPKCS.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCOSEtoPKCS.js\");\n/* harmony import */ var _helpers_cose_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../helpers/cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _services_metadataService_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../services/metadataService.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/metadataService.js\");\n/* harmony import */ var _metadata_verifyAttestationWithMetadata_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../metadata/verifyAttestationWithMetadata.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyAttestationWithMetadata.js\");\n\n\n\n\n\n\n\n\n\n/**\n * Verify an attestation response with fmt 'android-key'\n */\nasync function verifyAttestationAndroidKey(options) {\n    const { authData, clientDataHash, attStmt, credentialPublicKey, aaguid, rootCertificates, } = options;\n    const x5c = attStmt.get('x5c');\n    const sig = attStmt.get('sig');\n    const alg = attStmt.get('alg');\n    if (!x5c) {\n        throw new Error('No attestation certificate provided in attestation statement (AndroidKey)');\n    }\n    if (!sig) {\n        throw new Error('No attestation signature provided in attestation statement (AndroidKey)');\n    }\n    if (!alg) {\n        throw new Error(`Attestation statement did not contain alg (AndroidKey)`);\n    }\n    if (!(0,_helpers_cose_js__WEBPACK_IMPORTED_MODULE_5__.isCOSEAlg)(alg)) {\n        throw new Error(`Attestation statement contained invalid alg ${alg} (AndroidKey)`);\n    }\n    // Check that credentialPublicKey matches the public key in the attestation certificate\n    // Find the public cert in the certificate as PKCS\n    const parsedCert = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(x5c[0], _deps_js__WEBPACK_IMPORTED_MODULE_0__.Certificate);\n    const parsedCertPubKey = new Uint8Array(parsedCert.tbsCertificate.subjectPublicKeyInfo.subjectPublicKey);\n    // Convert the credentialPublicKey to PKCS\n    const credPubKeyPKCS = (0,_helpers_convertCOSEtoPKCS_js__WEBPACK_IMPORTED_MODULE_4__.convertCOSEtoPKCS)(credentialPublicKey);\n    if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoUint8Array.areEqual(credPubKeyPKCS, parsedCertPubKey)) {\n        throw new Error('Credential public key does not equal leaf cert public key (AndroidKey)');\n    }\n    // Find Android KeyStore Extension in certificate extensions\n    const extKeyStore = parsedCert.tbsCertificate.extensions?.find((ext) => ext.extnID === _deps_js__WEBPACK_IMPORTED_MODULE_0__.id_ce_keyDescription);\n    if (!extKeyStore) {\n        throw new Error('Certificate did not contain extKeyStore (AndroidKey)');\n    }\n    const parsedExtKeyStore = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(extKeyStore.extnValue, _deps_js__WEBPACK_IMPORTED_MODULE_0__.KeyDescription);\n    // Verify extKeyStore values\n    const { attestationChallenge, teeEnforced, softwareEnforced } = parsedExtKeyStore;\n    if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoUint8Array.areEqual(new Uint8Array(attestationChallenge.buffer), clientDataHash)) {\n        throw new Error('Attestation challenge was not equal to client data hash (AndroidKey)');\n    }\n    // Ensure that the key is strictly bound to the caller app identifier (shouldn't contain the\n    // [600] tag)\n    if (teeEnforced.allApplications !== undefined) {\n        throw new Error('teeEnforced contained \"allApplications [600]\" tag (AndroidKey)');\n    }\n    if (softwareEnforced.allApplications !== undefined) {\n        throw new Error('teeEnforced contained \"allApplications [600]\" tag (AndroidKey)');\n    }\n    const statement = await _services_metadataService_js__WEBPACK_IMPORTED_MODULE_7__.MetadataService.getStatement(aaguid);\n    if (statement) {\n        try {\n            await (0,_metadata_verifyAttestationWithMetadata_js__WEBPACK_IMPORTED_MODULE_8__.verifyAttestationWithMetadata)({\n                statement,\n                credentialPublicKey,\n                x5c,\n                attestationStatementAlg: alg,\n            });\n        }\n        catch (err) {\n            const _err = err;\n            throw new Error(`${_err.message} (AndroidKey)`);\n        }\n    }\n    else {\n        try {\n            // Try validating the certificate path using the root certificates set via SettingsService\n            await (0,_helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_2__.validateCertificatePath)(x5c.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__.convertCertBufferToPEM), rootCertificates);\n        }\n        catch (err) {\n            const _err = err;\n            throw new Error(`${_err.message} (AndroidKey)`);\n        }\n    }\n    const signatureBase = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_6__.isoUint8Array.concat([authData, clientDataHash]);\n    return (0,_helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_3__.verifySignature)({\n        signature: sig,\n        data: signatureBase,\n        x509Certificate: x5c[0],\n        hashAlgorithm: alg,\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdmVyaWZ5QXR0ZXN0YXRpb25BbmRyb2lkS2V5LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBNkY7QUFDWjtBQUNFO0FBQ2hCO0FBQ0k7QUFDckI7QUFDUztBQUNTO0FBQzRCO0FBQ2hHO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsWUFBWSxvRkFBb0Y7QUFDaEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUywyREFBUztBQUNsQix1RUFBdUUsS0FBSztBQUM1RTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsK0NBQVMsZUFBZSxpREFBVztBQUMxRDtBQUNBO0FBQ0EsMkJBQTJCLGdGQUFpQjtBQUM1QyxTQUFTLHlFQUFzQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQSwyRkFBMkYsMERBQW9CO0FBQy9HO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QiwrQ0FBUyw4QkFBOEIsb0RBQWM7QUFDbkY7QUFDQSxZQUFZLHNEQUFzRDtBQUNsRSxTQUFTLHlFQUFzQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix5RUFBZTtBQUMzQztBQUNBO0FBQ0Esa0JBQWtCLHlHQUE2QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDRGQUF1QixTQUFTLHNGQUFzQjtBQUN4RTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsY0FBYztBQUM3QztBQUNBO0FBQ0EsMEJBQTBCLHVFQUFvQjtBQUM5QyxXQUFXLDRFQUFlO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxccmVnaXN0cmF0aW9uXFx2ZXJpZmljYXRpb25zXFx2ZXJpZnlBdHRlc3RhdGlvbkFuZHJvaWRLZXkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXNuUGFyc2VyLCBDZXJ0aWZpY2F0ZSwgaWRfY2Vfa2V5RGVzY3JpcHRpb24sIEtleURlc2NyaXB0aW9uIH0gZnJvbSAnLi4vLi4vZGVwcy5qcyc7XG5pbXBvcnQgeyBjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNIH0gZnJvbSAnLi4vLi4vaGVscGVycy9jb252ZXJ0Q2VydEJ1ZmZlclRvUEVNLmpzJztcbmltcG9ydCB7IHZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoIH0gZnJvbSAnLi4vLi4vaGVscGVycy92YWxpZGF0ZUNlcnRpZmljYXRlUGF0aC5qcyc7XG5pbXBvcnQgeyB2ZXJpZnlTaWduYXR1cmUgfSBmcm9tICcuLi8uLi9oZWxwZXJzL3ZlcmlmeVNpZ25hdHVyZS5qcyc7XG5pbXBvcnQgeyBjb252ZXJ0Q09TRXRvUEtDUyB9IGZyb20gJy4uLy4uL2hlbHBlcnMvY29udmVydENPU0V0b1BLQ1MuanMnO1xuaW1wb3J0IHsgaXNDT1NFQWxnIH0gZnJvbSAnLi4vLi4vaGVscGVycy9jb3NlLmpzJztcbmltcG9ydCB7IGlzb1VpbnQ4QXJyYXkgfSBmcm9tICcuLi8uLi9oZWxwZXJzL2lzby9pbmRleC5qcyc7XG5pbXBvcnQgeyBNZXRhZGF0YVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9tZXRhZGF0YVNlcnZpY2UuanMnO1xuaW1wb3J0IHsgdmVyaWZ5QXR0ZXN0YXRpb25XaXRoTWV0YWRhdGEgfSBmcm9tICcuLi8uLi9tZXRhZGF0YS92ZXJpZnlBdHRlc3RhdGlvbldpdGhNZXRhZGF0YS5qcyc7XG4vKipcbiAqIFZlcmlmeSBhbiBhdHRlc3RhdGlvbiByZXNwb25zZSB3aXRoIGZtdCAnYW5kcm9pZC1rZXknXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlBdHRlc3RhdGlvbkFuZHJvaWRLZXkob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYXV0aERhdGEsIGNsaWVudERhdGFIYXNoLCBhdHRTdG10LCBjcmVkZW50aWFsUHVibGljS2V5LCBhYWd1aWQsIHJvb3RDZXJ0aWZpY2F0ZXMsIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHg1YyA9IGF0dFN0bXQuZ2V0KCd4NWMnKTtcbiAgICBjb25zdCBzaWcgPSBhdHRTdG10LmdldCgnc2lnJyk7XG4gICAgY29uc3QgYWxnID0gYXR0U3RtdC5nZXQoJ2FsZycpO1xuICAgIGlmICgheDVjKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXR0ZXN0YXRpb24gY2VydGlmaWNhdGUgcHJvdmlkZWQgaW4gYXR0ZXN0YXRpb24gc3RhdGVtZW50IChBbmRyb2lkS2V5KScpO1xuICAgIH1cbiAgICBpZiAoIXNpZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGF0dGVzdGF0aW9uIHNpZ25hdHVyZSBwcm92aWRlZCBpbiBhdHRlc3RhdGlvbiBzdGF0ZW1lbnQgKEFuZHJvaWRLZXkpJyk7XG4gICAgfVxuICAgIGlmICghYWxnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQXR0ZXN0YXRpb24gc3RhdGVtZW50IGRpZCBub3QgY29udGFpbiBhbGcgKEFuZHJvaWRLZXkpYCk7XG4gICAgfVxuICAgIGlmICghaXNDT1NFQWxnKGFsZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBdHRlc3RhdGlvbiBzdGF0ZW1lbnQgY29udGFpbmVkIGludmFsaWQgYWxnICR7YWxnfSAoQW5kcm9pZEtleSlgKTtcbiAgICB9XG4gICAgLy8gQ2hlY2sgdGhhdCBjcmVkZW50aWFsUHVibGljS2V5IG1hdGNoZXMgdGhlIHB1YmxpYyBrZXkgaW4gdGhlIGF0dGVzdGF0aW9uIGNlcnRpZmljYXRlXG4gICAgLy8gRmluZCB0aGUgcHVibGljIGNlcnQgaW4gdGhlIGNlcnRpZmljYXRlIGFzIFBLQ1NcbiAgICBjb25zdCBwYXJzZWRDZXJ0ID0gQXNuUGFyc2VyLnBhcnNlKHg1Y1swXSwgQ2VydGlmaWNhdGUpO1xuICAgIGNvbnN0IHBhcnNlZENlcnRQdWJLZXkgPSBuZXcgVWludDhBcnJheShwYXJzZWRDZXJ0LnRic0NlcnRpZmljYXRlLnN1YmplY3RQdWJsaWNLZXlJbmZvLnN1YmplY3RQdWJsaWNLZXkpO1xuICAgIC8vIENvbnZlcnQgdGhlIGNyZWRlbnRpYWxQdWJsaWNLZXkgdG8gUEtDU1xuICAgIGNvbnN0IGNyZWRQdWJLZXlQS0NTID0gY29udmVydENPU0V0b1BLQ1MoY3JlZGVudGlhbFB1YmxpY0tleSk7XG4gICAgaWYgKCFpc29VaW50OEFycmF5LmFyZUVxdWFsKGNyZWRQdWJLZXlQS0NTLCBwYXJzZWRDZXJ0UHViS2V5KSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyZWRlbnRpYWwgcHVibGljIGtleSBkb2VzIG5vdCBlcXVhbCBsZWFmIGNlcnQgcHVibGljIGtleSAoQW5kcm9pZEtleSknKTtcbiAgICB9XG4gICAgLy8gRmluZCBBbmRyb2lkIEtleVN0b3JlIEV4dGVuc2lvbiBpbiBjZXJ0aWZpY2F0ZSBleHRlbnNpb25zXG4gICAgY29uc3QgZXh0S2V5U3RvcmUgPSBwYXJzZWRDZXJ0LnRic0NlcnRpZmljYXRlLmV4dGVuc2lvbnM/LmZpbmQoKGV4dCkgPT4gZXh0LmV4dG5JRCA9PT0gaWRfY2Vfa2V5RGVzY3JpcHRpb24pO1xuICAgIGlmICghZXh0S2V5U3RvcmUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSBkaWQgbm90IGNvbnRhaW4gZXh0S2V5U3RvcmUgKEFuZHJvaWRLZXkpJyk7XG4gICAgfVxuICAgIGNvbnN0IHBhcnNlZEV4dEtleVN0b3JlID0gQXNuUGFyc2VyLnBhcnNlKGV4dEtleVN0b3JlLmV4dG5WYWx1ZSwgS2V5RGVzY3JpcHRpb24pO1xuICAgIC8vIFZlcmlmeSBleHRLZXlTdG9yZSB2YWx1ZXNcbiAgICBjb25zdCB7IGF0dGVzdGF0aW9uQ2hhbGxlbmdlLCB0ZWVFbmZvcmNlZCwgc29mdHdhcmVFbmZvcmNlZCB9ID0gcGFyc2VkRXh0S2V5U3RvcmU7XG4gICAgaWYgKCFpc29VaW50OEFycmF5LmFyZUVxdWFsKG5ldyBVaW50OEFycmF5KGF0dGVzdGF0aW9uQ2hhbGxlbmdlLmJ1ZmZlciksIGNsaWVudERhdGFIYXNoKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0F0dGVzdGF0aW9uIGNoYWxsZW5nZSB3YXMgbm90IGVxdWFsIHRvIGNsaWVudCBkYXRhIGhhc2ggKEFuZHJvaWRLZXkpJyk7XG4gICAgfVxuICAgIC8vIEVuc3VyZSB0aGF0IHRoZSBrZXkgaXMgc3RyaWN0bHkgYm91bmQgdG8gdGhlIGNhbGxlciBhcHAgaWRlbnRpZmllciAoc2hvdWxkbid0IGNvbnRhaW4gdGhlXG4gICAgLy8gWzYwMF0gdGFnKVxuICAgIGlmICh0ZWVFbmZvcmNlZC5hbGxBcHBsaWNhdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3RlZUVuZm9yY2VkIGNvbnRhaW5lZCBcImFsbEFwcGxpY2F0aW9ucyBbNjAwXVwiIHRhZyAoQW5kcm9pZEtleSknKTtcbiAgICB9XG4gICAgaWYgKHNvZnR3YXJlRW5mb3JjZWQuYWxsQXBwbGljYXRpb25zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd0ZWVFbmZvcmNlZCBjb250YWluZWQgXCJhbGxBcHBsaWNhdGlvbnMgWzYwMF1cIiB0YWcgKEFuZHJvaWRLZXkpJyk7XG4gICAgfVxuICAgIGNvbnN0IHN0YXRlbWVudCA9IGF3YWl0IE1ldGFkYXRhU2VydmljZS5nZXRTdGF0ZW1lbnQoYWFndWlkKTtcbiAgICBpZiAoc3RhdGVtZW50KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB2ZXJpZnlBdHRlc3RhdGlvbldpdGhNZXRhZGF0YSh7XG4gICAgICAgICAgICAgICAgc3RhdGVtZW50LFxuICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxQdWJsaWNLZXksXG4gICAgICAgICAgICAgICAgeDVjLFxuICAgICAgICAgICAgICAgIGF0dGVzdGF0aW9uU3RhdGVtZW50QWxnOiBhbGcsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zdCBfZXJyID0gZXJyO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke19lcnIubWVzc2FnZX0gKEFuZHJvaWRLZXkpYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBUcnkgdmFsaWRhdGluZyB0aGUgY2VydGlmaWNhdGUgcGF0aCB1c2luZyB0aGUgcm9vdCBjZXJ0aWZpY2F0ZXMgc2V0IHZpYSBTZXR0aW5nc1NlcnZpY2VcbiAgICAgICAgICAgIGF3YWl0IHZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoKHg1Yy5tYXAoY29udmVydENlcnRCdWZmZXJUb1BFTSksIHJvb3RDZXJ0aWZpY2F0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnN0IF9lcnIgPSBlcnI7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7X2Vyci5tZXNzYWdlfSAoQW5kcm9pZEtleSlgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBzaWduYXR1cmVCYXNlID0gaXNvVWludDhBcnJheS5jb25jYXQoW2F1dGhEYXRhLCBjbGllbnREYXRhSGFzaF0pO1xuICAgIHJldHVybiB2ZXJpZnlTaWduYXR1cmUoe1xuICAgICAgICBzaWduYXR1cmU6IHNpZyxcbiAgICAgICAgZGF0YTogc2lnbmF0dXJlQmFzZSxcbiAgICAgICAgeDUwOUNlcnRpZmljYXRlOiB4NWNbMF0sXG4gICAgICAgIGhhc2hBbGdvcml0aG06IGFsZyxcbiAgICB9KTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationAndroidKey.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationAndroidSafetyNet.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationAndroidSafetyNet.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyAttestationAndroidSafetyNet: () => (/* binding */ verifyAttestationAndroidSafetyNet)\n/* harmony export */ });\n/* harmony import */ var _helpers_toHash_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../helpers/toHash.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js\");\n/* harmony import */ var _helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../helpers/verifySignature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\");\n/* harmony import */ var _helpers_getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../helpers/getCertificateInfo.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/getCertificateInfo.js\");\n/* harmony import */ var _helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../helpers/validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _services_metadataService_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../services/metadataService.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/metadataService.js\");\n/* harmony import */ var _metadata_verifyAttestationWithMetadata_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../metadata/verifyAttestationWithMetadata.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyAttestationWithMetadata.js\");\n\n\n\n\n\n\n\n\n/**\n * Verify an attestation response with fmt 'android-safetynet'\n */\nasync function verifyAttestationAndroidSafetyNet(options) {\n    const { attStmt, clientDataHash, authData, aaguid, rootCertificates, verifyTimestampMS = true, credentialPublicKey, } = options;\n    const alg = attStmt.get('alg');\n    const response = attStmt.get('response');\n    const ver = attStmt.get('ver');\n    if (!ver) {\n        throw new Error('No ver value in attestation (SafetyNet)');\n    }\n    if (!response) {\n        throw new Error('No response was included in attStmt by authenticator (SafetyNet)');\n    }\n    // Prepare to verify a JWT\n    const jwt = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoUint8Array.toUTF8String(response);\n    const jwtParts = jwt.split('.');\n    const HEADER = JSON.parse(_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoBase64URL.toUTF8String(jwtParts[0]));\n    const PAYLOAD = JSON.parse(_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoBase64URL.toUTF8String(jwtParts[1]));\n    const SIGNATURE = jwtParts[2];\n    /**\n     * START Verify PAYLOAD\n     */\n    const { nonce, ctsProfileMatch, timestampMs } = PAYLOAD;\n    if (verifyTimestampMS) {\n        // Make sure timestamp is in the past\n        let now = Date.now();\n        if (timestampMs > Date.now()) {\n            throw new Error(`Payload timestamp \"${timestampMs}\" was later than \"${now}\" (SafetyNet)`);\n        }\n        // Consider a SafetyNet attestation valid within a minute of it being performed\n        const timestampPlusDelay = timestampMs + 60 * 1000;\n        now = Date.now();\n        if (timestampPlusDelay < now) {\n            throw new Error(`Payload timestamp \"${timestampPlusDelay}\" has expired (SafetyNet)`);\n        }\n    }\n    const nonceBase = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoUint8Array.concat([authData, clientDataHash]);\n    const nonceBuffer = await (0,_helpers_toHash_js__WEBPACK_IMPORTED_MODULE_0__.toHash)(nonceBase);\n    const expectedNonce = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoBase64URL.fromBuffer(nonceBuffer, 'base64');\n    if (nonce !== expectedNonce) {\n        throw new Error('Could not verify payload nonce (SafetyNet)');\n    }\n    if (!ctsProfileMatch) {\n        throw new Error('Could not verify device integrity (SafetyNet)');\n    }\n    /**\n     * END Verify PAYLOAD\n     */\n    /**\n     * START Verify Header\n     */\n    // `HEADER.x5c[0]` is definitely a base64 string\n    const leafCertBuffer = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoBase64URL.toBuffer(HEADER.x5c[0], 'base64');\n    const leafCertInfo = (0,_helpers_getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_2__.getCertificateInfo)(leafCertBuffer);\n    const { subject } = leafCertInfo;\n    // Ensure the certificate was issued to this hostname\n    // See https://developer.android.com/training/safetynet/attestation#verify-attestation-response\n    if (subject.CN !== 'attest.android.com') {\n        throw new Error('Certificate common name was not \"attest.android.com\" (SafetyNet)');\n    }\n    const statement = await _services_metadataService_js__WEBPACK_IMPORTED_MODULE_6__.MetadataService.getStatement(aaguid);\n    if (statement) {\n        try {\n            await (0,_metadata_verifyAttestationWithMetadata_js__WEBPACK_IMPORTED_MODULE_7__.verifyAttestationWithMetadata)({\n                statement,\n                credentialPublicKey,\n                x5c: HEADER.x5c,\n                attestationStatementAlg: alg,\n            });\n        }\n        catch (err) {\n            const _err = err;\n            throw new Error(`${_err.message} (SafetyNet)`);\n        }\n    }\n    else {\n        try {\n            // Try validating the certificate path using the root certificates set via SettingsService\n            await (0,_helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_3__.validateCertificatePath)(HEADER.x5c.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_4__.convertCertBufferToPEM), rootCertificates);\n        }\n        catch (err) {\n            const _err = err;\n            throw new Error(`${_err.message} (SafetyNet)`);\n        }\n    }\n    /**\n     * END Verify Header\n     */\n    /**\n     * START Verify Signature\n     */\n    const signatureBaseBuffer = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoUint8Array.fromUTF8String(`${jwtParts[0]}.${jwtParts[1]}`);\n    const signatureBuffer = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoBase64URL.toBuffer(SIGNATURE);\n    const verified = await (0,_helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_1__.verifySignature)({\n        signature: signatureBuffer,\n        data: signatureBaseBuffer,\n        x509Certificate: leafCertBuffer,\n    });\n    /**\n     * END Verify Signature\n     */\n    return verified;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdmVyaWZ5QXR0ZXN0YXRpb25BbmRyb2lkU2FmZXR5TmV0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFpRDtBQUNrQjtBQUNNO0FBQ1U7QUFDRjtBQUNSO0FBQ0w7QUFDNEI7QUFDaEc7QUFDQTtBQUNBO0FBQ087QUFDUCxZQUFZLDhHQUE4RztBQUMxSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw2RUFBMEI7QUFDMUM7QUFDQSw4QkFBOEIsNEVBQXlCO0FBQ3ZELCtCQUErQiw0RUFBeUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHNDQUFzQztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxZQUFZLG9CQUFvQixJQUFJO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsbUJBQW1CO0FBQ3JFO0FBQ0E7QUFDQSxzQkFBc0IsdUVBQW9CO0FBQzFDLDhCQUE4QiwwREFBTTtBQUNwQywwQkFBMEIsMEVBQXVCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHdFQUFxQjtBQUNoRCx5QkFBeUIsa0ZBQWtCO0FBQzNDLFlBQVksVUFBVTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHlFQUFlO0FBQzNDO0FBQ0E7QUFDQSxrQkFBa0IseUdBQTZCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixjQUFjO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNEZBQXVCLGdCQUFnQixzRkFBc0I7QUFDL0U7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGNBQWM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQywrRUFBNEIsSUFBSSxZQUFZLEdBQUcsWUFBWTtBQUMzRiw0QkFBNEIsd0VBQXFCO0FBQ2pELDJCQUEyQiw0RUFBZTtBQUMxQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXHJlZ2lzdHJhdGlvblxcdmVyaWZpY2F0aW9uc1xcdmVyaWZ5QXR0ZXN0YXRpb25BbmRyb2lkU2FmZXR5TmV0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRvSGFzaCB9IGZyb20gJy4uLy4uL2hlbHBlcnMvdG9IYXNoLmpzJztcbmltcG9ydCB7IHZlcmlmeVNpZ25hdHVyZSB9IGZyb20gJy4uLy4uL2hlbHBlcnMvdmVyaWZ5U2lnbmF0dXJlLmpzJztcbmltcG9ydCB7IGdldENlcnRpZmljYXRlSW5mbyB9IGZyb20gJy4uLy4uL2hlbHBlcnMvZ2V0Q2VydGlmaWNhdGVJbmZvLmpzJztcbmltcG9ydCB7IHZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoIH0gZnJvbSAnLi4vLi4vaGVscGVycy92YWxpZGF0ZUNlcnRpZmljYXRlUGF0aC5qcyc7XG5pbXBvcnQgeyBjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNIH0gZnJvbSAnLi4vLi4vaGVscGVycy9jb252ZXJ0Q2VydEJ1ZmZlclRvUEVNLmpzJztcbmltcG9ydCB7IGlzb0Jhc2U2NFVSTCwgaXNvVWludDhBcnJheSB9IGZyb20gJy4uLy4uL2hlbHBlcnMvaXNvL2luZGV4LmpzJztcbmltcG9ydCB7IE1ldGFkYXRhU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL21ldGFkYXRhU2VydmljZS5qcyc7XG5pbXBvcnQgeyB2ZXJpZnlBdHRlc3RhdGlvbldpdGhNZXRhZGF0YSB9IGZyb20gJy4uLy4uL21ldGFkYXRhL3ZlcmlmeUF0dGVzdGF0aW9uV2l0aE1ldGFkYXRhLmpzJztcbi8qKlxuICogVmVyaWZ5IGFuIGF0dGVzdGF0aW9uIHJlc3BvbnNlIHdpdGggZm10ICdhbmRyb2lkLXNhZmV0eW5ldCdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUF0dGVzdGF0aW9uQW5kcm9pZFNhZmV0eU5ldChvcHRpb25zKSB7XG4gICAgY29uc3QgeyBhdHRTdG10LCBjbGllbnREYXRhSGFzaCwgYXV0aERhdGEsIGFhZ3VpZCwgcm9vdENlcnRpZmljYXRlcywgdmVyaWZ5VGltZXN0YW1wTVMgPSB0cnVlLCBjcmVkZW50aWFsUHVibGljS2V5LCB9ID0gb3B0aW9ucztcbiAgICBjb25zdCBhbGcgPSBhdHRTdG10LmdldCgnYWxnJyk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhdHRTdG10LmdldCgncmVzcG9uc2UnKTtcbiAgICBjb25zdCB2ZXIgPSBhdHRTdG10LmdldCgndmVyJyk7XG4gICAgaWYgKCF2ZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB2ZXIgdmFsdWUgaW4gYXR0ZXN0YXRpb24gKFNhZmV0eU5ldCknKTtcbiAgICB9XG4gICAgaWYgKCFyZXNwb25zZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHJlc3BvbnNlIHdhcyBpbmNsdWRlZCBpbiBhdHRTdG10IGJ5IGF1dGhlbnRpY2F0b3IgKFNhZmV0eU5ldCknKTtcbiAgICB9XG4gICAgLy8gUHJlcGFyZSB0byB2ZXJpZnkgYSBKV1RcbiAgICBjb25zdCBqd3QgPSBpc29VaW50OEFycmF5LnRvVVRGOFN0cmluZyhyZXNwb25zZSk7XG4gICAgY29uc3Qgand0UGFydHMgPSBqd3Quc3BsaXQoJy4nKTtcbiAgICBjb25zdCBIRUFERVIgPSBKU09OLnBhcnNlKGlzb0Jhc2U2NFVSTC50b1VURjhTdHJpbmcoand0UGFydHNbMF0pKTtcbiAgICBjb25zdCBQQVlMT0FEID0gSlNPTi5wYXJzZShpc29CYXNlNjRVUkwudG9VVEY4U3RyaW5nKGp3dFBhcnRzWzFdKSk7XG4gICAgY29uc3QgU0lHTkFUVVJFID0gand0UGFydHNbMl07XG4gICAgLyoqXG4gICAgICogU1RBUlQgVmVyaWZ5IFBBWUxPQURcbiAgICAgKi9cbiAgICBjb25zdCB7IG5vbmNlLCBjdHNQcm9maWxlTWF0Y2gsIHRpbWVzdGFtcE1zIH0gPSBQQVlMT0FEO1xuICAgIGlmICh2ZXJpZnlUaW1lc3RhbXBNUykge1xuICAgICAgICAvLyBNYWtlIHN1cmUgdGltZXN0YW1wIGlzIGluIHRoZSBwYXN0XG4gICAgICAgIGxldCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBpZiAodGltZXN0YW1wTXMgPiBEYXRlLm5vdygpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBheWxvYWQgdGltZXN0YW1wIFwiJHt0aW1lc3RhbXBNc31cIiB3YXMgbGF0ZXIgdGhhbiBcIiR7bm93fVwiIChTYWZldHlOZXQpYCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ29uc2lkZXIgYSBTYWZldHlOZXQgYXR0ZXN0YXRpb24gdmFsaWQgd2l0aGluIGEgbWludXRlIG9mIGl0IGJlaW5nIHBlcmZvcm1lZFxuICAgICAgICBjb25zdCB0aW1lc3RhbXBQbHVzRGVsYXkgPSB0aW1lc3RhbXBNcyArIDYwICogMTAwMDtcbiAgICAgICAgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgaWYgKHRpbWVzdGFtcFBsdXNEZWxheSA8IG5vdykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQYXlsb2FkIHRpbWVzdGFtcCBcIiR7dGltZXN0YW1wUGx1c0RlbGF5fVwiIGhhcyBleHBpcmVkIChTYWZldHlOZXQpYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3Qgbm9uY2VCYXNlID0gaXNvVWludDhBcnJheS5jb25jYXQoW2F1dGhEYXRhLCBjbGllbnREYXRhSGFzaF0pO1xuICAgIGNvbnN0IG5vbmNlQnVmZmVyID0gYXdhaXQgdG9IYXNoKG5vbmNlQmFzZSk7XG4gICAgY29uc3QgZXhwZWN0ZWROb25jZSA9IGlzb0Jhc2U2NFVSTC5mcm9tQnVmZmVyKG5vbmNlQnVmZmVyLCAnYmFzZTY0Jyk7XG4gICAgaWYgKG5vbmNlICE9PSBleHBlY3RlZE5vbmNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IHZlcmlmeSBwYXlsb2FkIG5vbmNlIChTYWZldHlOZXQpJyk7XG4gICAgfVxuICAgIGlmICghY3RzUHJvZmlsZU1hdGNoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IHZlcmlmeSBkZXZpY2UgaW50ZWdyaXR5IChTYWZldHlOZXQpJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVORCBWZXJpZnkgUEFZTE9BRFxuICAgICAqL1xuICAgIC8qKlxuICAgICAqIFNUQVJUIFZlcmlmeSBIZWFkZXJcbiAgICAgKi9cbiAgICAvLyBgSEVBREVSLng1Y1swXWAgaXMgZGVmaW5pdGVseSBhIGJhc2U2NCBzdHJpbmdcbiAgICBjb25zdCBsZWFmQ2VydEJ1ZmZlciA9IGlzb0Jhc2U2NFVSTC50b0J1ZmZlcihIRUFERVIueDVjWzBdLCAnYmFzZTY0Jyk7XG4gICAgY29uc3QgbGVhZkNlcnRJbmZvID0gZ2V0Q2VydGlmaWNhdGVJbmZvKGxlYWZDZXJ0QnVmZmVyKTtcbiAgICBjb25zdCB7IHN1YmplY3QgfSA9IGxlYWZDZXJ0SW5mbztcbiAgICAvLyBFbnN1cmUgdGhlIGNlcnRpZmljYXRlIHdhcyBpc3N1ZWQgdG8gdGhpcyBob3N0bmFtZVxuICAgIC8vIFNlZSBodHRwczovL2RldmVsb3Blci5hbmRyb2lkLmNvbS90cmFpbmluZy9zYWZldHluZXQvYXR0ZXN0YXRpb24jdmVyaWZ5LWF0dGVzdGF0aW9uLXJlc3BvbnNlXG4gICAgaWYgKHN1YmplY3QuQ04gIT09ICdhdHRlc3QuYW5kcm9pZC5jb20nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2VydGlmaWNhdGUgY29tbW9uIG5hbWUgd2FzIG5vdCBcImF0dGVzdC5hbmRyb2lkLmNvbVwiIChTYWZldHlOZXQpJyk7XG4gICAgfVxuICAgIGNvbnN0IHN0YXRlbWVudCA9IGF3YWl0IE1ldGFkYXRhU2VydmljZS5nZXRTdGF0ZW1lbnQoYWFndWlkKTtcbiAgICBpZiAoc3RhdGVtZW50KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB2ZXJpZnlBdHRlc3RhdGlvbldpdGhNZXRhZGF0YSh7XG4gICAgICAgICAgICAgICAgc3RhdGVtZW50LFxuICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxQdWJsaWNLZXksXG4gICAgICAgICAgICAgICAgeDVjOiBIRUFERVIueDVjLFxuICAgICAgICAgICAgICAgIGF0dGVzdGF0aW9uU3RhdGVtZW50QWxnOiBhbGcsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zdCBfZXJyID0gZXJyO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke19lcnIubWVzc2FnZX0gKFNhZmV0eU5ldClgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyeSB2YWxpZGF0aW5nIHRoZSBjZXJ0aWZpY2F0ZSBwYXRoIHVzaW5nIHRoZSByb290IGNlcnRpZmljYXRlcyBzZXQgdmlhIFNldHRpbmdzU2VydmljZVxuICAgICAgICAgICAgYXdhaXQgdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGgoSEVBREVSLng1Yy5tYXAoY29udmVydENlcnRCdWZmZXJUb1BFTSksIHJvb3RDZXJ0aWZpY2F0ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnN0IF9lcnIgPSBlcnI7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7X2Vyci5tZXNzYWdlfSAoU2FmZXR5TmV0KWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVORCBWZXJpZnkgSGVhZGVyXG4gICAgICovXG4gICAgLyoqXG4gICAgICogU1RBUlQgVmVyaWZ5IFNpZ25hdHVyZVxuICAgICAqL1xuICAgIGNvbnN0IHNpZ25hdHVyZUJhc2VCdWZmZXIgPSBpc29VaW50OEFycmF5LmZyb21VVEY4U3RyaW5nKGAke2p3dFBhcnRzWzBdfS4ke2p3dFBhcnRzWzFdfWApO1xuICAgIGNvbnN0IHNpZ25hdHVyZUJ1ZmZlciA9IGlzb0Jhc2U2NFVSTC50b0J1ZmZlcihTSUdOQVRVUkUpO1xuICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgdmVyaWZ5U2lnbmF0dXJlKHtcbiAgICAgICAgc2lnbmF0dXJlOiBzaWduYXR1cmVCdWZmZXIsXG4gICAgICAgIGRhdGE6IHNpZ25hdHVyZUJhc2VCdWZmZXIsXG4gICAgICAgIHg1MDlDZXJ0aWZpY2F0ZTogbGVhZkNlcnRCdWZmZXIsXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogRU5EIFZlcmlmeSBTaWduYXR1cmVcbiAgICAgKi9cbiAgICByZXR1cm4gdmVyaWZpZWQ7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationAndroidSafetyNet.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationApple.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationApple.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyAttestationApple: () => (/* binding */ verifyAttestationApple)\n/* harmony export */ });\n/* harmony import */ var _deps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../deps.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/deps.js\");\n/* harmony import */ var _helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../helpers/validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _helpers_toHash_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../helpers/toHash.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js\");\n/* harmony import */ var _helpers_convertCOSEtoPKCS_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../helpers/convertCOSEtoPKCS.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCOSEtoPKCS.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n\n\n\n\n\n\nasync function verifyAttestationApple(options) {\n    const { attStmt, authData, clientDataHash, credentialPublicKey, rootCertificates, } = options;\n    const x5c = attStmt.get('x5c');\n    if (!x5c) {\n        throw new Error('No attestation certificate provided in attestation statement (Apple)');\n    }\n    /**\n     * Verify certificate path\n     */\n    try {\n        await (0,_helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_1__.validateCertificatePath)(x5c.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_2__.convertCertBufferToPEM), rootCertificates);\n    }\n    catch (err) {\n        const _err = err;\n        throw new Error(`${_err.message} (Apple)`);\n    }\n    /**\n     * Compare nonce in certificate extension to computed nonce\n     */\n    const parsedCredCert = _deps_js__WEBPACK_IMPORTED_MODULE_0__.AsnParser.parse(x5c[0], _deps_js__WEBPACK_IMPORTED_MODULE_0__.Certificate);\n    const { extensions, subjectPublicKeyInfo } = parsedCredCert.tbsCertificate;\n    if (!extensions) {\n        throw new Error('credCert missing extensions (Apple)');\n    }\n    const extCertNonce = extensions.find((ext) => ext.extnID === '1.2.840.113635.100.8.2');\n    if (!extCertNonce) {\n        throw new Error('credCert missing \"1.2.840.113635.100.8.2\" extension (Apple)');\n    }\n    const nonceToHash = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoUint8Array.concat([authData, clientDataHash]);\n    const nonce = await (0,_helpers_toHash_js__WEBPACK_IMPORTED_MODULE_3__.toHash)(nonceToHash);\n    /**\n     * Ignore the first six ASN.1 structure bytes that define the nonce as an OCTET STRING. Should\n     * trim off <Buffer 30 24 a1 22 04 20>\n     *\n     * TODO: Try and get @peculiar (GitHub) to add a schema for \"1.2.840.113635.100.8.2\" when we\n     * find out where it's defined (doesn't seem to be publicly documented at the moment...)\n     */\n    const extNonce = new Uint8Array(extCertNonce.extnValue.buffer).slice(6);\n    if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoUint8Array.areEqual(nonce, extNonce)) {\n        throw new Error(`credCert nonce was not expected value (Apple)`);\n    }\n    /**\n     * Verify credential public key matches the Subject Public Key of credCert\n     */\n    const credPubKeyPKCS = (0,_helpers_convertCOSEtoPKCS_js__WEBPACK_IMPORTED_MODULE_4__.convertCOSEtoPKCS)(credentialPublicKey);\n    const credCertSubjectPublicKey = new Uint8Array(subjectPublicKeyInfo.subjectPublicKey);\n    if (!_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoUint8Array.areEqual(credPubKeyPKCS, credCertSubjectPublicKey)) {\n        throw new Error('Credential public key does not equal credCert public key (Apple)');\n    }\n    return true;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdmVyaWZ5QXR0ZXN0YXRpb25BcHBsZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXVEO0FBQzRCO0FBQ0Y7QUFDaEM7QUFDc0I7QUFDWjtBQUNwRDtBQUNQLFlBQVksNEVBQTRFO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDRGQUF1QixTQUFTLHNGQUFzQjtBQUNwRTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsY0FBYztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwrQ0FBUyxlQUFlLGlEQUFXO0FBQzlELFlBQVksbUNBQW1DO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVFQUFvQjtBQUM1Qyx3QkFBd0IsMERBQU07QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMseUVBQXNCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsZ0ZBQWlCO0FBQzVDO0FBQ0EsU0FBUyx5RUFBc0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxyZWdpc3RyYXRpb25cXHZlcmlmaWNhdGlvbnNcXHZlcmlmeUF0dGVzdGF0aW9uQXBwbGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXNuUGFyc2VyLCBDZXJ0aWZpY2F0ZSB9IGZyb20gJy4uLy4uL2RlcHMuanMnO1xuaW1wb3J0IHsgdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGggfSBmcm9tICcuLi8uLi9oZWxwZXJzL3ZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoLmpzJztcbmltcG9ydCB7IGNvbnZlcnRDZXJ0QnVmZmVyVG9QRU0gfSBmcm9tICcuLi8uLi9oZWxwZXJzL2NvbnZlcnRDZXJ0QnVmZmVyVG9QRU0uanMnO1xuaW1wb3J0IHsgdG9IYXNoIH0gZnJvbSAnLi4vLi4vaGVscGVycy90b0hhc2guanMnO1xuaW1wb3J0IHsgY29udmVydENPU0V0b1BLQ1MgfSBmcm9tICcuLi8uLi9oZWxwZXJzL2NvbnZlcnRDT1NFdG9QS0NTLmpzJztcbmltcG9ydCB7IGlzb1VpbnQ4QXJyYXkgfSBmcm9tICcuLi8uLi9oZWxwZXJzL2lzby9pbmRleC5qcyc7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QXR0ZXN0YXRpb25BcHBsZShvcHRpb25zKSB7XG4gICAgY29uc3QgeyBhdHRTdG10LCBhdXRoRGF0YSwgY2xpZW50RGF0YUhhc2gsIGNyZWRlbnRpYWxQdWJsaWNLZXksIHJvb3RDZXJ0aWZpY2F0ZXMsIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHg1YyA9IGF0dFN0bXQuZ2V0KCd4NWMnKTtcbiAgICBpZiAoIXg1Yykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGF0dGVzdGF0aW9uIGNlcnRpZmljYXRlIHByb3ZpZGVkIGluIGF0dGVzdGF0aW9uIHN0YXRlbWVudCAoQXBwbGUpJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmeSBjZXJ0aWZpY2F0ZSBwYXRoXG4gICAgICovXG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGgoeDVjLm1hcChjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNKSwgcm9vdENlcnRpZmljYXRlcyk7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc3QgX2VyciA9IGVycjtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke19lcnIubWVzc2FnZX0gKEFwcGxlKWApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wYXJlIG5vbmNlIGluIGNlcnRpZmljYXRlIGV4dGVuc2lvbiB0byBjb21wdXRlZCBub25jZVxuICAgICAqL1xuICAgIGNvbnN0IHBhcnNlZENyZWRDZXJ0ID0gQXNuUGFyc2VyLnBhcnNlKHg1Y1swXSwgQ2VydGlmaWNhdGUpO1xuICAgIGNvbnN0IHsgZXh0ZW5zaW9ucywgc3ViamVjdFB1YmxpY0tleUluZm8gfSA9IHBhcnNlZENyZWRDZXJ0LnRic0NlcnRpZmljYXRlO1xuICAgIGlmICghZXh0ZW5zaW9ucykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyZWRDZXJ0IG1pc3NpbmcgZXh0ZW5zaW9ucyAoQXBwbGUpJyk7XG4gICAgfVxuICAgIGNvbnN0IGV4dENlcnROb25jZSA9IGV4dGVuc2lvbnMuZmluZCgoZXh0KSA9PiBleHQuZXh0bklEID09PSAnMS4yLjg0MC4xMTM2MzUuMTAwLjguMicpO1xuICAgIGlmICghZXh0Q2VydE5vbmNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignY3JlZENlcnQgbWlzc2luZyBcIjEuMi44NDAuMTEzNjM1LjEwMC44LjJcIiBleHRlbnNpb24gKEFwcGxlKScpO1xuICAgIH1cbiAgICBjb25zdCBub25jZVRvSGFzaCA9IGlzb1VpbnQ4QXJyYXkuY29uY2F0KFthdXRoRGF0YSwgY2xpZW50RGF0YUhhc2hdKTtcbiAgICBjb25zdCBub25jZSA9IGF3YWl0IHRvSGFzaChub25jZVRvSGFzaCk7XG4gICAgLyoqXG4gICAgICogSWdub3JlIHRoZSBmaXJzdCBzaXggQVNOLjEgc3RydWN0dXJlIGJ5dGVzIHRoYXQgZGVmaW5lIHRoZSBub25jZSBhcyBhbiBPQ1RFVCBTVFJJTkcuIFNob3VsZFxuICAgICAqIHRyaW0gb2ZmIDxCdWZmZXIgMzAgMjQgYTEgMjIgMDQgMjA+XG4gICAgICpcbiAgICAgKiBUT0RPOiBUcnkgYW5kIGdldCBAcGVjdWxpYXIgKEdpdEh1YikgdG8gYWRkIGEgc2NoZW1hIGZvciBcIjEuMi44NDAuMTEzNjM1LjEwMC44LjJcIiB3aGVuIHdlXG4gICAgICogZmluZCBvdXQgd2hlcmUgaXQncyBkZWZpbmVkIChkb2Vzbid0IHNlZW0gdG8gYmUgcHVibGljbHkgZG9jdW1lbnRlZCBhdCB0aGUgbW9tZW50Li4uKVxuICAgICAqL1xuICAgIGNvbnN0IGV4dE5vbmNlID0gbmV3IFVpbnQ4QXJyYXkoZXh0Q2VydE5vbmNlLmV4dG5WYWx1ZS5idWZmZXIpLnNsaWNlKDYpO1xuICAgIGlmICghaXNvVWludDhBcnJheS5hcmVFcXVhbChub25jZSwgZXh0Tm9uY2UpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgY3JlZENlcnQgbm9uY2Ugd2FzIG5vdCBleHBlY3RlZCB2YWx1ZSAoQXBwbGUpYCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmeSBjcmVkZW50aWFsIHB1YmxpYyBrZXkgbWF0Y2hlcyB0aGUgU3ViamVjdCBQdWJsaWMgS2V5IG9mIGNyZWRDZXJ0XG4gICAgICovXG4gICAgY29uc3QgY3JlZFB1YktleVBLQ1MgPSBjb252ZXJ0Q09TRXRvUEtDUyhjcmVkZW50aWFsUHVibGljS2V5KTtcbiAgICBjb25zdCBjcmVkQ2VydFN1YmplY3RQdWJsaWNLZXkgPSBuZXcgVWludDhBcnJheShzdWJqZWN0UHVibGljS2V5SW5mby5zdWJqZWN0UHVibGljS2V5KTtcbiAgICBpZiAoIWlzb1VpbnQ4QXJyYXkuYXJlRXF1YWwoY3JlZFB1YktleVBLQ1MsIGNyZWRDZXJ0U3ViamVjdFB1YmxpY0tleSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDcmVkZW50aWFsIHB1YmxpYyBrZXkgZG9lcyBub3QgZXF1YWwgY3JlZENlcnQgcHVibGljIGtleSAoQXBwbGUpJyk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationApple.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationFIDOU2F.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationFIDOU2F.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyAttestationFIDOU2F: () => (/* binding */ verifyAttestationFIDOU2F)\n/* harmony export */ });\n/* harmony import */ var _helpers_convertCOSEtoPKCS_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../helpers/convertCOSEtoPKCS.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCOSEtoPKCS.js\");\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../helpers/validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../helpers/verifySignature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _helpers_cose_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../helpers/cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n\n\n\n\n\n\n/**\n * Verify an attestation response with fmt 'fido-u2f'\n */\nasync function verifyAttestationFIDOU2F(options) {\n    const { attStmt, clientDataHash, rpIdHash, credentialID, credentialPublicKey, aaguid, rootCertificates, } = options;\n    const reservedByte = Uint8Array.from([0x00]);\n    const publicKey = (0,_helpers_convertCOSEtoPKCS_js__WEBPACK_IMPORTED_MODULE_0__.convertCOSEtoPKCS)(credentialPublicKey);\n    const signatureBase = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_4__.isoUint8Array.concat([\n        reservedByte,\n        rpIdHash,\n        clientDataHash,\n        credentialID,\n        publicKey,\n    ]);\n    const sig = attStmt.get('sig');\n    const x5c = attStmt.get('x5c');\n    if (!x5c) {\n        throw new Error('No attestation certificate provided in attestation statement (FIDOU2F)');\n    }\n    if (!sig) {\n        throw new Error('No attestation signature provided in attestation statement (FIDOU2F)');\n    }\n    // FIDO spec says that aaguid _must_ equal 0x00 here to be legit\n    const aaguidToHex = Number.parseInt(_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_4__.isoUint8Array.toHex(aaguid), 16);\n    if (aaguidToHex !== 0x00) {\n        throw new Error(`AAGUID \"${aaguidToHex}\" was not expected value`);\n    }\n    try {\n        // Try validating the certificate path using the root certificates set via SettingsService\n        await (0,_helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_2__.validateCertificatePath)(x5c.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__.convertCertBufferToPEM), rootCertificates);\n    }\n    catch (err) {\n        const _err = err;\n        throw new Error(`${_err.message} (FIDOU2F)`);\n    }\n    return (0,_helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_3__.verifySignature)({\n        signature: sig,\n        data: signatureBase,\n        x509Certificate: x5c[0],\n        hashAlgorithm: _helpers_cose_js__WEBPACK_IMPORTED_MODULE_5__.COSEALG.ES256,\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdmVyaWZ5QXR0ZXN0YXRpb25GSURPVTJGLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBdUU7QUFDVTtBQUNFO0FBQ2hCO0FBQ1I7QUFDWDtBQUNoRDtBQUNBO0FBQ0E7QUFDTztBQUNQLFlBQVksa0dBQWtHO0FBQzlHO0FBQ0Esc0JBQXNCLGdGQUFpQjtBQUN2QywwQkFBMEIsdUVBQW9CO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxzRUFBbUI7QUFDM0Q7QUFDQSxtQ0FBbUMsWUFBWTtBQUMvQztBQUNBO0FBQ0E7QUFDQSxjQUFjLDRGQUF1QixTQUFTLHNGQUFzQjtBQUNwRTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsY0FBYztBQUN6QztBQUNBLFdBQVcsNEVBQWU7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHFEQUFPO0FBQzlCLEtBQUs7QUFDTCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXHJlZ2lzdHJhdGlvblxcdmVyaWZpY2F0aW9uc1xcdmVyaWZ5QXR0ZXN0YXRpb25GSURPVTJGLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvbnZlcnRDT1NFdG9QS0NTIH0gZnJvbSAnLi4vLi4vaGVscGVycy9jb252ZXJ0Q09TRXRvUEtDUy5qcyc7XG5pbXBvcnQgeyBjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNIH0gZnJvbSAnLi4vLi4vaGVscGVycy9jb252ZXJ0Q2VydEJ1ZmZlclRvUEVNLmpzJztcbmltcG9ydCB7IHZhbGlkYXRlQ2VydGlmaWNhdGVQYXRoIH0gZnJvbSAnLi4vLi4vaGVscGVycy92YWxpZGF0ZUNlcnRpZmljYXRlUGF0aC5qcyc7XG5pbXBvcnQgeyB2ZXJpZnlTaWduYXR1cmUgfSBmcm9tICcuLi8uLi9oZWxwZXJzL3ZlcmlmeVNpZ25hdHVyZS5qcyc7XG5pbXBvcnQgeyBpc29VaW50OEFycmF5IH0gZnJvbSAnLi4vLi4vaGVscGVycy9pc28vaW5kZXguanMnO1xuaW1wb3J0IHsgQ09TRUFMRyB9IGZyb20gJy4uLy4uL2hlbHBlcnMvY29zZS5qcyc7XG4vKipcbiAqIFZlcmlmeSBhbiBhdHRlc3RhdGlvbiByZXNwb25zZSB3aXRoIGZtdCAnZmlkby11MmYnXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlBdHRlc3RhdGlvbkZJRE9VMkYob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYXR0U3RtdCwgY2xpZW50RGF0YUhhc2gsIHJwSWRIYXNoLCBjcmVkZW50aWFsSUQsIGNyZWRlbnRpYWxQdWJsaWNLZXksIGFhZ3VpZCwgcm9vdENlcnRpZmljYXRlcywgfSA9IG9wdGlvbnM7XG4gICAgY29uc3QgcmVzZXJ2ZWRCeXRlID0gVWludDhBcnJheS5mcm9tKFsweDAwXSk7XG4gICAgY29uc3QgcHVibGljS2V5ID0gY29udmVydENPU0V0b1BLQ1MoY3JlZGVudGlhbFB1YmxpY0tleSk7XG4gICAgY29uc3Qgc2lnbmF0dXJlQmFzZSA9IGlzb1VpbnQ4QXJyYXkuY29uY2F0KFtcbiAgICAgICAgcmVzZXJ2ZWRCeXRlLFxuICAgICAgICBycElkSGFzaCxcbiAgICAgICAgY2xpZW50RGF0YUhhc2gsXG4gICAgICAgIGNyZWRlbnRpYWxJRCxcbiAgICAgICAgcHVibGljS2V5LFxuICAgIF0pO1xuICAgIGNvbnN0IHNpZyA9IGF0dFN0bXQuZ2V0KCdzaWcnKTtcbiAgICBjb25zdCB4NWMgPSBhdHRTdG10LmdldCgneDVjJyk7XG4gICAgaWYgKCF4NWMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhdHRlc3RhdGlvbiBjZXJ0aWZpY2F0ZSBwcm92aWRlZCBpbiBhdHRlc3RhdGlvbiBzdGF0ZW1lbnQgKEZJRE9VMkYpJyk7XG4gICAgfVxuICAgIGlmICghc2lnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYXR0ZXN0YXRpb24gc2lnbmF0dXJlIHByb3ZpZGVkIGluIGF0dGVzdGF0aW9uIHN0YXRlbWVudCAoRklET1UyRiknKTtcbiAgICB9XG4gICAgLy8gRklETyBzcGVjIHNheXMgdGhhdCBhYWd1aWQgX211c3RfIGVxdWFsIDB4MDAgaGVyZSB0byBiZSBsZWdpdFxuICAgIGNvbnN0IGFhZ3VpZFRvSGV4ID0gTnVtYmVyLnBhcnNlSW50KGlzb1VpbnQ4QXJyYXkudG9IZXgoYWFndWlkKSwgMTYpO1xuICAgIGlmIChhYWd1aWRUb0hleCAhPT0gMHgwMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEFBR1VJRCBcIiR7YWFndWlkVG9IZXh9XCIgd2FzIG5vdCBleHBlY3RlZCB2YWx1ZWApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyBUcnkgdmFsaWRhdGluZyB0aGUgY2VydGlmaWNhdGUgcGF0aCB1c2luZyB0aGUgcm9vdCBjZXJ0aWZpY2F0ZXMgc2V0IHZpYSBTZXR0aW5nc1NlcnZpY2VcbiAgICAgICAgYXdhaXQgdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGgoeDVjLm1hcChjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNKSwgcm9vdENlcnRpZmljYXRlcyk7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc3QgX2VyciA9IGVycjtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke19lcnIubWVzc2FnZX0gKEZJRE9VMkYpYCk7XG4gICAgfVxuICAgIHJldHVybiB2ZXJpZnlTaWduYXR1cmUoe1xuICAgICAgICBzaWduYXR1cmU6IHNpZyxcbiAgICAgICAgZGF0YTogc2lnbmF0dXJlQmFzZSxcbiAgICAgICAgeDUwOUNlcnRpZmljYXRlOiB4NWNbMF0sXG4gICAgICAgIGhhc2hBbGdvcml0aG06IENPU0VBTEcuRVMyNTYsXG4gICAgfSk7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationFIDOU2F.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationPacked.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationPacked.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyAttestationPacked: () => (/* binding */ verifyAttestationPacked)\n/* harmony export */ });\n/* harmony import */ var _helpers_cose_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../helpers/cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../helpers/validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _helpers_getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../helpers/getCertificateInfo.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/getCertificateInfo.js\");\n/* harmony import */ var _helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../helpers/verifySignature.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/verifySignature.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _services_metadataService_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../services/metadataService.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/metadataService.js\");\n/* harmony import */ var _metadata_verifyAttestationWithMetadata_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../metadata/verifyAttestationWithMetadata.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyAttestationWithMetadata.js\");\n\n\n\n\n\n\n\n\n/**\n * Verify an attestation response with fmt 'packed'\n */\nasync function verifyAttestationPacked(options) {\n    const { attStmt, clientDataHash, authData, credentialPublicKey, aaguid, rootCertificates, } = options;\n    const sig = attStmt.get('sig');\n    const x5c = attStmt.get('x5c');\n    const alg = attStmt.get('alg');\n    if (!sig) {\n        throw new Error('No attestation signature provided in attestation statement (Packed)');\n    }\n    if (!alg) {\n        throw new Error('Attestation statement did not contain alg (Packed)');\n    }\n    if (!(0,_helpers_cose_js__WEBPACK_IMPORTED_MODULE_0__.isCOSEAlg)(alg)) {\n        throw new Error(`Attestation statement contained invalid alg ${alg} (Packed)`);\n    }\n    const signatureBase = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_5__.isoUint8Array.concat([authData, clientDataHash]);\n    let verified = false;\n    if (x5c) {\n        const { subject, basicConstraintsCA, version, notBefore, notAfter } = (0,_helpers_getCertificateInfo_js__WEBPACK_IMPORTED_MODULE_3__.getCertificateInfo)(x5c[0]);\n        const { OU, CN, O, C } = subject;\n        if (OU !== 'Authenticator Attestation') {\n            throw new Error('Certificate OU was not \"Authenticator Attestation\" (Packed|Full)');\n        }\n        if (!CN) {\n            throw new Error('Certificate CN was empty (Packed|Full)');\n        }\n        if (!O) {\n            throw new Error('Certificate O was empty (Packed|Full)');\n        }\n        if (!C || C.length !== 2) {\n            throw new Error('Certificate C was not two-character ISO 3166 code (Packed|Full)');\n        }\n        if (basicConstraintsCA) {\n            throw new Error('Certificate basic constraints CA was not `false` (Packed|Full)');\n        }\n        if (version !== 2) {\n            throw new Error('Certificate version was not `3` (ASN.1 value of 2) (Packed|Full)');\n        }\n        let now = new Date();\n        if (notBefore > now) {\n            throw new Error(`Certificate not good before \"${notBefore.toString()}\" (Packed|Full)`);\n        }\n        now = new Date();\n        if (notAfter < now) {\n            throw new Error(`Certificate not good after \"${notAfter.toString()}\" (Packed|Full)`);\n        }\n        // TODO: If certificate contains id-fido-gen-ce-aaguid(1.3.6.1.4.1.45724.1.1.4) extension, check\n        // that its value is set to the same AAGUID as in authData.\n        // If available, validate attestation alg and x5c with info in the metadata statement\n        const statement = await _services_metadataService_js__WEBPACK_IMPORTED_MODULE_6__.MetadataService.getStatement(aaguid);\n        if (statement) {\n            // The presence of x5c means this is a full attestation. Check to see if attestationTypes\n            // includes packed attestations.\n            if (statement.attestationTypes.indexOf('basic_full') < 0) {\n                throw new Error('Metadata does not indicate support for full attestations (Packed|Full)');\n            }\n            try {\n                await (0,_metadata_verifyAttestationWithMetadata_js__WEBPACK_IMPORTED_MODULE_7__.verifyAttestationWithMetadata)({\n                    statement,\n                    credentialPublicKey,\n                    x5c,\n                    attestationStatementAlg: alg,\n                });\n            }\n            catch (err) {\n                const _err = err;\n                throw new Error(`${_err.message} (Packed|Full)`);\n            }\n        }\n        else {\n            try {\n                // Try validating the certificate path using the root certificates set via SettingsService\n                await (0,_helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_2__.validateCertificatePath)(x5c.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__.convertCertBufferToPEM), rootCertificates);\n            }\n            catch (err) {\n                const _err = err;\n                throw new Error(`${_err.message} (Packed|Full)`);\n            }\n        }\n        verified = await (0,_helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_4__.verifySignature)({\n            signature: sig,\n            data: signatureBase,\n            x509Certificate: x5c[0],\n        });\n    }\n    else {\n        verified = await (0,_helpers_verifySignature_js__WEBPACK_IMPORTED_MODULE_4__.verifySignature)({\n            signature: sig,\n            data: signatureBase,\n            credentialPublicKey,\n            hashAlgorithm: alg,\n        });\n    }\n    return verified;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmaWNhdGlvbnMvdmVyaWZ5QXR0ZXN0YXRpb25QYWNrZWQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQWtEO0FBQytCO0FBQ0U7QUFDVjtBQUNOO0FBQ1I7QUFDUztBQUM0QjtBQUNoRztBQUNBO0FBQ0E7QUFDTztBQUNQLFlBQVksb0ZBQW9GO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsMkRBQVM7QUFDbEIsdUVBQXVFLEtBQUs7QUFDNUU7QUFDQSwwQkFBMEIsdUVBQW9CO0FBQzlDO0FBQ0E7QUFDQSxnQkFBZ0IsNERBQTRELEVBQUUsa0ZBQWtCO0FBQ2hHLGdCQUFnQixlQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQscUJBQXFCO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxvQkFBb0I7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MseUVBQWU7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IseUdBQTZCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxjQUFjO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsNEZBQXVCLFNBQVMsc0ZBQXNCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxjQUFjO0FBQ2pEO0FBQ0E7QUFDQSx5QkFBeUIsNEVBQWU7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSx5QkFBeUIsNEVBQWU7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxccmVnaXN0cmF0aW9uXFx2ZXJpZmljYXRpb25zXFx2ZXJpZnlBdHRlc3RhdGlvblBhY2tlZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc0NPU0VBbGcgfSBmcm9tICcuLi8uLi9oZWxwZXJzL2Nvc2UuanMnO1xuaW1wb3J0IHsgY29udmVydENlcnRCdWZmZXJUb1BFTSB9IGZyb20gJy4uLy4uL2hlbHBlcnMvY29udmVydENlcnRCdWZmZXJUb1BFTS5qcyc7XG5pbXBvcnQgeyB2YWxpZGF0ZUNlcnRpZmljYXRlUGF0aCB9IGZyb20gJy4uLy4uL2hlbHBlcnMvdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGguanMnO1xuaW1wb3J0IHsgZ2V0Q2VydGlmaWNhdGVJbmZvIH0gZnJvbSAnLi4vLi4vaGVscGVycy9nZXRDZXJ0aWZpY2F0ZUluZm8uanMnO1xuaW1wb3J0IHsgdmVyaWZ5U2lnbmF0dXJlIH0gZnJvbSAnLi4vLi4vaGVscGVycy92ZXJpZnlTaWduYXR1cmUuanMnO1xuaW1wb3J0IHsgaXNvVWludDhBcnJheSB9IGZyb20gJy4uLy4uL2hlbHBlcnMvaXNvL2luZGV4LmpzJztcbmltcG9ydCB7IE1ldGFkYXRhU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL21ldGFkYXRhU2VydmljZS5qcyc7XG5pbXBvcnQgeyB2ZXJpZnlBdHRlc3RhdGlvbldpdGhNZXRhZGF0YSB9IGZyb20gJy4uLy4uL21ldGFkYXRhL3ZlcmlmeUF0dGVzdGF0aW9uV2l0aE1ldGFkYXRhLmpzJztcbi8qKlxuICogVmVyaWZ5IGFuIGF0dGVzdGF0aW9uIHJlc3BvbnNlIHdpdGggZm10ICdwYWNrZWQnXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlBdHRlc3RhdGlvblBhY2tlZChvcHRpb25zKSB7XG4gICAgY29uc3QgeyBhdHRTdG10LCBjbGllbnREYXRhSGFzaCwgYXV0aERhdGEsIGNyZWRlbnRpYWxQdWJsaWNLZXksIGFhZ3VpZCwgcm9vdENlcnRpZmljYXRlcywgfSA9IG9wdGlvbnM7XG4gICAgY29uc3Qgc2lnID0gYXR0U3RtdC5nZXQoJ3NpZycpO1xuICAgIGNvbnN0IHg1YyA9IGF0dFN0bXQuZ2V0KCd4NWMnKTtcbiAgICBjb25zdCBhbGcgPSBhdHRTdG10LmdldCgnYWxnJyk7XG4gICAgaWYgKCFzaWcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhdHRlc3RhdGlvbiBzaWduYXR1cmUgcHJvdmlkZWQgaW4gYXR0ZXN0YXRpb24gc3RhdGVtZW50IChQYWNrZWQpJyk7XG4gICAgfVxuICAgIGlmICghYWxnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQXR0ZXN0YXRpb24gc3RhdGVtZW50IGRpZCBub3QgY29udGFpbiBhbGcgKFBhY2tlZCknKTtcbiAgICB9XG4gICAgaWYgKCFpc0NPU0VBbGcoYWxnKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEF0dGVzdGF0aW9uIHN0YXRlbWVudCBjb250YWluZWQgaW52YWxpZCBhbGcgJHthbGd9IChQYWNrZWQpYCk7XG4gICAgfVxuICAgIGNvbnN0IHNpZ25hdHVyZUJhc2UgPSBpc29VaW50OEFycmF5LmNvbmNhdChbYXV0aERhdGEsIGNsaWVudERhdGFIYXNoXSk7XG4gICAgbGV0IHZlcmlmaWVkID0gZmFsc2U7XG4gICAgaWYgKHg1Yykge1xuICAgICAgICBjb25zdCB7IHN1YmplY3QsIGJhc2ljQ29uc3RyYWludHNDQSwgdmVyc2lvbiwgbm90QmVmb3JlLCBub3RBZnRlciB9ID0gZ2V0Q2VydGlmaWNhdGVJbmZvKHg1Y1swXSk7XG4gICAgICAgIGNvbnN0IHsgT1UsIENOLCBPLCBDIH0gPSBzdWJqZWN0O1xuICAgICAgICBpZiAoT1UgIT09ICdBdXRoZW50aWNhdG9yIEF0dGVzdGF0aW9uJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSBPVSB3YXMgbm90IFwiQXV0aGVudGljYXRvciBBdHRlc3RhdGlvblwiIChQYWNrZWR8RnVsbCknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIUNOKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NlcnRpZmljYXRlIENOIHdhcyBlbXB0eSAoUGFja2VkfEZ1bGwpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFPKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NlcnRpZmljYXRlIE8gd2FzIGVtcHR5IChQYWNrZWR8RnVsbCknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIUMgfHwgQy5sZW5ndGggIT09IDIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2VydGlmaWNhdGUgQyB3YXMgbm90IHR3by1jaGFyYWN0ZXIgSVNPIDMxNjYgY29kZSAoUGFja2VkfEZ1bGwpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJhc2ljQ29uc3RyYWludHNDQSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDZXJ0aWZpY2F0ZSBiYXNpYyBjb25zdHJhaW50cyBDQSB3YXMgbm90IGBmYWxzZWAgKFBhY2tlZHxGdWxsKScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2ZXJzaW9uICE9PSAyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NlcnRpZmljYXRlIHZlcnNpb24gd2FzIG5vdCBgM2AgKEFTTi4xIHZhbHVlIG9mIDIpIChQYWNrZWR8RnVsbCknKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgaWYgKG5vdEJlZm9yZSA+IG5vdykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDZXJ0aWZpY2F0ZSBub3QgZ29vZCBiZWZvcmUgXCIke25vdEJlZm9yZS50b1N0cmluZygpfVwiIChQYWNrZWR8RnVsbClgKTtcbiAgICAgICAgfVxuICAgICAgICBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBpZiAobm90QWZ0ZXIgPCBub3cpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2VydGlmaWNhdGUgbm90IGdvb2QgYWZ0ZXIgXCIke25vdEFmdGVyLnRvU3RyaW5nKCl9XCIgKFBhY2tlZHxGdWxsKWApO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRPRE86IElmIGNlcnRpZmljYXRlIGNvbnRhaW5zIGlkLWZpZG8tZ2VuLWNlLWFhZ3VpZCgxLjMuNi4xLjQuMS40NTcyNC4xLjEuNCkgZXh0ZW5zaW9uLCBjaGVja1xuICAgICAgICAvLyB0aGF0IGl04oCZcyB2YWx1ZSBpcyBzZXQgdG8gdGhlIHNhbWUgQUFHVUlEIGFzIGluIGF1dGhEYXRhLlxuICAgICAgICAvLyBJZiBhdmFpbGFibGUsIHZhbGlkYXRlIGF0dGVzdGF0aW9uIGFsZyBhbmQgeDVjIHdpdGggaW5mbyBpbiB0aGUgbWV0YWRhdGEgc3RhdGVtZW50XG4gICAgICAgIGNvbnN0IHN0YXRlbWVudCA9IGF3YWl0IE1ldGFkYXRhU2VydmljZS5nZXRTdGF0ZW1lbnQoYWFndWlkKTtcbiAgICAgICAgaWYgKHN0YXRlbWVudCkge1xuICAgICAgICAgICAgLy8gVGhlIHByZXNlbmNlIG9mIHg1YyBtZWFucyB0aGlzIGlzIGEgZnVsbCBhdHRlc3RhdGlvbi4gQ2hlY2sgdG8gc2VlIGlmIGF0dGVzdGF0aW9uVHlwZXNcbiAgICAgICAgICAgIC8vIGluY2x1ZGVzIHBhY2tlZCBhdHRlc3RhdGlvbnMuXG4gICAgICAgICAgICBpZiAoc3RhdGVtZW50LmF0dGVzdGF0aW9uVHlwZXMuaW5kZXhPZignYmFzaWNfZnVsbCcpIDwgMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWV0YWRhdGEgZG9lcyBub3QgaW5kaWNhdGUgc3VwcG9ydCBmb3IgZnVsbCBhdHRlc3RhdGlvbnMgKFBhY2tlZHxGdWxsKScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB2ZXJpZnlBdHRlc3RhdGlvbldpdGhNZXRhZGF0YSh7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbFB1YmxpY0tleSxcbiAgICAgICAgICAgICAgICAgICAgeDVjLFxuICAgICAgICAgICAgICAgICAgICBhdHRlc3RhdGlvblN0YXRlbWVudEFsZzogYWxnLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIGNvbnN0IF9lcnIgPSBlcnI7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke19lcnIubWVzc2FnZX0gKFBhY2tlZHxGdWxsKWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBUcnkgdmFsaWRhdGluZyB0aGUgY2VydGlmaWNhdGUgcGF0aCB1c2luZyB0aGUgcm9vdCBjZXJ0aWZpY2F0ZXMgc2V0IHZpYSBTZXR0aW5nc1NlcnZpY2VcbiAgICAgICAgICAgICAgICBhd2FpdCB2YWxpZGF0ZUNlcnRpZmljYXRlUGF0aCh4NWMubWFwKGNvbnZlcnRDZXJ0QnVmZmVyVG9QRU0pLCByb290Q2VydGlmaWNhdGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBfZXJyID0gZXJyO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHtfZXJyLm1lc3NhZ2V9IChQYWNrZWR8RnVsbClgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2ZXJpZmllZCA9IGF3YWl0IHZlcmlmeVNpZ25hdHVyZSh7XG4gICAgICAgICAgICBzaWduYXR1cmU6IHNpZyxcbiAgICAgICAgICAgIGRhdGE6IHNpZ25hdHVyZUJhc2UsXG4gICAgICAgICAgICB4NTA5Q2VydGlmaWNhdGU6IHg1Y1swXSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2ZXJpZmllZCA9IGF3YWl0IHZlcmlmeVNpZ25hdHVyZSh7XG4gICAgICAgICAgICBzaWduYXR1cmU6IHNpZyxcbiAgICAgICAgICAgIGRhdGE6IHNpZ25hdHVyZUJhc2UsXG4gICAgICAgICAgICBjcmVkZW50aWFsUHVibGljS2V5LFxuICAgICAgICAgICAgaGFzaEFsZ29yaXRobTogYWxnLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHZlcmlmaWVkO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationPacked.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifyRegistrationResponse.js":
/*!********************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/registration/verifyRegistrationResponse.js ***!
  \********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   verifyRegistrationResponse: () => (/* binding */ verifyRegistrationResponse)\n/* harmony export */ });\n/* harmony import */ var _helpers_decodeAttestationObject_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/decodeAttestationObject.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeAttestationObject.js\");\n/* harmony import */ var _helpers_decodeClientDataJSON_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/decodeClientDataJSON.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeClientDataJSON.js\");\n/* harmony import */ var _helpers_parseAuthenticatorData_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/parseAuthenticatorData.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseAuthenticatorData.js\");\n/* harmony import */ var _helpers_toHash_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../helpers/toHash.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/toHash.js\");\n/* harmony import */ var _helpers_decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/decodeCredentialPublicKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/decodeCredentialPublicKey.js\");\n/* harmony import */ var _helpers_cose_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../helpers/cose.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/cose.js\");\n/* harmony import */ var _helpers_convertAAGUIDToString_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../helpers/convertAAGUIDToString.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertAAGUIDToString.js\");\n/* harmony import */ var _helpers_parseBackupFlags_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../helpers/parseBackupFlags.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/parseBackupFlags.js\");\n/* harmony import */ var _helpers_matchExpectedRPID_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../helpers/matchExpectedRPID.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/matchExpectedRPID.js\");\n/* harmony import */ var _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../helpers/iso/index.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/iso/index.js\");\n/* harmony import */ var _services_settingsService_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../services/settingsService.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/settingsService.js\");\n/* harmony import */ var _generateRegistrationOptions_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./generateRegistrationOptions.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/generateRegistrationOptions.js\");\n/* harmony import */ var _verifications_verifyAttestationFIDOU2F_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./verifications/verifyAttestationFIDOU2F.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationFIDOU2F.js\");\n/* harmony import */ var _verifications_verifyAttestationPacked_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./verifications/verifyAttestationPacked.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationPacked.js\");\n/* harmony import */ var _verifications_verifyAttestationAndroidSafetyNet_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./verifications/verifyAttestationAndroidSafetyNet.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationAndroidSafetyNet.js\");\n/* harmony import */ var _verifications_tpm_verifyAttestationTPM_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./verifications/tpm/verifyAttestationTPM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/tpm/verifyAttestationTPM.js\");\n/* harmony import */ var _verifications_verifyAttestationAndroidKey_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./verifications/verifyAttestationAndroidKey.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationAndroidKey.js\");\n/* harmony import */ var _verifications_verifyAttestationApple_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./verifications/verifyAttestationApple.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifications/verifyAttestationApple.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Verify that the user has legitimately completed the registration process\n *\n * **Options:**\n *\n * @param response - Response returned by **@simplewebauthn/browser**'s `startAuthentication()`\n * @param expectedChallenge - The base64url-encoded `options.challenge` returned by `generateRegistrationOptions()`\n * @param expectedOrigin - Website URL (or array of URLs) that the registration should have occurred on\n * @param expectedRPID - RP ID (or array of IDs) that was specified in the registration options\n * @param expectedType **(Optional)** - The response type expected ('webauthn.create')\n * @param requireUserVerification **(Optional)** - Enforce user verification by the authenticator (via PIN, fingerprint, etc...) Defaults to `true`\n * @param supportedAlgorithmIDs **(Optional)** - Array of numeric COSE algorithm identifiers supported for attestation by this RP. See https://www.iana.org/assignments/cose/cose.xhtml#algorithms. Defaults to all supported algorithm IDs\n */\nasync function verifyRegistrationResponse(options) {\n    const { response, expectedChallenge, expectedOrigin, expectedRPID, expectedType, requireUserVerification = true, supportedAlgorithmIDs = _generateRegistrationOptions_js__WEBPACK_IMPORTED_MODULE_11__.supportedCOSEAlgorithmIdentifiers, } = options;\n    const { id, rawId, type: credentialType, response: attestationResponse } = response;\n    // Ensure credential specified an ID\n    if (!id) {\n        throw new Error('Missing credential ID');\n    }\n    // Ensure ID is base64url-encoded\n    if (id !== rawId) {\n        throw new Error('Credential ID was not base64url-encoded');\n    }\n    // Make sure credential type is public-key\n    if (credentialType !== 'public-key') {\n        throw new Error(`Unexpected credential type ${credentialType}, expected \"public-key\"`);\n    }\n    const clientDataJSON = (0,_helpers_decodeClientDataJSON_js__WEBPACK_IMPORTED_MODULE_1__.decodeClientDataJSON)(attestationResponse.clientDataJSON);\n    const { type, origin, challenge, tokenBinding } = clientDataJSON;\n    // Make sure we're handling an registration\n    if (Array.isArray(expectedType)) {\n        if (!expectedType.includes(type)) {\n            const joinedExpectedType = expectedType.join(', ');\n            throw new Error(`Unexpected registration response type \"${type}\", expected one of: ${joinedExpectedType}`);\n        }\n    }\n    else if (expectedType) {\n        if (type !== expectedType) {\n            throw new Error(`Unexpected registration response type \"${type}\", expected \"${expectedType}\"`);\n        }\n    }\n    else if (type !== 'webauthn.create') {\n        throw new Error(`Unexpected registration response type: ${type}`);\n    }\n    // Ensure the device provided the challenge we gave it\n    if (typeof expectedChallenge === 'function') {\n        if (!(await expectedChallenge(challenge))) {\n            throw new Error(`Custom challenge verifier returned false for registration response challenge \"${challenge}\"`);\n        }\n    }\n    else if (challenge !== expectedChallenge) {\n        throw new Error(`Unexpected registration response challenge \"${challenge}\", expected \"${expectedChallenge}\"`);\n    }\n    // Check that the origin is our site\n    if (Array.isArray(expectedOrigin)) {\n        if (!expectedOrigin.includes(origin)) {\n            throw new Error(`Unexpected registration response origin \"${origin}\", expected one of: ${expectedOrigin.join(', ')}`);\n        }\n    }\n    else {\n        if (origin !== expectedOrigin) {\n            throw new Error(`Unexpected registration response origin \"${origin}\", expected \"${expectedOrigin}\"`);\n        }\n    }\n    if (tokenBinding) {\n        if (typeof tokenBinding !== 'object') {\n            throw new Error(`Unexpected value for TokenBinding \"${tokenBinding}\"`);\n        }\n        if (['present', 'supported', 'not-supported'].indexOf(tokenBinding.status) < 0) {\n            throw new Error(`Unexpected tokenBinding.status value of \"${tokenBinding.status}\"`);\n        }\n    }\n    const attestationObject = _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_9__.isoBase64URL.toBuffer(attestationResponse.attestationObject);\n    const decodedAttestationObject = (0,_helpers_decodeAttestationObject_js__WEBPACK_IMPORTED_MODULE_0__.decodeAttestationObject)(attestationObject);\n    const fmt = decodedAttestationObject.get('fmt');\n    const authData = decodedAttestationObject.get('authData');\n    const attStmt = decodedAttestationObject.get('attStmt');\n    const parsedAuthData = (0,_helpers_parseAuthenticatorData_js__WEBPACK_IMPORTED_MODULE_2__.parseAuthenticatorData)(authData);\n    const { aaguid, rpIdHash, flags, credentialID, counter, credentialPublicKey, extensionsData, } = parsedAuthData;\n    // Make sure the response's RP ID is ours\n    let matchedRPID;\n    if (expectedRPID) {\n        let expectedRPIDs = [];\n        if (typeof expectedRPID === 'string') {\n            expectedRPIDs = [expectedRPID];\n        }\n        else {\n            expectedRPIDs = expectedRPID;\n        }\n        matchedRPID = await (0,_helpers_matchExpectedRPID_js__WEBPACK_IMPORTED_MODULE_8__.matchExpectedRPID)(rpIdHash, expectedRPIDs);\n    }\n    // Make sure someone was physically present\n    if (!flags.up) {\n        throw new Error('User not present during registration');\n    }\n    // Enforce user verification if specified\n    if (requireUserVerification && !flags.uv) {\n        throw new Error('User verification required, but user could not be verified');\n    }\n    if (!credentialID) {\n        throw new Error('No credential ID was provided by authenticator');\n    }\n    if (!credentialPublicKey) {\n        throw new Error('No public key was provided by authenticator');\n    }\n    if (!aaguid) {\n        throw new Error('No AAGUID was present during registration');\n    }\n    const decodedPublicKey = (0,_helpers_decodeCredentialPublicKey_js__WEBPACK_IMPORTED_MODULE_4__.decodeCredentialPublicKey)(credentialPublicKey);\n    const alg = decodedPublicKey.get(_helpers_cose_js__WEBPACK_IMPORTED_MODULE_5__.COSEKEYS.alg);\n    if (typeof alg !== 'number') {\n        throw new Error('Credential public key was missing numeric alg');\n    }\n    // Make sure the key algorithm is one we specified within the registration options\n    if (!supportedAlgorithmIDs.includes(alg)) {\n        const supported = supportedAlgorithmIDs.join(', ');\n        throw new Error(`Unexpected public key alg \"${alg}\", expected one of \"${supported}\"`);\n    }\n    const clientDataHash = await (0,_helpers_toHash_js__WEBPACK_IMPORTED_MODULE_3__.toHash)(_helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_9__.isoBase64URL.toBuffer(attestationResponse.clientDataJSON));\n    const rootCertificates = _services_settingsService_js__WEBPACK_IMPORTED_MODULE_10__.SettingsService.getRootCertificates({\n        identifier: fmt,\n    });\n    // Prepare arguments to pass to the relevant verification method\n    const verifierOpts = {\n        aaguid,\n        attStmt,\n        authData,\n        clientDataHash,\n        credentialID,\n        credentialPublicKey,\n        rootCertificates,\n        rpIdHash,\n    };\n    /**\n     * Verification can only be performed when attestation = 'direct'\n     */\n    let verified = false;\n    if (fmt === 'fido-u2f') {\n        verified = await (0,_verifications_verifyAttestationFIDOU2F_js__WEBPACK_IMPORTED_MODULE_12__.verifyAttestationFIDOU2F)(verifierOpts);\n    }\n    else if (fmt === 'packed') {\n        verified = await (0,_verifications_verifyAttestationPacked_js__WEBPACK_IMPORTED_MODULE_13__.verifyAttestationPacked)(verifierOpts);\n    }\n    else if (fmt === 'android-safetynet') {\n        verified = await (0,_verifications_verifyAttestationAndroidSafetyNet_js__WEBPACK_IMPORTED_MODULE_14__.verifyAttestationAndroidSafetyNet)(verifierOpts);\n    }\n    else if (fmt === 'android-key') {\n        verified = await (0,_verifications_verifyAttestationAndroidKey_js__WEBPACK_IMPORTED_MODULE_16__.verifyAttestationAndroidKey)(verifierOpts);\n    }\n    else if (fmt === 'tpm') {\n        verified = await (0,_verifications_tpm_verifyAttestationTPM_js__WEBPACK_IMPORTED_MODULE_15__.verifyAttestationTPM)(verifierOpts);\n    }\n    else if (fmt === 'apple') {\n        verified = await (0,_verifications_verifyAttestationApple_js__WEBPACK_IMPORTED_MODULE_17__.verifyAttestationApple)(verifierOpts);\n    }\n    else if (fmt === 'none') {\n        if (attStmt.size > 0) {\n            throw new Error('None attestation had unexpected attestation statement');\n        }\n        // This is the weaker of the attestations, so there's nothing else to really check\n        verified = true;\n    }\n    else {\n        throw new Error(`Unsupported Attestation Format: ${fmt}`);\n    }\n    const toReturn = {\n        verified,\n    };\n    if (toReturn.verified) {\n        const { credentialDeviceType, credentialBackedUp } = (0,_helpers_parseBackupFlags_js__WEBPACK_IMPORTED_MODULE_7__.parseBackupFlags)(flags);\n        toReturn.registrationInfo = {\n            fmt,\n            counter,\n            aaguid: (0,_helpers_convertAAGUIDToString_js__WEBPACK_IMPORTED_MODULE_6__.convertAAGUIDToString)(aaguid),\n            credentialID: _helpers_iso_index_js__WEBPACK_IMPORTED_MODULE_9__.isoBase64URL.fromBuffer(credentialID),\n            credentialPublicKey,\n            credentialType,\n            attestationObject,\n            userVerified: flags.uv,\n            credentialDeviceType,\n            credentialBackedUp,\n            origin: clientDataJSON.origin,\n            rpID: matchedRPID,\n            authenticatorExtensionResults: extensionsData,\n        };\n    }\n    return toReturn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vcmVnaXN0cmF0aW9uL3ZlcmlmeVJlZ2lzdHJhdGlvblJlc3BvbnNlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBaUY7QUFDUDtBQUNJO0FBQ2hDO0FBQ3NDO0FBQ3RDO0FBQzhCO0FBQ1Y7QUFDRTtBQUNiO0FBQ1U7QUFDb0I7QUFDRTtBQUNGO0FBQ29CO0FBQ3RCO0FBQ1U7QUFDVjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1AsWUFBWSxpSUFBaUksK0ZBQWlDLElBQUk7QUFDbEwsWUFBWSxpRUFBaUU7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsZUFBZTtBQUNyRTtBQUNBLDJCQUEyQixzRkFBb0I7QUFDL0MsWUFBWSx3Q0FBd0M7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsS0FBSyxzQkFBc0IsbUJBQW1CO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLEtBQUssZUFBZSxhQUFhO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxLQUFLO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkdBQTZHLFVBQVU7QUFDdkg7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLFVBQVUsZUFBZSxrQkFBa0I7QUFDbEg7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UsT0FBTyxzQkFBc0IsMEJBQTBCO0FBQy9IO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLE9BQU8sZUFBZSxlQUFlO0FBQzdHO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLGFBQWE7QUFDL0U7QUFDQTtBQUNBLHdFQUF3RSxvQkFBb0I7QUFDNUY7QUFDQTtBQUNBLDhCQUE4Qix3RUFBcUI7QUFDbkQscUNBQXFDLDRGQUF1QjtBQUM1RDtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMEZBQXNCO0FBQ2pELFlBQVksdUZBQXVGO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGdGQUFpQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsZ0dBQXlCO0FBQ3RELHFDQUFxQyxzREFBUTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsSUFBSSxzQkFBc0IsVUFBVTtBQUMxRjtBQUNBLGlDQUFpQywwREFBTSxDQUFDLHdFQUFxQjtBQUM3RCw2QkFBNkIsMEVBQWU7QUFDNUM7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIscUdBQXdCO0FBQ2pEO0FBQ0E7QUFDQSx5QkFBeUIsbUdBQXVCO0FBQ2hEO0FBQ0E7QUFDQSx5QkFBeUIsdUhBQWlDO0FBQzFEO0FBQ0E7QUFDQSx5QkFBeUIsMkdBQTJCO0FBQ3BEO0FBQ0E7QUFDQSx5QkFBeUIsaUdBQW9CO0FBQzdDO0FBQ0E7QUFDQSx5QkFBeUIsaUdBQXNCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxJQUFJO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsMkNBQTJDLEVBQUUsOEVBQWdCO0FBQzdFO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix3RkFBcUI7QUFDekMsMEJBQTBCLDBFQUF1QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXHJlZ2lzdHJhdGlvblxcdmVyaWZ5UmVnaXN0cmF0aW9uUmVzcG9uc2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVjb2RlQXR0ZXN0YXRpb25PYmplY3QsIH0gZnJvbSAnLi4vaGVscGVycy9kZWNvZGVBdHRlc3RhdGlvbk9iamVjdC5qcyc7XG5pbXBvcnQgeyBkZWNvZGVDbGllbnREYXRhSlNPTiB9IGZyb20gJy4uL2hlbHBlcnMvZGVjb2RlQ2xpZW50RGF0YUpTT04uanMnO1xuaW1wb3J0IHsgcGFyc2VBdXRoZW50aWNhdG9yRGF0YSB9IGZyb20gJy4uL2hlbHBlcnMvcGFyc2VBdXRoZW50aWNhdG9yRGF0YS5qcyc7XG5pbXBvcnQgeyB0b0hhc2ggfSBmcm9tICcuLi9oZWxwZXJzL3RvSGFzaC5qcyc7XG5pbXBvcnQgeyBkZWNvZGVDcmVkZW50aWFsUHVibGljS2V5IH0gZnJvbSAnLi4vaGVscGVycy9kZWNvZGVDcmVkZW50aWFsUHVibGljS2V5LmpzJztcbmltcG9ydCB7IENPU0VLRVlTIH0gZnJvbSAnLi4vaGVscGVycy9jb3NlLmpzJztcbmltcG9ydCB7IGNvbnZlcnRBQUdVSURUb1N0cmluZyB9IGZyb20gJy4uL2hlbHBlcnMvY29udmVydEFBR1VJRFRvU3RyaW5nLmpzJztcbmltcG9ydCB7IHBhcnNlQmFja3VwRmxhZ3MgfSBmcm9tICcuLi9oZWxwZXJzL3BhcnNlQmFja3VwRmxhZ3MuanMnO1xuaW1wb3J0IHsgbWF0Y2hFeHBlY3RlZFJQSUQgfSBmcm9tICcuLi9oZWxwZXJzL21hdGNoRXhwZWN0ZWRSUElELmpzJztcbmltcG9ydCB7IGlzb0Jhc2U2NFVSTCB9IGZyb20gJy4uL2hlbHBlcnMvaXNvL2luZGV4LmpzJztcbmltcG9ydCB7IFNldHRpbmdzU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3NldHRpbmdzU2VydmljZS5qcyc7XG5pbXBvcnQgeyBzdXBwb3J0ZWRDT1NFQWxnb3JpdGhtSWRlbnRpZmllcnMgfSBmcm9tICcuL2dlbmVyYXRlUmVnaXN0cmF0aW9uT3B0aW9ucy5qcyc7XG5pbXBvcnQgeyB2ZXJpZnlBdHRlc3RhdGlvbkZJRE9VMkYgfSBmcm9tICcuL3ZlcmlmaWNhdGlvbnMvdmVyaWZ5QXR0ZXN0YXRpb25GSURPVTJGLmpzJztcbmltcG9ydCB7IHZlcmlmeUF0dGVzdGF0aW9uUGFja2VkIH0gZnJvbSAnLi92ZXJpZmljYXRpb25zL3ZlcmlmeUF0dGVzdGF0aW9uUGFja2VkLmpzJztcbmltcG9ydCB7IHZlcmlmeUF0dGVzdGF0aW9uQW5kcm9pZFNhZmV0eU5ldCB9IGZyb20gJy4vdmVyaWZpY2F0aW9ucy92ZXJpZnlBdHRlc3RhdGlvbkFuZHJvaWRTYWZldHlOZXQuanMnO1xuaW1wb3J0IHsgdmVyaWZ5QXR0ZXN0YXRpb25UUE0gfSBmcm9tICcuL3ZlcmlmaWNhdGlvbnMvdHBtL3ZlcmlmeUF0dGVzdGF0aW9uVFBNLmpzJztcbmltcG9ydCB7IHZlcmlmeUF0dGVzdGF0aW9uQW5kcm9pZEtleSB9IGZyb20gJy4vdmVyaWZpY2F0aW9ucy92ZXJpZnlBdHRlc3RhdGlvbkFuZHJvaWRLZXkuanMnO1xuaW1wb3J0IHsgdmVyaWZ5QXR0ZXN0YXRpb25BcHBsZSB9IGZyb20gJy4vdmVyaWZpY2F0aW9ucy92ZXJpZnlBdHRlc3RhdGlvbkFwcGxlLmpzJztcbi8qKlxuICogVmVyaWZ5IHRoYXQgdGhlIHVzZXIgaGFzIGxlZ2l0aW1hdGVseSBjb21wbGV0ZWQgdGhlIHJlZ2lzdHJhdGlvbiBwcm9jZXNzXG4gKlxuICogKipPcHRpb25zOioqXG4gKlxuICogQHBhcmFtIHJlc3BvbnNlIC0gUmVzcG9uc2UgcmV0dXJuZWQgYnkgKipAc2ltcGxld2ViYXV0aG4vYnJvd3NlcioqJ3MgYHN0YXJ0QXV0aGVudGljYXRpb24oKWBcbiAqIEBwYXJhbSBleHBlY3RlZENoYWxsZW5nZSAtIFRoZSBiYXNlNjR1cmwtZW5jb2RlZCBgb3B0aW9ucy5jaGFsbGVuZ2VgIHJldHVybmVkIGJ5IGBnZW5lcmF0ZVJlZ2lzdHJhdGlvbk9wdGlvbnMoKWBcbiAqIEBwYXJhbSBleHBlY3RlZE9yaWdpbiAtIFdlYnNpdGUgVVJMIChvciBhcnJheSBvZiBVUkxzKSB0aGF0IHRoZSByZWdpc3RyYXRpb24gc2hvdWxkIGhhdmUgb2NjdXJyZWQgb25cbiAqIEBwYXJhbSBleHBlY3RlZFJQSUQgLSBSUCBJRCAob3IgYXJyYXkgb2YgSURzKSB0aGF0IHdhcyBzcGVjaWZpZWQgaW4gdGhlIHJlZ2lzdHJhdGlvbiBvcHRpb25zXG4gKiBAcGFyYW0gZXhwZWN0ZWRUeXBlICoqKE9wdGlvbmFsKSoqIC0gVGhlIHJlc3BvbnNlIHR5cGUgZXhwZWN0ZWQgKCd3ZWJhdXRobi5jcmVhdGUnKVxuICogQHBhcmFtIHJlcXVpcmVVc2VyVmVyaWZpY2F0aW9uICoqKE9wdGlvbmFsKSoqIC0gRW5mb3JjZSB1c2VyIHZlcmlmaWNhdGlvbiBieSB0aGUgYXV0aGVudGljYXRvciAodmlhIFBJTiwgZmluZ2VycHJpbnQsIGV0Yy4uLikgRGVmYXVsdHMgdG8gYHRydWVgXG4gKiBAcGFyYW0gc3VwcG9ydGVkQWxnb3JpdGhtSURzICoqKE9wdGlvbmFsKSoqIC0gQXJyYXkgb2YgbnVtZXJpYyBDT1NFIGFsZ29yaXRobSBpZGVudGlmaWVycyBzdXBwb3J0ZWQgZm9yIGF0dGVzdGF0aW9uIGJ5IHRoaXMgUlAuIFNlZSBodHRwczovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy9jb3NlL2Nvc2UueGh0bWwjYWxnb3JpdGhtcy4gRGVmYXVsdHMgdG8gYWxsIHN1cHBvcnRlZCBhbGdvcml0aG0gSURzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlSZWdpc3RyYXRpb25SZXNwb25zZShvcHRpb25zKSB7XG4gICAgY29uc3QgeyByZXNwb25zZSwgZXhwZWN0ZWRDaGFsbGVuZ2UsIGV4cGVjdGVkT3JpZ2luLCBleHBlY3RlZFJQSUQsIGV4cGVjdGVkVHlwZSwgcmVxdWlyZVVzZXJWZXJpZmljYXRpb24gPSB0cnVlLCBzdXBwb3J0ZWRBbGdvcml0aG1JRHMgPSBzdXBwb3J0ZWRDT1NFQWxnb3JpdGhtSWRlbnRpZmllcnMsIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHsgaWQsIHJhd0lkLCB0eXBlOiBjcmVkZW50aWFsVHlwZSwgcmVzcG9uc2U6IGF0dGVzdGF0aW9uUmVzcG9uc2UgfSA9IHJlc3BvbnNlO1xuICAgIC8vIEVuc3VyZSBjcmVkZW50aWFsIHNwZWNpZmllZCBhbiBJRFxuICAgIGlmICghaWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGNyZWRlbnRpYWwgSUQnKTtcbiAgICB9XG4gICAgLy8gRW5zdXJlIElEIGlzIGJhc2U2NHVybC1lbmNvZGVkXG4gICAgaWYgKGlkICE9PSByYXdJZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyZWRlbnRpYWwgSUQgd2FzIG5vdCBiYXNlNjR1cmwtZW5jb2RlZCcpO1xuICAgIH1cbiAgICAvLyBNYWtlIHN1cmUgY3JlZGVudGlhbCB0eXBlIGlzIHB1YmxpYy1rZXlcbiAgICBpZiAoY3JlZGVudGlhbFR5cGUgIT09ICdwdWJsaWMta2V5Jykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgY3JlZGVudGlhbCB0eXBlICR7Y3JlZGVudGlhbFR5cGV9LCBleHBlY3RlZCBcInB1YmxpYy1rZXlcImApO1xuICAgIH1cbiAgICBjb25zdCBjbGllbnREYXRhSlNPTiA9IGRlY29kZUNsaWVudERhdGFKU09OKGF0dGVzdGF0aW9uUmVzcG9uc2UuY2xpZW50RGF0YUpTT04pO1xuICAgIGNvbnN0IHsgdHlwZSwgb3JpZ2luLCBjaGFsbGVuZ2UsIHRva2VuQmluZGluZyB9ID0gY2xpZW50RGF0YUpTT047XG4gICAgLy8gTWFrZSBzdXJlIHdlJ3JlIGhhbmRsaW5nIGFuIHJlZ2lzdHJhdGlvblxuICAgIGlmIChBcnJheS5pc0FycmF5KGV4cGVjdGVkVHlwZSkpIHtcbiAgICAgICAgaWYgKCFleHBlY3RlZFR5cGUuaW5jbHVkZXModHlwZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGpvaW5lZEV4cGVjdGVkVHlwZSA9IGV4cGVjdGVkVHlwZS5qb2luKCcsICcpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHJlZ2lzdHJhdGlvbiByZXNwb25zZSB0eXBlIFwiJHt0eXBlfVwiLCBleHBlY3RlZCBvbmUgb2Y6ICR7am9pbmVkRXhwZWN0ZWRUeXBlfWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4cGVjdGVkVHlwZSkge1xuICAgICAgICBpZiAodHlwZSAhPT0gZXhwZWN0ZWRUeXBlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgcmVnaXN0cmF0aW9uIHJlc3BvbnNlIHR5cGUgXCIke3R5cGV9XCIsIGV4cGVjdGVkIFwiJHtleHBlY3RlZFR5cGV9XCJgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlICE9PSAnd2ViYXV0aG4uY3JlYXRlJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgcmVnaXN0cmF0aW9uIHJlc3BvbnNlIHR5cGU6ICR7dHlwZX1gKTtcbiAgICB9XG4gICAgLy8gRW5zdXJlIHRoZSBkZXZpY2UgcHJvdmlkZWQgdGhlIGNoYWxsZW5nZSB3ZSBnYXZlIGl0XG4gICAgaWYgKHR5cGVvZiBleHBlY3RlZENoYWxsZW5nZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBpZiAoIShhd2FpdCBleHBlY3RlZENoYWxsZW5nZShjaGFsbGVuZ2UpKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDdXN0b20gY2hhbGxlbmdlIHZlcmlmaWVyIHJldHVybmVkIGZhbHNlIGZvciByZWdpc3RyYXRpb24gcmVzcG9uc2UgY2hhbGxlbmdlIFwiJHtjaGFsbGVuZ2V9XCJgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChjaGFsbGVuZ2UgIT09IGV4cGVjdGVkQ2hhbGxlbmdlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCByZWdpc3RyYXRpb24gcmVzcG9uc2UgY2hhbGxlbmdlIFwiJHtjaGFsbGVuZ2V9XCIsIGV4cGVjdGVkIFwiJHtleHBlY3RlZENoYWxsZW5nZX1cImApO1xuICAgIH1cbiAgICAvLyBDaGVjayB0aGF0IHRoZSBvcmlnaW4gaXMgb3VyIHNpdGVcbiAgICBpZiAoQXJyYXkuaXNBcnJheShleHBlY3RlZE9yaWdpbikpIHtcbiAgICAgICAgaWYgKCFleHBlY3RlZE9yaWdpbi5pbmNsdWRlcyhvcmlnaW4pKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgcmVnaXN0cmF0aW9uIHJlc3BvbnNlIG9yaWdpbiBcIiR7b3JpZ2lufVwiLCBleHBlY3RlZCBvbmUgb2Y6ICR7ZXhwZWN0ZWRPcmlnaW4uam9pbignLCAnKX1gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKG9yaWdpbiAhPT0gZXhwZWN0ZWRPcmlnaW4pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5leHBlY3RlZCByZWdpc3RyYXRpb24gcmVzcG9uc2Ugb3JpZ2luIFwiJHtvcmlnaW59XCIsIGV4cGVjdGVkIFwiJHtleHBlY3RlZE9yaWdpbn1cImApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICh0b2tlbkJpbmRpbmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0b2tlbkJpbmRpbmcgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgdmFsdWUgZm9yIFRva2VuQmluZGluZyBcIiR7dG9rZW5CaW5kaW5nfVwiYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFsncHJlc2VudCcsICdzdXBwb3J0ZWQnLCAnbm90LXN1cHBvcnRlZCddLmluZGV4T2YodG9rZW5CaW5kaW5nLnN0YXR1cykgPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgdG9rZW5CaW5kaW5nLnN0YXR1cyB2YWx1ZSBvZiBcIiR7dG9rZW5CaW5kaW5nLnN0YXR1c31cImApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGF0dGVzdGF0aW9uT2JqZWN0ID0gaXNvQmFzZTY0VVJMLnRvQnVmZmVyKGF0dGVzdGF0aW9uUmVzcG9uc2UuYXR0ZXN0YXRpb25PYmplY3QpO1xuICAgIGNvbnN0IGRlY29kZWRBdHRlc3RhdGlvbk9iamVjdCA9IGRlY29kZUF0dGVzdGF0aW9uT2JqZWN0KGF0dGVzdGF0aW9uT2JqZWN0KTtcbiAgICBjb25zdCBmbXQgPSBkZWNvZGVkQXR0ZXN0YXRpb25PYmplY3QuZ2V0KCdmbXQnKTtcbiAgICBjb25zdCBhdXRoRGF0YSA9IGRlY29kZWRBdHRlc3RhdGlvbk9iamVjdC5nZXQoJ2F1dGhEYXRhJyk7XG4gICAgY29uc3QgYXR0U3RtdCA9IGRlY29kZWRBdHRlc3RhdGlvbk9iamVjdC5nZXQoJ2F0dFN0bXQnKTtcbiAgICBjb25zdCBwYXJzZWRBdXRoRGF0YSA9IHBhcnNlQXV0aGVudGljYXRvckRhdGEoYXV0aERhdGEpO1xuICAgIGNvbnN0IHsgYWFndWlkLCBycElkSGFzaCwgZmxhZ3MsIGNyZWRlbnRpYWxJRCwgY291bnRlciwgY3JlZGVudGlhbFB1YmxpY0tleSwgZXh0ZW5zaW9uc0RhdGEsIH0gPSBwYXJzZWRBdXRoRGF0YTtcbiAgICAvLyBNYWtlIHN1cmUgdGhlIHJlc3BvbnNlJ3MgUlAgSUQgaXMgb3Vyc1xuICAgIGxldCBtYXRjaGVkUlBJRDtcbiAgICBpZiAoZXhwZWN0ZWRSUElEKSB7XG4gICAgICAgIGxldCBleHBlY3RlZFJQSURzID0gW107XG4gICAgICAgIGlmICh0eXBlb2YgZXhwZWN0ZWRSUElEID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZXhwZWN0ZWRSUElEcyA9IFtleHBlY3RlZFJQSURdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZXhwZWN0ZWRSUElEcyA9IGV4cGVjdGVkUlBJRDtcbiAgICAgICAgfVxuICAgICAgICBtYXRjaGVkUlBJRCA9IGF3YWl0IG1hdGNoRXhwZWN0ZWRSUElEKHJwSWRIYXNoLCBleHBlY3RlZFJQSURzKTtcbiAgICB9XG4gICAgLy8gTWFrZSBzdXJlIHNvbWVvbmUgd2FzIHBoeXNpY2FsbHkgcHJlc2VudFxuICAgIGlmICghZmxhZ3MudXApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBwcmVzZW50IGR1cmluZyByZWdpc3RyYXRpb24nKTtcbiAgICB9XG4gICAgLy8gRW5mb3JjZSB1c2VyIHZlcmlmaWNhdGlvbiBpZiBzcGVjaWZpZWRcbiAgICBpZiAocmVxdWlyZVVzZXJWZXJpZmljYXRpb24gJiYgIWZsYWdzLnV2KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVXNlciB2ZXJpZmljYXRpb24gcmVxdWlyZWQsIGJ1dCB1c2VyIGNvdWxkIG5vdCBiZSB2ZXJpZmllZCcpO1xuICAgIH1cbiAgICBpZiAoIWNyZWRlbnRpYWxJRCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGNyZWRlbnRpYWwgSUQgd2FzIHByb3ZpZGVkIGJ5IGF1dGhlbnRpY2F0b3InKTtcbiAgICB9XG4gICAgaWYgKCFjcmVkZW50aWFsUHVibGljS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gcHVibGljIGtleSB3YXMgcHJvdmlkZWQgYnkgYXV0aGVudGljYXRvcicpO1xuICAgIH1cbiAgICBpZiAoIWFhZ3VpZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIEFBR1VJRCB3YXMgcHJlc2VudCBkdXJpbmcgcmVnaXN0cmF0aW9uJyk7XG4gICAgfVxuICAgIGNvbnN0IGRlY29kZWRQdWJsaWNLZXkgPSBkZWNvZGVDcmVkZW50aWFsUHVibGljS2V5KGNyZWRlbnRpYWxQdWJsaWNLZXkpO1xuICAgIGNvbnN0IGFsZyA9IGRlY29kZWRQdWJsaWNLZXkuZ2V0KENPU0VLRVlTLmFsZyk7XG4gICAgaWYgKHR5cGVvZiBhbGcgIT09ICdudW1iZXInKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ3JlZGVudGlhbCBwdWJsaWMga2V5IHdhcyBtaXNzaW5nIG51bWVyaWMgYWxnJyk7XG4gICAgfVxuICAgIC8vIE1ha2Ugc3VyZSB0aGUga2V5IGFsZ29yaXRobSBpcyBvbmUgd2Ugc3BlY2lmaWVkIHdpdGhpbiB0aGUgcmVnaXN0cmF0aW9uIG9wdGlvbnNcbiAgICBpZiAoIXN1cHBvcnRlZEFsZ29yaXRobUlEcy5pbmNsdWRlcyhhbGcpKSB7XG4gICAgICAgIGNvbnN0IHN1cHBvcnRlZCA9IHN1cHBvcnRlZEFsZ29yaXRobUlEcy5qb2luKCcsICcpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgcHVibGljIGtleSBhbGcgXCIke2FsZ31cIiwgZXhwZWN0ZWQgb25lIG9mIFwiJHtzdXBwb3J0ZWR9XCJgKTtcbiAgICB9XG4gICAgY29uc3QgY2xpZW50RGF0YUhhc2ggPSBhd2FpdCB0b0hhc2goaXNvQmFzZTY0VVJMLnRvQnVmZmVyKGF0dGVzdGF0aW9uUmVzcG9uc2UuY2xpZW50RGF0YUpTT04pKTtcbiAgICBjb25zdCByb290Q2VydGlmaWNhdGVzID0gU2V0dGluZ3NTZXJ2aWNlLmdldFJvb3RDZXJ0aWZpY2F0ZXMoe1xuICAgICAgICBpZGVudGlmaWVyOiBmbXQsXG4gICAgfSk7XG4gICAgLy8gUHJlcGFyZSBhcmd1bWVudHMgdG8gcGFzcyB0byB0aGUgcmVsZXZhbnQgdmVyaWZpY2F0aW9uIG1ldGhvZFxuICAgIGNvbnN0IHZlcmlmaWVyT3B0cyA9IHtcbiAgICAgICAgYWFndWlkLFxuICAgICAgICBhdHRTdG10LFxuICAgICAgICBhdXRoRGF0YSxcbiAgICAgICAgY2xpZW50RGF0YUhhc2gsXG4gICAgICAgIGNyZWRlbnRpYWxJRCxcbiAgICAgICAgY3JlZGVudGlhbFB1YmxpY0tleSxcbiAgICAgICAgcm9vdENlcnRpZmljYXRlcyxcbiAgICAgICAgcnBJZEhhc2gsXG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBWZXJpZmljYXRpb24gY2FuIG9ubHkgYmUgcGVyZm9ybWVkIHdoZW4gYXR0ZXN0YXRpb24gPSAnZGlyZWN0J1xuICAgICAqL1xuICAgIGxldCB2ZXJpZmllZCA9IGZhbHNlO1xuICAgIGlmIChmbXQgPT09ICdmaWRvLXUyZicpIHtcbiAgICAgICAgdmVyaWZpZWQgPSBhd2FpdCB2ZXJpZnlBdHRlc3RhdGlvbkZJRE9VMkYodmVyaWZpZXJPcHRzKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZm10ID09PSAncGFja2VkJykge1xuICAgICAgICB2ZXJpZmllZCA9IGF3YWl0IHZlcmlmeUF0dGVzdGF0aW9uUGFja2VkKHZlcmlmaWVyT3B0cyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGZtdCA9PT0gJ2FuZHJvaWQtc2FmZXR5bmV0Jykge1xuICAgICAgICB2ZXJpZmllZCA9IGF3YWl0IHZlcmlmeUF0dGVzdGF0aW9uQW5kcm9pZFNhZmV0eU5ldCh2ZXJpZmllck9wdHMpO1xuICAgIH1cbiAgICBlbHNlIGlmIChmbXQgPT09ICdhbmRyb2lkLWtleScpIHtcbiAgICAgICAgdmVyaWZpZWQgPSBhd2FpdCB2ZXJpZnlBdHRlc3RhdGlvbkFuZHJvaWRLZXkodmVyaWZpZXJPcHRzKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZm10ID09PSAndHBtJykge1xuICAgICAgICB2ZXJpZmllZCA9IGF3YWl0IHZlcmlmeUF0dGVzdGF0aW9uVFBNKHZlcmlmaWVyT3B0cyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGZtdCA9PT0gJ2FwcGxlJykge1xuICAgICAgICB2ZXJpZmllZCA9IGF3YWl0IHZlcmlmeUF0dGVzdGF0aW9uQXBwbGUodmVyaWZpZXJPcHRzKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZm10ID09PSAnbm9uZScpIHtcbiAgICAgICAgaWYgKGF0dFN0bXQuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm9uZSBhdHRlc3RhdGlvbiBoYWQgdW5leHBlY3RlZCBhdHRlc3RhdGlvbiBzdGF0ZW1lbnQnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGlzIGlzIHRoZSB3ZWFrZXIgb2YgdGhlIGF0dGVzdGF0aW9ucywgc28gdGhlcmUncyBub3RoaW5nIGVsc2UgdG8gcmVhbGx5IGNoZWNrXG4gICAgICAgIHZlcmlmaWVkID0gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgQXR0ZXN0YXRpb24gRm9ybWF0OiAke2ZtdH1gKTtcbiAgICB9XG4gICAgY29uc3QgdG9SZXR1cm4gPSB7XG4gICAgICAgIHZlcmlmaWVkLFxuICAgIH07XG4gICAgaWYgKHRvUmV0dXJuLnZlcmlmaWVkKSB7XG4gICAgICAgIGNvbnN0IHsgY3JlZGVudGlhbERldmljZVR5cGUsIGNyZWRlbnRpYWxCYWNrZWRVcCB9ID0gcGFyc2VCYWNrdXBGbGFncyhmbGFncyk7XG4gICAgICAgIHRvUmV0dXJuLnJlZ2lzdHJhdGlvbkluZm8gPSB7XG4gICAgICAgICAgICBmbXQsXG4gICAgICAgICAgICBjb3VudGVyLFxuICAgICAgICAgICAgYWFndWlkOiBjb252ZXJ0QUFHVUlEVG9TdHJpbmcoYWFndWlkKSxcbiAgICAgICAgICAgIGNyZWRlbnRpYWxJRDogaXNvQmFzZTY0VVJMLmZyb21CdWZmZXIoY3JlZGVudGlhbElEKSxcbiAgICAgICAgICAgIGNyZWRlbnRpYWxQdWJsaWNLZXksXG4gICAgICAgICAgICBjcmVkZW50aWFsVHlwZSxcbiAgICAgICAgICAgIGF0dGVzdGF0aW9uT2JqZWN0LFxuICAgICAgICAgICAgdXNlclZlcmlmaWVkOiBmbGFncy51dixcbiAgICAgICAgICAgIGNyZWRlbnRpYWxEZXZpY2VUeXBlLFxuICAgICAgICAgICAgY3JlZGVudGlhbEJhY2tlZFVwLFxuICAgICAgICAgICAgb3JpZ2luOiBjbGllbnREYXRhSlNPTi5vcmlnaW4sXG4gICAgICAgICAgICBycElEOiBtYXRjaGVkUlBJRCxcbiAgICAgICAgICAgIGF1dGhlbnRpY2F0b3JFeHRlbnNpb25SZXN1bHRzOiBleHRlbnNpb25zRGF0YSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHRvUmV0dXJuO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/registration/verifyRegistrationResponse.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/android-key.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/android-key.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Google_Hardware_Attestation_Root_1: () => (/* binding */ Google_Hardware_Attestation_Root_1),\n/* harmony export */   Google_Hardware_Attestation_Root_2: () => (/* binding */ Google_Hardware_Attestation_Root_2)\n/* harmony export */ });\n/**\n * Google Hardware Attestation Root 1\n *\n * Downloaded from https://developer.android.com/training/articles/security-key-attestation#root_certificate\n * (first entry)\n *\n * Valid until 2026-05-24 @ 09:28 PST\n *\n * SHA256 Fingerprint\n * C1:98:4A:3E:F4:5C:1E:2A:91:85:51:DE:10:60:3C:86:F7:05:1B:22:49:C4:89:1C:AE:32:30:EA:BD:0C:97:D5\n */\nconst Google_Hardware_Attestation_Root_1 = `-----BEGIN CERTIFICATE-----\nMIIFYDCCA0igAwIBAgIJAOj6GWMU0voYMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\nBAUTEGY5MjAwOWU4NTNiNmIwNDUwHhcNMTYwNTI2MTYyODUyWhcNMjYwNTI0MTYy\nODUyWjAbMRkwFwYDVQQFExBmOTIwMDllODUzYjZiMDQ1MIICIjANBgkqhkiG9w0B\nAQEFAAOCAg8AMIICCgKCAgEAr7bHgiuxpwHsK7Qui8xUFmOr75gvMsd/dTEDDJdS\nSxtf6An7xyqpRR90PL2abxM1dEqlXnf2tqw1Ne4Xwl5jlRfdnJLmN0pTy/4lj4/7\ntv0Sk3iiKkypnEUtR6WfMgH0QZfKHM1+di+y9TFRtv6y//0rb+T+W8a9nsNL/ggj\nnar86461qO0rOs2cXjp3kOG1FEJ5MVmFmBGtnrKpa73XpXyTqRxB/M0n1n/W9nGq\nC4FSYa04T6N5RIZGBN2z2MT5IKGbFlbC8UrW0DxW7AYImQQcHtGl/m00QLVWutHQ\noVJYnFPlXTcHYvASLu+RhhsbDmxMgJJ0mcDpvsC4PjvB+TxywElgS70vE0XmLD+O\nJtvsBslHZvPBKCOdT0MS+tgSOIfga+z1Z1g7+DVagf7quvmag8jfPioyKvxnK/Eg\nsTUVi2ghzq8wm27ud/mIM7AY2qEORR8Go3TVB4HzWQgpZrt3i5MIlCaY504LzSRi\nigHCzAPlHws+W0rB5N+er5/2pJKnfBSDiCiFAVtCLOZ7gLiMm0jhO2B6tUXHI/+M\nRPjy02i59lINMRRev56GKtcd9qO/0kUJWdZTdA2XoS82ixPvZtXQpUpuL12ab+9E\naDK8Z4RHJYYfCT3Q5vNAXaiWQ+8PTWm2QgBR/bkwSWc+NpUFgNPN9PvQi8WEg5Um\nAGMCAwEAAaOBpjCBozAdBgNVHQ4EFgQUNmHhAHyIBQlRi0RsR/8aTMnqTxIwHwYD\nVR0jBBgwFoAUNmHhAHyIBQlRi0RsR/8aTMnqTxIwDwYDVR0TAQH/BAUwAwEB/zAO\nBgNVHQ8BAf8EBAMCAYYwQAYDVR0fBDkwNzA1oDOgMYYvaHR0cHM6Ly9hbmRyb2lk\nLmdvb2dsZWFwaXMuY29tL2F0dGVzdGF0aW9uL2NybC8wDQYJKoZIhvcNAQELBQAD\nggIBACDIw41L3KlXG0aMiS//cqrG+EShHUGo8HNsw30W1kJtjn6UBwRM6jnmiwfB\nPb8VA91chb2vssAtX2zbTvqBJ9+LBPGCdw/E53Rbf86qhxKaiAHOjpvAy5Y3m00m\nqC0w/Zwvju1twb4vhLaJ5NkUJYsUS7rmJKHHBnETLi8GFqiEsqTWpG/6ibYCv7rY\nDBJDcR9W62BW9jfIoBQcxUCUJouMPH25lLNcDc1ssqvC2v7iUgI9LeoM1sNovqPm\nQUiG9rHli1vXxzCyaMTjwftkJLkf6724DFhuKug2jITV0QkXvaJWF4nUaHOTNA4u\nJU9WDvZLI1j83A+/xnAJUucIv/zGJ1AMH2boHqF8CY16LpsYgBt6tKxxWH00XcyD\nCdW2KlBCeqbQPcsFmWyWugxdcekhYsAWyoSf818NUsZdBWBaR/OukXrNLfkQ79Iy\nZohZbvabO/X+MVT3rriAoKc8oE2Uws6DF+60PV7/WIPjNvXySdqspImSN78mflxD\nqwLqRBYkA3I75qppLGG9rp7UCdRjxMl8ZDBld+7yvHVgt1cVzJx9xnyGCC23Uaic\nMDSXYrB4I4WHXPGjxhZuCuPBLTdOLU8YRvMYdEvYebWHMpvwGCF6bAx3JBpIeOQ1\nwDB5y0USicV3YgYGmi+NZfhA4URSh77Yd6uuJOJENRaNVTzk\n-----END CERTIFICATE-----\n`;\n/**\n * Google Hardware Attestation Root 2\n *\n * Downloaded from https://developer.android.com/training/articles/security-key-attestation#root_certificate\n * (second entry)\n *\n * Valid until 2034-11-18 @ 12:37 PST\n *\n * SHA256 Fingerprint\n * 1E:F1:A0:4B:8B:A5:8A:B9:45:89:AC:49:8C:89:82:A7:83:F2:4E:A7:30:7E:01:59:A0:C3:A7:3B:37:7D:87:CC\n */\nconst Google_Hardware_Attestation_Root_2 = `-----BEGIN CERTIFICATE-----\nMIIFHDCCAwSgAwIBAgIJANUP8luj8tazMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV\nBAUTEGY5MjAwOWU4NTNiNmIwNDUwHhcNMTkxMTIyMjAzNzU4WhcNMzQxMTE4MjAz\nNzU4WjAbMRkwFwYDVQQFExBmOTIwMDllODUzYjZiMDQ1MIICIjANBgkqhkiG9w0B\nAQEFAAOCAg8AMIICCgKCAgEAr7bHgiuxpwHsK7Qui8xUFmOr75gvMsd/dTEDDJdS\nSxtf6An7xyqpRR90PL2abxM1dEqlXnf2tqw1Ne4Xwl5jlRfdnJLmN0pTy/4lj4/7\ntv0Sk3iiKkypnEUtR6WfMgH0QZfKHM1+di+y9TFRtv6y//0rb+T+W8a9nsNL/ggj\nnar86461qO0rOs2cXjp3kOG1FEJ5MVmFmBGtnrKpa73XpXyTqRxB/M0n1n/W9nGq\nC4FSYa04T6N5RIZGBN2z2MT5IKGbFlbC8UrW0DxW7AYImQQcHtGl/m00QLVWutHQ\noVJYnFPlXTcHYvASLu+RhhsbDmxMgJJ0mcDpvsC4PjvB+TxywElgS70vE0XmLD+O\nJtvsBslHZvPBKCOdT0MS+tgSOIfga+z1Z1g7+DVagf7quvmag8jfPioyKvxnK/Eg\nsTUVi2ghzq8wm27ud/mIM7AY2qEORR8Go3TVB4HzWQgpZrt3i5MIlCaY504LzSRi\nigHCzAPlHws+W0rB5N+er5/2pJKnfBSDiCiFAVtCLOZ7gLiMm0jhO2B6tUXHI/+M\nRPjy02i59lINMRRev56GKtcd9qO/0kUJWdZTdA2XoS82ixPvZtXQpUpuL12ab+9E\naDK8Z4RHJYYfCT3Q5vNAXaiWQ+8PTWm2QgBR/bkwSWc+NpUFgNPN9PvQi8WEg5Um\nAGMCAwEAAaNjMGEwHQYDVR0OBBYEFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMB8GA1Ud\nIwQYMBaAFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMA8GA1UdEwEB/wQFMAMBAf8wDgYD\nVR0PAQH/BAQDAgIEMA0GCSqGSIb3DQEBCwUAA4ICAQBOMaBc8oumXb2voc7XCWnu\nXKhBBK3e2KMGz39t7lA3XXRe2ZLLAkLM5y3J7tURkf5a1SutfdOyXAmeE6SRo83U\nh6WszodmMkxK5GM4JGrnt4pBisu5igXEydaW7qq2CdC6DOGjG+mEkN8/TA6p3cno\nL/sPyz6evdjLlSeJ8rFBH6xWyIZCbrcpYEJzXaUOEaxxXxgYz5/cTiVKN2M1G2ok\nQBUIYSY6bjEL4aUN5cfo7ogP3UvliEo3Eo0YgwuzR2v0KR6C1cZqZJSTnghIC/vA\nD32KdNQ+c3N+vl2OTsUVMC1GiWkngNx1OO1+kXW+YTnnTUOtOIswUP/Vqd5SYgAI\nmMAfY8U9/iIgkQj6T2W6FsScy94IN9fFhE1UtzmLoBIuUFsVXJMTz+Jucth+IqoW\nFua9v1R93/k98p41pjtFX+H8DslVgfP097vju4KDlqN64xV1grw3ZLl4CiOe/A91\noeLm2UHOq6wn3esB4r2EIQKb6jTVGu5sYCcdWpXr0AUVqcABPdgL+H7qJguBw09o\njm6xNIrw2OocrDKsudk/okr/AwqEyPKw9WnMlQgLIKw1rODG2NvU9oR3GVGdMkUB\nZutL8VuFkERQGt6vQ2OCw0sV47VMkuYbacK/xyZFiRcrPJPb41zgbQj9XAEyLKCH\nex0SdDrx+tWUDqG8At2JHA==\n-----END CERTIFICATE-----\n`;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vc2VydmljZXMvZGVmYXVsdFJvb3RDZXJ0cy9hbmRyb2lkLWtleS5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcc2VydmljZXNcXGRlZmF1bHRSb290Q2VydHNcXGFuZHJvaWQta2V5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR29vZ2xlIEhhcmR3YXJlIEF0dGVzdGF0aW9uIFJvb3QgMVxuICpcbiAqIERvd25sb2FkZWQgZnJvbSBodHRwczovL2RldmVsb3Blci5hbmRyb2lkLmNvbS90cmFpbmluZy9hcnRpY2xlcy9zZWN1cml0eS1rZXktYXR0ZXN0YXRpb24jcm9vdF9jZXJ0aWZpY2F0ZVxuICogKGZpcnN0IGVudHJ5KVxuICpcbiAqIFZhbGlkIHVudGlsIDIwMjYtMDUtMjQgQCAwOToyOCBQU1RcbiAqXG4gKiBTSEEyNTYgRmluZ2VycHJpbnRcbiAqIEMxOjk4OjRBOjNFOkY0OjVDOjFFOjJBOjkxOjg1OjUxOkRFOjEwOjYwOjNDOjg2OkY3OjA1OjFCOjIyOjQ5OkM0Ojg5OjFDOkFFOjMyOjMwOkVBOkJEOjBDOjk3OkQ1XG4gKi9cbmV4cG9ydCBjb25zdCBHb29nbGVfSGFyZHdhcmVfQXR0ZXN0YXRpb25fUm9vdF8xID0gYC0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLVxuTUlJRllEQ0NBMGlnQXdJQkFnSUpBT2o2R1dNVTB2b1lNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1Cc3hHVEFYQmdOVlxuQkFVVEVHWTVNakF3T1dVNE5UTmlObUl3TkRVd0hoY05NVFl3TlRJMk1UWXlPRFV5V2hjTk1qWXdOVEkwTVRZeVxuT0RVeVdqQWJNUmt3RndZRFZRUUZFeEJtT1RJd01EbGxPRFV6WWpaaU1EUTFNSUlDSWpBTkJna3Foa2lHOXcwQlxuQVFFRkFBT0NBZzhBTUlJQ0NnS0NBZ0VBcjdiSGdpdXhwd0hzSzdRdWk4eFVGbU9yNzVndk1zZC9kVEVEREpkU1xuU3h0ZjZBbjd4eXFwUlI5MFBMMmFieE0xZEVxbFhuZjJ0cXcxTmU0WHdsNWpsUmZkbkpMbU4wcFR5LzRsajQvN1xudHYwU2szaWlLa3lwbkVVdFI2V2ZNZ0gwUVpmS0hNMStkaSt5OVRGUnR2NnkvLzByYitUK1c4YTluc05ML2dnalxubmFyODY0NjFxTzByT3MyY1hqcDNrT0cxRkVKNU1WbUZtQkd0bnJLcGE3M1hwWHlUcVJ4Qi9NMG4xbi9XOW5HcVxuQzRGU1lhMDRUNk41UklaR0JOMnoyTVQ1SUtHYkZsYkM4VXJXMER4VzdBWUltUVFjSHRHbC9tMDBRTFZXdXRIUVxub1ZKWW5GUGxYVGNIWXZBU0x1K1JoaHNiRG14TWdKSjBtY0RwdnNDNFBqdkIrVHh5d0VsZ1M3MHZFMFhtTEQrT1xuSnR2c0JzbEhadlBCS0NPZFQwTVMrdGdTT0lmZ2ErejFaMWc3K0RWYWdmN3F1dm1hZzhqZlBpb3lLdnhuSy9FZ1xuc1RVVmkyZ2h6cTh3bTI3dWQvbUlNN0FZMnFFT1JSOEdvM1RWQjRIeldRZ3BacnQzaTVNSWxDYVk1MDRMelNSaVxuaWdIQ3pBUGxId3MrVzByQjVOK2VyNS8ycEpLbmZCU0RpQ2lGQVZ0Q0xPWjdnTGlNbTBqaE8yQjZ0VVhISS8rTVxuUlBqeTAyaTU5bElOTVJSZXY1NkdLdGNkOXFPLzBrVUpXZFpUZEEyWG9TODJpeFB2WnRYUXBVcHVMMTJhYis5RVxuYURLOFo0UkhKWVlmQ1QzUTV2TkFYYWlXUSs4UFRXbTJRZ0JSL2Jrd1NXYytOcFVGZ05QTjlQdlFpOFdFZzVVbVxuQUdNQ0F3RUFBYU9CcGpDQm96QWRCZ05WSFE0RUZnUVVObUhoQUh5SUJRbFJpMFJzUi84YVRNbnFUeEl3SHdZRFxuVlIwakJCZ3dGb0FVTm1IaEFIeUlCUWxSaTBSc1IvOGFUTW5xVHhJd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBT1xuQmdOVkhROEJBZjhFQkFNQ0FZWXdRQVlEVlIwZkJEa3dOekExb0RPZ01ZWXZhSFIwY0hNNkx5OWhibVJ5YjJsa1xuTG1kdmIyZHNaV0Z3YVhNdVkyOXRMMkYwZEdWemRHRjBhVzl1TDJOeWJDOHdEUVlKS29aSWh2Y05BUUVMQlFBRFxuZ2dJQkFDREl3NDFMM0tsWEcwYU1pUy8vY3FyRytFU2hIVUdvOEhOc3czMFcxa0p0am42VUJ3Uk02am5taXdmQlxuUGI4VkE5MWNoYjJ2c3NBdFgyemJUdnFCSjkrTEJQR0Nkdy9FNTNSYmY4NnFoeEthaUFIT2pwdkF5NVkzbTAwbVxucUMwdy9ad3ZqdTF0d2I0dmhMYUo1TmtVSllzVVM3cm1KS0hIQm5FVExpOEdGcWlFc3FUV3BHLzZpYllDdjdyWVxuREJKRGNSOVc2MkJXOWpmSW9CUWN4VUNVSm91TVBIMjVsTE5jRGMxc3NxdkMydjdpVWdJOUxlb00xc05vdnFQbVxuUVVpRzlySGxpMXZYeHpDeWFNVGp3ZnRrSkxrZjY3MjRERmh1S3VnMmpJVFYwUWtYdmFKV0Y0blVhSE9UTkE0dVxuSlU5V0R2WkxJMWo4M0ErL3huQUpVdWNJdi96R0oxQU1IMmJvSHFGOENZMTZMcHNZZ0J0NnRLeHhXSDAwWGN5RFxuQ2RXMktsQkNlcWJRUGNzRm1XeVd1Z3hkY2VraFlzQVd5b1NmODE4TlVzWmRCV0JhUi9PdWtYck5MZmtRNzlJeVxuWm9oWmJ2YWJPL1grTVZUM3JyaUFvS2M4b0UyVXdzNkRGKzYwUFY3L1dJUGpOdlh5U2Rxc3BJbVNONzhtZmx4RFxucXdMcVJCWWtBM0k3NXFwcExHRzlycDdVQ2RSanhNbDhaREJsZCs3eXZIVmd0MWNWekp4OXhueUdDQzIzVWFpY1xuTURTWFlyQjRJNFdIWFBHanhoWnVDdVBCTFRkT0xVOFlSdk1ZZEV2WWViV0hNcHZ3R0NGNmJBeDNKQnBJZU9RMVxud0RCNXkwVVNpY1YzWWdZR21pK05aZmhBNFVSU2g3N1lkNnV1Sk9KRU5SYU5WVHprXG4tLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tXG5gO1xuLyoqXG4gKiBHb29nbGUgSGFyZHdhcmUgQXR0ZXN0YXRpb24gUm9vdCAyXG4gKlxuICogRG93bmxvYWRlZCBmcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3RyYWluaW5nL2FydGljbGVzL3NlY3VyaXR5LWtleS1hdHRlc3RhdGlvbiNyb290X2NlcnRpZmljYXRlXG4gKiAoc2Vjb25kIGVudHJ5KVxuICpcbiAqIFZhbGlkIHVudGlsIDIwMzQtMTEtMTggQCAxMjozNyBQU1RcbiAqXG4gKiBTSEEyNTYgRmluZ2VycHJpbnRcbiAqIDFFOkYxOkEwOjRCOjhCOkE1OjhBOkI5OjQ1Ojg5OkFDOjQ5OjhDOjg5OjgyOkE3OjgzOkYyOjRFOkE3OjMwOjdFOjAxOjU5OkEwOkMzOkE3OjNCOjM3OjdEOjg3OkNDXG4gKi9cbmV4cG9ydCBjb25zdCBHb29nbGVfSGFyZHdhcmVfQXR0ZXN0YXRpb25fUm9vdF8yID0gYC0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLVxuTUlJRkhEQ0NBd1NnQXdJQkFnSUpBTlVQOGx1ajh0YXpNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1Cc3hHVEFYQmdOVlxuQkFVVEVHWTVNakF3T1dVNE5UTmlObUl3TkRVd0hoY05NVGt4TVRJeU1qQXpOelU0V2hjTk16UXhNVEU0TWpBelxuTnpVNFdqQWJNUmt3RndZRFZRUUZFeEJtT1RJd01EbGxPRFV6WWpaaU1EUTFNSUlDSWpBTkJna3Foa2lHOXcwQlxuQVFFRkFBT0NBZzhBTUlJQ0NnS0NBZ0VBcjdiSGdpdXhwd0hzSzdRdWk4eFVGbU9yNzVndk1zZC9kVEVEREpkU1xuU3h0ZjZBbjd4eXFwUlI5MFBMMmFieE0xZEVxbFhuZjJ0cXcxTmU0WHdsNWpsUmZkbkpMbU4wcFR5LzRsajQvN1xudHYwU2szaWlLa3lwbkVVdFI2V2ZNZ0gwUVpmS0hNMStkaSt5OVRGUnR2NnkvLzByYitUK1c4YTluc05ML2dnalxubmFyODY0NjFxTzByT3MyY1hqcDNrT0cxRkVKNU1WbUZtQkd0bnJLcGE3M1hwWHlUcVJ4Qi9NMG4xbi9XOW5HcVxuQzRGU1lhMDRUNk41UklaR0JOMnoyTVQ1SUtHYkZsYkM4VXJXMER4VzdBWUltUVFjSHRHbC9tMDBRTFZXdXRIUVxub1ZKWW5GUGxYVGNIWXZBU0x1K1JoaHNiRG14TWdKSjBtY0RwdnNDNFBqdkIrVHh5d0VsZ1M3MHZFMFhtTEQrT1xuSnR2c0JzbEhadlBCS0NPZFQwTVMrdGdTT0lmZ2ErejFaMWc3K0RWYWdmN3F1dm1hZzhqZlBpb3lLdnhuSy9FZ1xuc1RVVmkyZ2h6cTh3bTI3dWQvbUlNN0FZMnFFT1JSOEdvM1RWQjRIeldRZ3BacnQzaTVNSWxDYVk1MDRMelNSaVxuaWdIQ3pBUGxId3MrVzByQjVOK2VyNS8ycEpLbmZCU0RpQ2lGQVZ0Q0xPWjdnTGlNbTBqaE8yQjZ0VVhISS8rTVxuUlBqeTAyaTU5bElOTVJSZXY1NkdLdGNkOXFPLzBrVUpXZFpUZEEyWG9TODJpeFB2WnRYUXBVcHVMMTJhYis5RVxuYURLOFo0UkhKWVlmQ1QzUTV2TkFYYWlXUSs4UFRXbTJRZ0JSL2Jrd1NXYytOcFVGZ05QTjlQdlFpOFdFZzVVbVxuQUdNQ0F3RUFBYU5qTUdFd0hRWURWUjBPQkJZRUZEWmg0UUI4aUFVSlVZdEViRWYvR2t6SjZrOFNNQjhHQTFVZFxuSXdRWU1CYUFGRFpoNFFCOGlBVUpVWXRFYkVmL0dreko2azhTTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3RGdZRFxuVlIwUEFRSC9CQVFEQWdJRU1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQ0FRQk9NYUJjOG91bVhiMnZvYzdYQ1dudVxuWEtoQkJLM2UyS01HejM5dDdsQTNYWFJlMlpMTEFrTE01eTNKN3RVUmtmNWExU3V0ZmRPeVhBbWVFNlNSbzgzVVxuaDZXc3pvZG1Na3hLNUdNNEpHcm50NHBCaXN1NWlnWEV5ZGFXN3FxMkNkQzZET0dqRyttRWtOOC9UQTZwM2Nub1xuTC9zUHl6NmV2ZGpMbFNlSjhyRkJINnhXeUlaQ2JyY3BZRUp6WGFVT0VheHhYeGdZejUvY1RpVktOMk0xRzJva1xuUUJVSVlTWTZiakVMNGFVTjVjZm83b2dQM1V2bGlFbzNFbzBZZ3d1elIydjBLUjZDMWNacVpKU1RuZ2hJQy92QVxuRDMyS2ROUStjM04rdmwyT1RzVVZNQzFHaVdrbmdOeDFPTzEra1hXK1lUbm5UVU90T0lzd1VQL1ZxZDVTWWdBSVxubU1BZlk4VTkvaUlna1FqNlQyVzZGc1NjeTk0SU45ZkZoRTFVdHptTG9CSXVVRnNWWEpNVHorSnVjdGgrSXFvV1xuRnVhOXYxUjkzL2s5OHA0MXBqdEZYK0g4RHNsVmdmUDA5N3ZqdTRLRGxxTjY0eFYxZ3J3M1pMbDRDaU9lL0E5MVxub2VMbTJVSE9xNnduM2VzQjRyMkVJUUtiNmpUVkd1NXNZQ2NkV3BYcjBBVVZxY0FCUGRnTCtIN3FKZ3VCdzA5b1xuam02eE5JcncyT29jckRLc3Vkay9va3IvQXdxRXlQS3c5V25NbFFnTElLdzFyT0RHMk52VTlvUjNHVkdkTWtVQlxuWnV0TDhWdUZrRVJRR3Q2dlEyT0N3MHNWNDdWTWt1WWJhY0sveHlaRmlSY3JQSlBiNDF6Z2JRajlYQUV5TEtDSFxuZXgwU2REcngrdFdVRHFHOEF0MkpIQT09XG4tLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tXG5gO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/android-key.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/android-safetynet.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/android-safetynet.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GlobalSign_Root_CA: () => (/* binding */ GlobalSign_Root_CA)\n/* harmony export */ });\n/**\n * GlobalSign Root CA\n *\n * Downloaded from https://pki.goog/roots.pem\n *\n * Valid until 2028-01-28 @ 04:00 PST\n *\n * SHA256 Fingerprint\n * EB:D4:10:40:E4:BB:3E:C7:42:C9:E3:81:D3:1E:F2:A4:1A:48:B6:68:5C:96:E7:CE:F3:C1:DF:6C:D4:33:1C:99\n */\nconst GlobalSign_Root_CA = `-----BEGIN CERTIFICATE-----\nMIIDdTCCAl2gAwIBAgILBAAAAAABFUtaw5QwDQYJKoZIhvcNAQEFBQAwVzELMAkG\nA1UEBhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsTB1Jv\nb3QgQ0ExGzAZBgNVBAMTEkdsb2JhbFNpZ24gUm9vdCBDQTAeFw05ODA5MDExMjAw\nMDBaFw0yODAxMjgxMjAwMDBaMFcxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9i\nYWxTaWduIG52LXNhMRAwDgYDVQQLEwdSb290IENBMRswGQYDVQQDExJHbG9iYWxT\naWduIFJvb3QgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDaDuaZ\njc6j40+Kfvvxi4Mla+pIH/EqsLmVEQS98GPR4mdmzxzdzxtIK+6NiY6arymAZavp\nxy0Sy6scTHAHoT0KMM0VjU/43dSMUBUc71DuxC73/OlS8pF94G3VNTCOXkNz8kHp\n1Wrjsok6Vjk4bwY8iGlbKk3Fp1S4bInMm/k8yuX9ifUSPJJ4ltbcdG6TRGHRjcdG\nsnUOhugZitVtbNV4FpWi6cgKOOvyJBNPc1STE4U6G7weNLWLBYy5d4ux2x8gkasJ\nU26Qzns3dLlwR5EiUWMWea6xrkEmCMgZK9FGqkjWZCrXgzT/LCrBbBlDSgeF59N8\n9iFo7+ryUp9/k5DPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8E\nBTADAQH/MB0GA1UdDgQWBBRge2YaRQ2XyolQL30EzTSo//z9SzANBgkqhkiG9w0B\nAQUFAAOCAQEA1nPnfE920I2/7LqivjTFKDK1fPxsnCwrvQmeU79rXqoRSLblCKOz\nyj1hTdNGCbM+w6DjY1Ub8rrvrTnhQ7k4o+YviiY776BQVvnGCv04zcQLcFGUl5gE\n38NflNUVyRRBnMRddWQVDf9VMOyGj/8N7yy5Y0b2qvzfvGn9LhJIZJrglfCm7ymP\nAbEVtQwdpf5pLGkkeB6zpxxxYu7KyJesF12KwvhHhm4qxFYxldBniYUr+WymXUad\nDKqC5JlR3XC321Y9YeRq4VzW9v493kHMB65jUr9TU/Qr6cf9tveCX4XSQRjbgbME\nHMUfpIBvFSDJ3gyICh3WZlXi/EjJKSZp4A==\n-----END CERTIFICATE-----\n`;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vc2VydmljZXMvZGVmYXVsdFJvb3RDZXJ0cy9hbmRyb2lkLXNhZmV0eW5ldC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXHNlcnZpY2VzXFxkZWZhdWx0Um9vdENlcnRzXFxhbmRyb2lkLXNhZmV0eW5ldC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEdsb2JhbFNpZ24gUm9vdCBDQVxuICpcbiAqIERvd25sb2FkZWQgZnJvbSBodHRwczovL3BraS5nb29nL3Jvb3RzLnBlbVxuICpcbiAqIFZhbGlkIHVudGlsIDIwMjgtMDEtMjggQCAwNDowMCBQU1RcbiAqXG4gKiBTSEEyNTYgRmluZ2VycHJpbnRcbiAqIEVCOkQ0OjEwOjQwOkU0OkJCOjNFOkM3OjQyOkM5OkUzOjgxOkQzOjFFOkYyOkE0OjFBOjQ4OkI2OjY4OjVDOjk2OkU3OkNFOkYzOkMxOkRGOjZDOkQ0OjMzOjFDOjk5XG4gKi9cbmV4cG9ydCBjb25zdCBHbG9iYWxTaWduX1Jvb3RfQ0EgPSBgLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tXG5NSUlEZFRDQ0FsMmdBd0lCQWdJTEJBQUFBQUFCRlV0YXc1UXdEUVlKS29aSWh2Y05BUUVGQlFBd1Z6RUxNQWtHXG5BMVVFQmhNQ1FrVXhHVEFYQmdOVkJBb1RFRWRzYjJKaGJGTnBaMjRnYm5ZdGMyRXhFREFPQmdOVkJBc1RCMUp2XG5iM1FnUTBFeEd6QVpCZ05WQkFNVEVrZHNiMkpoYkZOcFoyNGdVbTl2ZENCRFFUQWVGdzA1T0RBNU1ERXhNakF3XG5NREJhRncweU9EQXhNamd4TWpBd01EQmFNRmN4Q3pBSkJnTlZCQVlUQWtKRk1Sa3dGd1lEVlFRS0V4QkhiRzlpXG5ZV3hUYVdkdUlHNTJMWE5oTVJBd0RnWURWUVFMRXdkU2IyOTBJRU5CTVJzd0dRWURWUVFERXhKSGJHOWlZV3hUXG5hV2R1SUZKdmIzUWdRMEV3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRRGFEdWFaXG5qYzZqNDArS2Z2dnhpNE1sYStwSUgvRXFzTG1WRVFTOThHUFI0bWRtenh6ZHp4dElLKzZOaVk2YXJ5bUFaYXZwXG54eTBTeTZzY1RIQUhvVDBLTU0wVmpVLzQzZFNNVUJVYzcxRHV4QzczL09sUzhwRjk0RzNWTlRDT1hrTno4a0hwXG4xV3Jqc29rNlZqazRid1k4aUdsYktrM0ZwMVM0YkluTW0vazh5dVg5aWZVU1BKSjRsdGJjZEc2VFJHSFJqY2RHXG5zblVPaHVnWml0VnRiTlY0RnBXaTZjZ0tPT3Z5SkJOUGMxU1RFNFU2Rzd3ZU5MV0xCWXk1ZDR1eDJ4OGdrYXNKXG5VMjZRem5zM2RMbHdSNUVpVVdNV2VhNnhya0VtQ01nWks5Rkdxa2pXWkNyWGd6VC9MQ3JCYkJsRFNnZUY1OU44XG45aUZvNytyeVVwOS9rNURQQWdNQkFBR2pRakJBTUE0R0ExVWREd0VCL3dRRUF3SUJCakFQQmdOVkhSTUJBZjhFXG5CVEFEQVFIL01CMEdBMVVkRGdRV0JCUmdlMllhUlEyWHlvbFFMMzBFelRTby8vejlTekFOQmdrcWhraUc5dzBCXG5BUVVGQUFPQ0FRRUExblBuZkU5MjBJMi83THFpdmpURktESzFmUHhzbkN3cnZRbWVVNzlyWHFvUlNMYmxDS096XG55ajFoVGROR0NiTSt3NkRqWTFVYjhycnZyVG5oUTdrNG8rWXZpaVk3NzZCUVZ2bkdDdjA0emNRTGNGR1VsNWdFXG4zOE5mbE5VVnlSUkJuTVJkZFdRVkRmOVZNT3lHai84Tjd5eTVZMGIycXZ6ZnZHbjlMaEpJWkpyZ2xmQ203eW1QXG5BYkVWdFF3ZHBmNXBMR2trZUI2enB4eHhZdTdLeUplc0YxMkt3dmhIaG00cXhGWXhsZEJuaVlVcitXeW1YVWFkXG5ES3FDNUpsUjNYQzMyMVk5WWVScTRWelc5djQ5M2tITUI2NWpVcjlUVS9RcjZjZjl0dmVDWDRYU1FSamJnYk1FXG5ITVVmcElCdkZTREozZ3lJQ2gzV1psWGkvRWpKS1NacDRBPT1cbi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS1cbmA7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/android-safetynet.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/apple.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/apple.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Apple_WebAuthn_Root_CA: () => (/* binding */ Apple_WebAuthn_Root_CA)\n/* harmony export */ });\n/**\n * Apple WebAuthn Root CA\n *\n * Downloaded from https://www.apple.com/certificateauthority/Apple_WebAuthn_Root_CA.pem\n *\n * Valid until 2045-03-14 @ 17:00 PST\n *\n * SHA256 Fingerprint\n * 09:15:DD:5C:07:A2:8D:B5:49:D1:F6:77:BB:5A:75:D4:BF:BE:95:61:A7:73:42:43:27:76:2E:9E:02:F9:BB:29\n */\nconst Apple_WebAuthn_Root_CA = `-----BEGIN CERTIFICATE-----\nMIICEjCCAZmgAwIBAgIQaB0BbHo84wIlpQGUKEdXcTAKBggqhkjOPQQDAzBLMR8w\nHQYDVQQDDBZBcHBsZSBXZWJBdXRobiBSb290IENBMRMwEQYDVQQKDApBcHBsZSBJ\nbmMuMRMwEQYDVQQIDApDYWxpZm9ybmlhMB4XDTIwMDMxODE4MjEzMloXDTQ1MDMx\nNTAwMDAwMFowSzEfMB0GA1UEAwwWQXBwbGUgV2ViQXV0aG4gUm9vdCBDQTETMBEG\nA1UECgwKQXBwbGUgSW5jLjETMBEGA1UECAwKQ2FsaWZvcm5pYTB2MBAGByqGSM49\nAgEGBSuBBAAiA2IABCJCQ2pTVhzjl4Wo6IhHtMSAzO2cv+H9DQKev3//fG59G11k\nxu9eI0/7o6V5uShBpe1u6l6mS19S1FEh6yGljnZAJ+2GNP1mi/YK2kSXIuTHjxA/\npcoRf7XkOtO4o1qlcaNCMEAwDwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUJtdk\n2cV4wlpn0afeaxLQG2PxxtcwDgYDVR0PAQH/BAQDAgEGMAoGCCqGSM49BAMDA2cA\nMGQCMFrZ+9DsJ1PW9hfNdBywZDsWDbWFp28it1d/5w2RPkRX3Bbn/UbDTNLx7Jr3\njAGGiQIwHFj+dJZYUJR786osByBelJYsVZd2GbHQu209b5RCmGQ21gpSAk9QZW4B\n1bWeT0vT\n-----END CERTIFICATE-----\n`;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vc2VydmljZXMvZGVmYXVsdFJvb3RDZXJ0cy9hcHBsZS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxzZXJ2aWNlc1xcZGVmYXVsdFJvb3RDZXJ0c1xcYXBwbGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBcHBsZSBXZWJBdXRobiBSb290IENBXG4gKlxuICogRG93bmxvYWRlZCBmcm9tIGh0dHBzOi8vd3d3LmFwcGxlLmNvbS9jZXJ0aWZpY2F0ZWF1dGhvcml0eS9BcHBsZV9XZWJBdXRobl9Sb290X0NBLnBlbVxuICpcbiAqIFZhbGlkIHVudGlsIDIwNDUtMDMtMTQgQCAxNzowMCBQU1RcbiAqXG4gKiBTSEEyNTYgRmluZ2VycHJpbnRcbiAqIDA5OjE1OkREOjVDOjA3OkEyOjhEOkI1OjQ5OkQxOkY2Ojc3OkJCOjVBOjc1OkQ0OkJGOkJFOjk1OjYxOkE3OjczOjQyOjQzOjI3Ojc2OjJFOjlFOjAyOkY5OkJCOjI5XG4gKi9cbmV4cG9ydCBjb25zdCBBcHBsZV9XZWJBdXRobl9Sb290X0NBID0gYC0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLVxuTUlJQ0VqQ0NBWm1nQXdJQkFnSVFhQjBCYkhvODR3SWxwUUdVS0VkWGNUQUtCZ2dxaGtqT1BRUURBekJMTVI4d1xuSFFZRFZRUUREQlpCY0hCc1pTQlhaV0pCZFhSb2JpQlNiMjkwSUVOQk1STXdFUVlEVlFRS0RBcEJjSEJzWlNCSlxuYm1NdU1STXdFUVlEVlFRSURBcERZV3hwWm05eWJtbGhNQjRYRFRJd01ETXhPREU0TWpFek1sb1hEVFExTURNeFxuTlRBd01EQXdNRm93U3pFZk1CMEdBMVVFQXd3V1FYQndiR1VnVjJWaVFYVjBhRzRnVW05dmRDQkRRVEVUTUJFR1xuQTFVRUNnd0tRWEJ3YkdVZ1NXNWpMakVUTUJFR0ExVUVDQXdLUTJGc2FXWnZjbTVwWVRCMk1CQUdCeXFHU000OVxuQWdFR0JTdUJCQUFpQTJJQUJDSkNRMnBUVmh6amw0V282SWhIdE1TQXpPMmN2K0g5RFFLZXYzLy9mRzU5RzExa1xueHU5ZUkwLzdvNlY1dVNoQnBlMXU2bDZtUzE5UzFGRWg2eUdsam5aQUorMkdOUDFtaS9ZSzJrU1hJdVRIanhBL1xucGNvUmY3WGtPdE80bzFxbGNhTkNNRUF3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVSnRka1xuMmNWNHdscG4wYWZlYXhMUUcyUHh4dGN3RGdZRFZSMFBBUUgvQkFRREFnRUdNQW9HQ0NxR1NNNDlCQU1EQTJjQVxuTUdRQ01GclorOURzSjFQVzloZk5kQnl3WkRzV0RiV0ZwMjhpdDFkLzV3MlJQa1JYM0Jibi9VYkRUTkx4N0pyM1xuakFHR2lRSXdIRmorZEpaWVVKUjc4Nm9zQnlCZWxKWXNWWmQyR2JIUXUyMDliNVJDbUdRMjFncFNBazlRWlc0QlxuMWJXZVQwdlRcbi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS1cbmA7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/apple.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/mds.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/mds.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GlobalSign_Root_CA_R3: () => (/* binding */ GlobalSign_Root_CA_R3)\n/* harmony export */ });\n/**\n * GlobalSign Root CA - R3\n *\n * Downloaded from https://valid.r3.roots.globalsign.com/\n *\n * Valid until 2029-03-18 @ 00:00 PST\n *\n * SHA256 Fingerprint\n * CB:B5:22:D7:B7:F1:27:AD:6A:01:13:86:5B:DF:1C:D4:10:2E:7D:07:59:AF:63:5A:7C:F4:72:0D:C9:63:C5:3B\n */\nconst GlobalSign_Root_CA_R3 = `-----BEGIN CERTIFICATE-----\n MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G\n A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp\n Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4\n MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG\n A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI\n hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8\n RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT\n gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm\n KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd\n QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ\n XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw\n DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o\n LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU\n RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp\n jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK\n 6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX\n mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs\n Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH\n WD9f\n -----END CERTIFICATE-----\n `;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vc2VydmljZXMvZGVmYXVsdFJvb3RDZXJ0cy9tZHMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcZHlcXERlc2t0b3BcXGdpdGh1YmNvcGlsb3RcXE5VUy1JU1MtQUktU0RMQy1Hcm91cDEtVG9Eb0FwcFxcbm9kZV9tb2R1bGVzXFxAc2ltcGxld2ViYXV0aG5cXHNlcnZlclxcZXNtXFxzZXJ2aWNlc1xcZGVmYXVsdFJvb3RDZXJ0c1xcbWRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR2xvYmFsU2lnbiBSb290IENBIC0gUjNcbiAqXG4gKiBEb3dubG9hZGVkIGZyb20gaHR0cHM6Ly92YWxpZC5yMy5yb290cy5nbG9iYWxzaWduLmNvbS9cbiAqXG4gKiBWYWxpZCB1bnRpbCAyMDI5LTAzLTE4IEAgMDA6MDAgUFNUXG4gKlxuICogU0hBMjU2IEZpbmdlcnByaW50XG4gKiBDQjpCNToyMjpENzpCNzpGMToyNzpBRDo2QTowMToxMzo4Njo1QjpERjoxQzpENDoxMDoyRTo3RDowNzo1OTpBRjo2Mzo1QTo3QzpGNDo3MjowRDpDOTo2MzpDNTozQlxuICovXG5leHBvcnQgY29uc3QgR2xvYmFsU2lnbl9Sb290X0NBX1IzID0gYC0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLVxuIE1JSURYekNDQWtlZ0F3SUJBZ0lMQkFBQUFBQUJJVmhUQ0tJd0RRWUpLb1pJaHZjTkFRRUxCUUF3VERFZ01CNEdcbiBBMVVFQ3hNWFIyeHZZbUZzVTJsbmJpQlNiMjkwSUVOQklDMGdVak14RXpBUkJnTlZCQW9UQ2tkc2IySmhiRk5wXG4gWjI0eEV6QVJCZ05WQkFNVENrZHNiMkpoYkZOcFoyNHdIaGNOTURrd016RTRNVEF3TURBd1doY05Namt3TXpFNFxuIE1UQXdNREF3V2pCTU1TQXdIZ1lEVlFRTEV4ZEhiRzlpWVd4VGFXZHVJRkp2YjNRZ1EwRWdMU0JTTXpFVE1CRUdcbiBBMVVFQ2hNS1IyeHZZbUZzVTJsbmJqRVRNQkVHQTFVRUF4TUtSMnh2WW1Gc1UybG5iakNDQVNJd0RRWUpLb1pJXG4gaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFNd2xkcEI1Qm5naUZ2WEFnN2FFeWlpZS9RVjJFY1d0aUhMOFxuIFJnSkR4N0tLblFSZkpNc3VTK0ZnZ2tiaFVxc01nVWR3Yk4xazBldjFMS01QZ2owTUs2NlgxN1lVaGhCNXV6c1RcbiBnSGVNQ09GSjBtcGlMeDllK3BabzM0a25sVGlmQnRjK3ljc21XUTF6M3JESTZTWU9neFhHNzF1TDBnUmd5a21tXG4gS1BacE8vYkx5Q2lSNVoyS1lWYzNySFFVM0hUZ091NXlMeTZjKzlDN3YvVTlBT0VHTStpQ0s2NVRwam9XYzR6ZFxuIFFRNGdPc0MwcDZIcHNrK1FMakpnNlZmTHVRU1NhR2psT0NaZ2RiS2ZkLytSRk8rdUlFbjhyVUFWU05FQ01XRVpcbiBYcmlYNzYxM3QyU2Flcjlmd1JQdm0yTDdEV3pnVkdrV3FRUGFidW1EazNGMnhtbUZnaGNDQXdFQUFhTkNNRUF3XG4gRGdZRFZSMFBBUUgvQkFRREFnRUdNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdIUVlEVlIwT0JCWUVGSS93UzMrb1xuIExrVWtyazFRK21PYWk5N2kzUnU4TUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFCTFFOdkFVS3IreUF6djk1WlVcbiBSVW03bGdBSlFheXpFNGFHS0Fjenltdm1kTG02QUMydXBBclQ5Zkh4RDRxL2MyZEtnOGRFZTNqZ3IyNXNid01wXG4gampNNVJjT081TGxYYktyOEVwYnNVOFl0NUNSc3VaUmorOXhUYUdkV1BvTzR6elVodzhsby9zN2F3bE9xekpDS1xuIDZmQmRSb3lWM1hwWUtCb3ZIZDdOQURkQmorMUViZGRUS0pkKzgyY0VIaFhYaXBhMDA5NU1KNlJNRzNOemR2UVhcbiBtY0lmZWc3akxRaXRDaHdzL3p5clZRNFBrWDQyNjhOWFNiN2hMaTE4WUl2RFFWRVRJNTNPOXpKcmxBR29tZWNzXG4gTXg4Nk95WFNoa0RPT3l5R2VNbGhMeFM2N3R0VmI5K0U3Z1VKVGIwbzJITE8wMkpRWlI3cmtwZURNZG16dGNwSFxuIFdEOWZcbiAtLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tXG4gYDtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/mds.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/services/metadataService.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/services/metadataService.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseMetadataService: () => (/* binding */ BaseMetadataService),\n/* harmony export */   MetadataService: () => (/* binding */ MetadataService)\n/* harmony export */ });\n/* harmony import */ var _helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/validateCertificatePath.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/validateCertificatePath.js\");\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _helpers_convertAAGUIDToString_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../helpers/convertAAGUIDToString.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertAAGUIDToString.js\");\n/* harmony import */ var _settingsService_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./settingsService.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/settingsService.js\");\n/* harmony import */ var _helpers_logging_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../helpers/logging.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/logging.js\");\n/* harmony import */ var _helpers_convertPEMToBytes_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../helpers/convertPEMToBytes.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertPEMToBytes.js\");\n/* harmony import */ var _helpers_fetch_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../helpers/fetch.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/fetch.js\");\n/* harmony import */ var _metadata_parseJWT_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../metadata/parseJWT.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/parseJWT.js\");\n/* harmony import */ var _metadata_verifyJWT_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../metadata/verifyJWT.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/metadata/verifyJWT.js\");\n\n\n\n\n\n\n\n\n\nconst defaultURLMDS = 'https://mds.fidoalliance.org/'; // v3\nvar SERVICE_STATE;\n(function (SERVICE_STATE) {\n    SERVICE_STATE[SERVICE_STATE[\"DISABLED\"] = 0] = \"DISABLED\";\n    SERVICE_STATE[SERVICE_STATE[\"REFRESHING\"] = 1] = \"REFRESHING\";\n    SERVICE_STATE[SERVICE_STATE[\"READY\"] = 2] = \"READY\";\n})(SERVICE_STATE || (SERVICE_STATE = {}));\nconst log = (0,_helpers_logging_js__WEBPACK_IMPORTED_MODULE_4__.getLogger)('MetadataService');\n/**\n * A basic service for coordinating interactions with the FIDO Metadata Service. This includes BLOB\n * download and parsing, and on-demand requesting and caching of individual metadata statements.\n *\n * https://fidoalliance.org/metadata/\n */\nclass BaseMetadataService {\n    constructor() {\n        Object.defineProperty(this, \"mdsCache\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"statementCache\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: {}\n        });\n        Object.defineProperty(this, \"state\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: SERVICE_STATE.DISABLED\n        });\n        Object.defineProperty(this, \"verificationMode\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 'strict'\n        });\n    }\n    /**\n     * Prepare the service to handle remote MDS servers and/or cache local metadata statements.\n     *\n     * **Options:**\n     *\n     * @param opts.mdsServers An array of URLs to FIDO Alliance Metadata Service\n     * (version 3.0)-compatible servers. Defaults to the official FIDO MDS server\n     * @param opts.statements An array of local metadata statements\n     * @param opts.verificationMode How MetadataService will handle unregistered AAGUIDs. Defaults to\n     * `\"strict\"` which throws errors during registration response verification when an\n     * unregistered AAGUID is encountered. Set to `\"permissive\"` to allow registration by\n     * authenticators with unregistered AAGUIDs\n     */\n    async initialize(opts = {}) {\n        const { mdsServers = [defaultURLMDS], statements, verificationMode } = opts;\n        this.setState(SERVICE_STATE.REFRESHING);\n        // If metadata statements are provided, load them into the cache first\n        if (statements?.length) {\n            let statementsAdded = 0;\n            statements.forEach((statement) => {\n                // Only cache statements that are for FIDO2-compatible authenticators\n                if (statement.aaguid) {\n                    this.statementCache[statement.aaguid] = {\n                        entry: {\n                            metadataStatement: statement,\n                            statusReports: [],\n                            timeOfLastStatusChange: '1970-01-01',\n                        },\n                        url: '',\n                    };\n                    statementsAdded += 1;\n                }\n            });\n            log(`Cached ${statementsAdded} local statements`);\n        }\n        // If MDS servers are provided, then process them and add their statements to the cache\n        if (mdsServers?.length) {\n            // Get a current count so we know how many new statements we've added from MDS servers\n            const currentCacheCount = Object.keys(this.statementCache).length;\n            let numServers = mdsServers.length;\n            for (const url of mdsServers) {\n                try {\n                    await this.downloadBlob({\n                        url,\n                        no: 0,\n                        nextUpdate: new Date(0),\n                    });\n                }\n                catch (err) {\n                    // Notify of the error and move on\n                    log(`Could not download BLOB from ${url}:`, err);\n                    numServers -= 1;\n                }\n            }\n            // Calculate the difference to get the total number of new statements we successfully added\n            const newCacheCount = Object.keys(this.statementCache).length;\n            const cacheDiff = newCacheCount - currentCacheCount;\n            log(`Cached ${cacheDiff} statements from ${numServers} metadata server(s)`);\n        }\n        if (verificationMode) {\n            this.verificationMode = verificationMode;\n        }\n        this.setState(SERVICE_STATE.READY);\n    }\n    /**\n     * Get a metadata statement for a given AAGUID.\n     *\n     * This method will coordinate updating the cache as per the `nextUpdate` property in the initial\n     * BLOB download.\n     */\n    async getStatement(aaguid) {\n        if (this.state === SERVICE_STATE.DISABLED) {\n            return;\n        }\n        if (!aaguid) {\n            return;\n        }\n        if (aaguid instanceof Uint8Array) {\n            aaguid = (0,_helpers_convertAAGUIDToString_js__WEBPACK_IMPORTED_MODULE_2__.convertAAGUIDToString)(aaguid);\n        }\n        // If a cache refresh is in progress then pause this until the service is ready\n        await this.pauseUntilReady();\n        // Try to grab a cached statement\n        const cachedStatement = this.statementCache[aaguid];\n        if (!cachedStatement) {\n            if (this.verificationMode === 'strict') {\n                // FIDO conformance requires RP's to only support registered AAGUID's\n                throw new Error(`No metadata statement found for aaguid \"${aaguid}\"`);\n            }\n            // Allow registration verification to continue without using metadata\n            return;\n        }\n        // If the statement points to an MDS API, check the MDS' nextUpdate to see if we need to refresh\n        if (cachedStatement.url) {\n            const mds = this.mdsCache[cachedStatement.url];\n            const now = new Date();\n            if (now > mds.nextUpdate) {\n                try {\n                    this.setState(SERVICE_STATE.REFRESHING);\n                    await this.downloadBlob(mds);\n                }\n                finally {\n                    this.setState(SERVICE_STATE.READY);\n                }\n            }\n        }\n        const { entry } = cachedStatement;\n        // Check to see if the this aaguid has a status report with a \"compromised\" status\n        for (const report of entry.statusReports) {\n            const { status } = report;\n            if (status === 'USER_VERIFICATION_BYPASS' ||\n                status === 'ATTESTATION_KEY_COMPROMISE' ||\n                status === 'USER_KEY_REMOTE_COMPROMISE' ||\n                status === 'USER_KEY_PHYSICAL_COMPROMISE') {\n                throw new Error(`Detected compromised aaguid \"${aaguid}\"`);\n            }\n        }\n        return entry.metadataStatement;\n    }\n    /**\n     * Download and process the latest BLOB from MDS\n     */\n    async downloadBlob(mds) {\n        const { url, no } = mds;\n        // Get latest \"BLOB\" (FIDO's terminology, not mine)\n        const resp = await (0,_helpers_fetch_js__WEBPACK_IMPORTED_MODULE_6__.fetch)(url);\n        const data = await resp.text();\n        // Parse the JWT\n        const parsedJWT = (0,_metadata_parseJWT_js__WEBPACK_IMPORTED_MODULE_7__.parseJWT)(data);\n        const header = parsedJWT[0];\n        const payload = parsedJWT[1];\n        if (payload.no <= no) {\n            // From FIDO MDS docs: \"also ignore the file if its number (no) is less or equal to the\n            // number of the last BLOB cached locally.\"\n            throw new Error(`Latest BLOB no. \"${payload.no}\" is not greater than previous ${no}`);\n        }\n        const headerCertsPEM = header.x5c.map(_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_1__.convertCertBufferToPEM);\n        try {\n            // Validate the certificate chain\n            const rootCerts = _settingsService_js__WEBPACK_IMPORTED_MODULE_3__.SettingsService.getRootCertificates({\n                identifier: 'mds',\n            });\n            await (0,_helpers_validateCertificatePath_js__WEBPACK_IMPORTED_MODULE_0__.validateCertificatePath)(headerCertsPEM, rootCerts);\n        }\n        catch (error) {\n            const _error = error;\n            // From FIDO MDS docs: \"ignore the file if the chain cannot be verified or if one of the\n            // chain certificates is revoked\"\n            throw new Error(`BLOB certificate path could not be validated: ${_error.message}`);\n        }\n        // Verify the BLOB JWT signature\n        const leafCert = headerCertsPEM[0];\n        const verified = await (0,_metadata_verifyJWT_js__WEBPACK_IMPORTED_MODULE_8__.verifyJWT)(data, (0,_helpers_convertPEMToBytes_js__WEBPACK_IMPORTED_MODULE_5__.convertPEMToBytes)(leafCert));\n        if (!verified) {\n            // From FIDO MDS docs: \"The FIDO Server SHOULD ignore the file if the signature is invalid.\"\n            throw new Error('BLOB signature could not be verified');\n        }\n        // Cache statements for FIDO2 devices\n        for (const entry of payload.entries) {\n            // Only cache entries with an `aaguid`\n            if (entry.aaguid) {\n                this.statementCache[entry.aaguid] = { entry, url };\n            }\n        }\n        // Remember info about the server so we can refresh later\n        const [year, month, day] = payload.nextUpdate.split('-');\n        this.mdsCache[url] = {\n            ...mds,\n            // Store the payload `no` to make sure we're getting the next BLOB in the sequence\n            no: payload.no,\n            // Convert the nextUpdate property into a Date so we can determine when to re-download\n            nextUpdate: new Date(parseInt(year, 10), \n            // Months need to be zero-indexed\n            parseInt(month, 10) - 1, parseInt(day, 10)),\n        };\n    }\n    /**\n     * A helper method to pause execution until the service is ready\n     */\n    pauseUntilReady() {\n        if (this.state === SERVICE_STATE.READY) {\n            return new Promise((resolve) => {\n                resolve();\n            });\n        }\n        // State isn't ready, so set up polling\n        const readyPromise = new Promise((resolve, reject) => {\n            const totalTimeoutMS = 70000;\n            const intervalMS = 100;\n            let iterations = totalTimeoutMS / intervalMS;\n            // Check service state every `intervalMS` milliseconds\n            const intervalID = globalThis.setInterval(() => {\n                if (iterations < 1) {\n                    clearInterval(intervalID);\n                    reject(`State did not become ready in ${totalTimeoutMS / 1000} seconds`);\n                }\n                else if (this.state === SERVICE_STATE.READY) {\n                    clearInterval(intervalID);\n                    resolve();\n                }\n                iterations -= 1;\n            }, intervalMS);\n        });\n        return readyPromise;\n    }\n    /**\n     * Report service status on change\n     */\n    setState(newState) {\n        this.state = newState;\n        if (newState === SERVICE_STATE.DISABLED) {\n            log('MetadataService is DISABLED');\n        }\n        else if (newState === SERVICE_STATE.REFRESHING) {\n            log('MetadataService is REFRESHING');\n        }\n        else if (newState === SERVICE_STATE.READY) {\n            log('MetadataService is READY');\n        }\n    }\n}\n// Export a service singleton\nconst MetadataService = new BaseMetadataService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vc2VydmljZXMvbWV0YWRhdGFTZXJ2aWNlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQWdGO0FBQ0Y7QUFDRjtBQUNyQjtBQUNMO0FBQ2tCO0FBQ3hCO0FBQ087QUFDRTtBQUNyRCx1REFBdUQ7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsc0NBQXNDO0FBQ3ZDLFlBQVksOERBQVM7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QixnQkFBZ0IsNkRBQTZEO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYiwwQkFBMEIsaUJBQWlCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsSUFBSTtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsV0FBVyxrQkFBa0IsWUFBWTtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHdGQUFxQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLE9BQU87QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLFFBQVE7QUFDeEI7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFLE9BQU87QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixVQUFVO0FBQzFCO0FBQ0EsMkJBQTJCLHdEQUFLO0FBQ2hDO0FBQ0E7QUFDQSwwQkFBMEIsK0RBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxXQUFXLGlDQUFpQyxHQUFHO0FBQy9GO0FBQ0EsOENBQThDLHNGQUFzQjtBQUNwRTtBQUNBO0FBQ0EsOEJBQThCLGdFQUFlO0FBQzdDO0FBQ0EsYUFBYTtBQUNiLGtCQUFrQiw0RkFBdUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSxlQUFlO0FBQzVGO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixpRUFBUyxPQUFPLGdGQUFpQjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCx1QkFBdUI7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxzZXJ2ZXJcXGVzbVxcc2VydmljZXNcXG1ldGFkYXRhU2VydmljZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2YWxpZGF0ZUNlcnRpZmljYXRlUGF0aCB9IGZyb20gJy4uL2hlbHBlcnMvdmFsaWRhdGVDZXJ0aWZpY2F0ZVBhdGguanMnO1xuaW1wb3J0IHsgY29udmVydENlcnRCdWZmZXJUb1BFTSB9IGZyb20gJy4uL2hlbHBlcnMvY29udmVydENlcnRCdWZmZXJUb1BFTS5qcyc7XG5pbXBvcnQgeyBjb252ZXJ0QUFHVUlEVG9TdHJpbmcgfSBmcm9tICcuLi9oZWxwZXJzL2NvbnZlcnRBQUdVSURUb1N0cmluZy5qcyc7XG5pbXBvcnQgeyBTZXR0aW5nc1NlcnZpY2UgfSBmcm9tICcuL3NldHRpbmdzU2VydmljZS5qcyc7XG5pbXBvcnQgeyBnZXRMb2dnZXIgfSBmcm9tICcuLi9oZWxwZXJzL2xvZ2dpbmcuanMnO1xuaW1wb3J0IHsgY29udmVydFBFTVRvQnl0ZXMgfSBmcm9tICcuLi9oZWxwZXJzL2NvbnZlcnRQRU1Ub0J5dGVzLmpzJztcbmltcG9ydCB7IGZldGNoIH0gZnJvbSAnLi4vaGVscGVycy9mZXRjaC5qcyc7XG5pbXBvcnQgeyBwYXJzZUpXVCB9IGZyb20gJy4uL21ldGFkYXRhL3BhcnNlSldULmpzJztcbmltcG9ydCB7IHZlcmlmeUpXVCB9IGZyb20gJy4uL21ldGFkYXRhL3ZlcmlmeUpXVC5qcyc7XG5jb25zdCBkZWZhdWx0VVJMTURTID0gJ2h0dHBzOi8vbWRzLmZpZG9hbGxpYW5jZS5vcmcvJzsgLy8gdjNcbnZhciBTRVJWSUNFX1NUQVRFO1xuKGZ1bmN0aW9uIChTRVJWSUNFX1NUQVRFKSB7XG4gICAgU0VSVklDRV9TVEFURVtTRVJWSUNFX1NUQVRFW1wiRElTQUJMRURcIl0gPSAwXSA9IFwiRElTQUJMRURcIjtcbiAgICBTRVJWSUNFX1NUQVRFW1NFUlZJQ0VfU1RBVEVbXCJSRUZSRVNISU5HXCJdID0gMV0gPSBcIlJFRlJFU0hJTkdcIjtcbiAgICBTRVJWSUNFX1NUQVRFW1NFUlZJQ0VfU1RBVEVbXCJSRUFEWVwiXSA9IDJdID0gXCJSRUFEWVwiO1xufSkoU0VSVklDRV9TVEFURSB8fCAoU0VSVklDRV9TVEFURSA9IHt9KSk7XG5jb25zdCBsb2cgPSBnZXRMb2dnZXIoJ01ldGFkYXRhU2VydmljZScpO1xuLyoqXG4gKiBBIGJhc2ljIHNlcnZpY2UgZm9yIGNvb3JkaW5hdGluZyBpbnRlcmFjdGlvbnMgd2l0aCB0aGUgRklETyBNZXRhZGF0YSBTZXJ2aWNlLiBUaGlzIGluY2x1ZGVzIEJMT0JcbiAqIGRvd25sb2FkIGFuZCBwYXJzaW5nLCBhbmQgb24tZGVtYW5kIHJlcXVlc3RpbmcgYW5kIGNhY2hpbmcgb2YgaW5kaXZpZHVhbCBtZXRhZGF0YSBzdGF0ZW1lbnRzLlxuICpcbiAqIGh0dHBzOi8vZmlkb2FsbGlhbmNlLm9yZy9tZXRhZGF0YS9cbiAqL1xuZXhwb3J0IGNsYXNzIEJhc2VNZXRhZGF0YVNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJtZHNDYWNoZVwiLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZToge31cbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0YXRlbWVudENhY2hlXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB7fVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwic3RhdGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IFNFUlZJQ0VfU1RBVEUuRElTQUJMRURcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInZlcmlmaWNhdGlvbk1vZGVcIiwge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6ICdzdHJpY3QnXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcmVwYXJlIHRoZSBzZXJ2aWNlIHRvIGhhbmRsZSByZW1vdGUgTURTIHNlcnZlcnMgYW5kL29yIGNhY2hlIGxvY2FsIG1ldGFkYXRhIHN0YXRlbWVudHMuXG4gICAgICpcbiAgICAgKiAqKk9wdGlvbnM6KipcbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcHRzLm1kc1NlcnZlcnMgQW4gYXJyYXkgb2YgVVJMcyB0byBGSURPIEFsbGlhbmNlIE1ldGFkYXRhIFNlcnZpY2VcbiAgICAgKiAodmVyc2lvbiAzLjApLWNvbXBhdGlibGUgc2VydmVycy4gRGVmYXVsdHMgdG8gdGhlIG9mZmljaWFsIEZJRE8gTURTIHNlcnZlclxuICAgICAqIEBwYXJhbSBvcHRzLnN0YXRlbWVudHMgQW4gYXJyYXkgb2YgbG9jYWwgbWV0YWRhdGEgc3RhdGVtZW50c1xuICAgICAqIEBwYXJhbSBvcHRzLnZlcmlmaWNhdGlvbk1vZGUgSG93IE1ldGFkYXRhU2VydmljZSB3aWxsIGhhbmRsZSB1bnJlZ2lzdGVyZWQgQUFHVUlEcy4gRGVmYXVsdHMgdG9cbiAgICAgKiBgXCJzdHJpY3RcImAgd2hpY2ggdGhyb3dzIGVycm9ycyBkdXJpbmcgcmVnaXN0cmF0aW9uIHJlc3BvbnNlIHZlcmlmaWNhdGlvbiB3aGVuIGFuXG4gICAgICogdW5yZWdpc3RlcmVkIEFBR1VJRCBpcyBlbmNvdW50ZXJlZC4gU2V0IHRvIGBcInBlcm1pc3NpdmVcImAgdG8gYWxsb3cgcmVnaXN0cmF0aW9uIGJ5XG4gICAgICogYXV0aGVudGljYXRvcnMgd2l0aCB1bnJlZ2lzdGVyZWQgQUFHVUlEc1xuICAgICAqL1xuICAgIGFzeW5jIGluaXRpYWxpemUob3B0cyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IHsgbWRzU2VydmVycyA9IFtkZWZhdWx0VVJMTURTXSwgc3RhdGVtZW50cywgdmVyaWZpY2F0aW9uTW9kZSB9ID0gb3B0cztcbiAgICAgICAgdGhpcy5zZXRTdGF0ZShTRVJWSUNFX1NUQVRFLlJFRlJFU0hJTkcpO1xuICAgICAgICAvLyBJZiBtZXRhZGF0YSBzdGF0ZW1lbnRzIGFyZSBwcm92aWRlZCwgbG9hZCB0aGVtIGludG8gdGhlIGNhY2hlIGZpcnN0XG4gICAgICAgIGlmIChzdGF0ZW1lbnRzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxldCBzdGF0ZW1lbnRzQWRkZWQgPSAwO1xuICAgICAgICAgICAgc3RhdGVtZW50cy5mb3JFYWNoKChzdGF0ZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IGNhY2hlIHN0YXRlbWVudHMgdGhhdCBhcmUgZm9yIEZJRE8yLWNvbXBhdGlibGUgYXV0aGVudGljYXRvcnNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdGVtZW50LmFhZ3VpZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlbWVudENhY2hlW3N0YXRlbWVudC5hYWd1aWRdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW50cnk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YVN0YXRlbWVudDogc3RhdGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1JlcG9ydHM6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVPZkxhc3RTdGF0dXNDaGFuZ2U6ICcxOTcwLTAxLTAxJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcnLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZW1lbnRzQWRkZWQgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxvZyhgQ2FjaGVkICR7c3RhdGVtZW50c0FkZGVkfSBsb2NhbCBzdGF0ZW1lbnRzYCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgTURTIHNlcnZlcnMgYXJlIHByb3ZpZGVkLCB0aGVuIHByb2Nlc3MgdGhlbSBhbmQgYWRkIHRoZWlyIHN0YXRlbWVudHMgdG8gdGhlIGNhY2hlXG4gICAgICAgIGlmIChtZHNTZXJ2ZXJzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIEdldCBhIGN1cnJlbnQgY291bnQgc28gd2Uga25vdyBob3cgbWFueSBuZXcgc3RhdGVtZW50cyB3ZSd2ZSBhZGRlZCBmcm9tIE1EUyBzZXJ2ZXJzXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Q2FjaGVDb3VudCA9IE9iamVjdC5rZXlzKHRoaXMuc3RhdGVtZW50Q2FjaGUpLmxlbmd0aDtcbiAgICAgICAgICAgIGxldCBudW1TZXJ2ZXJzID0gbWRzU2VydmVycy5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHVybCBvZiBtZHNTZXJ2ZXJzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kb3dubG9hZEJsb2Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgbm86IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0VXBkYXRlOiBuZXcgRGF0ZSgwKSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm90aWZ5IG9mIHRoZSBlcnJvciBhbmQgbW92ZSBvblxuICAgICAgICAgICAgICAgICAgICBsb2coYENvdWxkIG5vdCBkb3dubG9hZCBCTE9CIGZyb20gJHt1cmx9OmAsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIG51bVNlcnZlcnMgLT0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGRpZmZlcmVuY2UgdG8gZ2V0IHRoZSB0b3RhbCBudW1iZXIgb2YgbmV3IHN0YXRlbWVudHMgd2Ugc3VjY2Vzc2Z1bGx5IGFkZGVkXG4gICAgICAgICAgICBjb25zdCBuZXdDYWNoZUNvdW50ID0gT2JqZWN0LmtleXModGhpcy5zdGF0ZW1lbnRDYWNoZSkubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3QgY2FjaGVEaWZmID0gbmV3Q2FjaGVDb3VudCAtIGN1cnJlbnRDYWNoZUNvdW50O1xuICAgICAgICAgICAgbG9nKGBDYWNoZWQgJHtjYWNoZURpZmZ9IHN0YXRlbWVudHMgZnJvbSAke251bVNlcnZlcnN9IG1ldGFkYXRhIHNlcnZlcihzKWApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2ZXJpZmljYXRpb25Nb2RlKSB7XG4gICAgICAgICAgICB0aGlzLnZlcmlmaWNhdGlvbk1vZGUgPSB2ZXJpZmljYXRpb25Nb2RlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoU0VSVklDRV9TVEFURS5SRUFEWSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBhIG1ldGFkYXRhIHN0YXRlbWVudCBmb3IgYSBnaXZlbiBBQUdVSUQuXG4gICAgICpcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIGNvb3JkaW5hdGUgdXBkYXRpbmcgdGhlIGNhY2hlIGFzIHBlciB0aGUgYG5leHRVcGRhdGVgIHByb3BlcnR5IGluIHRoZSBpbml0aWFsXG4gICAgICogQkxPQiBkb3dubG9hZC5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRTdGF0ZW1lbnQoYWFndWlkKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBTRVJWSUNFX1NUQVRFLkRJU0FCTEVEKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFhYWd1aWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWFndWlkIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICAgICAgYWFndWlkID0gY29udmVydEFBR1VJRFRvU3RyaW5nKGFhZ3VpZCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgYSBjYWNoZSByZWZyZXNoIGlzIGluIHByb2dyZXNzIHRoZW4gcGF1c2UgdGhpcyB1bnRpbCB0aGUgc2VydmljZSBpcyByZWFkeVxuICAgICAgICBhd2FpdCB0aGlzLnBhdXNlVW50aWxSZWFkeSgpO1xuICAgICAgICAvLyBUcnkgdG8gZ3JhYiBhIGNhY2hlZCBzdGF0ZW1lbnRcbiAgICAgICAgY29uc3QgY2FjaGVkU3RhdGVtZW50ID0gdGhpcy5zdGF0ZW1lbnRDYWNoZVthYWd1aWRdO1xuICAgICAgICBpZiAoIWNhY2hlZFN0YXRlbWVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudmVyaWZpY2F0aW9uTW9kZSA9PT0gJ3N0cmljdCcpIHtcbiAgICAgICAgICAgICAgICAvLyBGSURPIGNvbmZvcm1hbmNlIHJlcXVpcmVzIFJQJ3MgdG8gb25seSBzdXBwb3J0IHJlZ2lzdGVyZWQgQUFHVUlEJ3NcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIG1ldGFkYXRhIHN0YXRlbWVudCBmb3VuZCBmb3IgYWFndWlkIFwiJHthYWd1aWR9XCJgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEFsbG93IHJlZ2lzdHJhdGlvbiB2ZXJpZmljYXRpb24gdG8gY29udGludWUgd2l0aG91dCB1c2luZyBtZXRhZGF0YVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSBzdGF0ZW1lbnQgcG9pbnRzIHRvIGFuIE1EUyBBUEksIGNoZWNrIHRoZSBNRFMnIG5leHRVcGRhdGUgdG8gc2VlIGlmIHdlIG5lZWQgdG8gcmVmcmVzaFxuICAgICAgICBpZiAoY2FjaGVkU3RhdGVtZW50LnVybCkge1xuICAgICAgICAgICAgY29uc3QgbWRzID0gdGhpcy5tZHNDYWNoZVtjYWNoZWRTdGF0ZW1lbnQudXJsXTtcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBpZiAobm93ID4gbWRzLm5leHRVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKFNFUlZJQ0VfU1RBVEUuUkVGUkVTSElORyk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZG93bmxvYWRCbG9iKG1kcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKFNFUlZJQ0VfU1RBVEUuUkVBRFkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGVudHJ5IH0gPSBjYWNoZWRTdGF0ZW1lbnQ7XG4gICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGUgdGhpcyBhYWd1aWQgaGFzIGEgc3RhdHVzIHJlcG9ydCB3aXRoIGEgXCJjb21wcm9taXNlZFwiIHN0YXR1c1xuICAgICAgICBmb3IgKGNvbnN0IHJlcG9ydCBvZiBlbnRyeS5zdGF0dXNSZXBvcnRzKSB7XG4gICAgICAgICAgICBjb25zdCB7IHN0YXR1cyB9ID0gcmVwb3J0O1xuICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gJ1VTRVJfVkVSSUZJQ0FUSU9OX0JZUEFTUycgfHxcbiAgICAgICAgICAgICAgICBzdGF0dXMgPT09ICdBVFRFU1RBVElPTl9LRVlfQ09NUFJPTUlTRScgfHxcbiAgICAgICAgICAgICAgICBzdGF0dXMgPT09ICdVU0VSX0tFWV9SRU1PVEVfQ09NUFJPTUlTRScgfHxcbiAgICAgICAgICAgICAgICBzdGF0dXMgPT09ICdVU0VSX0tFWV9QSFlTSUNBTF9DT01QUk9NSVNFJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRGV0ZWN0ZWQgY29tcHJvbWlzZWQgYWFndWlkIFwiJHthYWd1aWR9XCJgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZW50cnkubWV0YWRhdGFTdGF0ZW1lbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERvd25sb2FkIGFuZCBwcm9jZXNzIHRoZSBsYXRlc3QgQkxPQiBmcm9tIE1EU1xuICAgICAqL1xuICAgIGFzeW5jIGRvd25sb2FkQmxvYihtZHMpIHtcbiAgICAgICAgY29uc3QgeyB1cmwsIG5vIH0gPSBtZHM7XG4gICAgICAgIC8vIEdldCBsYXRlc3QgXCJCTE9CXCIgKEZJRE8ncyB0ZXJtaW5vbG9neSwgbm90IG1pbmUpXG4gICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcC50ZXh0KCk7XG4gICAgICAgIC8vIFBhcnNlIHRoZSBKV1RcbiAgICAgICAgY29uc3QgcGFyc2VkSldUID0gcGFyc2VKV1QoZGF0YSk7XG4gICAgICAgIGNvbnN0IGhlYWRlciA9IHBhcnNlZEpXVFswXTtcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IHBhcnNlZEpXVFsxXTtcbiAgICAgICAgaWYgKHBheWxvYWQubm8gPD0gbm8pIHtcbiAgICAgICAgICAgIC8vIEZyb20gRklETyBNRFMgZG9jczogXCJhbHNvIGlnbm9yZSB0aGUgZmlsZSBpZiBpdHMgbnVtYmVyIChubykgaXMgbGVzcyBvciBlcXVhbCB0byB0aGVcbiAgICAgICAgICAgIC8vIG51bWJlciBvZiB0aGUgbGFzdCBCTE9CIGNhY2hlZCBsb2NhbGx5LlwiXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYExhdGVzdCBCTE9CIG5vLiBcIiR7cGF5bG9hZC5ub31cIiBpcyBub3QgZ3JlYXRlciB0aGFuIHByZXZpb3VzICR7bm99YCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGVhZGVyQ2VydHNQRU0gPSBoZWFkZXIueDVjLm1hcChjb252ZXJ0Q2VydEJ1ZmZlclRvUEVNKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHRoZSBjZXJ0aWZpY2F0ZSBjaGFpblxuICAgICAgICAgICAgY29uc3Qgcm9vdENlcnRzID0gU2V0dGluZ3NTZXJ2aWNlLmdldFJvb3RDZXJ0aWZpY2F0ZXMoe1xuICAgICAgICAgICAgICAgIGlkZW50aWZpZXI6ICdtZHMnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBhd2FpdCB2YWxpZGF0ZUNlcnRpZmljYXRlUGF0aChoZWFkZXJDZXJ0c1BFTSwgcm9vdENlcnRzKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnN0IF9lcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgLy8gRnJvbSBGSURPIE1EUyBkb2NzOiBcImlnbm9yZSB0aGUgZmlsZSBpZiB0aGUgY2hhaW4gY2Fubm90IGJlIHZlcmlmaWVkIG9yIGlmIG9uZSBvZiB0aGVcbiAgICAgICAgICAgIC8vIGNoYWluIGNlcnRpZmljYXRlcyBpcyByZXZva2VkXCJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQkxPQiBjZXJ0aWZpY2F0ZSBwYXRoIGNvdWxkIG5vdCBiZSB2YWxpZGF0ZWQ6ICR7X2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVmVyaWZ5IHRoZSBCTE9CIEpXVCBzaWduYXR1cmVcbiAgICAgICAgY29uc3QgbGVhZkNlcnQgPSBoZWFkZXJDZXJ0c1BFTVswXTtcbiAgICAgICAgY29uc3QgdmVyaWZpZWQgPSBhd2FpdCB2ZXJpZnlKV1QoZGF0YSwgY29udmVydFBFTVRvQnl0ZXMobGVhZkNlcnQpKTtcbiAgICAgICAgaWYgKCF2ZXJpZmllZCkge1xuICAgICAgICAgICAgLy8gRnJvbSBGSURPIE1EUyBkb2NzOiBcIlRoZSBGSURPIFNlcnZlciBTSE9VTEQgaWdub3JlIHRoZSBmaWxlIGlmIHRoZSBzaWduYXR1cmUgaXMgaW52YWxpZC5cIlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCTE9CIHNpZ25hdHVyZSBjb3VsZCBub3QgYmUgdmVyaWZpZWQnKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDYWNoZSBzdGF0ZW1lbnRzIGZvciBGSURPMiBkZXZpY2VzXG4gICAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgcGF5bG9hZC5lbnRyaWVzKSB7XG4gICAgICAgICAgICAvLyBPbmx5IGNhY2hlIGVudHJpZXMgd2l0aCBhbiBgYWFndWlkYFxuICAgICAgICAgICAgaWYgKGVudHJ5LmFhZ3VpZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVtZW50Q2FjaGVbZW50cnkuYWFndWlkXSA9IHsgZW50cnksIHVybCB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIFJlbWVtYmVyIGluZm8gYWJvdXQgdGhlIHNlcnZlciBzbyB3ZSBjYW4gcmVmcmVzaCBsYXRlclxuICAgICAgICBjb25zdCBbeWVhciwgbW9udGgsIGRheV0gPSBwYXlsb2FkLm5leHRVcGRhdGUuc3BsaXQoJy0nKTtcbiAgICAgICAgdGhpcy5tZHNDYWNoZVt1cmxdID0ge1xuICAgICAgICAgICAgLi4ubWRzLFxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIHBheWxvYWQgYG5vYCB0byBtYWtlIHN1cmUgd2UncmUgZ2V0dGluZyB0aGUgbmV4dCBCTE9CIGluIHRoZSBzZXF1ZW5jZVxuICAgICAgICAgICAgbm86IHBheWxvYWQubm8sXG4gICAgICAgICAgICAvLyBDb252ZXJ0IHRoZSBuZXh0VXBkYXRlIHByb3BlcnR5IGludG8gYSBEYXRlIHNvIHdlIGNhbiBkZXRlcm1pbmUgd2hlbiB0byByZS1kb3dubG9hZFxuICAgICAgICAgICAgbmV4dFVwZGF0ZTogbmV3IERhdGUocGFyc2VJbnQoeWVhciwgMTApLCBcbiAgICAgICAgICAgIC8vIE1vbnRocyBuZWVkIHRvIGJlIHplcm8taW5kZXhlZFxuICAgICAgICAgICAgcGFyc2VJbnQobW9udGgsIDEwKSAtIDEsIHBhcnNlSW50KGRheSwgMTApKSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSBoZWxwZXIgbWV0aG9kIHRvIHBhdXNlIGV4ZWN1dGlvbiB1bnRpbCB0aGUgc2VydmljZSBpcyByZWFkeVxuICAgICAqL1xuICAgIHBhdXNlVW50aWxSZWFkeSgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFNFUlZJQ0VfU1RBVEUuUkVBRFkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIFN0YXRlIGlzbid0IHJlYWR5LCBzbyBzZXQgdXAgcG9sbGluZ1xuICAgICAgICBjb25zdCByZWFkeVByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0b3RhbFRpbWVvdXRNUyA9IDcwMDAwO1xuICAgICAgICAgICAgY29uc3QgaW50ZXJ2YWxNUyA9IDEwMDtcbiAgICAgICAgICAgIGxldCBpdGVyYXRpb25zID0gdG90YWxUaW1lb3V0TVMgLyBpbnRlcnZhbE1TO1xuICAgICAgICAgICAgLy8gQ2hlY2sgc2VydmljZSBzdGF0ZSBldmVyeSBgaW50ZXJ2YWxNU2AgbWlsbGlzZWNvbmRzXG4gICAgICAgICAgICBjb25zdCBpbnRlcnZhbElEID0gZ2xvYmFsVGhpcy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZXJhdGlvbnMgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJRCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChgU3RhdGUgZGlkIG5vdCBiZWNvbWUgcmVhZHkgaW4gJHt0b3RhbFRpbWVvdXRNUyAvIDEwMDB9IHNlY29uZHNgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5zdGF0ZSA9PT0gU0VSVklDRV9TVEFURS5SRUFEWSkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsSUQpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnMgLT0gMTtcbiAgICAgICAgICAgIH0sIGludGVydmFsTVMpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlYWR5UHJvbWlzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVwb3J0IHNlcnZpY2Ugc3RhdHVzIG9uIGNoYW5nZVxuICAgICAqL1xuICAgIHNldFN0YXRlKG5ld1N0YXRlKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBuZXdTdGF0ZTtcbiAgICAgICAgaWYgKG5ld1N0YXRlID09PSBTRVJWSUNFX1NUQVRFLkRJU0FCTEVEKSB7XG4gICAgICAgICAgICBsb2coJ01ldGFkYXRhU2VydmljZSBpcyBESVNBQkxFRCcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5ld1N0YXRlID09PSBTRVJWSUNFX1NUQVRFLlJFRlJFU0hJTkcpIHtcbiAgICAgICAgICAgIGxvZygnTWV0YWRhdGFTZXJ2aWNlIGlzIFJFRlJFU0hJTkcnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuZXdTdGF0ZSA9PT0gU0VSVklDRV9TVEFURS5SRUFEWSkge1xuICAgICAgICAgICAgbG9nKCdNZXRhZGF0YVNlcnZpY2UgaXMgUkVBRFknKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8vIEV4cG9ydCBhIHNlcnZpY2Ugc2luZ2xldG9uXG5leHBvcnQgY29uc3QgTWV0YWRhdGFTZXJ2aWNlID0gbmV3IEJhc2VNZXRhZGF0YVNlcnZpY2UoKTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/services/metadataService.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@simplewebauthn/server/esm/services/settingsService.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@simplewebauthn/server/esm/services/settingsService.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SettingsService: () => (/* binding */ SettingsService)\n/* harmony export */ });\n/* harmony import */ var _helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helpers/convertCertBufferToPEM.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/helpers/convertCertBufferToPEM.js\");\n/* harmony import */ var _defaultRootCerts_android_safetynet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./defaultRootCerts/android-safetynet.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/android-safetynet.js\");\n/* harmony import */ var _defaultRootCerts_android_key_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./defaultRootCerts/android-key.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/android-key.js\");\n/* harmony import */ var _defaultRootCerts_apple_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./defaultRootCerts/apple.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/apple.js\");\n/* harmony import */ var _defaultRootCerts_mds_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./defaultRootCerts/mds.js */ \"(rsc)/./node_modules/@simplewebauthn/server/esm/services/defaultRootCerts/mds.js\");\n\n\n\n\n\nclass BaseSettingsService {\n    constructor() {\n        // Certificates are stored as PEM-formatted strings\n        Object.defineProperty(this, \"pemCertificates\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        this.pemCertificates = new Map();\n    }\n    /**\n     * Set potential root certificates for attestation formats that use them. Root certs will be tried\n     * one-by-one when validating a certificate path.\n     *\n     * Certificates can be specified as a raw `Buffer`, or as a PEM-formatted string. If a\n     * `Buffer` is passed in it will be converted to PEM format.\n     */\n    setRootCertificates(opts) {\n        const { identifier, certificates } = opts;\n        const newCertificates = [];\n        for (const cert of certificates) {\n            if (cert instanceof Uint8Array) {\n                newCertificates.push((0,_helpers_convertCertBufferToPEM_js__WEBPACK_IMPORTED_MODULE_0__.convertCertBufferToPEM)(cert));\n            }\n            else {\n                newCertificates.push(cert);\n            }\n        }\n        this.pemCertificates.set(identifier, newCertificates);\n    }\n    /**\n     * Get any registered root certificates for the specified attestation format\n     */\n    getRootCertificates(opts) {\n        const { identifier } = opts;\n        return this.pemCertificates.get(identifier) ?? [];\n    }\n}\nconst SettingsService = new BaseSettingsService();\n// Initialize default certificates\nSettingsService.setRootCertificates({\n    identifier: 'android-key',\n    certificates: [\n        _defaultRootCerts_android_key_js__WEBPACK_IMPORTED_MODULE_2__.Google_Hardware_Attestation_Root_1,\n        _defaultRootCerts_android_key_js__WEBPACK_IMPORTED_MODULE_2__.Google_Hardware_Attestation_Root_2,\n    ],\n});\nSettingsService.setRootCertificates({\n    identifier: 'android-safetynet',\n    certificates: [_defaultRootCerts_android_safetynet_js__WEBPACK_IMPORTED_MODULE_1__.GlobalSign_Root_CA],\n});\nSettingsService.setRootCertificates({\n    identifier: 'apple',\n    certificates: [_defaultRootCerts_apple_js__WEBPACK_IMPORTED_MODULE_3__.Apple_WebAuthn_Root_CA],\n});\nSettingsService.setRootCertificates({\n    identifier: 'mds',\n    certificates: [_defaultRootCerts_mds_js__WEBPACK_IMPORTED_MODULE_4__.GlobalSign_Root_CA_R3],\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL3NlcnZlci9lc20vc2VydmljZXMvc2V0dGluZ3NTZXJ2aWNlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUE4RTtBQUNEO0FBQytDO0FBQ3ZEO0FBQ0g7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiwyQkFBMkI7QUFDM0M7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDBGQUFzQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGFBQWE7QUFDN0I7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsZ0dBQWtDO0FBQzFDLFFBQVEsZ0dBQWtDO0FBQzFDO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxtQkFBbUIsc0ZBQWtCO0FBQ3JDLENBQUM7QUFDRDtBQUNBO0FBQ0EsbUJBQW1CLDhFQUFzQjtBQUN6QyxDQUFDO0FBQ0Q7QUFDQTtBQUNBLG1CQUFtQiwyRUFBcUI7QUFDeEMsQ0FBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxkeVxcRGVza3RvcFxcZ2l0aHViY29waWxvdFxcTlVTLUlTUy1BSS1TRExDLUdyb3VwMS1Ub0RvQXBwXFxub2RlX21vZHVsZXNcXEBzaW1wbGV3ZWJhdXRoblxcc2VydmVyXFxlc21cXHNlcnZpY2VzXFxzZXR0aW5nc1NlcnZpY2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29udmVydENlcnRCdWZmZXJUb1BFTSB9IGZyb20gJy4uL2hlbHBlcnMvY29udmVydENlcnRCdWZmZXJUb1BFTS5qcyc7XG5pbXBvcnQgeyBHbG9iYWxTaWduX1Jvb3RfQ0EgfSBmcm9tICcuL2RlZmF1bHRSb290Q2VydHMvYW5kcm9pZC1zYWZldHluZXQuanMnO1xuaW1wb3J0IHsgR29vZ2xlX0hhcmR3YXJlX0F0dGVzdGF0aW9uX1Jvb3RfMSwgR29vZ2xlX0hhcmR3YXJlX0F0dGVzdGF0aW9uX1Jvb3RfMiwgfSBmcm9tICcuL2RlZmF1bHRSb290Q2VydHMvYW5kcm9pZC1rZXkuanMnO1xuaW1wb3J0IHsgQXBwbGVfV2ViQXV0aG5fUm9vdF9DQSB9IGZyb20gJy4vZGVmYXVsdFJvb3RDZXJ0cy9hcHBsZS5qcyc7XG5pbXBvcnQgeyBHbG9iYWxTaWduX1Jvb3RfQ0FfUjMgfSBmcm9tICcuL2RlZmF1bHRSb290Q2VydHMvbWRzLmpzJztcbmNsYXNzIEJhc2VTZXR0aW5nc1NlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBDZXJ0aWZpY2F0ZXMgYXJlIHN0b3JlZCBhcyBQRU0tZm9ybWF0dGVkIHN0cmluZ3NcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwicGVtQ2VydGlmaWNhdGVzXCIsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiB2b2lkIDBcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucGVtQ2VydGlmaWNhdGVzID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgcG90ZW50aWFsIHJvb3QgY2VydGlmaWNhdGVzIGZvciBhdHRlc3RhdGlvbiBmb3JtYXRzIHRoYXQgdXNlIHRoZW0uIFJvb3QgY2VydHMgd2lsbCBiZSB0cmllZFxuICAgICAqIG9uZS1ieS1vbmUgd2hlbiB2YWxpZGF0aW5nIGEgY2VydGlmaWNhdGUgcGF0aC5cbiAgICAgKlxuICAgICAqIENlcnRpZmljYXRlcyBjYW4gYmUgc3BlY2lmaWVkIGFzIGEgcmF3IGBCdWZmZXJgLCBvciBhcyBhIFBFTS1mb3JtYXR0ZWQgc3RyaW5nLiBJZiBhXG4gICAgICogYEJ1ZmZlcmAgaXMgcGFzc2VkIGluIGl0IHdpbGwgYmUgY29udmVydGVkIHRvIFBFTSBmb3JtYXQuXG4gICAgICovXG4gICAgc2V0Um9vdENlcnRpZmljYXRlcyhvcHRzKSB7XG4gICAgICAgIGNvbnN0IHsgaWRlbnRpZmllciwgY2VydGlmaWNhdGVzIH0gPSBvcHRzO1xuICAgICAgICBjb25zdCBuZXdDZXJ0aWZpY2F0ZXMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBjZXJ0IG9mIGNlcnRpZmljYXRlcykge1xuICAgICAgICAgICAgaWYgKGNlcnQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgICAgICAgICAgbmV3Q2VydGlmaWNhdGVzLnB1c2goY29udmVydENlcnRCdWZmZXJUb1BFTShjZXJ0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXdDZXJ0aWZpY2F0ZXMucHVzaChjZXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBlbUNlcnRpZmljYXRlcy5zZXQoaWRlbnRpZmllciwgbmV3Q2VydGlmaWNhdGVzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGFueSByZWdpc3RlcmVkIHJvb3QgY2VydGlmaWNhdGVzIGZvciB0aGUgc3BlY2lmaWVkIGF0dGVzdGF0aW9uIGZvcm1hdFxuICAgICAqL1xuICAgIGdldFJvb3RDZXJ0aWZpY2F0ZXMob3B0cykge1xuICAgICAgICBjb25zdCB7IGlkZW50aWZpZXIgfSA9IG9wdHM7XG4gICAgICAgIHJldHVybiB0aGlzLnBlbUNlcnRpZmljYXRlcy5nZXQoaWRlbnRpZmllcikgPz8gW107XG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IFNldHRpbmdzU2VydmljZSA9IG5ldyBCYXNlU2V0dGluZ3NTZXJ2aWNlKCk7XG4vLyBJbml0aWFsaXplIGRlZmF1bHQgY2VydGlmaWNhdGVzXG5TZXR0aW5nc1NlcnZpY2Uuc2V0Um9vdENlcnRpZmljYXRlcyh7XG4gICAgaWRlbnRpZmllcjogJ2FuZHJvaWQta2V5JyxcbiAgICBjZXJ0aWZpY2F0ZXM6IFtcbiAgICAgICAgR29vZ2xlX0hhcmR3YXJlX0F0dGVzdGF0aW9uX1Jvb3RfMSxcbiAgICAgICAgR29vZ2xlX0hhcmR3YXJlX0F0dGVzdGF0aW9uX1Jvb3RfMixcbiAgICBdLFxufSk7XG5TZXR0aW5nc1NlcnZpY2Uuc2V0Um9vdENlcnRpZmljYXRlcyh7XG4gICAgaWRlbnRpZmllcjogJ2FuZHJvaWQtc2FmZXR5bmV0JyxcbiAgICBjZXJ0aWZpY2F0ZXM6IFtHbG9iYWxTaWduX1Jvb3RfQ0FdLFxufSk7XG5TZXR0aW5nc1NlcnZpY2Uuc2V0Um9vdENlcnRpZmljYXRlcyh7XG4gICAgaWRlbnRpZmllcjogJ2FwcGxlJyxcbiAgICBjZXJ0aWZpY2F0ZXM6IFtBcHBsZV9XZWJBdXRobl9Sb290X0NBXSxcbn0pO1xuU2V0dGluZ3NTZXJ2aWNlLnNldFJvb3RDZXJ0aWZpY2F0ZXMoe1xuICAgIGlkZW50aWZpZXI6ICdtZHMnLFxuICAgIGNlcnRpZmljYXRlczogW0dsb2JhbFNpZ25fUm9vdF9DQV9SM10sXG59KTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@simplewebauthn/server/esm/services/settingsService.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@simplewebauthn/browser/dist/bundle/index.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@simplewebauthn/browser/dist/bundle/index.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WebAuthnAbortService: () => (/* binding */ WebAuthnAbortService),\n/* harmony export */   WebAuthnError: () => (/* binding */ WebAuthnError),\n/* harmony export */   base64URLStringToBuffer: () => (/* binding */ base64URLStringToBuffer),\n/* harmony export */   browserSupportsWebAuthn: () => (/* binding */ browserSupportsWebAuthn),\n/* harmony export */   browserSupportsWebAuthnAutofill: () => (/* binding */ browserSupportsWebAuthnAutofill),\n/* harmony export */   bufferToBase64URLString: () => (/* binding */ bufferToBase64URLString),\n/* harmony export */   platformAuthenticatorIsAvailable: () => (/* binding */ platformAuthenticatorIsAvailable),\n/* harmony export */   startAuthentication: () => (/* binding */ startAuthentication),\n/* harmony export */   startRegistration: () => (/* binding */ startRegistration)\n/* harmony export */ });\n/* [@simplewebauthn/browser@10.0.0] */\nfunction bufferToBase64URLString(buffer) {\n    const bytes = new Uint8Array(buffer);\n    let str = '';\n    for (const charCode of bytes) {\n        str += String.fromCharCode(charCode);\n    }\n    const base64String = btoa(str);\n    return base64String.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n}\n\nfunction base64URLStringToBuffer(base64URLString) {\n    const base64 = base64URLString.replace(/-/g, '+').replace(/_/g, '/');\n    const padLength = (4 - (base64.length % 4)) % 4;\n    const padded = base64.padEnd(base64.length + padLength, '=');\n    const binary = atob(padded);\n    const buffer = new ArrayBuffer(binary.length);\n    const bytes = new Uint8Array(buffer);\n    for (let i = 0; i < binary.length; i++) {\n        bytes[i] = binary.charCodeAt(i);\n    }\n    return buffer;\n}\n\nfunction browserSupportsWebAuthn() {\n    return (window?.PublicKeyCredential !== undefined &&\n        typeof window.PublicKeyCredential === 'function');\n}\n\nfunction toPublicKeyCredentialDescriptor(descriptor) {\n    const { id } = descriptor;\n    return {\n        ...descriptor,\n        id: base64URLStringToBuffer(id),\n        transports: descriptor.transports,\n    };\n}\n\nfunction isValidDomain(hostname) {\n    return (hostname === 'localhost' ||\n        /^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}$/i.test(hostname));\n}\n\nclass WebAuthnError extends Error {\n    constructor({ message, code, cause, name, }) {\n        super(message, { cause });\n        this.name = name ?? cause.name;\n        this.code = code;\n    }\n}\n\nfunction identifyRegistrationError({ error, options, }) {\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal instanceof AbortSignal) {\n            return new WebAuthnError({\n                message: 'Registration ceremony was sent an abort signal',\n                code: 'ERROR_CEREMONY_ABORTED',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'ConstraintError') {\n        if (publicKey.authenticatorSelection?.requireResidentKey === true) {\n            return new WebAuthnError({\n                message: 'Discoverable credentials were required but no available authenticator supported it',\n                code: 'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',\n                cause: error,\n            });\n        }\n        else if (publicKey.authenticatorSelection?.userVerification === 'required') {\n            return new WebAuthnError({\n                message: 'User verification was required but no available authenticator supported it',\n                code: 'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'InvalidStateError') {\n        return new WebAuthnError({\n            message: 'The authenticator was previously registered',\n            code: 'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',\n            cause: error,\n        });\n    }\n    else if (error.name === 'NotAllowedError') {\n        return new WebAuthnError({\n            message: error.message,\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: error,\n        });\n    }\n    else if (error.name === 'NotSupportedError') {\n        const validPubKeyCredParams = publicKey.pubKeyCredParams.filter((param) => param.type === 'public-key');\n        if (validPubKeyCredParams.length === 0) {\n            return new WebAuthnError({\n                message: 'No entry in pubKeyCredParams was of type \"public-key\"',\n                code: 'ERROR_MALFORMED_PUBKEYCREDPARAMS',\n                cause: error,\n            });\n        }\n        return new WebAuthnError({\n            message: 'No available authenticator supported any of the specified pubKeyCredParams algorithms',\n            code: 'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',\n            cause: error,\n        });\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = window.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            return new WebAuthnError({\n                message: `${window.location.hostname} is an invalid domain`,\n                code: 'ERROR_INVALID_DOMAIN',\n                cause: error,\n            });\n        }\n        else if (publicKey.rp.id !== effectiveDomain) {\n            return new WebAuthnError({\n                message: `The RP ID \"${publicKey.rp.id}\" is invalid for this domain`,\n                code: 'ERROR_INVALID_RP_ID',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'TypeError') {\n        if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {\n            return new WebAuthnError({\n                message: 'User ID was not between 1 and 64 characters',\n                code: 'ERROR_INVALID_USER_ID_LENGTH',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        return new WebAuthnError({\n            message: 'The authenticator was unable to process the specified options, or could not create a new credential',\n            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n            cause: error,\n        });\n    }\n    return error;\n}\n\nclass BaseWebAuthnAbortService {\n    createNewAbortSignal() {\n        if (this.controller) {\n            const abortError = new Error('Cancelling existing WebAuthn API call for new one');\n            abortError.name = 'AbortError';\n            this.controller.abort(abortError);\n        }\n        const newController = new AbortController();\n        this.controller = newController;\n        return newController.signal;\n    }\n    cancelCeremony() {\n        if (this.controller) {\n            const abortError = new Error('Manually cancelling existing WebAuthn API call');\n            abortError.name = 'AbortError';\n            this.controller.abort(abortError);\n            this.controller = undefined;\n        }\n    }\n}\nconst WebAuthnAbortService = new BaseWebAuthnAbortService();\n\nconst attachments = ['cross-platform', 'platform'];\nfunction toAuthenticatorAttachment(attachment) {\n    if (!attachment) {\n        return;\n    }\n    if (attachments.indexOf(attachment) < 0) {\n        return;\n    }\n    return attachment;\n}\n\nasync function startRegistration(optionsJSON) {\n    if (!browserSupportsWebAuthn()) {\n        throw new Error('WebAuthn is not supported in this browser');\n    }\n    const publicKey = {\n        ...optionsJSON,\n        challenge: base64URLStringToBuffer(optionsJSON.challenge),\n        user: {\n            ...optionsJSON.user,\n            id: base64URLStringToBuffer(optionsJSON.user.id),\n        },\n        excludeCredentials: optionsJSON.excludeCredentials?.map(toPublicKeyCredentialDescriptor),\n    };\n    const options = { publicKey };\n    options.signal = WebAuthnAbortService.createNewAbortSignal();\n    let credential;\n    try {\n        credential = (await navigator.credentials.create(options));\n    }\n    catch (err) {\n        throw identifyRegistrationError({ error: err, options });\n    }\n    if (!credential) {\n        throw new Error('Registration was not completed');\n    }\n    const { id, rawId, response, type } = credential;\n    let transports = undefined;\n    if (typeof response.getTransports === 'function') {\n        transports = response.getTransports();\n    }\n    let responsePublicKeyAlgorithm = undefined;\n    if (typeof response.getPublicKeyAlgorithm === 'function') {\n        try {\n            responsePublicKeyAlgorithm = response.getPublicKeyAlgorithm();\n        }\n        catch (error) {\n            warnOnBrokenImplementation('getPublicKeyAlgorithm()', error);\n        }\n    }\n    let responsePublicKey = undefined;\n    if (typeof response.getPublicKey === 'function') {\n        try {\n            const _publicKey = response.getPublicKey();\n            if (_publicKey !== null) {\n                responsePublicKey = bufferToBase64URLString(_publicKey);\n            }\n        }\n        catch (error) {\n            warnOnBrokenImplementation('getPublicKey()', error);\n        }\n    }\n    let responseAuthenticatorData;\n    if (typeof response.getAuthenticatorData === 'function') {\n        try {\n            responseAuthenticatorData = bufferToBase64URLString(response.getAuthenticatorData());\n        }\n        catch (error) {\n            warnOnBrokenImplementation('getAuthenticatorData()', error);\n        }\n    }\n    return {\n        id,\n        rawId: bufferToBase64URLString(rawId),\n        response: {\n            attestationObject: bufferToBase64URLString(response.attestationObject),\n            clientDataJSON: bufferToBase64URLString(response.clientDataJSON),\n            transports,\n            publicKeyAlgorithm: responsePublicKeyAlgorithm,\n            publicKey: responsePublicKey,\n            authenticatorData: responseAuthenticatorData,\n        },\n        type,\n        clientExtensionResults: credential.getClientExtensionResults(),\n        authenticatorAttachment: toAuthenticatorAttachment(credential.authenticatorAttachment),\n    };\n}\nfunction warnOnBrokenImplementation(methodName, cause) {\n    console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${methodName}. You should report this error to them.\\n`, cause);\n}\n\nfunction browserSupportsWebAuthnAutofill() {\n    if (!browserSupportsWebAuthn()) {\n        return new Promise((resolve) => resolve(false));\n    }\n    const globalPublicKeyCredential = window\n        .PublicKeyCredential;\n    if (globalPublicKeyCredential.isConditionalMediationAvailable === undefined) {\n        return new Promise((resolve) => resolve(false));\n    }\n    return globalPublicKeyCredential.isConditionalMediationAvailable();\n}\n\nfunction identifyAuthenticationError({ error, options, }) {\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal instanceof AbortSignal) {\n            return new WebAuthnError({\n                message: 'Authentication ceremony was sent an abort signal',\n                code: 'ERROR_CEREMONY_ABORTED',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'NotAllowedError') {\n        return new WebAuthnError({\n            message: error.message,\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: error,\n        });\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = window.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            return new WebAuthnError({\n                message: `${window.location.hostname} is an invalid domain`,\n                code: 'ERROR_INVALID_DOMAIN',\n                cause: error,\n            });\n        }\n        else if (publicKey.rpId !== effectiveDomain) {\n            return new WebAuthnError({\n                message: `The RP ID \"${publicKey.rpId}\" is invalid for this domain`,\n                code: 'ERROR_INVALID_RP_ID',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        return new WebAuthnError({\n            message: 'The authenticator was unable to process the specified options, or could not create a new assertion signature',\n            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n            cause: error,\n        });\n    }\n    return error;\n}\n\nasync function startAuthentication(optionsJSON, useBrowserAutofill = false) {\n    if (!browserSupportsWebAuthn()) {\n        throw new Error('WebAuthn is not supported in this browser');\n    }\n    let allowCredentials;\n    if (optionsJSON.allowCredentials?.length !== 0) {\n        allowCredentials = optionsJSON.allowCredentials?.map(toPublicKeyCredentialDescriptor);\n    }\n    const publicKey = {\n        ...optionsJSON,\n        challenge: base64URLStringToBuffer(optionsJSON.challenge),\n        allowCredentials,\n    };\n    const options = {};\n    if (useBrowserAutofill) {\n        if (!(await browserSupportsWebAuthnAutofill())) {\n            throw Error('Browser does not support WebAuthn autofill');\n        }\n        const eligibleInputs = document.querySelectorAll(\"input[autocomplete$='webauthn']\");\n        if (eligibleInputs.length < 1) {\n            throw Error('No <input> with \"webauthn\" as the only or last value in its `autocomplete` attribute was detected');\n        }\n        options.mediation = 'conditional';\n        publicKey.allowCredentials = [];\n    }\n    options.publicKey = publicKey;\n    options.signal = WebAuthnAbortService.createNewAbortSignal();\n    let credential;\n    try {\n        credential = (await navigator.credentials.get(options));\n    }\n    catch (err) {\n        throw identifyAuthenticationError({ error: err, options });\n    }\n    if (!credential) {\n        throw new Error('Authentication was not completed');\n    }\n    const { id, rawId, response, type } = credential;\n    let userHandle = undefined;\n    if (response.userHandle) {\n        userHandle = bufferToBase64URLString(response.userHandle);\n    }\n    return {\n        id,\n        rawId: bufferToBase64URLString(rawId),\n        response: {\n            authenticatorData: bufferToBase64URLString(response.authenticatorData),\n            clientDataJSON: bufferToBase64URLString(response.clientDataJSON),\n            signature: bufferToBase64URLString(response.signature),\n            userHandle,\n        },\n        type,\n        clientExtensionResults: credential.getClientExtensionResults(),\n        authenticatorAttachment: toAuthenticatorAttachment(credential.authenticatorAttachment),\n    };\n}\n\nfunction platformAuthenticatorIsAvailable() {\n    if (!browserSupportsWebAuthn()) {\n        return new Promise((resolve) => resolve(false));\n    }\n    return PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHNpbXBsZXdlYmF1dGhuL2Jyb3dzZXIvZGlzdC9idW5kbGUvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsbUJBQW1CO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsWUFBWSxLQUFLO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMkNBQTJDLEdBQUc7QUFDOUM7O0FBRUE7QUFDQSxrQkFBa0IsNkJBQTZCO0FBQy9DLHlCQUF5QixPQUFPO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFDQUFxQyxpQkFBaUI7QUFDdEQsWUFBWSxZQUFZO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMEJBQTBCO0FBQ3REO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLGdCQUFnQjtBQUN2RDtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxxQkFBcUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDRCQUE0QjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBHQUEwRyxXQUFXO0FBQ3JIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsdUNBQXVDLGlCQUFpQjtBQUN4RCxZQUFZLFlBQVk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsMEJBQTBCO0FBQ3REO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLGVBQWU7QUFDdEQ7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxxQkFBcUI7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDRCQUE0QjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFPIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGR5XFxEZXNrdG9wXFxnaXRodWJjb3BpbG90XFxOVVMtSVNTLUFJLVNETEMtR3JvdXAxLVRvRG9BcHBcXG5vZGVfbW9kdWxlc1xcQHNpbXBsZXdlYmF1dGhuXFxicm93c2VyXFxkaXN0XFxidW5kbGVcXGluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIFtAc2ltcGxld2ViYXV0aG4vYnJvd3NlckAxMC4wLjBdICovXG5mdW5jdGlvbiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhidWZmZXIpIHtcbiAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgbGV0IHN0ciA9ICcnO1xuICAgIGZvciAoY29uc3QgY2hhckNvZGUgb2YgYnl0ZXMpIHtcbiAgICAgICAgc3RyICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpO1xuICAgIH1cbiAgICBjb25zdCBiYXNlNjRTdHJpbmcgPSBidG9hKHN0cik7XG4gICAgcmV0dXJuIGJhc2U2NFN0cmluZy5yZXBsYWNlKC9cXCsvZywgJy0nKS5yZXBsYWNlKC9cXC8vZywgJ18nKS5yZXBsYWNlKC89L2csICcnKTtcbn1cblxuZnVuY3Rpb24gYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIoYmFzZTY0VVJMU3RyaW5nKSB7XG4gICAgY29uc3QgYmFzZTY0ID0gYmFzZTY0VVJMU3RyaW5nLnJlcGxhY2UoLy0vZywgJysnKS5yZXBsYWNlKC9fL2csICcvJyk7XG4gICAgY29uc3QgcGFkTGVuZ3RoID0gKDQgLSAoYmFzZTY0Lmxlbmd0aCAlIDQpKSAlIDQ7XG4gICAgY29uc3QgcGFkZGVkID0gYmFzZTY0LnBhZEVuZChiYXNlNjQubGVuZ3RoICsgcGFkTGVuZ3RoLCAnPScpO1xuICAgIGNvbnN0IGJpbmFyeSA9IGF0b2IocGFkZGVkKTtcbiAgICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoYmluYXJ5Lmxlbmd0aCk7XG4gICAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJ5dGVzW2ldID0gYmluYXJ5LmNoYXJDb2RlQXQoaSk7XG4gICAgfVxuICAgIHJldHVybiBidWZmZXI7XG59XG5cbmZ1bmN0aW9uIGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuKCkge1xuICAgIHJldHVybiAod2luZG93Py5QdWJsaWNLZXlDcmVkZW50aWFsICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgdHlwZW9mIHdpbmRvdy5QdWJsaWNLZXlDcmVkZW50aWFsID09PSAnZnVuY3Rpb24nKTtcbn1cblxuZnVuY3Rpb24gdG9QdWJsaWNLZXlDcmVkZW50aWFsRGVzY3JpcHRvcihkZXNjcmlwdG9yKSB7XG4gICAgY29uc3QgeyBpZCB9ID0gZGVzY3JpcHRvcjtcbiAgICByZXR1cm4ge1xuICAgICAgICAuLi5kZXNjcmlwdG9yLFxuICAgICAgICBpZDogYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIoaWQpLFxuICAgICAgICB0cmFuc3BvcnRzOiBkZXNjcmlwdG9yLnRyYW5zcG9ydHMsXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaXNWYWxpZERvbWFpbihob3N0bmFtZSkge1xuICAgIHJldHVybiAoaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnIHx8XG4gICAgICAgIC9eKFthLXowLTldKygtW2EtejAtOV0rKSpcXC4pK1thLXpdezIsfSQvaS50ZXN0KGhvc3RuYW1lKSk7XG59XG5cbmNsYXNzIFdlYkF1dGhuRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoeyBtZXNzYWdlLCBjb2RlLCBjYXVzZSwgbmFtZSwgfSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlLCB7IGNhdXNlIH0pO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lID8/IGNhdXNlLm5hbWU7XG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBpZGVudGlmeVJlZ2lzdHJhdGlvbkVycm9yKHsgZXJyb3IsIG9wdGlvbnMsIH0pIHtcbiAgICBjb25zdCB7IHB1YmxpY0tleSB9ID0gb3B0aW9ucztcbiAgICBpZiAoIXB1YmxpY0tleSkge1xuICAgICAgICB0aHJvdyBFcnJvcignb3B0aW9ucyB3YXMgbWlzc2luZyByZXF1aXJlZCBwdWJsaWNLZXkgcHJvcGVydHknKTtcbiAgICB9XG4gICAgaWYgKGVycm9yLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICBpZiAob3B0aW9ucy5zaWduYWwgaW5zdGFuY2VvZiBBYm9ydFNpZ25hbCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnUmVnaXN0cmF0aW9uIGNlcmVtb255IHdhcyBzZW50IGFuIGFib3J0IHNpZ25hbCcsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0NFUkVNT05ZX0FCT1JURUQnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdDb25zdHJhaW50RXJyb3InKSB7XG4gICAgICAgIGlmIChwdWJsaWNLZXkuYXV0aGVudGljYXRvclNlbGVjdGlvbj8ucmVxdWlyZVJlc2lkZW50S2V5ID09PSB0cnVlKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdEaXNjb3ZlcmFibGUgY3JlZGVudGlhbHMgd2VyZSByZXF1aXJlZCBidXQgbm8gYXZhaWxhYmxlIGF1dGhlbnRpY2F0b3Igc3VwcG9ydGVkIGl0JyxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfQVVUSEVOVElDQVRPUl9NSVNTSU5HX0RJU0NPVkVSQUJMRV9DUkVERU5USUFMX1NVUFBPUlQnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHB1YmxpY0tleS5hdXRoZW50aWNhdG9yU2VsZWN0aW9uPy51c2VyVmVyaWZpY2F0aW9uID09PSAncmVxdWlyZWQnKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdVc2VyIHZlcmlmaWNhdGlvbiB3YXMgcmVxdWlyZWQgYnV0IG5vIGF2YWlsYWJsZSBhdXRoZW50aWNhdG9yIHN1cHBvcnRlZCBpdCcsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0FVVEhFTlRJQ0FUT1JfTUlTU0lOR19VU0VSX1ZFUklGSUNBVElPTl9TVVBQT1JUJyxcbiAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnSW52YWxpZFN0YXRlRXJyb3InKSB7XG4gICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiAnVGhlIGF1dGhlbnRpY2F0b3Igd2FzIHByZXZpb3VzbHkgcmVnaXN0ZXJlZCcsXG4gICAgICAgICAgICBjb2RlOiAnRVJST1JfQVVUSEVOVElDQVRPUl9QUkVWSU9VU0xZX1JFR0lTVEVSRUQnLFxuICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ05vdEFsbG93ZWRFcnJvcicpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICBjb2RlOiAnRVJST1JfUEFTU1RIUk9VR0hfU0VFX0NBVVNFX1BST1BFUlRZJyxcbiAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdOb3RTdXBwb3J0ZWRFcnJvcicpIHtcbiAgICAgICAgY29uc3QgdmFsaWRQdWJLZXlDcmVkUGFyYW1zID0gcHVibGljS2V5LnB1YktleUNyZWRQYXJhbXMuZmlsdGVyKChwYXJhbSkgPT4gcGFyYW0udHlwZSA9PT0gJ3B1YmxpYy1rZXknKTtcbiAgICAgICAgaWYgKHZhbGlkUHViS2V5Q3JlZFBhcmFtcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ05vIGVudHJ5IGluIHB1YktleUNyZWRQYXJhbXMgd2FzIG9mIHR5cGUgXCJwdWJsaWMta2V5XCInLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9NQUxGT1JNRURfUFVCS0VZQ1JFRFBBUkFNUycsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdObyBhdmFpbGFibGUgYXV0aGVudGljYXRvciBzdXBwb3J0ZWQgYW55IG9mIHRoZSBzcGVjaWZpZWQgcHViS2V5Q3JlZFBhcmFtcyBhbGdvcml0aG1zJyxcbiAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9BVVRIRU5USUNBVE9SX05PX1NVUFBPUlRFRF9QVUJLRVlDUkVEUEFSQU1TX0FMRycsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnU2VjdXJpdHlFcnJvcicpIHtcbiAgICAgICAgY29uc3QgZWZmZWN0aXZlRG9tYWluID0gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lO1xuICAgICAgICBpZiAoIWlzVmFsaWREb21haW4oZWZmZWN0aXZlRG9tYWluKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgJHt3aW5kb3cubG9jYXRpb24uaG9zdG5hbWV9IGlzIGFuIGludmFsaWQgZG9tYWluYCxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfSU5WQUxJRF9ET01BSU4nLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHB1YmxpY0tleS5ycC5pZCAhPT0gZWZmZWN0aXZlRG9tYWluKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBUaGUgUlAgSUQgXCIke3B1YmxpY0tleS5ycC5pZH1cIiBpcyBpbnZhbGlkIGZvciB0aGlzIGRvbWFpbmAsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0lOVkFMSURfUlBfSUQnLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGVycm9yLm5hbWUgPT09ICdUeXBlRXJyb3InKSB7XG4gICAgICAgIGlmIChwdWJsaWNLZXkudXNlci5pZC5ieXRlTGVuZ3RoIDwgMSB8fCBwdWJsaWNLZXkudXNlci5pZC5ieXRlTGVuZ3RoID4gNjQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1VzZXIgSUQgd2FzIG5vdCBiZXR3ZWVuIDEgYW5kIDY0IGNoYXJhY3RlcnMnLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9JTlZBTElEX1VTRVJfSURfTEVOR1RIJyxcbiAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnVW5rbm93bkVycm9yJykge1xuICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogJ1RoZSBhdXRoZW50aWNhdG9yIHdhcyB1bmFibGUgdG8gcHJvY2VzcyB0aGUgc3BlY2lmaWVkIG9wdGlvbnMsIG9yIGNvdWxkIG5vdCBjcmVhdGUgYSBuZXcgY3JlZGVudGlhbCcsXG4gICAgICAgICAgICBjb2RlOiAnRVJST1JfQVVUSEVOVElDQVRPUl9HRU5FUkFMX0VSUk9SJyxcbiAgICAgICAgICAgIGNhdXNlOiBlcnJvcixcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBlcnJvcjtcbn1cblxuY2xhc3MgQmFzZVdlYkF1dGhuQWJvcnRTZXJ2aWNlIHtcbiAgICBjcmVhdGVOZXdBYm9ydFNpZ25hbCgpIHtcbiAgICAgICAgaWYgKHRoaXMuY29udHJvbGxlcikge1xuICAgICAgICAgICAgY29uc3QgYWJvcnRFcnJvciA9IG5ldyBFcnJvcignQ2FuY2VsbGluZyBleGlzdGluZyBXZWJBdXRobiBBUEkgY2FsbCBmb3IgbmV3IG9uZScpO1xuICAgICAgICAgICAgYWJvcnRFcnJvci5uYW1lID0gJ0Fib3J0RXJyb3InO1xuICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLmFib3J0KGFib3J0RXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld0NvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgIHRoaXMuY29udHJvbGxlciA9IG5ld0NvbnRyb2xsZXI7XG4gICAgICAgIHJldHVybiBuZXdDb250cm9sbGVyLnNpZ25hbDtcbiAgICB9XG4gICAgY2FuY2VsQ2VyZW1vbnkoKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGFib3J0RXJyb3IgPSBuZXcgRXJyb3IoJ01hbnVhbGx5IGNhbmNlbGxpbmcgZXhpc3RpbmcgV2ViQXV0aG4gQVBJIGNhbGwnKTtcbiAgICAgICAgICAgIGFib3J0RXJyb3IubmFtZSA9ICdBYm9ydEVycm9yJztcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlci5hYm9ydChhYm9ydEVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmNvbnN0IFdlYkF1dGhuQWJvcnRTZXJ2aWNlID0gbmV3IEJhc2VXZWJBdXRobkFib3J0U2VydmljZSgpO1xuXG5jb25zdCBhdHRhY2htZW50cyA9IFsnY3Jvc3MtcGxhdGZvcm0nLCAncGxhdGZvcm0nXTtcbmZ1bmN0aW9uIHRvQXV0aGVudGljYXRvckF0dGFjaG1lbnQoYXR0YWNobWVudCkge1xuICAgIGlmICghYXR0YWNobWVudCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChhdHRhY2htZW50cy5pbmRleE9mKGF0dGFjaG1lbnQpIDwgMCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiBhdHRhY2htZW50O1xufVxuXG5hc3luYyBmdW5jdGlvbiBzdGFydFJlZ2lzdHJhdGlvbihvcHRpb25zSlNPTikge1xuICAgIGlmICghYnJvd3NlclN1cHBvcnRzV2ViQXV0aG4oKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dlYkF1dGhuIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyJyk7XG4gICAgfVxuICAgIGNvbnN0IHB1YmxpY0tleSA9IHtcbiAgICAgICAgLi4ub3B0aW9uc0pTT04sXG4gICAgICAgIGNoYWxsZW5nZTogYmFzZTY0VVJMU3RyaW5nVG9CdWZmZXIob3B0aW9uc0pTT04uY2hhbGxlbmdlKSxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgLi4ub3B0aW9uc0pTT04udXNlcixcbiAgICAgICAgICAgIGlkOiBiYXNlNjRVUkxTdHJpbmdUb0J1ZmZlcihvcHRpb25zSlNPTi51c2VyLmlkKSxcbiAgICAgICAgfSxcbiAgICAgICAgZXhjbHVkZUNyZWRlbnRpYWxzOiBvcHRpb25zSlNPTi5leGNsdWRlQ3JlZGVudGlhbHM/Lm1hcCh0b1B1YmxpY0tleUNyZWRlbnRpYWxEZXNjcmlwdG9yKSxcbiAgICB9O1xuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHB1YmxpY0tleSB9O1xuICAgIG9wdGlvbnMuc2lnbmFsID0gV2ViQXV0aG5BYm9ydFNlcnZpY2UuY3JlYXRlTmV3QWJvcnRTaWduYWwoKTtcbiAgICBsZXQgY3JlZGVudGlhbDtcbiAgICB0cnkge1xuICAgICAgICBjcmVkZW50aWFsID0gKGF3YWl0IG5hdmlnYXRvci5jcmVkZW50aWFscy5jcmVhdGUob3B0aW9ucykpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IGlkZW50aWZ5UmVnaXN0cmF0aW9uRXJyb3IoeyBlcnJvcjogZXJyLCBvcHRpb25zIH0pO1xuICAgIH1cbiAgICBpZiAoIWNyZWRlbnRpYWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWdpc3RyYXRpb24gd2FzIG5vdCBjb21wbGV0ZWQnKTtcbiAgICB9XG4gICAgY29uc3QgeyBpZCwgcmF3SWQsIHJlc3BvbnNlLCB0eXBlIH0gPSBjcmVkZW50aWFsO1xuICAgIGxldCB0cmFuc3BvcnRzID0gdW5kZWZpbmVkO1xuICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuZ2V0VHJhbnNwb3J0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0cmFuc3BvcnRzID0gcmVzcG9uc2UuZ2V0VHJhbnNwb3J0cygpO1xuICAgIH1cbiAgICBsZXQgcmVzcG9uc2VQdWJsaWNLZXlBbGdvcml0aG0gPSB1bmRlZmluZWQ7XG4gICAgaWYgKHR5cGVvZiByZXNwb25zZS5nZXRQdWJsaWNLZXlBbGdvcml0aG0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlc3BvbnNlUHVibGljS2V5QWxnb3JpdGhtID0gcmVzcG9uc2UuZ2V0UHVibGljS2V5QWxnb3JpdGhtKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB3YXJuT25Ccm9rZW5JbXBsZW1lbnRhdGlvbignZ2V0UHVibGljS2V5QWxnb3JpdGhtKCknLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IHJlc3BvbnNlUHVibGljS2V5ID0gdW5kZWZpbmVkO1xuICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuZ2V0UHVibGljS2V5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBfcHVibGljS2V5ID0gcmVzcG9uc2UuZ2V0UHVibGljS2V5KCk7XG4gICAgICAgICAgICBpZiAoX3B1YmxpY0tleSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlUHVibGljS2V5ID0gYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcoX3B1YmxpY0tleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB3YXJuT25Ccm9rZW5JbXBsZW1lbnRhdGlvbignZ2V0UHVibGljS2V5KCknLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IHJlc3BvbnNlQXV0aGVudGljYXRvckRhdGE7XG4gICAgaWYgKHR5cGVvZiByZXNwb25zZS5nZXRBdXRoZW50aWNhdG9yRGF0YSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzcG9uc2VBdXRoZW50aWNhdG9yRGF0YSA9IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJlc3BvbnNlLmdldEF1dGhlbnRpY2F0b3JEYXRhKCkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgd2Fybk9uQnJva2VuSW1wbGVtZW50YXRpb24oJ2dldEF1dGhlbnRpY2F0b3JEYXRhKCknLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaWQsXG4gICAgICAgIHJhd0lkOiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhyYXdJZCksXG4gICAgICAgIHJlc3BvbnNlOiB7XG4gICAgICAgICAgICBhdHRlc3RhdGlvbk9iamVjdDogYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmVzcG9uc2UuYXR0ZXN0YXRpb25PYmplY3QpLFxuICAgICAgICAgICAgY2xpZW50RGF0YUpTT046IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJlc3BvbnNlLmNsaWVudERhdGFKU09OKSxcbiAgICAgICAgICAgIHRyYW5zcG9ydHMsXG4gICAgICAgICAgICBwdWJsaWNLZXlBbGdvcml0aG06IHJlc3BvbnNlUHVibGljS2V5QWxnb3JpdGhtLFxuICAgICAgICAgICAgcHVibGljS2V5OiByZXNwb25zZVB1YmxpY0tleSxcbiAgICAgICAgICAgIGF1dGhlbnRpY2F0b3JEYXRhOiByZXNwb25zZUF1dGhlbnRpY2F0b3JEYXRhLFxuICAgICAgICB9LFxuICAgICAgICB0eXBlLFxuICAgICAgICBjbGllbnRFeHRlbnNpb25SZXN1bHRzOiBjcmVkZW50aWFsLmdldENsaWVudEV4dGVuc2lvblJlc3VsdHMoKSxcbiAgICAgICAgYXV0aGVudGljYXRvckF0dGFjaG1lbnQ6IHRvQXV0aGVudGljYXRvckF0dGFjaG1lbnQoY3JlZGVudGlhbC5hdXRoZW50aWNhdG9yQXR0YWNobWVudCksXG4gICAgfTtcbn1cbmZ1bmN0aW9uIHdhcm5PbkJyb2tlbkltcGxlbWVudGF0aW9uKG1ldGhvZE5hbWUsIGNhdXNlKSB7XG4gICAgY29uc29sZS53YXJuKGBUaGUgYnJvd3NlciBleHRlbnNpb24gdGhhdCBpbnRlcmNlcHRlZCB0aGlzIFdlYkF1dGhuIEFQSSBjYWxsIGluY29ycmVjdGx5IGltcGxlbWVudGVkICR7bWV0aG9kTmFtZX0uIFlvdSBzaG91bGQgcmVwb3J0IHRoaXMgZXJyb3IgdG8gdGhlbS5cXG5gLCBjYXVzZSk7XG59XG5cbmZ1bmN0aW9uIGJyb3dzZXJTdXBwb3J0c1dlYkF1dGhuQXV0b2ZpbGwoKSB7XG4gICAgaWYgKCFicm93c2VyU3VwcG9ydHNXZWJBdXRobigpKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcmVzb2x2ZShmYWxzZSkpO1xuICAgIH1cbiAgICBjb25zdCBnbG9iYWxQdWJsaWNLZXlDcmVkZW50aWFsID0gd2luZG93XG4gICAgICAgIC5QdWJsaWNLZXlDcmVkZW50aWFsO1xuICAgIGlmIChnbG9iYWxQdWJsaWNLZXlDcmVkZW50aWFsLmlzQ29uZGl0aW9uYWxNZWRpYXRpb25BdmFpbGFibGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHJlc29sdmUoZmFsc2UpKTtcbiAgICB9XG4gICAgcmV0dXJuIGdsb2JhbFB1YmxpY0tleUNyZWRlbnRpYWwuaXNDb25kaXRpb25hbE1lZGlhdGlvbkF2YWlsYWJsZSgpO1xufVxuXG5mdW5jdGlvbiBpZGVudGlmeUF1dGhlbnRpY2F0aW9uRXJyb3IoeyBlcnJvciwgb3B0aW9ucywgfSkge1xuICAgIGNvbnN0IHsgcHVibGljS2V5IH0gPSBvcHRpb25zO1xuICAgIGlmICghcHVibGljS2V5KSB7XG4gICAgICAgIHRocm93IEVycm9yKCdvcHRpb25zIHdhcyBtaXNzaW5nIHJlcXVpcmVkIHB1YmxpY0tleSBwcm9wZXJ0eScpO1xuICAgIH1cbiAgICBpZiAoZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InKSB7XG4gICAgICAgIGlmIChvcHRpb25zLnNpZ25hbCBpbnN0YW5jZW9mIEFib3J0U2lnbmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdBdXRoZW50aWNhdGlvbiBjZXJlbW9ueSB3YXMgc2VudCBhbiBhYm9ydCBzaWduYWwnLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9DRVJFTU9OWV9BQk9SVEVEJyxcbiAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChlcnJvci5uYW1lID09PSAnTm90QWxsb3dlZEVycm9yJykge1xuICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgIGNvZGU6ICdFUlJPUl9QQVNTVEhST1VHSF9TRUVfQ0FVU0VfUFJPUEVSVFknLFxuICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ1NlY3VyaXR5RXJyb3InKSB7XG4gICAgICAgIGNvbnN0IGVmZmVjdGl2ZURvbWFpbiA9IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZTtcbiAgICAgICAgaWYgKCFpc1ZhbGlkRG9tYWluKGVmZmVjdGl2ZURvbWFpbikpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2ViQXV0aG5FcnJvcih7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYCR7d2luZG93LmxvY2F0aW9uLmhvc3RuYW1lfSBpcyBhbiBpbnZhbGlkIGRvbWFpbmAsXG4gICAgICAgICAgICAgICAgY29kZTogJ0VSUk9SX0lOVkFMSURfRE9NQUlOJyxcbiAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwdWJsaWNLZXkucnBJZCAhPT0gZWZmZWN0aXZlRG9tYWluKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdlYkF1dGhuRXJyb3Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBUaGUgUlAgSUQgXCIke3B1YmxpY0tleS5ycElkfVwiIGlzIGludmFsaWQgZm9yIHRoaXMgZG9tYWluYCxcbiAgICAgICAgICAgICAgICBjb2RlOiAnRVJST1JfSU5WQUxJRF9SUF9JRCcsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoZXJyb3IubmFtZSA9PT0gJ1Vua25vd25FcnJvcicpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJBdXRobkVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdUaGUgYXV0aGVudGljYXRvciB3YXMgdW5hYmxlIHRvIHByb2Nlc3MgdGhlIHNwZWNpZmllZCBvcHRpb25zLCBvciBjb3VsZCBub3QgY3JlYXRlIGEgbmV3IGFzc2VydGlvbiBzaWduYXR1cmUnLFxuICAgICAgICAgICAgY29kZTogJ0VSUk9SX0FVVEhFTlRJQ0FUT1JfR0VORVJBTF9FUlJPUicsXG4gICAgICAgICAgICBjYXVzZTogZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZXJyb3I7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0QXV0aGVudGljYXRpb24ob3B0aW9uc0pTT04sIHVzZUJyb3dzZXJBdXRvZmlsbCA9IGZhbHNlKSB7XG4gICAgaWYgKCFicm93c2VyU3VwcG9ydHNXZWJBdXRobigpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV2ViQXV0aG4gaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXInKTtcbiAgICB9XG4gICAgbGV0IGFsbG93Q3JlZGVudGlhbHM7XG4gICAgaWYgKG9wdGlvbnNKU09OLmFsbG93Q3JlZGVudGlhbHM/Lmxlbmd0aCAhPT0gMCkge1xuICAgICAgICBhbGxvd0NyZWRlbnRpYWxzID0gb3B0aW9uc0pTT04uYWxsb3dDcmVkZW50aWFscz8ubWFwKHRvUHVibGljS2V5Q3JlZGVudGlhbERlc2NyaXB0b3IpO1xuICAgIH1cbiAgICBjb25zdCBwdWJsaWNLZXkgPSB7XG4gICAgICAgIC4uLm9wdGlvbnNKU09OLFxuICAgICAgICBjaGFsbGVuZ2U6IGJhc2U2NFVSTFN0cmluZ1RvQnVmZmVyKG9wdGlvbnNKU09OLmNoYWxsZW5nZSksXG4gICAgICAgIGFsbG93Q3JlZGVudGlhbHMsXG4gICAgfTtcbiAgICBjb25zdCBvcHRpb25zID0ge307XG4gICAgaWYgKHVzZUJyb3dzZXJBdXRvZmlsbCkge1xuICAgICAgICBpZiAoIShhd2FpdCBicm93c2VyU3VwcG9ydHNXZWJBdXRobkF1dG9maWxsKCkpKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignQnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IFdlYkF1dGhuIGF1dG9maWxsJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZWxpZ2libGVJbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbYXV0b2NvbXBsZXRlJD0nd2ViYXV0aG4nXVwiKTtcbiAgICAgICAgaWYgKGVsaWdpYmxlSW5wdXRzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdObyA8aW5wdXQ+IHdpdGggXCJ3ZWJhdXRoblwiIGFzIHRoZSBvbmx5IG9yIGxhc3QgdmFsdWUgaW4gaXRzIGBhdXRvY29tcGxldGVgIGF0dHJpYnV0ZSB3YXMgZGV0ZWN0ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBvcHRpb25zLm1lZGlhdGlvbiA9ICdjb25kaXRpb25hbCc7XG4gICAgICAgIHB1YmxpY0tleS5hbGxvd0NyZWRlbnRpYWxzID0gW107XG4gICAgfVxuICAgIG9wdGlvbnMucHVibGljS2V5ID0gcHVibGljS2V5O1xuICAgIG9wdGlvbnMuc2lnbmFsID0gV2ViQXV0aG5BYm9ydFNlcnZpY2UuY3JlYXRlTmV3QWJvcnRTaWduYWwoKTtcbiAgICBsZXQgY3JlZGVudGlhbDtcbiAgICB0cnkge1xuICAgICAgICBjcmVkZW50aWFsID0gKGF3YWl0IG5hdmlnYXRvci5jcmVkZW50aWFscy5nZXQob3B0aW9ucykpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IGlkZW50aWZ5QXV0aGVudGljYXRpb25FcnJvcih7IGVycm9yOiBlcnIsIG9wdGlvbnMgfSk7XG4gICAgfVxuICAgIGlmICghY3JlZGVudGlhbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0F1dGhlbnRpY2F0aW9uIHdhcyBub3QgY29tcGxldGVkJyk7XG4gICAgfVxuICAgIGNvbnN0IHsgaWQsIHJhd0lkLCByZXNwb25zZSwgdHlwZSB9ID0gY3JlZGVudGlhbDtcbiAgICBsZXQgdXNlckhhbmRsZSA9IHVuZGVmaW5lZDtcbiAgICBpZiAocmVzcG9uc2UudXNlckhhbmRsZSkge1xuICAgICAgICB1c2VySGFuZGxlID0gYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmVzcG9uc2UudXNlckhhbmRsZSk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGlkLFxuICAgICAgICByYXdJZDogYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcocmF3SWQpLFxuICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgICAgYXV0aGVudGljYXRvckRhdGE6IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJlc3BvbnNlLmF1dGhlbnRpY2F0b3JEYXRhKSxcbiAgICAgICAgICAgIGNsaWVudERhdGFKU09OOiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhyZXNwb25zZS5jbGllbnREYXRhSlNPTiksXG4gICAgICAgICAgICBzaWduYXR1cmU6IGJ1ZmZlclRvQmFzZTY0VVJMU3RyaW5nKHJlc3BvbnNlLnNpZ25hdHVyZSksXG4gICAgICAgICAgICB1c2VySGFuZGxlLFxuICAgICAgICB9LFxuICAgICAgICB0eXBlLFxuICAgICAgICBjbGllbnRFeHRlbnNpb25SZXN1bHRzOiBjcmVkZW50aWFsLmdldENsaWVudEV4dGVuc2lvblJlc3VsdHMoKSxcbiAgICAgICAgYXV0aGVudGljYXRvckF0dGFjaG1lbnQ6IHRvQXV0aGVudGljYXRvckF0dGFjaG1lbnQoY3JlZGVudGlhbC5hdXRoZW50aWNhdG9yQXR0YWNobWVudCksXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gcGxhdGZvcm1BdXRoZW50aWNhdG9ySXNBdmFpbGFibGUoKSB7XG4gICAgaWYgKCFicm93c2VyU3VwcG9ydHNXZWJBdXRobigpKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcmVzb2x2ZShmYWxzZSkpO1xuICAgIH1cbiAgICByZXR1cm4gUHVibGljS2V5Q3JlZGVudGlhbC5pc1VzZXJWZXJpZnlpbmdQbGF0Zm9ybUF1dGhlbnRpY2F0b3JBdmFpbGFibGUoKTtcbn1cblxuZXhwb3J0IHsgV2ViQXV0aG5BYm9ydFNlcnZpY2UsIFdlYkF1dGhuRXJyb3IsIGJhc2U2NFVSTFN0cmluZ1RvQnVmZmVyLCBicm93c2VyU3VwcG9ydHNXZWJBdXRobiwgYnJvd3NlclN1cHBvcnRzV2ViQXV0aG5BdXRvZmlsbCwgYnVmZmVyVG9CYXNlNjRVUkxTdHJpbmcsIHBsYXRmb3JtQXV0aGVudGljYXRvcklzQXZhaWxhYmxlLCBzdGFydEF1dGhlbnRpY2F0aW9uLCBzdGFydFJlZ2lzdHJhdGlvbiB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@simplewebauthn/browser/dist/bundle/index.js\n");

/***/ })

};
;